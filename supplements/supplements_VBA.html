<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="author" content="Choquet Olivier & Vandenheede Driss">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Les fondamentaux VBA - Suppléments - e-Syllabus HTML5 et CSS3</title>
        <!-- une icône dans la barre du navigateur -->
        <link rel="icon" href="../images/favicon.png" type="image/png">
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <!-- liens d'évitement -->
        <ul class="a11y-nav">
            <li>
                <a href="#container">Passer directement au contenu</a>
            </li>
            <li>
                <a href="#menu">Accéder au menu secondaire de la page</a>
            </li>
            <li>
                <a href="#aside">Accéder aux liens utiles</a>
            </li>
        </ul>
        <!-- bannière et menu -->
        <header role="banner">
            <div class="logoTitle">
                <h1>Cours d'introduction au Web</h1>
                <h2>HTML5 et CSS3</h2>
            </div>
            <nav role="navigation" aria-label="Menu principal de navigation">
                <ul>
                    <li><a href="../index.html">Le cours</a></li>
                    <li><a href="../internet.html">Internet</a></li>
                    <li><a href="../html5.html">HTML5</a></li>
                    <li><a href="../css3.html">CSS3</a></li>
                    <li><a href="../methodologie.html">Méthodologie</a></li>
                    <li><a href="../lexique.html">Lexique</a></li>
                    <li><a href="../supplements.html" class="current">Suppléments</a></li>
                </ul>
            </nav>
        </header>
        <main id="container" role="main" tabindex="-1">
            <div id="menu">
                <nav role="navigation">
                    <ol>
                        <li><a href="../supplements.html">Retour au sommaire</a></li>
                        <li><a href="#introduction">Introduction</a></li>
                        <li><a href="#VBA">VBA</a></li>
                        <li><a href="#definition_sequence_automatiser">Définition d'une séquence à automatiser</a></li>
                        <li><a href="#enregistrement_premiere_macro">Enregistrement de la première macro</a></li>
                        <li><a href="#amelioration_ergonomie">Amélioration de l'ergonomie</a></li>
                        <li><a href="#macros_en_VBA">Des macros en VBA</a></li>
                        <li><a href="#concepts_base_VBA">Concepts de base en VBA</a></li>
                        <li><a href="#premieres_manipulations_VBA">Premières manipulations en VBA</a></li>
                        <li><a href="#VBE">VBE</a></li>
                        <li><a href="#execution_code_VBE">Exécuter du code dans le VBE</a></li>
                        <li><a href="#erreurs_VBA">Les erreurs en VBA</a></li>
                        <li><a href="#sauvegarde_scripts_VBA">Sauvegarde des scripts VBA</a></li>
                        <li><a href="#securisation_application_VBA">Sécurisation de l'application VBA</a></li>
                        <li><a href="#grands_types_variables">Les grands types de variables</a></li>
                        <li><a href="#operateurs_conditionnels">Les opérateurs conditionnels</a></li>
                        <li><a href="#boucles">Les boucles</a></li>
                        <li><a href="#fonctions_evenements">Les fonctions et les événements</a></li>
                        <li><a href="#interaction_utilisateurs_formulaires">Interaction avec les utilisateurs via des formulaires</a></li>
                    </ol>
                </nav>
                <!-- aside lié à la page et pas à l'article donc pas à l'intérieur de article -->
                <aside id="aside">
                    <p>Liens utiles :</p>
                    <ul>
                        <li><a href="http://www.w3schools.com/js/default.asp" target="_blank">Tutoriel JavaScript de W3Schools</a></li>
                        <li><a href="http://www.w3.org/" target="_blank">W3C</a></li>
                        <li><a href="http://fr.openclassrooms.com/informatique/cours/apprenez-a-creer-votre-site-web-avec-html5-et-css3" target="_blank">Open Classroom</a></li>
                        <li><a href="http://www.w3.org/TR/html5/" target="_blank">Norme HTML5</a></li>
                        <li><a href="http://www.w3schools.com/" target="_blank">W3Schools</a></li>
                        <li><a href="http://www.alsacreations.com/" target="_blank">Alsa Création</a></li>
                        <li><a href="https://www.youtube.com/c/LeDesignerduWeb/videos">Le Designer du web</a></li>
                    </ul>
                </aside>
            </div>
            <section id="mainSection">
                <article>
                    <h1>Les fondamentaux VBA :</h1>
                </article>
                <article>
                    <h2 id="introduction">Introduction :</h2>
                    <p>Combien de fois avez-vous réalisé une tâche rébarbative sur Excel aujourd'hui ? Vous savez, ces tâches fastidieuses qui nécessitent des actions répétitives et vous font perdre un temps précieux. Et si je vous disais qu'il existe une solution pour automatiser ces tâches en seulement quelques clics ? Intéressant, non ?</p>
                    <p>Dans ce cours, on va voir les fondamentaux du <span class="html">VBA</span>, ou <span class="html">Visual Basic for Applications</span>, un outil puissant intégré aux applications de Microsoft Office, qui est un langage de programmation qui vous permet d'automatiser des tâches répétitives, de créer des macros pour vous aider à manipuler et traiter vos données de manière efficace.</p>
                    <p>La particularité du VBA est qu'il est intégré directement à Excel. Même si vous n'êtes pas un exert en programmation, vous pouvez facilement apprendre à utiliser le VBA, car il utilise une syntaxe simple et intuitive. Vous pouvez par exemple rapidement automatiser des tâches telles que la génération de rapports, le tri et le filtrage de données, la création de graphiques, la consolidation de fichier, l'importation et l'exportation de données, et bien plus encore.</p>
                    <p>Imaginez le temps que vous pourriez gagner en évitant de faire manuellement ces tâches répétitives. Le VBA permet de gagner en productivité en automatisant les tâches !</p>
                </article>
                <article>
                    <h2 id="VBA">VBA :</h2>
                    <p>Commençons par une définition la plus simple possible. Le <span class="em">V</span>isual <span class="em">B</span>asic for<span class="em">A</span>pplication, ou <span class="html">VBA</span>, est un langage de programmation dérivé du <span class="em">V</span>isual <span class="em">B</span>asic (<span class="html">VB</span>) créé par Microsoft en 1993. C'est donc un langage de programmation qui utilise un programme comme hôte.</p>
                    <p>Souvent, les langages de programmation s'utilisent sans application tierce. Le VBA c'est exactement l'inverse, il a toujours besoin d'une application pour fonctionner, d'où la notion <span class="em">d'Application</span> dans <span class="em">Visual Basic for Application</span>, et non tout simplement du Visual Basic.</p>
                    <p>Dans notre cas, l'application va être Excel, Word, Access ou Outlook (tous les logiciels de la suite Office permettent d'exécuter du VBA). C'est pourquoi quand nous entendons "VBA", c'est souvent pour faire référence à une macro dans une application Office (macro Excel, par exemple).</p>
                    <p>Une <span class="em">macro Excel</span> est simplement un morceau de code qui va s'exécuter pour faire des actions à notre place. La macro Excel est simplement du code VBA.</p>
                    <p>Avant de commencer à parler du VBA et de détailler quelques cas d'usage, nous allons essayer de comprendre pourquoi nous en avons besoin.</p>
                    <p>Que ce soit à titre personnel ou professionnel, il arrive parfois plusieurs fois les mêmes actions dans un projet. Et vous en conviendrez, cela a peu de valeur ajoutée de refaire toujours la même chose. Vous pourriez utiliser votre temps à faire autre chose. C'est pourquoi nous allons <span class="em">automatiser</span> les tâches avec une macro Excel (donc du VBA).</p>
                    <p>Imaginons que vous êtes analyste dans une entreprise.</p>
                    <p>Tous les matins, après avoir pris votre café et être revenu à votre bureau, vous devez regarder les chiffres de vente de la veille. Tous les matins, vous devez faire les mêmes actions :</p>
                    <ul>
                        <li>
                            <p>ajouter une nouvelle feuille;</p>
                        </li>
                        <li>
                            <p>renommer cette feuille en "Data";</p>
                        </li>
                        <li>
                            <p>ouvrir le fichier Excel contenant les données;</p>
                        </li>
                        <li>
                            <p>sélectionner la zone à copier dans le fichier puis copier les données;</p>
                        </li>
                        <li>
                            <p>coller les informations dans la feuille Data que vous venez de créer;</p>
                        </li>
                        <li>
                            <p>mettre en place un filtre sur la première ligne;</p>
                        </li>
                        <li>
                            <p>trier des produits du plus grand au plus petit (pour voir les top produits vendus)</p>
                        </li>
                        <li>
                            <p>créer une mise en forme conditionnelle (sous la forme rouge, jaune et vert en fonction de la quantité de produits vendus);</p>
                        </li>
                        <li>
                            <p>enregistrer le fichier dans le dossier.</p>
                        </li>
                    </ul>
                    <p>Pour faire cela, vous allez prendre 10 minutes tous les matins à réaliser ces différentes actions. Si vous écrivez une macro Excel en VBA, vous pouvez faire tout cela de façon automatique et en quelques secondes !</p>
                    <p class="em">Voilà tout l'intérêt du VBA :</p>
                    <ul>
                        <li>
                            <p><span class="em">Fiabilité</span> : La macro va exécuter le code tous les matins de la même façon. Que ce soit vous ou une autre personne qui exécute le code, le résultat sera toujours le même.</p>
                        </li>
                        <li>
                            <p><span class="em">Gain de temps</span> : Vous n'aurez plus à perdre 10 minutes tous les matins pour des actions répétitives, votre code le fera pour vous.</p>
                        </li>
                        <li>
                            <p><span class="em">Rapidité d'exécution</span> : La séquence d'exécution du code est bien plus rapide à faire une fois qu'elle est programmée. Il est assez fréquent que l'utilisateur passe plusieurs minutes à faire plusieurs actions, et que la macro réalise les mêmes actions en seulement quelques secondes.</p>
                        </li>
                    </ul>
                    <p>Mais le VBA ne peut pas avoir que des avantages, il a quelques <span class="em">inconvénients</span> tout de même :</p>
                    <ul>
                        <li>
                            <p><span class="em">Périmètre d'utilisation</span> : C'est le principal frein du VBA : c'est un langage qui s'utilise principalement avec les logiciels de la suite Office. Il y a bien d'autres applications qui utilisent un peu de VBA, mais c'est à la merge.</p>
                        </li>
                        <li>
                            <p><span class="em">L'apprentissage</span> : Rapidement, l'enregistreur de macro ne suffit plus et il faudra passer par l'apprentissage du VBA pour améliorer le fonctionnement d'une macro (c'est pour cela que nous sommes ensemble aujourd'hui).</p>
                        </li>
                    </ul>
                    <p>Il y a une bonne nouvelle supplémentaire, l'apprentissage du VBA va vous ouvrir les portes de la programmation. Tous les langages fonctionnent plus ou moins de la même façon. On retrouve dans tous les langages des variables, des boucles, des sous-programmes, des bibliothèqyes, des objets, etc. Ce n'est donc pas perdu, au contraire ! Vous allez commencer par un des langages les plus simples à apprendre.</p>
                    <h3>Identifiez les cas d'usage de VBA :</h3>
                    <p>Maintenant que nous avons défini les différents concepts et l'utilisation que nous pouvons en faire, nous allons définir les cas d'usage du VBA. Quand allons-nous l'utiliser et dans quel but ?</p>
                    <p>Nous pouvons lister <span class="em">4 principaux cas d'usage</span> :</p>
                    <ul>
                        <li>
                            <p>automatisation simple;</p>
                        </li>
                        <li>
                            <p>traitement automatique;</p>
                        </li>
                        <li>
                            <p>automatisation complète;</p>
                        </li>
                        <li>
                            <p><span class="html">ERP</span> (Enterprise Resource Planning) professionnel complet.</p>
                        </li>
                    </ul>
                    <p><span class="em">L'automatisation simple</span> dans un fichier pourrait s'apparenter à la petite séquence que nous avons vue plus haut. Un utilisateur qui fait tous les jours différentes actions sur un fichier afin de faire une mise en forme, quelques copier-coller, un peu de nettoyage du fichier. Ce sont des actions simples mais récurrentes.</p>
                    <p>Vous commencerez souvent le VBA avec des macros qui permettent de faire une automatosation simple des différentes actions. Puis, quand vous êtes un peu plus à l'aise, on comprend tout l'intérêt d'aller plus loin dans l'automatisation. Vous passez donc à des <span class="em">traitements automatiques plus complexes</span>, comme par exemple compiler plusieurs fichiers ensemble, faire du nettoyage des données, mettre à jour des reportings, créer des visualisations automatiquement, etc. Ce type de traitement est plus lourd et requiert de meilleures connaissances en VBA.</p>
                    <p>Puis quelques mois ou années plus tard, après avoir automatisé des traitements, vous commencez à vous dire que finalement vous pourriez aller encore plus loin. AU lieu de compiler des fichiers Excel, vous pourriez exécuter des requêtes SQL dans des bases de données, faire un nettoyage des données plus poussée, puis mettre à jour un reporting et faire une analyse que vous allez envoyer par e-mail automatiquement avec votre macro Excel. C'est ce que nous pouvons appeler une <span class="em">automatisation complète</span> d'une tâche.</p>
                    <p>Mais en fait, on peut faire plein de choses avec le VBA ! Bientôt, je vais finir par vous dire qu'on peut faire fonctionner une entreprise avec du VBA ? Figurez-vous... que oui ! Il est tout à fait possible d'utiliser des macros VBA qui s'appuient sur la suite Office, pour fabriquer un petit ERP pour une entreprise. Il faut évaluer la cohérence entre notre projet et l'utilisation que l'on peut faire de cet outil. Cette solution est utilisée par certaines entreprises qui ont des besoins très spécifiques. Nous pourrions appeler cela un ERP d'entreprise. Avec, nous pourrions utiliser des macros Excel pour gérer la base de données clients via des formulaires par exemple, puis mettre à jour la base de données ou encore gérer la production d'une usine en fonction des besoins, des demandes des clients.</p>
                    <p>Vous seriez étonné de voir le nombre de grandes entreprises qui utilisent encore ce type d'outil pour des besoins spécifiques.</p>
                </article>
                <article>
                    <h2 id="definition_sequence_automatiser">Définissez une séquence à automatiser :</h2>
                    <p>Maintenant que nous avons défini le VBA et que vous avez compris son utilité, il est temps de commencer à l'utiliser. Vous allez commencer par utiliser <span class="em">l'enregistreur de macro</span> dans Excel.</p>
                    <p>Un enregistreur de macro, c'est quelque chose qui enregistre du code ? Vous y êtes presque : l'enregistreur de macro est un outil qui va retranscrire tout ce que vous allez faire sur Excel en code VBA automatiquement. Ainsi, vous n'avez pas besoin d'écrire du code, le logiciel le fait pour vous.</p>
                    <p>C'est une bonne nouvelle, ça ! Pas besoin d'apprendre le VBA alors, puisqu'un outil va traduire nos actions en code ! Comme souvent, ce n'est pas aussi simple que cela : effectivement l'enregistreur de macro retranscrit des actions en code VBA, et c'est une bonne nouvelle. Vous allez pouvoir commencer par essayer de comprendre le code, puis apporter des modifications mineures. Il y a quand même une limitation à cela :</p>
                    <ul>
                        <li>
                            <p>d'une part, le code n'est pas optimisé;</p>
                        </li>
                        <li>
                            <p>d'autre part, il ne permet pas d'utiliser des variables, des boucles, des tests, etc.</p>
                        </li>
                    </ul>
                    <p>Nous verrons cela plus tard, mais c'est important de comprendre ce que vous pouvez faire ou ne pas faire avec l'enregistreur de macro. Finalement, une macro, ce n'est ni plus ni moins que du code VBA qui est écrit automatiquement en fonction des actions que vous allez faire avec votre souris ou votre clavier.</p>
                    <p>Bon OK, ce n'est pas aussi simple que ce que vous avez pensé au début; on l'enregistre quand cette macro ?! Nous y arrivons, mais avant cela, il nous reste encore une chose à définir. En effet, si nous voulons enregistrer une macro, c'est que nous allons faire des actions dans un ordre bien plus précis que nous souhaitons par la suite refaire automatiquement. Cela implique donc que cette <span class="em">séquence</span> soit <span class="em">logique</span> et bien définie dès le départ. Si vous faites une erreur dans votre séquence, elle sera enregistrée et donc répétée à chaque utilisation de notre macro.</p>
                    <p>C'est pourquoi il est très important de bien avoir en tête les différentes actions que vous souhaitez faire.</p>
                    <p>Dans notre cas, nous allons commencer par une séquence très simple :</p>
                    <ul>
                        <li>
                            <p>lancer le logiciel Excel;</p>
                        </li>
                        <li>
                            <p>cliquer sur la cellule B1 et écrire "Bonjour";</p>
                        </li>
                        <li>
                            <p>changer la couleur du texte en bleu;</p>
                        </li>
                        <li>
                            <p>souligner ce texte.</p>
                        </li>
                    </ul>
                    <p>Maintenant que vous avez défini la séquence, vous n'avez plus qu'à la faire une fois que vous avez lancé l'enregistreur de cette macro.</p>
                </article>
                <article>
                    <h2 id="enregistrement_premiere_macro">Enregistrez votre première macro :</h2>
                    <p>Pour lancer un enregistrement, rien de plus simple. Il suffit :</p>
                    <ul>
                        <li>
                            <p>d'aller dans l'onglet <span class="em">Affichage</span>;</p>
                        </li>
                        <li>
                            <p>puis de cliquer sur la petite flèche en dessous de Macros;</p>
                        </li>
                        <li>
                            <p>puis de cliquer sur "Enregistrer une macro".</p>
                        </li>
                    </ul>
                    <figure>
                        <img src="../images/onglet_Affichage_Excel.png" alt="">
                        <figcaption>Onglet Affichage dans Excel</figcaption>
                    </figure>
                    <p>Une nouvelle fenêtre s'ouvre :</p>
                    <figure>
                        <img src="../images/fenetre_enregistrement_macro_VBA.png" alt="">
                        <figcaption>Fenêtre d'enregistrement d'une macro</figcaption>
                    </figure>
                    <p>Appelez votre macro "mise_a_jour",</p>
                    <ul>
                        <li>
                            <p>puis cliquez sur "OK";</p>
                        </li>
                        <li>
                            <p>puis exécutez votre séquence que j'ai détaillée plus haut.</p>
                        </li>
                    </ul>
                    <p>Une fois que c'est terminé, il suffit de :</p>
                    <ul>
                        <li>
                            <p>retourner sur "Affichage";</p>
                        </li>
                        <li>
                            <p>puis cliquer sur la flèche vers le bas en dessous de "Macros";</p>
                        </li>
                        <li>
                            <p>et cliquer sur "Arrêter l'enregistrement".</p>
                        </li>
                    </ul>
                    <p>Bravo ! Vous venez de créer votre première macro !!</p>
                    <p>Nous allons la tester ensemble, mais pour cela, il faut effacer la cellule B2.</p>
                    <p>Pour tester votre macro, vous avez besoin de <span class="em">retrouver l'état initial</span> avant l'enregistrement de votre macro. C'est pourquoi vous avez fait dans l'enregistrement de votre macro.</p>
                    <p>Maintenant, il suffit simplement de relancer votre macro. Rien de plus simple, retournez dans l'onglet "Affichage" d'Excel puis cette fois, cliquez sur "Macros". Dans cette nouvelle fenêtre, votre macro "mise_a_jour" est présente. Cliquez une fois dessus puis appuyez sur "Exécuter".</p>
                    <figure>
                        <img src="../images/fenetre_liste_macros_classeur.png" alt="">
                        <figcaption>Fenêtre contenant la liste de toutes les macros associées au classeur</figcaption>
                    </figure>
                    <p>Félicitations ! Vous venez d'exécuter votre première macro et si tout s'est bien passé, vous devez vous retrouver dans la cellule B1 "Bonjour", qui est colorée en bleu et soulignée.</p>
                </article>
                <article>
                    <h2 id="amelioration_ergonomie">Améliorez l'ergonomie :</h2>
                    <p>Comme vous avez pu le voir, lancer une macro par l'onglet "Affichage", puis "Macros". Choisir la macro puis appuyer sur "Exécuter", ce n'est pas vraiment facile à utiliser...</p>
                    <p>Pour rendre l'utilisation plus intuitive, nous pouvons associer une macro à un bouton; ainsi il vous suffira de cliquer sur ce bouton pour que la macro s'exécute. Vous pouvez par exemple associer la macro, rien de plus simple, il vous suffit de faire un clic droit sur le bouton puis d'aller dans "Affecter une macro". Cliquez sur la macro "mise_a_jour" puis cliquez sur "OK".</p>
                    <p>Voici un exemple de bouton :</p>
                    <figure>
                        <img src="../images/exemple_bouton_VBA.png" alt="">
                        <figcaption>Exemple de bouton</figcaption>
                    </figure>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Pour insérer une forme rectangle, il faut aller dans l'onglet "Insertion" d'Excel, cliquer sur "Formes" et choisir le rectangle.</p>
                    </div>
                    <p>Pour lancer cette macro, il vous suffit simplement de cliquer sur votre rectangle et cela lance la macro "Mise à jour".</p>
                    <p>Vous pouvez personnaliser les boutons avec les différentes formes, couleurs ou encore effets. Si vous voulez aller plus loin dans la personnalisation, vous pouvez créer vos propres boutons sous forme d'image. Il ne vous reste plus qu'à associer une macro de la même façon que nous avons créée ensemble.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Conseil : une fois que votre macro est associée à votre bouton ou photo, si vous souhaitez la modifier, cela va lancer la macro. Eh oui, le clic gauche sur l'objet lance la macro et ne le sélectionne plus. Si vous souhaitez y avoir accès, il faut faire un clic droit sur l'objet.</p>
                    </div>
                    <p>C'est bien d'avoir un bouton pour lancer une macro, mais il y a une autre solution simple pour le faire, le <span class="em">raccourci clavier</span>.</p>
                    <p>Vous l'avez peut-être remarqué quand vous avez créé votre macro, il y avait une zone pour entrer une touche de <span class="em">raccourci</span>.</p>
                    <ul>
                        <li>
                            <p>Retournez alors dans la fenêtre Macros (pour rappel, c'esy dans l'onglet "Affichage" puis "Macros").</p>
                        </li>
                        <li>
                            <p>Sélectionnez votre macro mise_a_jour.</p>
                        </li>
                        <li>
                            <p>Puis cliquez sur "Options".</p>
                        </li>
                    </ul>
                    <p>Une nouvelle fenêtre s'ouvre et vous retrouvez dans celle-ci la partie raccourci de la macro, ainsi que la partie commentaire sur la macro.</p>
                    <p>Dans la zone vide après le "CTRL +", écrivez "k" puis cliquez sur "OK".</p>
                    <figure>
                        <img src="../images/fenetre_option_macro_VBA.png" alt="">
                        <figcaption>Fenêtre d'option d'une macro</figcaption>
                    </figure>
                    <p>Cela signifie qu'à chaque fois que vous allez utiliser le raccourci clavier <kbd>CTRL</kbd> + <kbd>K</kbd>, vous allez lancer votre macro. Je vous laisse essayer !</p>
                    <div class="information">
                        <img src="../images/information.png" alt="" class="float_left">
                        <p>Vous pouvez associer n'importe quelle touche sur votre clavier, il faut juste se rappeler que certaines ont déjà des actions, comme <kbd>CTRL</kbd> + <kbd>V</kbd> (coller) ou <kbd>CTRL</kbd> + <kbd>A</kbd> (tout sélectionner).</p>
                    </div>
                </article>
                <article>
                    <h2 id="macros_en_VBA">Passez des macros au langage de programmation VBA :</h2>
                    <p>Vous venez de faire votre <span class="em">première macro</span> dans Excel. Durant tout le processus de création de cette macro, nous n'avons jamais parlé de <span class="html">VBA</span>. Pourtant cette macro, c'est bien du code VBA qui est exécuté par Excel.</p>
                    <p>Ah oui c'est vrai, mais où est le code VBA dans une macro ? De base, Excel ne montre pas le code VBA qui est généré. En effet, pour une utilisation simple comme notre exemple plus haut, vous n'avez pas besoin d'avoir accès au code VBA. Cependant, pour commencer à comprendre le VBA, votre macro simple va être parfaite.</p>
                    <h3>Découvrez l'éditeur VBA :</h3>
                    <p>Pour voir le code VBA qu'Excel a généré lors de votre enregistrement :</p>
                    <ul>
                        <li>
                            <p>retournez dans l'onglet "Affichage" d'Excel;</p>
                        </li>
                        <li>
                            <p>cliquez sur "Macros";</p>
                        </li>
                        <li>
                            <p>cette fois, au lieu d'exécuter la macro, cliquez sur "Modifier".</p>
                        </li>
                    </ul>
                    <p>Cette nouvelle fenêtre qui vient de s'ouvrir, c'est le <span class="html">V</span>isual <span class="html">B</span>asic <span class="html">E</span>ditor (nous utiliserons <span class="html">VBE</span> à partir de maintenant).</p>
                    <figure>
                        <img src="../images/interface_VBE.png" alt="">
                        <figcaption>Interface du Visual Basic Editor (VBE)</figcaption>
                    </figure>
                    <p>Que voit-on dans le VBE ? Une nouvelle interface avec 2 fenêtres :</p>
                    <ul>
                        <li>
                            <p>à gauche, la fenêtre des projets (nous y reviendrons plus tard);</p>
                        </li>
                        <li>
                            <p>à droite c'est votre <span class="em">code VBA</span>.</p>
                        </li>
                    </ul>
                    <p>Voici le code que nous avons écrit avec une explication pour chaque ligne :</p>
                    <table class="tableBalises">
                        <tbody>
                            <tr>
                                <td>
<pre><code>Sub Mise_a_jour</code></pre>
                                </td>
                                <td>Le mot clé <span class="html">Sub</span> permet de déclarer le début d'une fonction (d'un programme). Ici le programme s'appelle <span class="em">Mise_a_jour</span>.</td>
                            </tr>
                            <tr>
                                <td>
<pre><code>Mise_a_jour Macro</code></pre>
                                </td>
                                <td>Cette ligne est en vert avec un apostrophe, c'est donc un commentaire qui ne sera pas lu.</td>
                            </tr>
                            <tr>
                                <td>
<pre><code>Range("B2").Select</code></pre>
                                </td>
                                <td><span class="html">Range</span> avec <span class="html">("B2").select</span> permet de sélectionner la cellule B2 dans Excel.</td>
                            </tr>
                            <tr>
                                <td>
<pre><code>ActiveCell.FormulaR1C1 = "Bonjour"</code></pre>
                                </td>
                                <td><span class="html">ActiveCell.FormulaR1C1</span> permet d'écrire dans une cellule, donc notre cas d'écrire le mot "Bonjour" dans la cellule sélectionnée plus haut.</td>
                            </tr>
                            <tr>
                                <td>
<pre><code>Range("B2").Select</code></pre>
                                </td>
                                <td><span class="html">Range</span> avec <span class="html">("B2").select</span> permet de sélectionner la cellule B2 dans Excel.</td>
                            </tr>
                            <tr>
                                <td>
<pre><code>With Selection.Font</code></pre>
                                </td>
                                <td>Le mot <span class="html">With</span> permet d'exécuter une série d'instructions. Dans notre cas, d'utiliser l'objet "font" sur la celluele sélectionnée.</td>
                            </tr>
                            <tr>
                                <td>
<pre><code>.ThemeColor = xlThemeColorAccent5</code></pre>
                                </td>
                                <td>On utilise la propriété <span class="html">Color</span> et on lui affecte une couleur. Ici le paramètre <span class="html">xlThemeColorAccent5</span> correspond à du bleu dans ma version d'Excel.</td>
                            </tr>
                            <tr>
                                <td>
<pre><code>.TintAndShade = 0</code></pre>
                                </td>
                                <td>La propriété <span class="html">TintAndShade</span> permet d'utiliser des dégradés de la couleur.</td>
                            </tr>
                            <tr>
                                <td>
<pre><code>End With</code></pre>
                                </td>
                                <td>Les mots-clés <span class="html">End</span> et <span class="html">With</span> permettent de fermer la série d'instructions.</td>
                            </tr>
                            <tr>
                                <td>
<pre><code>Selection.Font.Underline = xlUnderlineStyleSingle</code></pre>
                                </td>
                                <td><span class="html">Selection.Font.Underline</span> permet d'appliquer un soulignage de la cellule avec un seul trait.</td>
                            </tr>
                            <tr>
                                <td>
<pre><code>End Sub</code></pre>
                                </td>
                                <td><span class="html">End Sub</span> permet de mettre fin au programme.</td>
                            </tr>
                        </tbody>
                    </table>
                </article>
                <article>
                    <h2 id="concepts_base_VBA">Maîtrisez les concepts de base du langage VBA :</h2>
                    <p>Comme vous avez pu le voir dans le détail du code ci-dessus, nous avons parlé <span class="em">d'objet</span> pour le "font".</p>
                    <p>Pour moi, un objet c'est quelque chose de matériel, pourquoi on en parle dans de la programmation ? Faisons une pause ici pour expliquer un peu plus en détail le concept d'objet. Il est important de comprendre que le VBA est une programmation qu'on appelle <span class="em">programmation orientée objet (POO)</span>. Tout comme le Python, le Java, le C++ ou encore le PHP (avec quelques nuances pour le VBA).</p>
                    <p>Mais qu'est-ce qu'un objet, en programmation ? Si on prend notre exemple, <span class="em">font</span> est donc un objet. Cet objet a plusieurs caractéristiques, comme par exemple :</p>
                    <ul>
                        <li>
                            <p>la couleur;</p>
                        </li>
                        <li>
                            <p>si c'est en gras;</p>
                        </li>
                        <li>
                            <p>si c'est en italique;</p>
                        </li>
                        <li>
                            <p>le nom de la police;</p>
                        </li>
                        <li>
                            <p>la taille;</p>
                        </li>
                        <li>
                            <p>le soulignement;</p>
                        </li>
                        <li>
                            <p>etc.</p>
                        </li>
                    </ul>
                    <p>Pour faire simple, un objet, c'est un ensemble de caractéristiques encapsulées dans un objet.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>À noter qu'un objet peut contenir lui-même un autre objet. Ainsi, l'objet <span class="em">range</span> contient un objet <span class="em">font</span>.</p>
                    </div>
                    <p>On peut faire le parallèle avec une recette de cuisine.</p>
                    <p>Notre recette de cuisine, c'est un peu comme notre application Excel.</p>
                    <p>En effet, pour faire notre "objet" recette de cuisine, nous avons besoin d'autres objets comme l'objet robot et l'objet four. Pour l'objet four, nous allons utiliser la méthode "Chauffer" avec les paramètres chaleur tournante, 180° et 40 minutes. Notre objet four contient également des événements, comme une minuterie qui permet au déclenchement d'arrêter le four.</p>
                    <p>Si nous résumons, notre objet four contient :</p>
                    <ul>
                        <li>
                            <p>des <span class="em">caractéristiques</span> (type de cuisson, température ou encore temps de cuissson);</p>
                        </li>
                        <li>
                            <p>des <span class="em">méthodes</span> (chauffer, griller, etc.);</p>
                        </li>
                        <li>
                            <p>des <span class="em">événements</span> (arrêt du four, etc.).</p>
                        </li>
                    </ul>
                    <p>Et tout comme nos objets dans Excel, l'objet four ne s'utilise pas que pour cette recette, on peut utiliser cet objet dans plusieurs autres recettes.</p>
                    <p>C'est exactement pareil dans Excel, certains objets sont utilisés sur des graphiques, des cellules ou des zones de texte; pourtant c'est exactement le même objet à chaque fois, mais à des endroits différents, qui s'utilise de la même façon.</p>
                    <p>Voici les principaux objets pour Excel :</p>
                    <ul>
                        <li>
                            <p>Workbook;</p>
                        </li>
                        <li>
                            <p>Sheets;</p>
                        </li>
                        <li>
                            <p>Range;</p>
                        </li>
                        <li>
                            <p>Windows;</p>
                        </li>
                        <li>
                            <p>Chart.</p>
                        </li>
                    </ul>
                    <p>Je vous ai dit qu'un objet contient des caractéristiques ou d'autres objets. SI je veux être plus juste, un objet peut contenir plus d'informations.</p>
                    <p>Ainsi un objet peut contenir :</p>
                    <ul>
                        <li>
                            <p>un autre objet;</p>
                        </li>
                        <li>
                            <p>des caractéristiques;</p>
                        </li>
                        <li>
                            <p>des méthodes;</p>
                        </li>
                        <li>
                            <p>des événements.</p>
                        </li>
                    </ul>
                    <p>Si nous devions résumer :</p>
                    <ul>
                        <li>
                            <p>une caractéristique est une <span class="em">propriété</span> de notre objet :</p>
                            <ul>
                                <li>
                                    <p>(police : Times, courleur : bleu, gras : non, etc.);</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>une méthode est un <span class="em">verbe</span>, une action que nous allons faire :</p>
                            <ul>
                                <li>
                                    <p>si on reprend l'exemple de notre texte, les différentes méthodes peuvent être remplacer, ajouter, trier, couper, coller, etc. Ce sont des actions que nous allons faire sur une cellule (avec l'objet range);</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>un événement est une <span class="em">action</span> qui va se produire quand une condition va être remplie :</p>
                            <ul>
                                <li>
                                    <p>par exemple l'événement "newsheet" de l'objet "application" permet de déclencher le lancement d'un sous-programme à chaque fois qu'on ajoute une feuille.</p>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </article>
                <article>
                    <h2 id="premieres_manipulations_VBA">Effectuez vos première manipulations en VBA :</h2>
                    <p>Maintenant que vous avez vu en détail le concept d'objet, vous allez pouvoir faire des modifications sur votre objet <span class="em">font</span>.</p>
                    <p>Imaginons par exemple que vous ne souhaitez plus écrire votre texte en bleu mais plutôt en rouge. Vous avez vu que l'objet <span class="em">font</span> contient une méthode Color. La valeur de Color est xlThemeColorAccent5 pour du bleu. Si vous voulez avoir un texte orange, vous n'avez qu'à écrire 'xlThemeColorAccent2' et le texte sera écrit en orange à l'exécution de votre macro. Ici, pas la peine de refaire l'enregistrement de votre macro.</p>
                    <p>Voici le résultat du code :</p>
<pre><code>Range("B2").Select
ActiveCell.FormulaR1C1 = "Bonjour"
Range("B2").Select
With Selection.Font
    .ThemeColor = xlThemeColorAccent2
    .TintAndShade = 0
End With
Selection.Font.Underline = xlUnderlineStyleSingle</code></pre>
                </article>
                <article>
                    <h2 id="VBE">Appréhendez l'éditeur VBA :</h2>
                    <p>Vous allez passer pas mal de temps sur le VBE, c'est pourquoi il est important de comprendre rapidement comment il fonctionne et comment vous pouvez améliorer l'interface.</p>
                    <p>Nous avons vu plus haut qu'il y avait une fenêtre de projet et une fenêtre de code. Dans cette dernière fenêtre, vous pouvez voir que certains mots sont écrits en bleu, en noir ou en vert.</p>
                    <p>Mais qu'est-ce que cela veut bien dire ?</p>
                    <ul>
                        <li>
                            <p>Bleu : Ce sont <span class="em">les mots-clés</span>.</p>
                        </li>
                        <li>
                            <p>Vert : Ce sont </p>
                            <span class="em">les commentaires</span>.</li>
                            <li>
                                <p>Noir : C'est <span class="em">le code classique</span>.</p>
                            </li>
                    </ul>
                    <figure>
                        <img src="../images/code_cree_macro_VBE.png" alt="">
                        <figcaption>Code créé par notre macro Mise à jour dans le VBE</figcaption>
                    </figure>
                    <p>Commençons par les <span class="em">mots-clés</span> : ce sont des mots qui sont spécifiquement réservés par le VBE. Les mots en bleu ne peuvent pas être utilisés comme variables, par exemple (nous détaillerons plus loin le concept de variable). Ces mots ont une importance particulière pour le VBE.</p>
                    <p>Par exemple, dans notre cas, le mot "sub" permet de déclarer le début d'une procédure (un programme).</p>
                    <p>Les <span class="em">commentaires</span> ont une importance toute particulière pour tous les langages de programmation. Ils permettent de comprendre ce que fait le code. Au début de l'écriture d'un code, c'est assez simple de comprendre ou de se rappeler; mais au bout de quelques dizaines de lignes et quelques jours, on se rend vite compte que c'est difficile de se rappeler ce que nous avons voulu faire. C'est pourquoi il est vraiment important de garder une rigueur sur les commentaires.</p>
                    <p>On peut, par exemple, expliquer une variable ou le rôle d'une variable, mais on peut surtout expliquer une partie de code ou de fonction entière.</p>
                    <p>Mais ça fait quoi un commentaire dans le code ? Le commentaire dans le code, c'est simple, c'est un morceau de code qui ne va pas s'exécuter. Une ligne qui ne sera plus lue par le code.</p>
                    <p>En VBA, on utilise l'apostrophe "'" pour que la ligne ne soit pas lue.</p>
                    <figure>
                        <img src="../images/exemple_commentaire_VBA.png" alt="">
                        <figcaption>Ajout du commentaire Mise_a_jour_Macro à titre d'exemple</figcaption>
                    </figure>
                    <p>Mais parfois on a besoin de commenter plusieurs lignes d'un coup. Comme une grosse partie d'explication ou encore toute une partie d'un programme que vous ne souhaitez pas exécuter. Mettre des apostrophes devant chaque ligne, cela peut être long. Vous allez donc utiliser la fonction "Commenter bloc" ou "Ne pas commenter bloc" de l'éditeur VBE.</p>
                    <p>Pour faire apparaître cette option, il faut aller dans "Affichage" puis barre d'outils puis choisir "Édition". Vous avez maintenant accès dans cette nouvelle barre d'outils à l'option "Commenter bloc" !</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>On remarque que suivant l'endroit où est placé le signe du commentaire, on peut ne mettre en commentaire qu'une partie d'une ligne.</p>
                    </div>
                    <p>Pour finir, le code écrit <span class="em">en noir</span>, c'est du simple code classique qui va être exécuté.</p>
                </article>
                <article>
                    <h2 id="execution_code_VBE">Exécutez du code dans le VBE :</h2>
                    <p>Contrairement à Excel où vous avez associé votre macro à un bouton et un raccourci clavier, il n'y a rien pour lancer votre macro de façon intuitive.</p>
                    <p>Dans le VBE, vous allez aller dans "Exécution" ouis cliquer sur "Exécuter la macro". Cela va avoir pour effet d'exécuter la macro entièrement. Vous pouvez également passer par le raccourci dans l'interface qui se matérialise comme le signe "<span class="em">play</span>" en vert. Dernière façon de faire, utiliser le raccourci clavier <kbd>F5</kbd>.</p>
                    <figure>
                        <img src="../images/bouton_play_VBE.png" alt="">
                        <figcaption>Le bouton "Play"</figcaption>
                    </figure>
                    <p>Il arrive assez fréquemment de vouloir tester les lignes une par une pour comprendre le code. Il faut donc utiliser le <span class="em">mode pas à pas détaillé</span> en passant par <span class="em">Débogage</span> puis en cliquant sur "Pas à pas détaillé". À chaque fois que vous cliquez dessus, cela exécute une ligne et cela passe à la suivante. C'est bien pour tester une seule ligne, mais si on doit le faire à chaque fois, cela va être long et fastidieux. Il existe un raccourci clavier qui est <kbd>F8</kbd>. À chaque appui sur <kbd>F8</kbd>, la ligne s'exécute et le code passe à la ligne suivante.</p>
                    <p>C'est une bonne solution, mais imaginez que vous vouliez regarder les 10 dernières lignes de notre code. Il va falloir commencer par appuyer 30 fois sur <kbd>F8</kbd> pour arriver à la partie qui vous intéresse ! Pour pallier ce problème, vous pouvez définir ce que l'on appelle un <span class="em">point d'arrêt</span> dans le code.</p>
                    <figure>
                        <img src="../images/exemple_point_arret_VBE.png" alt="">
                        <figcaption>Exemple de point d'arrêt dans le VBE</figcaption>
                    </figure>
                    <p>Ce point d'arrêt, matérialisé par un rond rouge dans la marge, s'ajoute en cliquant exactement là où est le point rouge dans la capture d'écran. Quand vous exécutez l'intégralité de votre code (F5), l'exécution va s'arrêter sur ce point d'arrêt et à partir de là vous pouvez utiliser le mode pas à pas (F8).</p>
                </article>
                <article>
                    <h2 id="erreurs_VBA">Appréhendez les erreurs en VBA :</h2>
                    <p>QUand vous commencerez à écrire du code en VBA, vous ferez des erreurs. C'est tout à fait normal de ne pas écrire du premier coup une ligne parfaitement, et le VBE est justement là pour vous expliquer une erreur.</p>
                    <p>Bon, je préfère vous le dire tout de suite, il ne va pas vraiment vous expliquer l'erreur. Il va essayer de vous décrire brièvement le problèmme qu'il a rencontré, et il va surtout nous donner la ligne qui comporte l'erreur.</p>
                    <p>Avec la pratique on comprend plus facilement les erreurs et dans le pire des cas, vous pouvez toujours aller voir sur Internet pour expliciter cette erreur.</p>
                    <p>Bon, je préfère vous le dire tout de suite, il ne va pas vraiment vous expliquer l'erreur. Il va essayer de vous décrire brièvement le problème qu'il a rencontré, et il va surtout nous donner la ligne qui comporte l'erreur.</p>
                    <p>Avec la pratique on comprend plus facilement les erreurs et dans le pire des cas, vous pouvez toujours aller voir sur Internet pour expliciter cette erreur.</p>
                    <p>Dans le code que vous avez utilisé jusqu'à maintenant, j'ai supprimé le "t" du seelect, et voici l'erreur que nous a renvoyée le VBE :</p>
                    <figure>
                        <img src="../images/fenetre_erreur_VBE.png" alt="">
                        <figcaption>Fenêtre d'erreur dans le VBE</figcaption>
                    </figure>
                    <p>Objectivement, l'erreur n'est pas vraiment parlante mais vous pouvez par contre appuyer sur "<span class="em">Débogage</span>" pour que le VBE vous surligne la ligne avec une erreur.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Avec le temps et la pratique, vous comprendrez de plus en plus vite les erreurs sur les lignes.</p>
                    </div>
                </article>
                <article>
                    <h2 id="sauvegarde_scripts_VBA">Sauvegardez vos scripts VBA :</h2>
                    <p>Il est maintenant temps d'aborder une partie très importante, le stockage de votre code. Écrire du code pour automatiser des tâches c'est bien, mais encore faut-il pouvoir le stocker quelque part, sinon cela n'a pas grand intérêt.</p>
                    <p>Si vous avez déjà essayé de faire une macro VBA et d'enregistrer votre fichier, vous avez dû avoir un message comme celui-là :</p>
                    <figure>
                        <img src="../images/fenetre_enregistrement_Excel_pas_contenir_VBA.png" alt="">
                        <figcaption>Fenêtre d'enregistrement quand le format Excel ne peut pas contenir de VBA</figcaption>
                    </figure>
                    <p>Faisons un point sur les différentes extensions dans Excel pour comprendre ce problème.</p>
                    <p>Voici la liste des différentes extensions Excel :</p>
                    <ul>
                        <li>
                            <p>classeur Excel (.xlsx);</p>
                        </li>
                        <li>
                            <p>classeur Excel prenant en charge les macros (.xslm);</p>
                        </li>
                        <li>
                            <p>classeur Excel binaire (.xlsb);</p>
                        </li>
                        <li>
                            <p>classeur Excel 93 - 2003 (.xls).</p>
                        </li>
                    </ul>
                    <div class="important">
                        <img src="../images/important.png" alt="Important" class="float_left">
                        <p>Le format de base d'Excel, le XSLX, ne prend pas en charge les macros.</p>
                    </div>
                    <p>C'est-à-dire que si vous créez une macro et que vous enregistrez le fichier en classeur Excel (.xslx), votre macro ne sera pas sauvegardée dans le fichier Excel. Car oui, de base, quand on crée une macro, elle est directement stockée dans le fichier Excel. L'extension XSLX est la seule à ne pas prendre en charge les macros.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Le fait que l'extension .xslx ne prenne pas en chagre les macros est une protection pour Excel. Le code peut parfois être malveillant, Microsoft a alors décidé d'utiliser une extension qui supprime tout le code dans les fichiers.</p>
                    </div>
                    <p>À quoi servent les 3 autres extensions, alors ? L'extension <span class="em">.xslm</span> a exactement les mêmes caractéristiques que le .xslx sauf que cette fois, il accpete les macros dans le fichier Excel.</p>
                    <p>Le <span class="em">.xslb</span> est similaire au XSLM sauf que celui-ci compresse beaucoup mieux les données. C'est personnellement l'extension que j'utilise le plus souvent (on peut facilement réduire la taille d'un fichier de moitié avec cette extension).</p>
                    <p>Pour finir, le <span class="em">.xls</span>, c'est une vieille extension d'Excel qui date de 1997; cette version, même si elle n'est plus censée être utilisée, est encore assez répandue (malheureusement).</p>
                    <p>Vous venez de voir quelles extensions acceptent de stocker du code. Retour maintenant à notre VBA pour mieux comprendre où se trouve notre code dans le fichier. Regardons cette fois la partie de gauche, la fenêtre <span class="em">Projet</span>. Dans cette fenêtre on voit le nom de notre fichier Excel et 3 dossiers :</p>
                    <ul>
                        <li>
                            <p>Microsoft Excel Objets : avec la feuille actuelle et ThisWorkbook;</p>
                        </li>
                        <li>
                            <p>Feuilles;</p>
                        </li>
                        <li>
                            <p>Modules.</p>
                        </li>
                    </ul>
                    <figure>
                        <img src="../images/onglet_Projet_Excel.png" alt="">
                        <figcaption>Onglet Projet dans le VBE</figcaption>
                    </figure>
                    <p>On peut voir que votre enregistrement de macro a créé un dossier Modules dans lequel on retrouve le module 1 qui contient votre code. Nous verrons par la suite pourquoi le stocker dans le module ou directement dans la <span class="em">feuil1</span> ou dans <span class="em">ThisWorkbook</span>. Pour le moment, il faut juste savoir que les macros se créent automatiquement dans un nouveau module.</p>
                </article>
                <article>
                    <h2 id="securisation_application_VBA">Sécurisez votre application VBA :</h2>
                    <p>Maintenant que vous savez comment sauvegarder vos macros dans un fichier Excel, il faut les <span class="em">protéger</span>. En effet, si vous laissez une macro dans un fichier et que quelqu'un ouvre le fichier et efface la macro, vous perdez votre code.</p>
                    <p>Nous verrons plus loin que nous ne sommes pas obligés de stocker le code de la macro directement dans un fichier. Cependant, une bonne pratique est dans tous les cas de mettre un <span class="em">mot de passe</span> au VBE.</p>
                    <p>Pour ce faire, je vous invite à aller dans "Outils" puis "Propriétés de VBA Projet". Dans cette nouvelle fenêtre, il faut aller sur l'onglet "Protection". Vous voyez dans cette fenêtre que vous pouvez mettre un mot de passe (que vous devez taper deux fois). Vous avez également une option pour verrouiller le projet pour l'affichage qu'il faut cocher.</p>
                    <p>Une fois le mot de passe actif, enregistrez et fermez votre fichier Excel. Maintenant, ouvrez ce fichier, et surprise, vous ne pouvez plus éditer de macro, vous pouvez seulement l'exécuter.</p>
                    <p>Comment avoir à nouveau accès à l'édition alors ? Allez dans l'onglet "Développeur" et cliquez sur "Visual Basic". En allant de votre projet, vous aurez l'opportunité de rentrer votre mot de passe pour déverouiller le VBE.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Si n'avez pas l'onglet "Développeur", il suffit d'aller dans "Fichier", puis "Options" et "Personnaliser le ruban". Dans la fenêtre de droite, il vous suffit de cocher "Développeur", et un nouvel onglet arrive sur l'interface d'Excel.</p>
                    </div>
                    <div class="important">
                        <img src="../images/important.png" alt="Important" class="float_left">
                        <p>Attention, il existe différentes façons de casser les codes dans Excel, que ce soit pour une feuille de calcul, un classeur ou encore l'éditeur VBE. Cette technique va protéger votre code dans 99% des cas mais attention, ce n'est pas infaillible. Internet regorge de techniques pour casser ces différents codes.</p>
                    </div>
                </article>
                <article>
                    <h2 id="grands_types_variables">Appréhendez les grands types de variables :</h2>
                    <p>Précédemment, vous avez vu comment réaliser des macros avec l'enregistreur de macro intégré à Excel, et faire quelques modifications.</p>
                    <p>L'enregistrement des macros, c'est très bien pour des <span class="em">macros "simples"</span>, mais quand vous voulez rajouter des fonctionnalités ou optimiser les macros, il faut commencer à écrire du code... <span class="em">Les variables</span> sont la première chose que nous allons voir ensemble. Cela va vous permettre de faire des boucles, des tests, ou encore d'utiliser un formulaire.</p>
                    <h3>Déclarez une variable :</h3>
                    <p>LE VBA ne fait pas exception à la règle : comme tous les langages de programmation, il utilise des variables. Prenons une définition simple : une variable, c'est un élément auquel on <span class="em">affecte une valeur</span>.</p>
                    <p>Par exemple, je peux créer une variable qui s'appelle <span class="em">annee_de_naissance</span> dans laquelle je vais stocker un nombre comme <span class="em">1987</span>.</p>
                    <p>Mais pourquoi utiliser une variable pour stocker un nombre ? Autant l'utiliser directement, non ? Effectivement, si nous ne l'utilisons qu'une seule fois dans notre code, autant écrire directement le nombre. Mais si je vous dis maintenant que cette variable, ce n'est pas moi qui vais la définir, mais qu'à terme, cela va être automatiquement mis à jour en fonction de différentes informations dans le projet ?</p>
                    <p>Vous commencez peut-être à comprendre...</p>
                    <h3>Distinguez les grands types de variables :</h3>
                    <p>Comme vu précédemment, une variable est un élément qui peut <span class="em">contenir</span> des informations, elle n'est pas <span class="em">statique</span>. Le nombre peut changer en fonction d'événements extérieurs ou en fonction d'une information dans le code. Nous pouvons donc associer à une variable une valeur (on charge une variable avec une valeur). En VBA, il faut définir le type d'une variable avant de pouvoir l'utiliser.</p>
                    <p>Voici un tableau (non exhaustif) avec les principales variables que nous allons utiliser :</p>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Type de variable</th>
                                <th>Détails</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Texte</td>
                                <td>String</td>
                                <td>Texte</td>
                            </tr>
                            <tr>
                                <td>Date</td>
                                <td>Date</td>
                                <td>Date et heure</td>
                            </tr>
                            <tr>
                                <td>Boolean</td>
                                <td>Boolean</td>
                                <td>Vrai ou faux</td>
                            </tr>
                            <tr>
                                <td>Numérique</td>
                                <td>Byte</td>
                                <td>Nombre entier allant de 0 à 255</td>
                            </tr>
                            <tr>
                                <td>Numérique</td>
                                <td>Integer</td>
                                <td>Nombre entier allant de -32768 à +32767</td>
                            </tr>
                            <tr>
                                <td>Numérique</td>
                                <td>Long</td>
                                <td>Nombre entier allant de -2,1 millards juqu'à +2,1 milliards</td>
                            </tr>
                            <tr>
                                <td>Numérique</td>
                                <td>Float</td>
                                <td>Nombre à virgule</td>
                            </tr>
                            <tr>
                                <td>Objet</td>
                                <td>Objet</td>
                                <td>Objet</td>
                            </tr>
                        </tbody>
                    </table>
                    <p>Vous pouvez donc définir une variable pour contenir du <span class="em">texte</span>, des <span class="em">nombres</span> entiers, des nombres à virgule, des <span class="em">booléens</span>, etc.</p>
                    <p>Mais alors, si en type texte je peux également stocker des nombres, à quoi ça sert tous les autres types de variables ? Afin de comprendre l'importance des types de variables, je vous propose un exemple.</p>
                    <p>Je crée deux variables :</p>
                    <ul>
                        <li>
                            <p><span class="em">Annee_de_naissance</span> en 'string' où je stocke la valeur <span class="em">1987</span>;</p>
                        </li>
                        <li>
                            <p><span class="em">Age</span> en 'integer' où je stocke la valeur de <span class="em">35</span>.</p>
                        </li>
                    </ul>
                    <p>Maintenant, je vous demande d'additionner les deux variables. Quelle réponse me donnez-vous ?</p>
                    <p>"<span class="em">2022</span>", et vous avez raison !</p>
                    <p>Maintenant, demandons la même chose en VBA. Nous allons avoir comme résultat "35".</p>
                    <p>Pourquoi ? Simplement car nous ne pouvons pas additionner un type string (texte) avec un type integer (Numérique). Le VBA va additionner seulement le 35 avec rien.</p>
                    <p>Vous comprenez <span class="em">l'importance</span> de bien définir les variables dès le début du projet. En fonction du type de variable, nous ne pourrons pas les utiliser de la même façon ni pour faire les mêmes choses. Certaines actions ne sont possibles qu'avec un type de variable spécifique.</p>
                    <p>Maintenant que vous avez compris l'importance des types, vous allez créer votre première variable.</p>
                    <h3>Écivez votre première ligne de code !</h3>
                    <p>Voici le code pour créer la variable
                    <span class="em">annee_de_naissance</span> :</p>
<pre><code>dim annee_de_naissance as integer</code></pre>
                    <p>On y retrouve 4 lots différents :</p>
                    <ul>
                        <li>
                            <p>"Dim" : (raccourci de "Dimension"), permet de faire comprendre à l'éditeur VBA qu'on va créer un nouvelle variable, et déclarer ses dimensions (nom, type etc.);</p>
                        </li>
                        <li>
                            <p>"annee_de_naissance" : nom de la variable que nous souhaitons créer;</p>
                        </li>
                        <li>
                            <p>"As" : permet d'associer un type à la variable;</p>
                        </li>
                        <li>
                            <p>"Integer" : type de la variable.</p>
                        </li>
                    </ul>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Notez qu'à la création, la variable est vide, il n'y a d'information à l'intérieur.</p>
                    </div>
                    <p>Il y a plusieurs <span class="em">bonnes pratiques</span> à mettre en place quand vous créez des variables dans un projet :</p>
                    <ol>
                        <li>
                            <p>Un nom explicite de ce que va contenir la variable.</p>
                        </li>
                        <li>
                            <p>Pas d'espace. Si vous voulez utiliser deux mots, séparez-les avec un "_".</p>
                        </li>
                        <li>
                            <p>Pas de majuscule.</p>
                        </li>
                    </ol>
                    <p>C'est bien joli de savoir déclarer une variable, mais à quoi ça sert si elle est vide, et comment je la charge ? Eh bien, cette partie est très simple, si on reprend notre exemple. Il suffit simplement d'écrire :</p>
<pre><code>annee_de_naissance = 1987</code></pre>
                    <p>Voilà, vous venez de charger le nombre 1987 dans votre variable.</p>
                    <p>Si vous voulez voir le contenu de votre variable, utilisez la commande "<span class="html">msgbox</span>".</p>
<pre><code>MSgBox (annee_de_naissance)</code></pre>
                    <p>Cette commande va vous afficher "1987" dans une fenêtre Windows dans Excel.</p>
                    <p>Vous pouvez également voir la valeur de cette variable en utilisant le panneau des <span class="em">variables locales</span> dans l'éditeur VBA.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Si celui-ci n'est pas dans votre interface, allez dans "Affichages" puis cliquez sur "Afficher les variables locales".</p>
                    </div>
                    <p>Comme vous pouvez voir dans le panier des variables locales de mon exemple, la variable <span class="em">age</span> contient <span class="em">35</span>. Le 35 est entre guillemets alors que le 1987 n'a pas de guillemets. Si on regarde le type, on voit que <span class="em">annee_de_naissance</span> est un 'integer' et <span class="em">age</span> une 'string'. Les guillemets autour du 35 nous indiquent que le nombre est stocké comme une chaîne de caractères (donc entre guillemets).</p>
                </article>
                <article>
                    <h2 id="operateurs_conditionnels">Utilisez les opérateurs conditionnels :</h2>
                    <p>Précédemment, nous avons vu comment <span class="em">déclarer une variable</span> avec les différents types qui existent. Voyons maintenant ensemble le vrai intérêt d'une variable, et comment cela va vous aider dans votre code de tous les jours.</p>
                    <p>Nous allons commencer par utiliser des <span class="em">opérateurs conditionnels</span>, puis nous les utiliserons au travers de conditions avec des <span class="html">If</span> puis, pour finir, avec des <span class="html">Select Case</span>.</p>
                    <h3>Maîtrisez les opérateurs conditionnels :</h3>
                    <p>Je crois que c'est le moment où cela va se compliquer... non ? Figurez-vous que non, pas vraiment; les mots "<span class="em">opérateurs conditionnels</span>" peuvent à première vue vous faire peur, mais en fait c'est assez simple.</p>
                    <p>Les opérateurs conditionnels permettent de faire des <span class="em">actions</span> avec des variables, comme par exemple les comparer.</p>
                    <p>Comme par exemple regarder si une variable est plus grande qu'une autre ? Tout à fait, ce n'est pas plus difficile que cela. Regardons ensemble les différents types d'opérateurs et analysons ensemble la syntaxe. On retrouve des opérateurs :</p>
                    <ul>
                        <li>
                            <p><span class="em">arithmétiques</span>;</p>
                        </li>
                        <li>
                            <p><span class="em">de comparaison</span>;</p>
                        </li>
                        <li>
                            <p><span class="em">logiques</span>;</p>
                        </li>
                        <li>
                            <p><span class="em">de concaténation</span>.</p>
                        </li>
                    </ul>
                    <p>Commençons ensemble par les <span class="em">opérateurs arithmétiques</span>. Ces opérateurs permettent de faire des calculs entre deux variables. Par exemple, additionner la variable 1 avec la variable 2.</p>
                    <h4>Les opérateurs arithmétiques :</h4>
                    <p>Toutes les opérations <span class="em">arithmétiques</span> classiques s'utilisent avec des nombres (integer, float, etc.) :</p>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th>Calcul</th>
                                <th>Opérateur à utiliser en VBA</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Addition</td>
                                <td>+</td>
                            </tr>
                            <tr>
                                <td>Soustraction</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>Multiplication</td>
                                <td>*</td>
                            </tr>
                            <tr>
                                <td>Division</td>
                                <td>/</td>
                            </tr>
                            <tr>
                                <td>Modulo</td>
                                <td>mod</td>
                            </tr>
                            <tr>
                                <td>Division donnant un entier</td>
                                <td>\</td>
                            </tr>
                            <tr>
                                <td>Puissance</td>
                                <td>^</td>
                            </tr>
                            <tr>
                                <td>Affectation d'une valeur</td>
                                <td>=</td>
                            </tr>
                        </tbody>
                    </table>
                    <p>Reprenons notre exemple précédent : nous allons chercher à retrouver l'année de naissance en effectuant une soustraction entre l'âge et l'année actuelle. Voyons comment faire cela :</p>
                    <p>Code de la macro :</p>
<pre><code>Sub annee()

Dim age As Integer
Dom calcul As Integer

age = 36
calcul = 2023 - Age
Msg(calcul)

End Sub</code></pre>
                    <p>Tous les opérateurs s'utilisent de la même manière que notre exemple. Je vous laisse faire différents tests pour mieux vous familiariser avec les opérateurs.</p>
                    <p>Maintenant que vous savez faire des calculs, il est temps de comparer les variables avec les <span class="em">opérateurs de comparaison</span>.</p>
                    <h4>Les opérateurs de comparaison :</h4>
                    <p>Il existe plusieurs opérateurs de <span class="em">comparaison</span> en VBA; en voici une liste non exhaustive :</p>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th>Calcul</th>
                                <th>Opérateur à utiliser en VBA</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Inféreur à</td>
                                <td>&lt;</td>
                            </tr>
                            <tr>
                                <td>Inférieur ou égal à</td>
                                <td>&lt;=</td>
                            </tr>
                            <tr>
                                <td>Supérieur à</td>
                                <td>&gt;</td>
                            </tr>
                            <tr>
                                <td>Supérieur ou égal à</td>
                                <td>&gt;=</td>
                            </tr>
                            <tr>
                                <td>Égal à</td>
                                <td>=</td>
                            </tr>
                            <tr>
                                <td>Différent à</td>
                                <td>&lt;&gt;</td>
                            </tr>
                            <tr>
                                <td>Comparer deux strings</td>
                                <td>like</td>
                            </tr>
                        </tbody>
                    </table>
                    <p>Le résultat de cette opération renvoie un <span class="em">True (vrai)</span> ou <span class="em">False (faux)</span> dans la vairable.</p>
                    <p>SI nous continuons avec notre exemple, nous avions calculé un résultat de 2023, nous souhaitons savoir si ce résultat est supérieur ou égal à 2000.</p>
<pre><code>Sub annee()
Dim age As Integer
Dim calul As Boolean
Dim annee_test As Integer

age = 36
annee_test = 2000

calcul = (2003 - age) &gt;= annee_test

MsgBox (calcul)

End Sub</code></pre>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Petite précision, le résultat renvoie "<span class="em">faux</span>" car la variable résultat est déclarée en 'boolean'. Si cette variable était un 'integer', alors le résultat serait 0.</p>
                    </div>
                    <p>Vous pouvez également comparer autre chose que des chiffres, comme par exemple vous demander si deux chaînes de caractères sont identiques. Essayez les différents opérateurs.</p>
                    <p>Continuons le tour des opérateurs avec les <span class="em">opérateurs logiques</span>. Ils sont particulièrement importants en programmation.</p>
                    <h4>Les opérateurs logiques :</h4>
                    <p>Voici la liste des principaux opérateurs <span class="em">logique</span> :</p>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th>Calcul</th>
                                <th>Opérateur à utiliser en VBA</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Conjonction</td>
                                <td>And</td>
                            </tr>
                            <tr>
                                <td>Négation logique</td>
                                <td>Not</td>
                            </tr>
                            <tr>
                                <td>Disjonction</td>
                                <td>Or</td>
                            </tr>
                            <tr>
                                <td>Xor</td>
                                <td>Exclusion</td>
                            </tr>
                        </tbody>
                    </table>
                    <p>Essayons à présent, avec notre exemple, de savoir si la date de l'année est égale à 2022 et si l'âge est inférieur à 30 ans. Pour faire cela, utilisez l'opérateur logique de conjonction 'And'. Le 'And' est simplement un "Et", il faut que les deux conditions soient réunies pour que cela renvoie un "vrai" cette fois.</p>
                    <p>Vérifiez toujours si la date de naissance est bien inférieure à l'année 2000 et ajoutez la condition de ville. Car on souhaite que le programme nous renvoie "vrai" si c'est une personne qui viet de Montpellier.</p>
<pre><code>Sub annee()
Dim age As Integer
Dim calcul As Integer
Dim annee As Integer
Dim resultat As Boolean
age = 35
annee = 2000
ville_naissance = "Montpellier"

calcul = 2023 - age
resultat = calcul &lt;= annee And ville_naissance = "Montpellier"

MsgBox (resultat)
End Sub</code></pre>
                    <p>Je vous laisse ici aussi faire des tests, comme mettre Paris dans la ville de naissance (cela va vous renvoyer "faux", normalement) puis changeer l'opérateur en <span class="html">OR</span> et voir ce que cela change. Si tout se passe bien, cela doit vous dire "vrai". Pour l'opérateur <span class="html">OR</span>, si une des deux conditions est validée, alors il renvoie "vrai".</p>
                    <p>Pour finir, voyons ensemble les opérateurs de <span class="em">concaténation</span>.</p>
                    <h4>Les opérateurs de concaténation :</h4>
                    <p>Nous avons déjà évoqé ce sujet précédemment avec des chaînes de caractères. La concaténation se fait généralement sur du texte (donc des strings). On peut utiliser l'opérateur <span class="html">+</span> ou <span class="html">&</span>. L'opérateur <span class="html">+</span> s'utilise pour additionner des nombres, donc par convention on va plutôt utiliser le <span class="html">&</span> et laisser le <span class="html">+</span> aux nombres, même si les deux versions fonctionnent.</p>
                    <h3>Appréhendez la notion de condition :</h3>
                    <p>Si tout va bien, vous comprenez maintenant l'intérêt des variables et ce que nous pouvons en faire avec les différents tests. Nous avons vu ensemble que nous pouvons les additionner, faire des tests entre deux variables ou encore les concaténer. Nous allons maintenant voir un nouvel élément, <span class="em">les conditions</span>. C'est très important de bien comprendre le fonctionnement, car vous allez très souvent l'utiliser tel quel ou avec certaines déclinaisons.</p>
                    <p>Trève de bavardage, essayons la condition <span class="html">If</span>.</p>
                    <p>Le <span class="html">IF</span> (en français, <span class="em">si</span>) permet de venir <span class="em">tester des hypothèses</span>.</p>
                    <p>Par exemple, imaginons que je souhaite tester l'âge de quelqu'un et faire une action différente en fonction de son âge.</p>
                    <p>Si l'âge de la personne est supérieur ou égal à 18 ans,</p>
                    <p>alors je lui dis qu'il peut créer un compte,</p>
                    <p>sinon je lui dis qu'il est trop jeune pour créer un compte.</p>
                    <p>Cette syntaxe permet de faire des actions différentes en fonction de la valeur de la variable âge.</p>
                    <p>Regardons maintenant comment cela se matérialise en VBA :</p>
<pre><code>Sub annee()
Dim age As Integer
Dim age_minimum As Integer
age = 16
age_minimum = 18

If age &gt;= age_minimum Then
    MsgBox ("Tu peux créer ton compte")
    Else
    MsgBox ("Tu es trop jeune pour créer ton compte")
End If

End Sub</code></pre>
                    <p>Notre fonction <span class="html">If</span> s'écrit toujours de la même façon. Commençons par lui donner le test que vous voulez faire. Ici je lui dis que je souhaite que la variable âge soit supérieure ou égale à 18. Le résultat, comme nous l'avons vu plus haut, renvoie un booléen "vrai" ou "faux".</p>
                    <p>Utilisez ensuite le mot <span class="html">Then</span> (qui veut dire "alors") : alors si le résultat du test est vrai, exécuter la ligne qui est en dessous, qui écrit à l'utilisateur "Tu peux créer ton compte".</p>
                    <p>Pour finir, utilisez le mot <span class="html">Else</span> (qui veut dire "sinon") : sinon je dis à l'utilisateur "Tu es trop jeune pour créer ton compte". Puis je termine par un <span class="html">End If</span> pour lui dire que le if est terminé.</p>
                    <p>En changeant la valeur de la variable âge, vous pouvez voir que cela fonctionne bien.</p>
                    <div class="information">
                        <img src="" alt="" class="float_left">
                        <p>Vous remarquerez que les données écrites à l'intérieur du if ne sont pas alignées avec le If (If age &lt;&gt; End If). Ce n'est pas une erreur de la mise en page mais bien une bonne pratique. Cela s'appelle <span class="em">l'indentation</span>. Cette pratique consiste à ajouter des espaces en début de ligne pour créer une structure. Cela permet d'améliorer la lisibilité et la compréhension du code. Nous pouvons ainsi voir ce qui est "à l'intérieur" du if facilement sans avoir à regarder les parenthèses. Dans notre exemple, nous n'avons qu'un seul If. Imaginez maintenant plusieurs if imbriqués ensemble, sans l'indentation : c'est très compliqué.</p>
                        <p>Dans notre exemple, je n'ai utilisé qu'une seule condition, mais vous pouvez bien évidemment utiliser les opérateurs logiques pour rajouter des conditions.</p>
                    </div>
                    <p>Vous venez de tester si une valeur est vraie ou fasse. Mais imaginons maintenant que vous souhaitez tester plusieurs valeurs. Vous allez devoir faire plein de petits if, et cela va être assez fastidieux. Heureusement pour nous, il existe une variante du if qui permet de faire du multichoix, le <span class="html">ElseIf</span>.</p>
                    <p>Revenons à notre exemple, nous souhaitons maintenant faire des actions différentes en fonction de la ville de naissance d'une personne.</p>
<pre><code>Sub annee()

Dim departement_naissance As string
departement_naissance = Range("A1").Value

If departement_naissance = 34 Then
    MsgBox ("Tu es rattaché à l'agence Occitanie")
    ElseIf departement_naissance = 75 Then
    MsgBox ("Tu es rattaché à l'agence d'Île-de-France")
    ElseIf departement_naissance = 33 Then
    MsgBox ("Tu es rattaché à l'agence de Nouvelle Aquitaine")
    If departement_naissance = 69 Then
    MsgBox ("Tu es rattaché à l'agence Auvergne Rhône-Alpes")
    Else
    MsgBox ("Nous n'avons pas l'information")
End If

End Sub</code></pre>
                    <p>Le début de la syntaxe est la même, sauf que cette fois au lieu de rajouter un else, nous avons rajouté un <span class="html">elseif</span> avec une nouvelle condition. Ainsi, à chaque nouvel <span class="html">elseif</span> vous pouvez ajouter une condition; le code va passer sur chaque test jusqu'à arriver à celui qui permet de valider la condition, puis afficher le message.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Vous remarquerez que vous ne pouvez <span class="em">valider qu'un seul <span class="html">elseif</span></span>, car une fois qu'une condition est validée, le VBE va automatiquement sauter toutes les autres conditions pour arriver sur le <span class="html">End If</span> et sortir de ce test.</p>
                    </div>
                    <p>J'ai volontairement rajouté à la fin de ce <span class="html">if</span> un <span class="html">else</span>, qui permet de dire à l'utilisateur que nous n'avons pas cette information. Si nous n'avions pas ajouté ce else et qu'un utilisateur venait du 35, il n'y aurait même pas eu de message pour l'utilisateur.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Quand vous travaillez sur des conditions, il faut toujours essayer de couvrir tous les cas possibles de chaque valeur que vous souhaitez tester en entrée.</p>
                    </div>
                    <h3>Allez plus loin avec Select :</h3>
                    <p>Comme vous venez de le voir, la combinaison des <span class="html">elseif</span> n'est pas vraiment <span class="em">élégante</span> (oui oui je vous assure qu'on peut dire <span class="em">élégante</span> du code).</p>
                    <p>Il existe une autre solution qui donne les mêmes résultats mais qui est plus simple d'utilisation, c'est le <span class="html">Select Case</span>.</p>
                    <p>Reprenons le même exemple qu'avec le <span class="html">ElseIf</span> mais en l'adoptant avec le <span class="html">Select Case</span>.</p>
<pre><code>Sub Association_region()

Dim departement_naissance As String
departement_naissance = Range("A1").Value

Select Case departement_naissance
    Case 9, 11, 12, 30, 31, 32, 34, 46, 48, 65, 66, 81, 82
    MsgBox ("Tu es rattaché à l'agence Occitanie")
    Case 75, 77, 78, 91, 92, 93, 94, 95
    MsgBox ("Tu es rattaché à l'agence d'Île-de-France")
    Case 16, 17, 19, 23, 24, 33, 40, 47, 64, 79, 86, 87
    MsgBox("Tu es rattaché à l'agence de Nouvelle Aquitaine")
    Case 1, 3, 7, 15, 26, 38, 42, 43, 63, 69, 73, 74
    MsgBox ("Tu es rattaché à l'agence Auvergne Rhône-Alpes")
    Case 2, 4, 5, 6, 8, 10, 13, 14, 18, 20, 21, 22, 25, 27, 28, 29, 36, 37, 39, 41, 44, 45, 49, 5O, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 67, 68, 70, 71, 72, 76, 80, 83, 84, 85, 88, 89, 90, 97
    MsgBox ("Nous n'avons pas d'agence dans ton département")
End Select

End Sub</code></pre>
                    <p>Avec ce code, vous arriverez rapidement à couvrir facilement tous les cas de la version avec le <span class="html">if</span>, et à ajouter tous les départements pour chaque région sans alourdir le code. Comme vous le remarquez, cela ne prend pas beaucoup plus de place que le <span class="html">ElseIf</span> alors que vous couvrez beaucoup de départements.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Notez que vous pouvez utiliser des plages de valeurs, comme par exemple les 'case 1 to 10', ou encore des conditions, comme 'case is &lt; 10'.</p>
                    </div>
                </article>
                <article>
                    <h2 id="boucles">Maîtrisez les boucles :</h2>
                    <p>Maintenant que vous avez vu comment définir une variable et comment vous pouvez l'utiliser en faisant des tests, passons à une nouvelle étape cruciale dans l'apprentissage de la programmation, avec <span class="em">les boucles</span>.</p>
                    <p>Une boucle permet de refaire <span class="em">plusieurs fois une même action</span>. Tout comme le test des hypothèses que nous avons vu plus haut (le <span class="html">IF</span> et le <span class="html">Select Case</span>), il existe plusieurs boucles qui ont des résultats assez similaires mais une mécanique différente. Voyons ensemble la boucle <span class="html">For</span>, la boucle <span class="html">Do</span>, et pour finir la boucle <span class="html">While</span>.</p>
                    <h3>Appréhendez les boucles conditionnelles :</h3>
                    <p>Les boucles permettent de <span class="em">gagner beaucoup de temps</span> sur le traitement et sur l'écriture de votre code. En effet, il est assez commun de dire que nous ne souhaitons pas écrire plusieurs fois la même ligne de code. Pour commencer, cela n'est pas optimisé, et puis ce n'est <span class="em">pas élégant</span>.</p>
                    <p>Élégant, élégant... ça reste du code quand même ! Oui je suis d'accord avec vous, mais je ne doute pas qu'à un moment, quand vous allez écrire, vous trouverez vous aussi que votre code est élégant.</p>
                    <p>Revenons maintenant à notre boucle. Vous avez un tableau de 10 départements dans lequel vous souhaitez leur rattacher automatiquement leur région. Pour ce faire, vous pouvez écrire du code qui va aller chercher chaque ligne une par une.</p>
                    <figure>
                        <img src="../images/exemple_departements_Excel.png" alt="">
                        <figcaption>Exemple de départempents dans Excel</figcaption>
                    </figure>
                    <p>Le code va ressembler à cela pour la cellule B3 :</p>
<pre><code>Sub Association_region()

Dim departement_naissance As Integer

departement_naissance = Range("A3").Value

Select Case departement_naissance
    Case 9, 11, 12, 30, 31, 32, 34, 46, 48, 65, 66, 81, 82
    Range("B3").Value = "Occitanie"
    Case 75, 77, 78, 91, 92, 93, 94, 95
    Range("B3").Value = "Île-de-France"
    Case 16, 17, 19, 23, 24, 33, 40, 47, 64, 79, 86, 87
    Range("B3").Value = "Nouvelle Aquitaine"
    Case 1, 3, 7, 15, 26, 38, 42, 43, 63, 69, 73, 74
    Range("B3").Value = "Auvergne Rhône-Alpes"
    Case 2, 4, 5, 6, 8, 10, 13, 14, 18, 20, 21, 22, 25, 27, 28, 29, 36, 37, 39, 41, 44, 45, 49, 5O, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 67, 68, 70, 71, 72, 76, 80, 83, 84, 85, 88, 89, 90, 97
    Range("B3").Value = "Pas d'agence"
End Select

End Sub</code></pre>
                    <p>Après avoir exécuté ce code, vous allez avoir le mot "Occitanie" dans la cellule B3.</p>
                    <p>Sans les boucles, vous devriez écrire ce code pour chaque ligne. Le code ci-dessus fait le travail pour la première case "A3". Puis vous auriez à écrire le même code qui fait le travail pour cette fois A4, puis encore A5, et ainsi de suite. <span class="em">La boucle va permettre de passer sur toutes les cellules sans écrire beaucoup plus de code.</span></p>
                    <h3>Maîtrisez la boucle FOR :</h3>
                    <p>Commençons par la boucle <span class="html">FOR</span>. La syntaxe de cette boucle est assez simple, nous commençons par...</p>
                    <p>FOR ! Effectivement c'est bien le mot "For" qui va permettre de débuter cette instruction, puis vous allez mettre une condition.</p>
                    <p>Par exemple :</p>
                    <p>For i = 1 to 15</p>
                    <p>Cette boucle va donc fonctionner <span class="em">tant que i n'est pas égale à 15</span>. Vous pourriez me dire, mais pourquoi il y a un i et pourquoi 15 ? Si vous revenez dans le fichier Excel, vous pouvez voir que la dernière cellule que nous souhaitons remplir est la quinzième; c'est pour cela que vous vous arrêtez à 15. C'est une convention, dans un <span class="html">for</span> nous utilisons une variable qui s'appelle <span class="em">i</span>. Nous allons détailler la mécanique de cette variable juste en dessous.</p>
                    <p>Ensuite utilisez le <span class="html">select case</span> que nous avons déjà vu pour remplir la cellule. Cependant, dans notre cellule nous avions une référence à la cellule B3, et le problème c'est que nous souhaitons automatiser cela. Vous allez donc changer le code pour qu'il s'adapte : au lieu d'utiliser le code <span class="html">Range("B3").Value = "Occitanie"</span>, écrivez <span class="html">Range("B" & i).Value = "Occitanie"</span>.</p>
                    <p>Cela va permettre d'obtenir en valeur :</p>
                    <ul>
                        <li>
                            <p>B3, quand i va être égale à 3;</p>
                        </li>
                        <li>
                            <p>B4, quand i va être égale à 4.</p>
                        </li>
                    </ul>
                    <p>Pour finir une instruction <span class="html">For</span>, il vous faut écrire <span class="html">Next</span>. Vous souhaitez ici incrémenter la valeur de <span class="html">i</span>, pour qu'elle balaie toutes les valeurs de 1 à 15. Écrivez alors <span class="html">Next i</span>. Le VBE va alors incrémenter automatiquement la variable de i de 1.</p>
                    <p>Voici le code avec la boucle <span class="html">For</span> :</p>
<pre><code>Sub for_Association_region()

Dim departement_naissance As Integer
Dim i As Integer
i = 3

For i = 3 To 15
    departement_naissance = Range("A" & i).Value
    Select Case departement_naissance
        Case 9, 11, 12, 30, 31, 32, 34, 46, 48, 65, 66, 81, 82
        Range("B" & i).Value = "Occitanie"
        Case 75, 77, 78, 91, 92, 93, 94, 95
        Range("B" & i).Value = "Île-de-France"
        Case 16, 17, 19, 23, 24, 33, 40, 47, 64, 79, 86, 87
        Range("B" & i).Value = "Nouvelle Aquitaine"
        Case 1, 3, 7, 15, 26, 38, 42, 43, 63, 69, 73, 74
        Range("B" & i).Value = "Auvergne Rhône-Alpes"
        Case 2, 4, 5, 6, 8, 10, 13, 14, 18, 20, 21, 22, 25, 27, 28, 29, 36, 37, 39, 41, 44, 45, 49, 5O, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 67, 68, 70, 71, 72, 76, 80, 83, 84, 85, 88, 89, 90, 97
        Range("B" & i).Value = "Pas d'agence"
    End Select
Next i

End Sub</code></pre>
                    <p>Si vous avez également essayé ce code chez vous, vous devez normalement avoir les différentes cellules remplies avec les bonnes informations.</p>
                    <p>Pour implémenter cette boucle, nous avons dû faire des changements par rapport au code initial. Nous avons commencé à partir de la ligne 3 dans le <span class="html">For</span>, car il n'y avait pas de données avant cette ligne.</p>
                    <p>Si vous comparez la taille du code entre la version pour une seule cellule et celle-ci pour les 15, il y a 4 lignes de plus seulement. Et à la place de 15 nous pourrions avoir une liste de <span class="em">cent mille lignes</span>, cela ne <span class="em">change pas la taille du code</span>, juste le temps d'exécution qui est plus long.</p>
                    <p>Le nom de la variable qui permet de faire des itérations n'a pas d'importance. Communément, cette variable s'appelle <span class="html">i</span>, mais nous pourrions très bien utiliser une variable qui s'appelle <span class="html">catapulte</span>. Vous auriez alors <span class="html">For catapulte = 3 to 15</span> et un <span class="html">next catapulte</span>. Ce code fonctionne parfaitement.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Vous remarquerez que j'ai changé toutes les références à la cellule 3 par le i. J'ai également déclaré la variable i.</p>
                    </div>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Notez qu'il existe une variante de cette boucle qui s'utilise avec des tableaux ou des collections avec l'instruction <span class="html">For Each ... Next...</span></p>
                    </div>
                    <h3>Utilisez les boucles Do et While :</h3>
                    <p>Les boucles sont très utilisées en général en programmation car cela permet de répéter une action facilement.</p>
                    <p>Il existe deux autres types de boucles en VBA, le <span class="html">Do</span> et le <span class="html">While</span>. Nous allons commencer par le <span class="html">Do</span>.</p>
                    <h4>La boucle Do :</h4>
                    <p>Le <span class="html">Do</span> a un fonctionnement assez similaire au <span class="html">For</span>, à la nuance près qu'il n'y a pas d'incrémentation automatique.</p>
                    <p>Écrivez la commande <span class="html">Do While i &lt;= 15</span>. C'est-à-dire "faire tant que i est inférieure ou égale à quinze".</p>
                    <p>À la fin, rajoutez une incrémentation de i avec i = i + 1, puis clôturez l'instruction par un loop.</p>
<pre><code>Sub do_Association_region()</code></pre>
                    <p>Ce code donne exactement le même résultat que la boucle <span class="html">For</span>.</p>
                    <p>Voici le code :</p>
<pre><code>Sub do_Association_region()

Dim departement_naissance As Integer
Dim i As Integer
i = 3

Do While i &lt;= 15
    departement_naissance = Range("A" & i).Value
    Select Case departement_naissance
        Case 9, 11, 12, 30, 31, 32, 34, 46, 48, 65, 66, 81, 82
        Range("B" & i).Value = "Occitanie"
        Case 75, 77, 78, 91, 92, 93, 94, 95
        Range("B" & i).Value = "Île-de-France"
        Case 16, 17, 19, 23, 24, 33, 40, 47, 64, 79, 86, 87
        Range("B" & i).Value = "Nouvelle Aquitaine"
        Case 1, 3, 7, 15, 26, 38, 42, 43, 63, 69, 73, 74
        Range("B" & i).Value = "Auvergne Rhône-Alpes"
        Case 2, 4, 5, 6, 8, 10, 13, 14, 18, 20, 21, 22, 25, 27, 28, 29, 36, 37, 39, 41, 44, 45, 49, 5O, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 67, 68, 70, 71, 72, 76, 80, 83, 84, 85, 88, 89, 90, 97
        Range("B" & i).Value = "Pas d'agence"
    End Select
    i = i + 1
Loop

End Sub</code></pre>
                    <p>Si vous êtes un peu joueur, vous pouvez essayer d'enlever le i = i + 1 puis de relancer le code. D'après vous, qu'est-ce qu'il va se passer ?</p>
                    <p>Vous imaginez que le code va remplir la ligne 3, car nous avons déclaré i = 3 et il n'y a pas d'incrémentation, puis c'est tout. C'est une bonne lecture du code effectivement, mais tout est dans le "c'est tout". En réalité, votre code va rester <span class="em">bloqué</span> et remplir indéfiniment la même cellule (B3). En effet, la seule chose qui peut nous faire sortir de la boucle c'est d'arriver à 15; tant que nous ne sommes pas arrivés à ce chiffre, la boucle essaie toujours d'exécuter une action. Elle refait donc la même action... <span class="em">en boucle</span>.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Si vous avez exécuté le code sans l'incrémentation, vous avez sûrement un Excel qui est figé ainsi que l'éditeur VBE. Pour forcer le VBE à sortir de la boucle, vous pouvez utiliser la touche <kbd>ECHAP</kbd> puis appuyer sur Débogage.</p>
                    </div>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Il y a différentes variantes de cette boucle, comme le Do Until... Loop ou encore le Do... Loop While et pour finir le Do... Until Loop.</p>
                    </div>
                    <h4>La boucle While :</h4>
                    <p>Pour en finir avec les boucles, utilisons ensemble la dernière : le <span class="html">While... Went</span>. Cette boucle fonctionne comme le Do While... Loop.</p>
                    <p>Voici le code :</p>
<pre><code>Sub While_Association_region()

Dim departement_naissance As Integer
Dim i As Integer
i = 3

While i &lt;= 15
    departement_naissance = Range("A" & i).Value
    Select Case departement_naissance
        Case 9, 11, 12, 30, 31, 32, 34, 46, 48, 65, 66, 81, 82
        Range("B" & i).Value = "Occitanie"
        Case 75, 77, 78, 91, 92, 93, 94, 95
        Range("B" & i).Value = "Île-de-France"
        Case 16, 17, 19, 23, 24, 33, 40, 47, 64, 79, 86, 87
        Range("B" & i).Value = "Nouvelle Aquitaine"
        Case 1, 3, 7, 15, 26, 38, 42, 43, 63, 69, 73, 74
        Range("B" & i).Value = "Auvergne Rhône-Alpes"
        Case 2, 4, 5, 6, 8, 10, 13, 14, 18, 20, 21, 22, 25, 27, 28, 29, 36, 37, 39, 41, 44, 45, 49, 5O, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 67, 68, 70, 71, 72, 76, 80, 83, 84, 85, 88, 89, 90, 97
        Range("B" & i).Value = "Pas d'agence"
    End Select
    i = i + 1
Went

End Sub</code></pre>
                    <p>J'ai fait fait 3 fois le même travail avec 3 types de boucles différentes pour faire la même chose, alors laquelle je dois choisir ? <span class="html">For</span>, <span class="html">Do</span> ou <span class="html">While</span> ?</p>
                    <p>Comme souvent en programmation, il n'y a pas qu'une réponse. J'ai envie de vous dire que l'important c'est d'utiliser la méthode qui vous convient. Il n'y a pas de méthode vraiment meilleure qu'une autre dans les 3 que nous avons présentées.</p>
                    <h3>Interrompez une boucle :</h3>
                    <p>Un peu plus haut, nous avons <span class="em">supprimé l'itération</span> du i et nous sommes restés <span class="em">coincés</span> dans la boucle. À ce moment, je vous ai dit que la seule chose qui pouvait vous faire sortir du code c'est d'arriver à 15, c'est-à-dire la condition initiale.</p>
                    <p>J'ai volontairement omis de vous dire que vous pouvez sortir des boucles avec des instructions spécifiques, <span class="html">Exit For</span> pour les boucles For et <span class="html">Exit Do</span> pour les boucles <span class="html">Do</span>.</p>
                    <p>Voyons ensemble le fonctionnement du code et l'utilisation que nous pouvons en faire.</p>
                    <p>Maintenant quand un département n'est pas trouvé, vous ne souhaitez pas continuer à remplir les départements, mais avertir l'utilisateur qu'il y a une erreur.</p>
                    <p>Voici le code que vous allez utiliser :</p>
<pre><code>Sub for_Exit_Association_region()

    Dim departement_naissance As Integer
    Dim i As Integer
    i = 3
    
    For i = 3 To 15
        departement_naissance = Range("A" & i).Value
        Select Case departement_naissance
            Case 9, 11, 12, 30, 31, 32, 34, 46, 48, 65, 66, 81, 82
            Range("B" & i).Value = "Occitanie"
            Case 75, 77, 78, 91, 92, 93, 94, 95
            Range("B" & i).Value = "Île-de-France"
            Case 16, 17, 19, 23, 24, 33, 40, 47, 64, 79, 86, 87
            Range("B" & i).Value = "Nouvelle Aquitaine"
            Case 1, 3, 7, 15, 26, 38, 42, 43, 63, 69, 73, 74
            Range("B" & i).Value = "Auvergne Rhône-Alpes"
            Case 2, 4, 5, 6, 8, 10, 13, 14, 18, 20, 21, 22, 25, 27, 28, 29, 36, 37, 39, 41, 44, 45, 49, 5O, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 67, 68, 70, 71, 72, 76, 80, 83, 84, 85, 88, 89, 90, 97
            MsgBox ("Attention, il n'y a pas d'agence dans ce département !!!")
            Exit For
        End Select
    Next i
    
    End Sub</code></pre>
                    <p>Comme vous pouvez le voir, seules les quatre premières cellules se sont remplies avec cette ligne de code. À la cinquième, le code :</p>
                    <ul>
                        <li>
                            <p>est entré dans le dernier <span class="html">Case</span>;</p>
                        </li>
                        <li>
                            <p>vous a indiqué avec un <span class="em">messagebox</span> qu'il y a un problème;</p>
                        </li>
                        <li>
                            <p>puis il est sorti du <span class="html">For</span> avec le <span class="html">Exit For</span> sans terminer toute la procédure.</p>
                        </li>
                    </ul>
                    <p>Vous pouvez dans vos scripts utiliser cette instruction pour ne pas rester dans ce que nous appelons une "<span class="em">boucle infinie</span>".</p>
                </article>
                <article>
                    <h2 id="fonctions_evenements">Maîtrisez les fonctions et les événements :</h2>
                    <p>Nous allons maintenant nous aventurer sur des sujets plus "simples" en pratique. Nous allons voir ensemble comment nous pouvons <span class="em">appeler</span> des fonctions ou des procédures pour clarifier notre code.</p>
                    <h3>Appréhendez les procédures :</h3>
                    <p>Si nous devions définir ce qu'est une procédure, nous pourrions dire que c'est un morceau de code que nous souhaitons extraire du code initial.</p>
                    <p>C'est un sous-programme, en gros ? Tout à fait, c'est un <span class="em">sous-programme</span> dans votre code VBA. Vous pouvez faire cela pour augmenter la lisibilité du code ou encore parce que vous utilisez le même code deux fois dans deux macros différentes. Afin de ne pas réécrire le code, nous préférons l'extraire.</p>
                    <p>Devinez quoi ? Comme d'habitude, il existe plusieurs façons de faire un sous-programme. Je vous ai dit en introduction que c'était un peu plus simple, et c'est vrai. Nous avons deux façons de faire des sous-programmes :</p>
                    <ul>
                        <li>
                            <p><span class="em">une subroutine</span> (Sub) (que vous utilisez depuis le début dans votre code);</p>
                        </li>
                        <li>
                            <p><span class="em">une fonction</span> (Function).</p>
                        </li>
                    </ul>
                    <p>Voici un petit tableau qui résume assez simplement ce que peuvent faire une subroutine et une fonction :</p>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th>Particularité</th>
                                <th>Subroutine</th>
                                <th>Fonction</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Elles peuvent contenir des méthodes ou des instructions ?</td>
                                <td>Oui</td>
                                <td>Oui</td>
                            </tr>
                            <tr>
                                <td>Elles peuvent être appelées depuis un autre sous-programme ?</td>
                                <td>Oui</td>
                                <td>Oui</td>
                            </tr>
                            <tr>
                                <td>Elles acceptent des arguments ?</td>
                                <td>Oui</td>
                                <td>Oui</td>
                            </tr>
                            <tr>
                                <td>Elles retournent une valeur ?</td>
                                <td class="em">Non</td>
                                <td>Oui</td>
                            </tr>
                        </tbody>
                    </table>
                    <p>Vous voyez rapidement que ce qui distingue une subroutine d'une fonction, ce sont les valeurs qu'elles peuvent <span class="em">retourner</span>.</p>
                    <p>Mais revenons un instant sur la troisième ligne de ce tableau avec la question "Elles acceptent des arguments ?".</p>
                    <p>Oui effectivement, cela veut dire quoi, accepter un argument ? L'utilisation d'un sous-programme pose un problème : les variables que vous utilisez dans votre programme général ne sont pas disponibles dans ce nouveau sous-programme.</p>
                    <p>Prenons un exemple :</p>
                    <p>Je souhaite modifier la date de mon reporting, en transformant le mois 02 en février. Le problème, c'est que je n'ai pas envie de voir ce code avec le gros Select Case directement dans mon code, je souhaite en faire un sous-programme.</p>
                    <p>Dans mon code, j'ai besoin de lire cette variable du mois qui contient "02" et que je dois transformer.</p>
<pre><code>Sub changement_mois()

Dim date_reporting As Date
Dim transformation_date As Integer
Dim mois As String
Dim jour As Integer
Dim annee As Integer

date_reporting = Range("A1").Value
transformation_date = Month(date_reporting)
jour = Day(date_reporting)
annee = Year(date_reporting)

Select Case transformation_date
    Case 1
    mois = "janvier"
    Case 2
    mois = "févrirer"
    Case 3
    mois = "mars"
    Case 4
    mois = "avril"
    Case 5
    mois = "mai"
    Case 6
    mois = "juin"
    Case 7
    mois = "juillet"
    Case 8
    mois = "août"
    Case 9
    mois = "septembre"
    Case 10
    mois = "octobre"
    Case 11
    mois = "novembre"
    Case 12
    mois = "décembre"
End Select

Range("D1").Value = "Reporting du " & jour & " " & mois & " " & annee

End Sub</code></pre>
                    <p>Cette fonction vous permet d'écrire la date dans un titre, "Reporting du mois du 1 février 2023".</p>
                    <p>Imaginons que vous ayez <span class="em">besoin de cette fonction dans une autre macro</span>, vous n'aurez pas envie de l'écrire à nouveau. C'est pourquoi vous pouvez en faire un sous-programme que vous aurez seulement besoin d'appeler pour transformer le mois.</p>
                    <p>Le problème, c'est que la lecture de la date se fait dans le programme principal; vous avez deux solutions, soit :</p>
                    <ul>
                        <li>
                            <p>relire dans votre sous-programme la valeur de la cellule qui contient la valeur du mois;</p>
                        </li>
                        <li>
                            <p>passer comme argument le mois que vous avez déjà récupéré à votre sous-programme.</p>
                        </li>
                    </ul>
                    <p>Pour ce premier test, vous allez relire la variable dans le sous-programme.</p>
                    <p>Voici ce que cela peut devenir avec une subroutine.</p>
<pre><code>Sub changement_mois_SP()

Dim date_reporting As Date
Dim transformation_date As Integer
Dim mois As String
Dim jour As Integer
Dim annee As Integer

date_reporting = Range("A1").Value
jour = Day(date_reporting)
annee = Year(date_reporting)

transformation_mois

mois = Range("B1").Value

Range("D1").Value = "Reporting du " & jour & " " & mois & " " & annee

End Sub

Sub transformation_mois()

Dim date_reporting As Date
Dim transformation_date As Integer
Dim mois As String

date_reporting = Range("A1").Value

transformation_date = Month(date_reporting)

Select Case transformation_date
    Case 1
    mois = "janvier"
    Case 2
    mois = "février"
    Case 3
    mois = "mars"
    Case 4
    mois = "avril"
    Case 5
    mois = "mai"
    Case 6
    mois = "juin"
    Case 7
    mois = "juillet"
    Case 8
    mois = "août"
    Case 9
    mois = "septembre"
    Case 10
    mois = "octobre"
    Case 11
    mois = "novembre"
    Case 12
    mois = "decembre
End Select

Range("B1").Value = mois

End Sub</code></pre>
                    <p>Vous avez <span class="em">fractionné</span> le programme initial qui est maintenant bien plus petit et on peut voir qu'il appelle le sous-programme transformation_mois. Le sous-programme :</p>
                    <ul>
                        <li>
                            <p>récupère les informations de la date dans le fichier;</p>
                        </li>
                        <li>
                            <p>passer par le <span class="html">Select Case</span>;</p>
                        </li>
                        <li>
                            <p>puis stocke la valeur de sa transformation dans la cellule B2.</p>
                        </li>
                    </ul>
                    <p>Le programme principal n'a plus qu'à récupérer cette valeur en B2 et écrire le titre du reporting.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Félicitations ! Vous venez de faire votre premier sous-programme !</p>
                    </div>
                    <p>Nous allons faire une légère digression avant de passer aux arguments.</p>
                    <p>Vous pouvez limiter la portée des appels pour les différents sous-programmes en utilisant la procédure :</p>
                    <ul>
                        <li>
                            <p><span class="html">Private</span> : utilisable seulement par les programmes d'un même module;</p>
                        </li>
                        <li>
                            <p><span class="html">Public</span> : utilisable par tous les modules;</p>
                        </li>
                        <li>
                            <p><span class="html">Static</span> : permet d'utiliser les variables pendant toute la durée du programme (les variables sont globales et non plus locales pour un sous-programme).</p>
                        </li>
                    </ul>
                    <p>Mais dans l'exemple, il n'y a rien d'écrit : pas de private, public ou static. C'est normal ? Effectivement, de base quand on ne rajoute rien, le sous-programme est par défaut en <span class="html">public</span>.</p>
                    <p>Si vous souhaitez limiter l'appel de votre programme à votre module, vous écrirez :</p>
<pre><code>Private Sub transformation_mois()</code></pre>
                    <p>Voyons comment fractionner notre code pour le rendre lisible.</p>
                    <h3>Maîtrisez les arguments de vos fonctions :</h3>
                    <p>Comme nous l'avons vu plus haut, vous pouvez fractionner un morceau de programme que vous êtes susceptible de réutiliser, ou tout simplement pour rendre le code plus lisible.</p>
                    <p>Je ne sais pas si vous avez fait attention, mais dans le sous-programme que nous avons utilisé, nous avons écrit volontairement le résultat de notre Select Case dans la cellule B2. Les sous-programmes ne permettent pas de renvoyer une valeur à un autre sous-programme, c'est pour cela que nous avons écrit dans une cellule sur Excel pour stocer la valeur.</p>
                    <p>Pour pallier ce problème, nous pouvons utiliser des <span class="em">fonctions</span>. L'utilisation des fonctions est très similaire à la subroutine, à la différence qu'elle peut <span class="em">renvoyer</span> à un autre programme avec la transformation des données.</p>
                    <p>Regardons ensemble ce que cela va changer sur notre programme initial avec la subroutine.</p>
<pre><code>Sub changement_mois_Fonc()

Dim date_reporting As Date
Dim mois As string
Dim jour As Integer
Dim annee As Integer

date_reporting = Range("A1").Value
jour = Day(date_reporting)
annee = Year(date_reporting)

mois = transformation_mois_fonc(date_reporting)

Range("D1").Value = "Reporting du " & jour & " " & mois & " " & annee

End Sub

Private Function transformation_mois_fonc(ByVal transformation_date As Date) As string

transformation_mois_fonc = Month(transformation_date)

Select Case transformation_mois_fonc
    Case 1
    transformation_mois_fonc = "janvier"
    Case 2
    transformation_mois_fonc = "février"
    Case 3
    transformation_mois_fonc = "mars"
    Case 4
    transformation_mois_fonc = "avril"
    Case 5
    transformation_mois_fonc = "mai"
    Case 6
    transformation_mois_fonc = "juin"
    Case 7
    transformation_mois_fonc = "juillet"
    Case 8 
    transformation_mois_fonc = "août"
    Case 9
    transformation_mois_fonc = "septembre"
    Case 10
    transformation_mois_fonc = "octobre"
    Case 11
    transformation_mois_fonc = "novembre"
    Case 12
    transformation_mois_fonc = "décembre"
End Select

End Function</code></pre>
                    <p>Vous voyez dans le code ci-dessus que la fonction est déclarée comme une <span class="html">Private Function</span>. Et cette fois, dans les parenthèses de la fonction nous avons ajouté une variable que nous avons déclarée. Elle s'appelle transformation_date, et c'est une date. Cette déclaration vous permet de dire à la fonction que quand vous allez l'appeler dans le programme principal, vous lui donnez une valeur qui sera une date et qui sera automatiquement transférée dans cette nouvelle variable transformation_date.</p>
                    <p>Dans la déclaration de la fonction, j'ai également ajouté As String à la fin de la déclaration.</p>
                    <p>Ce n'est pas une erreur, ça ? Vous ne voyez pas le rapport entre une déclaration de variable et une fonction. Eh bien non, ce n'est pas une erreur. En faisant cela, j'utilise le nom de ma fonction comme une variable et je vais justement <span class="em">retourner</span> cette variable <span class="html">transformation_mois_fonc</span> dans mon programme principal. Vous pouvez également voir que j'ai remplacé la variable qui contient le résultat de mon <span class="html">Select Case</span> par cette nouvelle variable.</p>
                    <p>Retournons maintenant du côté du sous-programme. J'ai seulement changé l'appel de ma fonction :</p>
<pre><code>mois = transformation_mois_fonc(date_reporting)</code></pre>
                    <p>Je passe dans ma fonction la variable <span class="html">date_reporting</span> pour que ma fonction puisse la récupérer. Vous voyez que je stocke la valeur de ma fonction dans la variable mois. En effet, la fonction va nous renvoyer une valeur au travers d'une string (que nous avons déclarée dans la fonction).</p>
                    <p>Je n'ai volontairement pas encore parlé du <span class="html">ByVal</span> que j'ai ajouté dans ma fonction, c'est vrai. Je garde le meilleur pour la fin.</p>
                    <p>Vous pouvez ajouter soit un <span class="html">ByVal</span> soit un <span class="html">ByRef</span>, sachant que si vous ne mettez rien, c'est que vous utilisez un <span class="html">ByRef</span>. En ajoutant un <span class="html">ByVal</span>, je protège ma variable initiale qui ne va pas changer. En effet, la valeur qui est renvoyée par ma fonction est une nouvelle variable.</p>
                    <p>En utilisant un <span class="html">ByRef</span>, je modifie la variable initiale en la remplaçant par ma transformation.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>L'utilisation du <span class="html">ByRef</span> est plus performante, car j'utilise toujours la même variable, alors que l'utilisation du <span class="html">ByVal</span> est protectrice, car j'utilise une nouvelle variable.</p>
                    </div>
                </article>
                <article>
                    <h2 id="interaction_utilisateurs_formulaires">Interagissez avec les utilisateurs via des forlulaires :</h2>
                    <p>Nous avons vu ensemble, tout au long de ce cours, les différents variables, opérateurs, boucles et fonctions. Il nous reste à voir une dernière partie importante : comment interagir avec les utilisateurs ?</p>
                    <p>Ça va être plus visuel, car vous allez voir les boîtes de dialogue et les formulaires.</p>
                    <h3>Interagissez avec Excel en créant votre boîte de dialogue :</h3>
                    <p>Depuis le début de ce cours, vous avez déjà utilisé des boîtes de dialogue sans vraiment les nommer.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Une boîte de dialogue est une fenêtre qui permet d'interagir avec les utilisateurs.</p>
                    </div>
                    <p>Vous avez au début utilisé les msgbox. C'est la boîte de dialogue  la plus simple pour Excel.</p>
                    <p>Le code est très simple. C'est seulement :</p>
<pre><code>Sub premier_message()
msgbox ("Hello World")
End Sub</code></pre>
                    <p>Quand vous exécutez ce code, vous obtenez une petite fenêtre qui vous dit :</p>
                    <figure>
                        <img src="../images/exemple_messagebox_Excel.png" alt="">
                        <figcaption>Exemple de messagebox dans Excel</figcaption>
                    </figure>
                    <p>Rappelez-vous que nous avions utilisé la msgbox pour donner à l'utilisateur son département de rattachement. C'est une version simple des différentes interactions que nous allons voir avec les utilisateurs.</p>
                    
                </article>
            <!-- fin de section -->
            </section>
        </main>
        <footer role="contentinfo">
            <div>
                <address>
                    Professeurs :
                    <a class="mail" href="mailto:olivier.choquet@vinci.be">Choquet Olivier</a>
                    <a class="mail" href="mailto:driss.vandenheede.techinfo@gmail.com">Vandenheede Driss</a>
                </address>
            </div>
            <div>
                <p>Si vous détectez une erreur, une faute d'orthographe, n'hésitez pas à envoyer un mail aux adresses juste à côté avec le nom de la page et l'erreur détectée.</p>
            </div>
            <div id="version">
                <p>Syllabus HTML</p>
                <p>Version 5.0</p>
            </div>
        </footer>
        <script src="../pre.js"></script>
    </body>
</html>