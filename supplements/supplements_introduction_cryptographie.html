<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="author" content="Choquet Olivier & Vandenheede Driss">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Introduction à la cryptographie - Suppléments - e-Syllabus HTML5 et CSS3</title>
        <!-- une icône dans la barre du navigateur -->
        <link rel="icon" href="../images/favicon.png" type="image/png">
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <!-- liens d'évitement -->
        <ul class="a11y-nav">
            <li>
                <a href="#container">Passer directement au contenu</a>
            </li>
            <li>
                <a href="#menu">Accéder au menu secondaire de la page</a>
            </li>
            <li>
                <a href="#aside">Accéder aux liens utiles</a>
            </li>
        </ul>
        
        <!-- bannière et menu -->
        <header role="banner">
            <div class="logoTitle">
                <h1>Cours d'introduction au Web</h1>
                <h2>HTML5 et CSS3</h2>
            </div>
            <nav role="navigation" aria-label="Menu principal de navigation">
                <ul>
                    <li><a href="../index.html">Le cours</a></li>
                    <li><a href="../internet.html">Internet</a></li>
                    <li><a href="../html5.html">HTML5</a></li>
                    <li><a href="../css3.html">CSS3</a></li>
                    <li><a href="../methodologie.html">Méthodologie</a></li>
                    <li><a href="../lexique.html">Lexique</a></li>
                    <li><a href="../supplements.html" class="current">Suppléments</a></li>
                </ul>
            </nav>
        </header>

        <div id="menu">
            <nav role="navigation" aria-label="Menu secondaire">
                <ol>
                    <li><a href="../supplements.html">Retour au sommaire</a></li>
                    <li><a href="#introduction">Introduction</a></li>
                    <li><a href="#histoire">Un peu d'histoire</a></li>
                    <li><a href="#cryptographie_moderne">La cryptographie moderne</a></li>
                    <li><a href="#cryptage_symetrique">Cryptage symétrique</a></li>
                    <li><a href="#modes_operation">Les modes d'opération</a></li>
                    <li><a href="#chiffrement_asymetrique">Le chiffrement asymétrique</a></li>
                    <li><a href="#protocoles_accord_cle">Les protocoles d'accord de clé</a></li>
                    <li><a href="#authenticite_integrite">Authenticité/intégrité</a></li>
                    <li><a href="#fonctions_hachage">Les fonctions de hachage</a></li>
                    <li><a href="#certificats_PKI">Les certificats et la PKI</a></li>
                    <li><a href="#smart_card">Carte à puce</a></li>
                    <li><a href="#exemples_questions_examen">Exemples de questions d'examen</a></li>
                </ol>
            </nav>
            
            <!-- aside lié à la page et pas à l'article donc pas à l'intérieur de article -->
            <aside id="aside" role="complementary">
                <p>Liens utiles :</p>
                <ul>
                    <li><a href="https://www.youtube.com/c/LeDesignerduWeb/videos">Le Designer du web</a></li>
                </ul>
            </aside>
        </div>
        
        <main id="container" role="main" tabindex="-1">
            <section id="mainSection">
                <article>
                    <h1>Introduction à la cryptographie :</h1>
                    <figure>
                        <img src="../images/Shannon.jpg" alt="">
                        <figcaption>
                            <p>Claude Elwood Shannon</p>
                            <p>(1916-2001)</p>
                        </figcaption>
                    </figure>
                    <p>Claude Shannon est l'un des fondateurs de la cryptographie moderne. Ses travaux ont posé les bases théoriques de la sécurité de l'information, encore utilisées aujourd'hui.</p>
                </article>
                <article>
                    <h2 id="introduction">Introduction :</h2>
                    <h3>Objectifs :</h3>
                    <ul>
                        <li>
                            <p>Aperçu des principaux outils cryptographiques modernes :</p>
                            <ul>
                                <li>
                                    <p>Chiffrement</p>
                                </li>
                                <li>
                                    <p>Codes d'authentification des messages (MAC - Message Authentication Codes)</p>
                                </li>
                                <li>
                                    <p>Signature</p>
                                </li>
                                <li>
                                    <p>PKI</p>
                                </li>
                                <li>
                                    <p>...</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>Approche descendante à partir d'exemples concrets :</p>
                            <ul>
                                <li>
                                    <p>Approche fonctionnelle</p>
                                </li>
                                <li>
                                    <p>Comment ça marche</p>
                                </li>
                                <li>
                                    <p>Ce qu'il fait</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>Je ne vais pas vous transformer en cryptographes en quelques heures !</p>
                        </li>
                    </ul>
                    <h3>Cryptographie :</h3>
                    <p>C'est la science de la sécurité de l'information.</p>
                    <ul>
                        <li>
                            <p>Confidentialité</p>
                        </li>
                        <li>
                            <p>L'intégrité des données</p>
                        </li>
                        <li>
                            <p>Authentification de l'entité</p>
                        </li>
                        <li>
                            <p>Authentification de l'origine des données</p>
                        </li>
                    </ul>
                    <p>La cryptographie est la science de la sécurité de l'information et elle se divise en deux disciplines :</p>
                    <ul>
                        <li>
                            <p><span class="em">La cryptographie</span> se concentre sur la conception de primitives (chiffrement, signature, etc.).</p>
                        </li>
                        <li>
                            <p><span class="em">La cryptanalyse</span>, quant à elle, s'occupe de l'analyse de la sécurité de ces primitives, notamment en recherchant des failles et en développant des attaques.</p>
                        </li>
                    </ul>
                    <h3>Où trouve-t-on la cryptographie ?</h3>
                    <div>
                        <img src="../images/cryptographie.PNG" alt="" class="float_right">
                        <ul>
                            <li>
                                <p>Authentification/contrôle d'accès</p>
                            </li>
                            <li>
                                <p>Cryptage</p>
                            </li>
                            <li>
                                <p>Signature numérique</p>
                            </li>
                            <li>
                                <p>Commerce électronique</p>
                            </li>
                            <li>
                                <p>... et bien plus encore</p>
                            </li>
                        </ul>
                    </div>
                </article>
                <article>
                    <h2 id="histoire">Un peu d'histoire :</h2>
                    <h3>La scytale :</h3>
                    <div>
                        <img src="../images/scytale.png" alt="" class="float_right">
                        <ul>
                            <li>
                                <p>Sparte, 400 avant JC</p>
                            </li>
                            <li>
                                <p>Un ruban est enroulé autour d'un bâton.</p>
                            </li>
                            <li>
                                <p>Le message est écrit sur le ruban.</p>
                            </li>
                            <li>
                                <p>Le ruban est déroulé et remis au messager.</p>
                            </li>
                            <li>
                                <p>Pour décrypter, il faut un bâton du même diamètre (= clé).</p>
                            </li>
                        </ul>
                    </div>
                    <p>Cette illustration montre le principe de la <span class="em">scytale</span>, l'un des premiers dispositifs de chiffrements connus. Le message devient incompréhensible dès que le ruban est déroulé, sauf pour une personne possédant un bâton de diamètre identique.</p>
                    <h4>La scytale : Formalisation :</h4>
                    <p>Cela équivaut à :</p>
                    <ul>
                        <li>
                            <p>Écrire un texte en lignes de taille fixe</p>
                        </li>
                        <li>
                            <p>Le transposer en colonnes</p>
                        </li>
                        <li>
                            <p>Clé = largeur de ligne</p>
                        </li>
                    </ul>
                    <p>Il s'agit d'un <span class="em">chiffrage de transposition</span> : les symboles sont déplacés, mais leur valeur ne change pas.</p>
                    <p>Bien sûr, assez facile à casser.</p>
                    <img src="../images/scytale_1.PNG" alt="">
                    <h3>Le cryptage de César :</h3>
                    <p>Chaque lettre du message est remplacée par celle située x places plus loin dans l'alphabet.</p>
                    <p>Exemple : x = 3.</p>
                    <img src="../images/chiffrement_cesar.PNG" alt="">
                    <p>Cette image illustre le <span class="em">chiffrement de César</span>, où chaque lettre du message est décalée d'un nombre fixe de positions dans l'alphabet.</p>
                    <p>Il s'agit d'un <span class="em">chiffrement de substitution</span> : les symboles sont remplacés selon une certaine transformation, mais leur position ne change pas.</p>
                    <p><span class="em">La transposition</span> et <span class="em">la substitution</span> sont toujours au coeur des chiffrements symétriques modernes.</p>
                    <h3>Transposition et substitution dans les chiffrements modernes :</h3>
                    <img src="../images/transposition_substitution_cipher.PNG" alt="">
                    <div>
                        <img src="../images/transposition_substitution_cipher_1.png" alt="" class="float_right">
                        <p>Répétez 16 fois.</p>
                        <p>Il s'agit de la norme de cryptage des données (DES - Data Encryption Standard).</p>
                    </div>
                    <h3>Cryptage du livre de codes (codebook) :</h3>
                    <p>C'est un dictionnaire (secret) contenant un (ou plusieurs) mot(s) de remplacement pour chaque mot en clair.</p>
                    <p>Si le livre est pris par des ennemis, les secrets sont perdus.</p>
                    <p>Si le même mot de remplacement est utilisé trop souvent, une analyse de fréquence devient possible.</p>
                    <p>Remarque : des variantes étaient encore utilisées pendant la Seconde Guerre mondiale (par exemple : code Navajo).</p>
                    <h4>Exemple :</h4>
                    <img src="../images/exemple_codebook.jpg" alt="">
                    <h3>L'avènement des télécoms :</h3>
                    <img src="../images/advent_telecom.png" alt="">
                    <h3>L'espionnage en 1914-18 :</h3>
                    <img src="../images/spying_1914_1918.png" alt="">
                    <h3>Enigma :</h3>
                    <img src="../images/enigma.png" alt="">
                    <h3>La Bombe et Enigma :</h3>
                    <img src="../images/bombe_enigma.png" alt="">
                    <h3>NSA (600 mathématiciens, 120 doctorats en mathématiques) :</h3>
                    <img src="../images/NSA.png" alt="">
                    <p>Cette image met en évidence l'importance stratégique de la cryptographie au XX<sup>ème</sup> siècle, notamment durant les conflits mondiaux. Les machines comme <span class="em">Enigma</span> ont profondément influencé l'évolution des techniques crytographiques modernes.</p>
                    <h3>Internet :</h3>
                    <img src="../images/Internet.jpg" alt="">
                </article>
                <article>
                    <h2 id="cryptographie_moderne">La cryptographie moderne :</h2>
                    <img src="../images/cryptographie_moderne.png" alt="">
                    <p>Ce schéma illustre l'utilisation concrète de la cryptographie moderne dans les communications sécurisées. Il montre comment le chiffrement, l'authentification et l'intégrité sont combinés pour protéger les échanges sur Internet.</p>
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>https://... &#8594; HTTP Secure</p>
                    </div>
                    <img src="../images/cryptographie_moderne_3.png" alt="">
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Ce document provient bien de fgov.be.</p>
                        <p>Son contenu n'a pas été modifié.</p>
                        <p>Confidentialité : Personne ne peut lire les données pendant leur transmission.</p>
                    </div>
                    <img src="../images/cryptographie_moderne_1.png" alt="">
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>PKCS #1 SHA-1 - RSA</p>
                    </div>
                    <img src="../images/cryptographie_moderne_2.png" alt="">
                    <div class="information">
                        <img src="../images/information.png" alt="Information" class="float_left">
                        <p>Une norme cryptographique publique.</p>
                        <p>Tous les détails sur les opérations effectuées sont disponibles sur le web.</p>
                        <p>Ce caractère public ne limite-t-il pas d'une manière ou d'une autre la sécurité ?</p>
                    </div>
                    <h3>L'hypothèse de Kerckhoffs :</h3>
                    <p>L'attaquant connaît tous les détails de l'algorithme.</p>
                    <p>Seule la clé est inconnue.</p>
                    <img src="../images/kerckhoffs.PNG" alt="">
                    <p>Ce schéma représente l'<span class="em">hypothèse de Kerckhoffs</span>, selon laquelle la sécurité d'un système cryptographique ne repose pas sur le secret de l'algorithme, mais uniquement sur la confidentialité de la clé.</p>
                    <p>On suppose que l'attaquant connaît tous les détails de l'algorithme.</p>
                    <p>Ce principe est fondamental car il permet la création de standards publics et ouverts, comme RSA ou AES, qui peuvent être analysés par la communauté scientifique pour garantir leur robustesse.</p>
                </article>
                <article>
                    <h2 id="cryptage_symetrique">Cryptage symétrique :</h2>
                    <img src="../images/chiffrement_symetrique_1.PNG" alt="">
                    <p>Peut-on parvenir à un cryptage parfait ? Oui.</p>
                    <p>Shannon : one-time pad.</p>
                    <h3>One-time pad :</h3>
                    <img src="../images/one_time_pad.PNG" alt="">
                    <img src="../images/one_time_pad_1.PNG" alt="">
                    <img src="../images/one_time_pad_2.PNG" alt="">
                    <p>Ces schémas expliquent le fonctionnement du <span class="em">one-time pad</span>, un chiffrement théoriquement parfait. Chaque bit du message est combiné avec un bit de clé totalement aléatoire et utilisé une seule fois.</p>
                    <h3>Secret parfait :</h3>
                    <p>Peu importe :</p>
                    <ul>
                        <li>
                            <p>la puissance de calcul</p>
                        </li>
                        <li>
                            <p>la quantité de données interceptées</p>
                        </li>
                        <li>
                            <p>la technique utilisée</p>
                        </li>
                    </ul>
                    <p>Il est <span class="em">impossible</span> d'obtenir la <span class="em">moindre</span> information sur le message (sauf sa longueur).</p>
                    <p class="em">&#8594; Sécurité théorique de l'information.</p>
                    <p>Mais la clé doit être :</p>
                    <ul>
                        <li>
                            <p>vraiment aléatoire</p>
                        </li>
                        <li>
                            <p>utilisée une seule fois (longueur &gt; quantité totale de données)</p>
                        </li>
                        <li>
                            <p>échangée de manière totalement fiable</p>
                        </li>
                        <li>
                            <p>stockée dans un endroit parfaitement sûr</p>
                        </li>
                    </ul>
                    <p>&#8594; Impossible d'appliquer en pratique.</p>
                    <p>&#8594; Nous devrons baisser nos critères :</p>
                    <ul>
                        <li>
                            <p>Limiter la puissance de l'adversaire : <span class="em">sécurité informatique</span>.</p>
                        </li>
                        <li>
                            <p>Abaisser la définition de sécurité (par exemple : attaque possible, mais avec une très faible probabilité).</p>
                        </li>
                    </ul>
                    <h3>Définir un cryptage sécurisé :</h3>
                    <p>Si nous voulons avoir une chance de construire des systèmes sécurisés, nous devons au moins trouver une définition solide de la sécurité.</p>
                    <p>Pouvons-nous nous mettre d'accord sur une définition claire, formelle et sans ambiguïté ?</p>
                    <p>&#8594; Essayons.</p>
                    <h3>Comment pourrions-nous définir le chiffrement sécurisé ?</h3>
                    <ul>
                        <li>
                            <p>Étant donné un texte chiffré, aucun adversaire ne devrait être en mesure de récupérer la <span class="em">clé</span>.</p>
                        </li>
                        <li>
                            <p>Étant donné un texte chiffré, aucun adversaire ne devrait être en mesure de récupérer le <span class="em">texte en clair</span>.</p>
                        </li>
                        <li>
                            <p>Étant donné un texte chiffré, aucun adversaire ne devrait être capable de récupérer <span class="em">un caractère</span> du texte en clair.</p>
                        </li>
                        <li>
                            <p>Étant donné un texte chiffré, aucun adversaire ne devrait être en mesure de récupérer <span class="em">des informations</span> sur le texte en clair.</p>
                        </li>
                    </ul>
                    <h3>Jeu de chiffrement sécurisé : un exemple :</h3>
                    <ol>
                        <li>
                            <p>L'adversaire peut demander le cryptage de nombreux messages : m<sub>0</sub>, ..., m<sub>n</sub>.</p>
                        </li>
                        <li>
                            <p>L'adversaire construit alors deux messages : m'<sub>0</sub> et m'<sub>1</sub>.</p>
                        </li>
                        <li>
                            <p>L'un d'eux est choisi, crypté et restitué à l'adversaire.</p>
                        </li>
                        <li>
                            <p>Encore une fois, l'adversaire peut demander le cryptage de nombreux messages : m"<sub>0</sub>, ..., m"<sub>n</sub>.</p>
                        </li>
                        <li>
                            <p>L'adversaire devine lequel de m'<sub>0</sub> ou de m'<sub>1</sub> a été renvoyé.</p>
                        </li>
                    </ol>
                    <p>Un système est considéré comme sécurisé si nous pouvons prouver que :</p>
                    <ul>
                        <li>
                            <p>Il ne peut exister un tel adversaire avec une puissance de calcul "limitée" (avec une définition précise).</p>
                        </li>
                        <li>
                            <p>Réussir avec une probabilité non négligeable.</p>
                        </li>
                    </ul>
                    <p>Remarque : Ceci n'est qu'un exemple de définition de sécurité : de nombreuses variantes existent.</p>
                    <h3>Chiffrement probabiliste :</h3>
                    <p>Un adversaire ne devrait pas pouvoir dire quoi que ce soit sur la signification d'un message chiffré.</p>
                    <ul>
                        <li>
                            <p>Pas même le fait que le même message ait été observé auparavant !</p>
                        </li>
                    </ul>
                    <p>&#8594; Le cryptage doit donc être probabiliste.</p>
                    <ul>
                        <li>
                            <p>Le même message, chiffré plusieurs fois, avec la même clé, donne des <span class="em">textes chiffrés différents</span>.</p>
                        </li>
                    </ul>
                    <p>Le cryptage symétrique est basé sur une clé secrète partagée et permet :</p>
                    <ul>
                        <li>
                            <p>Transformation du texte brut en texte chiffré (<span class="em">chiffrement</span>)</p>
                        </li>
                        <li>
                            <p>Récupération du texte brut à partir du texte chiffré (<span class="em">déchiffrement</span>)</p>
                        </li>
                    </ul>
                    <p>L'adversaire ignorant la clé ne peut récupérer <span class="em">aucune</span> information sur le message (sauf sa taille).</p>
                    <p>Bien entendu, la même clé peut être utilisée pour transmettre un grand nombre de messages.</p>
                    <p>Schémas basés sur des <span class="em">chiffrements par blocs</span>.</p>
                    <p>(ou alternativement, des chiffrements de flux)</p>
                    <h3>Chiffrement par blocs (bloc ciphers) :</h3>
                    <p>Un composant d'un système de chiffrement symétrique :</p>
                    <ul>
                        <li>
                            <p>Paramètre avec une clé</p>
                        </li>
                        <li>
                            <p>Traite des blocs de données de taille fixe</p>
                        </li>
                    </ul>
                    <div>
                        <img src="../images/block_cipher.gif" alt="" class="float_right">
                        <p>Quelques exemples bien connus :</p>
                        <ul>
                            <li>
                                <p>DES (ancien)</p>
                            </li>
                            <li>
                                <p>AES</p>
                            </li>
                            <li>
                                <p>Twofish</p>
                            </li>
                            <li>
                                <p>Serpent</p>
                            </li>
                        </ul>
                    </div>
                    <p>Cette illustration montre le fonctionnement général d'un <span class="em">chiffrement par blocs</span>. Le message est découpé en blocs de taille fixe, chacun étant transformé par l'algorithme à l'aide d'une clé secrète.</p>
                    <h3>Exercices sur le chiffrement symétrique :</h3>
                    <h4>OpenSSL :</h4>
                    <blockquote cite="https://fr.wikipedia.org/wiki/OpenSSL">
                        <p>OpenSSL est une boîte à outils de chiffrement comportant deux bibliothèques, <span class="em">libcrypto</span> et <span class="em">libssl</span>, fournissant respectivement une implémentation des algorithmes cryptographiques et du protocole de communication SSL/TLS, ainsi qu'une interface en ligne de commande, <span class="em">openssl</span>. Développée en C, OpenSSL est disponible sur les principaux systèmes d'exploitation et dispose de nombreux wrappers ce qui la rend utilisable dans une grande variété de langages informatiques.</p>
                    </blockquote>
                    <ol>
                        <li>
                            <p>Commencez, au choix, par :</p>
                            <ul>
                                <li>
                                    <p><a href="https://medium.com/swlh/installing-openssl-on-windows-10-and-updating-path-80992e26f6a1" target="_blank">Installer OpenSSL sur votre PC</a>. Attention cependant : l'étape <q>in the User variables section, select Path and click Edit</q> n'est pas 100% claire : veillez bien à ajouter une nouvelle ligne au path.</p>
                                </li>
                                <li>
                                    <p>Alternativement,vous pouvez utiliser <a href="https://www.cryptool.org/en/cto/openssl/" target="_blank">un émulateur d'OpenSSL</a>.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>Créez un fichier "texte_clair.txt" et écrivez-y un message, puis chiffrez-le au moyen de la commande (à taper en une ligne) :</p>
<pre><code>openssl enc -e -aes-128-ecb -in texte_clair.txt -out texte_chiffre.enc -K 0102030405060708090A0B0C0D0E0F00</code></pre>
                            <div class="important">
                                <img src="../images/important.png" alt="Important" class="float_left">
                                <p>La commande ci-dessus n'est PAS une bonne pratique, comme nous allons le voir.</p>
                            </div>
                            <ul>
                                <li>
                                    <p>À quoi correspondent les paramètres -e, -in, -out, -K ? (nous reviendrons sur -aes-128-ecb plus tard)</p>
                                    <ul>
                                        <li>
                                            <p><span class="em">-e</span> &#8594; <span class="em">encrypt</span> : chiffrement.</p>
                                        </li>
                                        <li>
                                            <p><span class="em">-in texte_clair.txt</span> : fichier d'entrée (texte clair).</p>
                                        </li>
                                        <li>
                                            <p><span class="em">-out texte_chiffre.enc</span> : fichier chiffré en sortie.</p>
                                        </li>
                                        <li>
                                            <p><span class="em">-K KEY</span> : clé <span class="em">en hexadécimal</span> donnée manuellement.</p>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <p>Quelle est la taille de clé utilisée ?</p>
                                    <p>La clé <span class="em">0102030405060708090A0B0C0D0E0F00</span> contient <span class="em">32 caractères hexadécimaux</span>, soit <span class="em">128 bits</span> (car 2 hex = 1 octet = 8 bits).</p>
                                    <p>Réponse : <span class="em">clé AES-128 bits</span>.</p>
                                </li>
                                <li>
                                    <p>Comment déchiffrer le fichier ainsi produit ?</p>
<pre><code>openssl enc -d -aes-128-ecb -in texte_chiffre.enc -out texte_dechiffre.txt -K 0102030405060708090A0B0C0D0E0F00</code></pre>
                                    <p>L'option <span class="em">-d</span> (<span class="em">decrypt</span>) permet de déchiffrer.</p>
                                </li>
                                <li>
                                    <p>Essayez de chiffrer/déchiffrer un fichier avec une clé de 256 bits.</p>
                                    <p>Il suffit d'utiliser AES-256-ECB pour chiffrer/déchiffrer :</p>
<pre><code>openssl enc -e -aes-256-ecb -in texte.txt -out texte.enc -K &lt;clé 64 hex&gt;</code></pre>
<pre><code>openssl enc -d -aes-256-ecb -in texte.enc -out texte_dechiffre.txt -K &lt;clé 64 hex&gt;</code></pre>
                                    <p>64 hex = <span class="em">256 bits</span>.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>Chiffrez le texte suivant (attention à le copier exactement) :</p>
<pre><code>ANTICONSTITUTIONNELLEMENT EST LE PLUS LONG MOT DE LA LANGUE FRANCAISE, MAIS, QUAND ON Y REFLECHIT, CE MOT N'EST GUERE UTILISE QUE JUSTEMENT DANS CETTE PHRASE: &lt;ANTICONSTITUTIONNELLEMENT EST LE PLUS LONG MOT DE LA LANGUE FRANCAISE&gt;. C'EST UN PEU ABSURDE...</code></pre>
                            <ul>
                                <li>
                                    <p>Observez attentivement le fichier chiffré (ce sera sans doute plus aisé avec un éditeur hexadécimal, comme par exemple <a href="https://hexed.it/" target="_blank">https://hexed.it/</a>). Que constatez-vous ? Essayez de reproduire le phénomène avec d'autres textes.</p>
                                    <img src="../images/anticonstitutionnellement.png" alt="">
                                    <p>Les blocs identiques donnent <span class="em">des blocs chiffrés identiques</span>.</p>
                                    <p>Donc on voit des <span class="em">répétitions évidentes</span> dans l'hexadécimal.</p>
                                    <p>C'est une fuite d'information !</p>
                                </li>
                                <li>
                                    <p>Ceci est-il quelque chose que l'on attendrait d'un bon système de chiffrement ?</p>
                                    <p>ECB = <span class="em">pas sûr du tout</span>, car il n'utilise pas d'aléa.</p>
                                    <p>Ce n'est PAS ce qu'on attend d'un bon chiffrement.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>Chiffrez plusieurs fois le même fichier avec la même clé, et comparez les résultats.</p>
                            <ul>
                                <li>
                                    <p>À nouveau, ceci est-il quelque chose que l'on peut attendre d'un bon système de chiffrement ?</p>
                                    <p>Le résultat sera strictement <span class="em">identique</span> à chaque fois.</p>
                                    <p>C'est une faille grave : un attaquant voit les répétitions.</p>
                                </li>
                            </ul>
                            <p>Ce constat va nous permettre d'introduire un concept très important en matière de <span class="em">block ciphers</span> : les modes d'opération.</p>
                        </li>
                    </ol>
                </article>
                <article>
                    <h2 id="modes_operation">Les modes d'opération :</h2>
                    <p>Les chiffrements par blocs fonctionnent par blocs.</p>
                    <img src="../images/block_ciphers_operate.PNG" alt="">
                    <ul>
                        <li>
                            <p>Les blocs de texte en clair donnent les mêmes blocs de texte chiffré.</p>
                        </li>
                        <li>
                            <p>La détection de patterns est possible.</p>
                        </li>
                    </ul>
                    <p>Nous ne pouvons pas accepter cela : la qualité du cryptage ne doit pas dépendre de la structure du texte en clair.</p>
                    <p>Les <span class="em">modes d'opération</span>  définissent <span class="em">comment enchaîner les blocs</span> pour chiffrer un message long.</p>
                    <p>&#8594; <span class="em">Les modes d'opération</span> peuvent résoudre le problème.</p>
                    <h3>Image cryptée dans ECB :</h3>
                    <div>
                        <img src="../images/image_chiffree_ECB.jpg" alt="">
                        <img src="../images/image_chiffree_ECB_1.jpg" alt="" class="float_right">
                    </div>
                    <p>Cette image illustre la principale faiblesse du mode <span class="em">ECB</span> : les motifs du message original restent visibles après chiffrement, révélant ainsi des informations sensibles.</p>
                    <p>Le principe de <span class="em">ECB (Electronic Codebook)</span> est que chaque bloc est chiffré indépendamment. Le même bloc clair donne le même bloc chiffré.</p>
                    <p>Les avantages sont :</p>
                    <ul>
                        <li>
                            <p>Simple</p>
                        </li>
                        <li>
                            <p>Rapide</p>
                        </li>
                    </ul>
                    <p>Les inconvénients (graves) sont :</p>
                    <ul>
                        <li>
                            <p>Révèle les motifs du message</p>
                        </li>
                        <li>
                            <p>Aucune sécurité sémantique</p>
                        </li>
                    </ul>
                    <p class="em">&#8594; Jamais utilisé en pratique.</p>
                    <h3>Mode CBC :</h3>
                    <img src="../images/CBC_mode.PNG" alt="">
                    <p>Ce schéma présente le fonctionnement du mode <span class="em">CBC</span>, où chaque bloc dépend du précédent, ce qui empêche la répétition visible des motifs observée avec ECB.</p>
                    <p>Le principe de <span class="em">CBC (Cipher Block Chaining)</span> est que chaque bloc clair est XORé avec le bloc chiffré précédent. Il utilise un <span class="em">IV (Initialization Vector)</span>.</p>
                    <p>Les avantages sont :</p>
                    <ul>
                        <li>
                            <p>Cache les motifs</p>
                        </li>
                        <li>
                            <p>Simple</p>
                        </li>
                    </ul>
                    <p>Les inconvénients sont :</p>
                    <ul>
                        <li>
                            <p>Pas d'authentification</p>
                        </li>
                        <li>
                            <p>Vulnérable aux padding oracle attacks</p>
                        </li>
                    </ul>
                    <p class="em">&#8594; Encore courant mais remplacé par AEAD (AuthenticatedEncryption with Associated Data). Pas d'intégrité, vulnérable à certaines attaques.</p>
                    <h4>Comment décrypter ?</h4>
                    <img src="../images/CBC_mode_1.PNG" alt="">
                    <h3>IV :</h3>
                    <p>C'est un "paramètre de diversification", garantissant que les messages avec le même en-tête et ne génèrent pas le même texte chiffré.</p>
                    <p>Il est généralement transmis avec un texte chiffré.</p>
                    <p>&#8594; Il n'a pas besoin d'être secret.</p>
                    <p>Mais il doit changer à chaque fois et doit être imprévisible.</p>
                    <h3>Mode CTR :</h3>
                    <img src="../images/CTR_mode.PNG" alt="">
                    <p>Le principe de <span class="em">CTR (Counter Mode)</span> est de chiffrer un compteur (nonce + compteur). Il fait un XOR avec le texte clair.</p>
                    <p>Les avantages sont :</p>
                    <ul>
                        <li>
                            <p>Très rapide</p>
                        </li>
                        <li>
                            <p>Parallélisable</p>
                        </li>
                        <li>
                            <p>Pas de padding</p>
                        </li>
                    </ul>
                    <p>Les inconvénients sont :</p>
                    <ul>
                        <li>
                            <p>Aucune authentification</p>
                        </li>
                        <li>
                            <p>Nonce jamais réutilisable</p>
                        </li>
                    </ul>
                    <p class="em">&#8594; Très utilisé avec une authentification séparée. Pas d'intégrité.</p>
                    <p>Un <span class="em">nonce</span> (Number Once) est une valeur :</p>
                    <ul>
                        <li>
                            <p class="em">unique</p>
                        </li>
                        <li>
                            <p class="em">utilisée une seule fois</p>
                        </li>
                        <li>
                            <p class="em">non secrète</p>
                        </li>
                    </ul>
                    <p>&#8594; Son rôle principal est d'empêcher les <span class="em">réutilisations</span>, les <span class="em">rejeux</span> et les <span class="em">répétitions</span> dans les protocoles cryptographiques.</p>
                    <h3>Mode CFB :</h3>
                    <p>Le principe de <span class="em">CFB (Cipher Feedback)</span> est de transformer un block cipher en <span class="em">chiffrement par flot (stream cipher)</span>, une des deux catégories du chiffrement symétrique, et de chiffrer des données bit par bit ou octet par octet.</p>
                    <p>Les avantages sont :</p>
                    <ul>
                        <li>
                            <p>Pas besoin de padding</p>
                        </li>
                    </ul>
                    <p>Les inconvénients sont :</p>
                    <ul>
                        <li>
                            <p>Plus lent</p>
                        </li>
                        <li>
                            <p>Pas authentifié</p>
                        </li>
                    </ul>
                    <p class="em">&#8594; Plus lent, peu utilisé aujourd'hui.</p>
                    <h3>Mode OFB :</h3>
                    <p>Le principe de <span class="em">OFB (Output Feedback)</span> est de générer un flot pseudo-aléatoire indépendant du message et de faire un XOR avec le texte clair.</p>
                    <p>Les avantages sont :</p>
                    <ul>
                        <li>
                            <p>Pas de propagation d'erreur</p>
                        </li>
                        <li>
                            <p>Pas de padding</p>
                        </li>
                    </ul>
                    <p>Les avantages sont :</p>
                    <ul>
                        <li>
                            <p>Réutilisation du IV catastrophique</p>
                        </li>
                    </ul>
                    <p class="em">&#8594; Sensible à la réutilisation de l'IV.</p>
                    <h3>GCM (Galois/Counter Mode) :</h3>
                    <ul>
                        <li>
                            <p>Basé sur CTR</p>
                        </li>
                        <li>
                            <p>Fournit <span class="em">confidentialité</span> + <span class="em">intégrité</span> + <span class="em">authenticité</span></p>
                        </li>
                    </ul>
                    <p>&#10003; Très sécurisé</p>
                    <p>&#10003; Très utilisé (TLS, HTTP)</p>
                    <p>Certains modes (CTR, OFB, CFB) transforment un <span class="em">block cipher en stream cipher</span> utilisant un flot de clés généré à partir du bloc chiffré.</p>
                    <p>Un <span class="em">block cipher</span> chiffre des blocs fixes et nécessite un <span class="em">mode d'opération</span> pour sécuriser des messages longs, tandis qu'un <span class="em">stream cipher</span> chiffre un flux continu de données. Les modes modernes comme <span class="em">AES-GCM</span> assurent à la fois confidentialité et intégrité.</p>
                    <h3>Chiffrement symétrique : résumé :</h3>
                    <p>Il assure la confidentialité des données sur la base d'une clé secrète partagée.</p>
                    <p>Il est défini par :</p>
                    <ul>
                        <li>
                            <p>Un chiffrement par bloc (AES, Twofish, Serpent, ... Mais <span class="em">pas</span> DES !)</p>
                        </li>
                        <li>
                            <p>Un mode d'opération (CBC, OFB, CFB, ... Mais <span class="em">pas</span> ECB !)</p>
                        </li>
                    </ul>
                    <p>Il utilise une norme et l'utilise exactement comme décrit.</p>
                    <h3>Exercices sur le chiffrement symétrique :</h3>
                    <h4>OpenSSL et les modes d'opération :</h4>
                    <p>Tentez à nouveau de chiffrer différents fichiers, en utilisant cette fois un mode d'opération tel que AES-CBC ou AES-CTR.</p>
                    <p>Comment résoudre le message d'erreur "iv undefined" ?</p>
                    <p>Parce que CBC/CTR <span class="em">ont besoin d'un IV</span> (vecteur d'initialisation).</p>
                    <p>On doit donc ajouter :</p>
<pre><code>-iv &lt;IV en hex&gt;</code></pre>
                    <p>Par exemple :</p>
<pre><code>openssl enc -e -aes-128-cbc -in texte.txt -out texte.enc -K &lt;clé&gt; -iv 000102030405060708090A0B0C0D0E0F</code></pre>
                    <p>Les problèmes ci-dessus se manifestent-ils à nouveau ?</p>
                    <p>Non les problèmes précédents disparaissent.</p>
                    <p>CBC masque les répétitions grâce à l'IV.</p>
                    <p>CTR transforme AES en flux cryptographique.</p>
                    <p>&#8594; Les motifs ne réapparaissent plus.</p>
                    <p>Que se passe-t-il si on chiffre plusieurs fois le même fichier avec la même clé et le même IV ? Lequel de ces paramètres doit-il impérativement changer à chaque nouveau chiffrement ?</p>
                    <p>On retrouve le <span class="em">même résultat</span>, comme en ECB.</p>
                    <p>&#9888; <span class="em">Interdit</span> en cryptographie.</p>
                    <p>Note : <a href="https://wiki.openssl.org/index.php/Enc" target="_blank">la documentation (imparfaite) relative au chiffrement symétrique sous openssl</a>.</p>
                    <p class="em">L'IV doit obligatoirement changer.</p>
                    <p>La clé peut être réutilisée (dans certaines limites), l'IV <span class="em">jamais</span>.</p>
                    <h4>Chiffrement symétrique pour le stockage de données : VeraCrypt :</h4>
                    <ol>
                        <li>
                            <p><a href="https://veracrypt.io/en/Home.html" target="_blank">Installez le logiciel VeraCrypt</a>.</p>
                        </li>
                        <li>
                            <p>Testez l'outil de benchmarking : quel est le débit du chiffrement AES sur votre machine ?</p>
                            <p>Cela dépend de ton CPU. Typiquement :</p>
                            <ul>
                                <li>
                                    <p>1 GB/s (anciens)</p>
                                </li>
                                <li>
                                    <p>3-5 GB/s (modernes Intel/AMD)</p>
                                </li>
                                <li>
                                    <p>8-10 GB/s (AES-NI)</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>Créez un volume chiffré ("encrypted file container, standard").</p>
                            <ul>
                                <li>
                                    <p>Pourquoi faut-il bouger la souris durant la création ?</p>
                                    <p>Pour récolter de l'<span class="em">entropie</span> (aléa) utilisée pour générer :</p>
                                    <ul>
                                        <li>
                                            <p>la clé maîtresse</p>
                                        </li>
                                        <li>
                                            <p>les algorithmes internes</p>
                                        </li>
                                    </ul>
                                    <p>Plus tu bouges, plus l'aléa est bon &#8594; meilleure sécurité.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>Essayez de monter le volume, d'y ajouter des fichiers, de le démonter...</p>
                            <ul>
                                <li>
                                    <p>Pourquoi le montage est-il si lent, alors que les benchmarks sont excellents ?</p>
                                    <p>Parce que VeraCrypt doit :</p>
                                    <ul>
                                        <li>
                                            <p>dériver ta clé (fonction très lente de type PBKDF2)</p>
                                        </li>
                                        <li>
                                            <p>vérifier l'en-tête du volume</p>
                                        </li>
                                    </ul>
                                    <p>D'où la lenteur &#8594; c'est normal.</p>
                                </li>
                                <li>
                                    <p>Que se passe-t-il si le mot de passe est incorrect ?</p>
                                    <p>VeraCrypt <span class="em">prétend juste que le volume est invalide</span>.</p>
                                    <p>Il ne dit jamais "mauvais mot de passe". C'est volontaire pour ne donner aucune information à un attaquant.</p>
                                </li>
                            </ul>
                            <p>Un volume VeraCrypt doit-il obligatoirement porter l'extension <span class="em">.hc</span> ? Pourquoi ?</p>
                            <p>Non car un volume VeraCrypt peut avoir :</p>
                            <ul>
                                <li>
                                    <p>.hc</p>
                                </li>
                                <li>
                                    <p>.dat</p>
                                </li>
                                <li>
                                    <p>.bin</p>
                                </li>
                                <li>
                                    <p>ou <span class="em">aucune extension</span></p>
                                </li>
                            </ul>
                            <p>L'extension sert juste pour l'utilisateur.</p>
                            <p>Que se passera-t-il si vous oubliez votre mot de passe ?</p>
                            <p class="em">&#8594; Perte définitive des données.</p>
                            <p>Il n'y a <span class="em">aucun moyen</span> de récupérer le volume.</p>
                        </li>
                    </ol>
                    <p>D'accord, alors...</p>
                    <p>Nous avons essentiellement résolu le problème de confidentialité, <span class="em">à condition que</span> les deux parties partagent une clé secrète.</p>
                    <p>Comment peuvent-elles obtenir un tel secret ?</p>
                    <p>Fondamentalement, il existe deux options :</p>
                    <ul>
                        <li>
                            <p>Trouver un moyen de le transmettre : <span class="em">le cryptage asymétrique</span>.</p>
                        </li>
                        <li>
                            <p>La construire ensemble : <span class="em">les protocoles d'accord de clé</span>.</p>
                        </li>
                    </ul>
                </article>
                <article>
                    <h2 id="chiffrement_asymetrique">Le chiffrement asymétrique :</h2>
                    <img src="../images/chiffrement_asymetrique_1.PNG" alt="">
                    <p>Deux clés par utilisateur : une privée et une publique.</p>
                    <p>La clé publique permet uniquement de chiffrer les messages.</p>
                    <p>Pour envoyer un message à quelqu'un :</p>
                    <ul>
                        <li>
                            <p>Obtenez sa clé publique (par exemple : à partir d'un repository)</p>
                        </li>
                        <li>
                            <p>Utilisez-la pour chiffrer le message</p>
                        </li>
                    </ul>
                    <h3>Arithmétique modulaire :</h3>
                    <p>Vous l'utilisez tous les jours, même si vous ne le savez pas.</p>
                    <p>Supposons qu'il soit 11h00. Quelle heure sera-t-il dans 26 heures ?</p>
                    <ul>
                        <li>
                            <p>37h00 ? &#8594; mmm... non.</p>
                        </li>
                        <li>
                            <p>L'heure sera de 13h00.</p>
                        </li>
                        <li>
                            <p>Mais comment est-on arrivé à ce résultat ?</p>
                        </li>
                    </ul>
                    <p>Il n'y a que 24 heures dans une journée, puis on recommence.</p>
                    <p>Lorsque le résultat est supérieur à 24, soustrayez 24.</p>
                    <p>C'est de l'arithmétique modulaire (modulo 24).</p>
                    <ul>
                        <li>
                            <p>Considérons uniquement l'ensemble des entiers.</p>
                        </li>
                        <li>
                            <p>Divisez-le en intervalles de taille 24.</p>
                        </li>
                        <li>
                            <p>Deux valeurs sont dites égales si elles correspondent à la même position dans un intervalle.</p>
                        </li>
                        <li>
                            <p>Autrement dit, si leur différence est un multiple de 24.</p>
                        </li>
                    </ul>
                    <p>Soit n, a, b des nombres entiers :</p>
                    <ul>
                        <li>
                            <p><span class="em">Congruence</span> : a &#8801; b mod n &#8660; n | (a-b)</p>
                        </li>
                        <li>
                            <p>On note <span class="em">Z<sub>n</sub></span> les entiers modulo n.</p>
                        </li>
                        <li>
                            <p>Les opérations arithmétiques classiques peuvent être transférées vers Z<sub>n</sub>, par exemple :</p>
                            <p>11 * (7 + 12) &#8801; 11 * 7 + 11 * 12 &#8801; 4 &#8801; 11 * 2 + 1 * 12 (mod 5)</p>
                        </li>
                    </ul>
                    <p>De nombreux algorithmes cryptographiques sont basés sur des entiers arithmétiques modulo grands (disons 2048 bits).</p>
                    <p>Pratiquons un peu...</p>
                    <p>9 + 5 (mod 10)</p>
                    <p>&#8801; 14 (mod 10)</p>
                    <p>&#8801; 4 (mod 10)</p>
                    <p class="em">or</p>
                    <p>9 * 5 (mod 7) &#8801; 2 * 5 (mod 7)</p>
                    <p>&#8801; 45 (mod 7) &#8801; 10 (mod 7)</p>
                    <p>&#8801; 3 (mod 7) &#8801; 3 (mod 7)</p>
                    <p>On essaie ?</p>
                    <p>8 * 7 + 17 * (2 + 8) + 11<sup>2</sup> (mod 6)</p>
                    <p>&#8801; 2 * 1 + 5 * (2 + 2) + 11<sup>2</sup> (mod 6)</p>
                    <p>&#8801; 2 + 20 + 121 (mod 6)</p>
                    <p>&#8801; 2 + 2 + 1 (mod 6)</p>
                    <p>&#8801; 5 (mod 6)</p>
                    <p>6 * 5 + 11 * 31 + 2 * 9 (mod 5)</p>
                    <h3>Fonction totiente d'Euler :</h3>
                    <p>a est <span class="em">premier à n</span> si pgcd(a,n) = 1.</p>
                    <p>Fonction totiente d'Euler : &#966;(n) = # { i &lt;= n | gcd(i,n) = 1}</p>
                    <p>En particulier :</p>
                    <ul>
                        <li>
                            <p>Pour un p premier : &#966;(p) = p - 1</p>
                        </li>
                        <li>
                            <p>Pour p, q premiers, n : &#966;(n) = (p - 1) * (q - 1)</p>
                        </li>
                    </ul>
                    <h4>Théorème d'Euler :</h4>
                    <p>Si pgcd(a,n) = 1, alors a<sup>&#966;(n)</sup> &#8801; 1 (mod n)</p>
                    <h4>RSA : configuration des clés :</h4>
                    <ul>
                        <li>
                            <p>Choisissez deux grands nombres premiers <span class="em">p, q</span> (disons, 1024 bits).</p>
                        </li>
                        <li>
                            <p>Calculez <span class="em">n</span> = <span class="em">p * q</span>.</p>
                        </li>
                        <li>
                            <p>Choisissez <span class="em">d</span> &lt;= &#966;(n).</p>
                        </li>
                        <li>
                            <p>Calculez <span class="em">e</span> = <span class="em">d</span><sup>-1</sup></p>
                            <p>(&#8660;<span class="em">e</span> * <span class="em">d</span> = 1 mod &#966;(n)</p>
                            <p>&#8660; <span class="em">e</span> * <span class="em">d</span> = k * &#966;(n)+1)</p>
                        </li>
                    </ul>
                    <h4>RSA : chiffrage / déchiffrage :</h4>
                    <img src="../images/RSA_chiffrage_dechiffrage.PNG" alt="">
                    <h4>Problème de factorisation :</h4>
                    <p>Si p, q peuvent êre récupérés à partir de n, alors RSA est rompu.</p>
                    <p>C'est ce qu'on appelle le <span class="em">problème de factorisation</span> qui est <span class="em">considéré</span> comme étant difficile.</p>
                    <h3>Cryptage asymétrique : en pratique :</h3>
                    <ul>
                        <li>
                            <p>Plusieurs schémas de cryptage ont été conçus dont le plus connu est le RSA.</p>
                        </li>
                        <li>
                            <p>Sécurité basée sur l'hypothèse qu'un problème mathématique donné est difficile.</p>
                            <ul>
                                <li>
                                    <p>Factorisation du produit de deux grands nombres premiers.</p>
                                </li>
                                <li>
                                    <p>Calculer le logarithme discret d'un nombre dans un groupe.</p>
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <h3>Cryptographie symétrique ou asymétrique :</h3>
                    <p>Cryptographie asymétrique :</p>
                    <ul>
                        <li>
                            <p>Aucun problème de transmission de clé.</p>
                        </li>
                        <li>
                            <p>Beaucoup plus lent.</p>
                        </li>
                    </ul>
                    <p>Habituellement, un système hybride est utilisé :</p>
                    <ul>
                        <li>
                            <p>Transmettre une clé de session par crypto asymétrique.</p>
                        </li>
                        <li>
                            <p>Transmettre des données par crypto symétrique.</p>
                        </li>
                    </ul>
                    <p>Attention : ne comparez pas les tailles de clés symétriques et asymétriques !</p>
                    <h3>Exercices sur le chiffrement asymétrique :</h3>
                    <p>OpenSSL, que nous avons déjà utilisé, supporte également le chiffrement asymétrique. Le but de cet exercice est d'en manipuler quelques exemples, sans nullement prétendre en couvrir toute la documentation. <a href="https://wiki.openssl.org/index.php/Command_Line_Utilities" target="_blank">Pour plus d'infos</a>.</p>
                    <ol>
                        <li>
                            <h4>Génération de paire de clés :</h4>
                            <p>Générez une paire de clés RSA au moyen de la commande suivante (en remplaçant XY par vos initiales) :</p>
<pre><code>openssl genpkey -algorithm RSA -out rsa_PrivAndPub_XY.pem -pkeyopt rsa_keygen_bits:4096 -aes-128-cbc</code></pre>
                            <div class="information">
                                <img src="../images/information.png" alt="Information" class="float_left">
                                <p>L'option <span class="em">-aes-128-cbc</span> permet de chiffrer le fichier contenant les clés. La clé de chiffrement AES est dérivée d'un mot de passe qui vous est demandé à l'exécution de la commande.</p>
                            </div>
                            <p>À quoi servent les autres options ?</p>
                            <ul>
                                <li>
                                    <p><span class="em">openssl genpkey</span> : utilitaire d'OpenSSL pour générer des clés privées (remplace <span class="em">genrsa</span> dans les versions récentes).</p>
                                </li>
                                <li>
                                    <p><span class="em">-algorithm RSA</span> : on demande une clé RSA.</p>
                                </li>
                                <li>
                                    <p><span class="em">-out rsa_PrivAndPub_XY.pem</span> : fichier de sortie contenant la <span class="em">clé privée</span> (ici protégé par mot de passe et encodé en PEM).</p>
                                </li>
                                <li>
                                    <p><span class="em">-pkeyopt rsa_keygen_bits:4096</span> : taille de la clé <span class="em">&#8594; 4096 bits</span> (sécurité élevée).</p>
                                </li>
                                <li>
                                    <p><span class="em">-aes-128-cbc</span> : <span class="em">chiffre la clé privée sur disque</span> avec AES-128-CBC. OpenSSL demandera une passphrase. Important : si tu oublies la passphrase, tu perds la clé privée.</p>
                                </li>
                            </ul>
                            <p>Remarque : le fichier créé <span class="em">contient uniquement la clé privée</span> (dans un format PEM chiffré). Il ne contient pas automatiquement la clé publique séparée.</p>
                            <p>Il est maintenant important d'exécuter une commande telle que (à nouveau, remplacez XY par vos initiales) :</p>
<pre><code>openssl pkey -in rsa_PrivAndPub_XY.pem -pubout -out rsa_pub_XY.pem</code></pre>
                            <p>En quoi cette commande est-elle importante ? Quelle est la différence entre les deux fichiers ?</p>
                            <ul>
                                <li>
                                    <p><span class="em">rsa_PrivAndPub_XY.pem</span> &#8594; contient la <span class="em">clé privée</span> (chiffrée sur disque si tu as utilisé <span class="em">-aes-128-cbc</span>).</p>
                                </li>
                                <li>
                                    <p><span class="em">rsa_pub_XY.pem</span> &#8594; contient la <span class="em">clé publique</span> extraite de la clé privée.</p>
                                </li>
                            </ul>
                            <p><span class="em">Différence fondamentale</span> : la clé publique peut être partagée librement; la clé privée <span class="em">ne doit jamais sortir</span> de ton contrôle.</p>
                            <p>Examinez le contenu du fichier rsa_pub_XY.pem. Quels moyens pourriez-vous utiliser pour le transmettre à quelqu'un d'autre ?</p>
                            <p>Tu peux transmettre ce fichier (ou copier/coller son contenu) pour que quelqu'un puisse t'envoyer des messages chiffrés.</p>
                            <p>À quoi correspond "pem" ? Faites une recherche internet (sans y passer trop de temps).</p>
                            <p><span class="em">Format PEM</span> : c'est un encodage base64 d'un DER binaire, encadré par des en-têtes. Lisible avec un éditeur de texte.</p>
                            <p>Transmettez votre clé publique à un autre étudiant.</p>
                        </li>
                        <li>
                            <h4>Chiffrement/déchiffrement RSA :</h4>
                            <p>Écrivez un court message dans un fichier texte_clair.txt et chiffrez-le à destination d'un autre étudiant au moyen de la commande suivante (attention à la clé publique à utiliser).</p>
<pre><code>openssl pkeyutl -encrypt -pubin -inkey rsa_pub_XY.pem -in Texte_clair.txt -out texte_chiffre.enc -pkeyopt rsa_padding_mode:oaep</code></pre>
                            <p><span class="em">OAEP (Optimal Asymmetric Encryption Padding)</span> est un mode d'encodage/padding moderne et sécurisé (préférable à PKCS#1 v1.5 pour le chiffrement).</p>                            
                            <p>Déchiffrez un message au moyen de la commande :</p>
<pre><code>openssl pkeyutl -decrypt -inkey rsa_PrivAndPub_XY.pem -in texte_chiffre.enc -out Texte_dechiffre.txt -pkeyopt rsa_padding_mode:oaep</code></pre>
                            <p>Essayez ensuite de chiffrer un fichier plus gros. Que se passe-t-il ? Quelle serait la bonne manière de chiffrer un tel fichier avec RSA ?</p>
                            <p><span class="em">RSA ne chiffre que des petits blocs</span> : la taille maximale de données chiffrables <span class="em">key_size_in_bytes - padding_overhead</span>.</p>
                            <p>Si tu essayes de chiffrer un fichier de plusieurs Mo directement avec RSA, <span class="em">la commande échouera</span> ou ne chiffrera qu'une partie et produira une erreur.</p>
                            <p>La bonne pratique est le chiffrement hybride :</p>
                            <ol>
                                <li>
                                    <p>Générer une clé symétrique aléatoire (exemple : 32 octets pour AES-256) :</p>
<pre><code>openssl rand -out symkey.bin 32</code></pre>
                                </li>
                                <li>
                                    <p>Chiffrer le fichier avec AES (symétrique) en utilisant cette clé :</p>
<pre><code>openssl enc -aes-256-cbc -salt -in fichier_original -out fichier.enc -pass file:./symkey.bin</code></pre>
                                    <p>(ou utiliser AES-GCM si tu veux intégrité + chiffrement authentifié)</p>
                                </li>
                                <li>
                                    <p>Chiffrer la clé symétrique avec RSA (la petite clé) :</p>
<pre><code>openssl pkeyutl -encrypt -pubin -inkey rsa_pub_XY.pem -in symkey.bin -out symkey.bin.enc -pkeyopt rsa_padding_mode:oaep</code></pre>
                                </li>
                                <li>
                                    <p>Envoyer <span class="em">fichier.enc</span> + <span class="em">symkey.bin.enc</span> au destinataire.</p>
                                </li>
                                <li>
                                    <p>Le destinataire déchiffre <span class="em">symkey.bin.enc</span> avec sa clé privée :</p>
<pre><code>openssl pkeyutl -decrypt -inkey rsa_PrivAndPub_XY.pem -in symkey.bin.enc -out symkey.bin -pkeyopt rsa_padding_mode:oaep</code></pre>
                                    <p>Puis déchifffre le fichier AES :</p>
<pre><code>openssl enc -d -aes-256-cbc -in fichier.enc -out fichier_dechiffre -pass file:./symkey.bin</code></pre>
                                </li>
                            </ol>
                            <p>Pourquoi ? RSA protège la petite clé symétrique; AES chiffre efficacement les gros volumes. C'est la méthode standard utilisée dans TLS, PGP, S/MIME, etc.</p>
                            <p><a href="https://www.czeskis.com/random/openssl-encrypt-file.html" target="_blank">Divers exemples de cette procédure peuvent être trouvés sur le net.</a></p>
                        </li>
                    </ol>
                </article>
                <article>
                    <h2 id="protocoles_accord_cle">Les protocoles d'accord de clé :</h2>
                    <p>Cela permet à deux parties de générer conjointement une clé secrète connue d'eux seuls.</p>
                    <p>Cela fonctionne même si toutes les communications ont lieu sur un canal public.</p>
                    <img src="../images/protocoles_accord_cle.PNG" alt="">
                    <h3>Une analogie non mathématique :</h3>
                    <p>Supposons qu'Alice et Bob soient peintres et souhaitent se mettre d'accord sur une couleur commune et secrète.</p>
                    <p>La couleur ne les dérange pas, ils veulent juste la même et possédée uniquement par eux.</p>
                    <img src="../images/protocoles_accord_cle_1.PNG" alt="">
                    <h3>Problème de logarithme discret :</h3>
                    <p>Étant donné g, a, p, il est facile de calculer <span class="em">A</span> = <span class="em">g<sup>a</sup></span> mod <span class="em">p</span>.</p>
                    <p>D'un autre côté, trouver b tel que <span class="em">B</span> = <span class="em">g<sup>b</sup></span> mod <span class="em">p</span> <span class="em">semble</span> être difficile.</p>
                    <p>C'est ce qu'on appelle le <span class="em">problème du logarithme discret</span>.</p>
                    <h3>L'accord de clés Diffie-Hellman "avec les mathématiques" :</h3>
                    <img src="../images/Diffie_Hellman.PNG" alt="">
                    <p>Ce schéma illustre le protocole <span class="em">Diffie-Hellman</span>, permettant à deux parties de générer une clé secrète commune sans jamais l'échanger directement.</p>
                    <h3>En pratique :</h3>
                    <p>Plusieurs schémas "mathématiques" existent pour générer une clé commune. Le plus connu est Diffie-Hellman.</p>
                    <p>Comme pour le chiffrement asymétrique, la sécurité repose sur l'hypothèse qu'un problème mathématique est difficile (typiquement les mêmes problèmes, en fait).</p>
                    <h3>Attaque man-in-the-middle :</h3>
                    <img src="../images/man_in_the_middle.PNG" alt="">
                </article>
                <article>
                    <h2 id="authenticite_integrite">Authenticité/intégrité :</h2>
                    <p>Jusqu'à présent, nous avons discuté du problème de confidentialité.</p>
                    <p>Mais pouvons-nous aussi garantir l'authenticité ?</p>
                    <p>Autrement dit, empêcher les adversaires de modifier les données.</p>
                    <p>Ou, au moins, assurez-vous que nous le remarquerons s'ils le font.</p>
                    <p>Bonnes nouvelles : la cryptographie symétrique / asymétrique permet de répondre à cette problématique.</p>
                    <h3>Cas symétrique : Message Authentication Code (MAC) :</h3>
                    <img src="../images/message_authentication_code.PNG" alt="">
                    <h4>MAC : principe :</h4>
                    <ul>
                        <li>
                            <p>Le tag d'authenticité dépend du message et d'une clé secrète calculée et annexée au message.</p>
                        </li>
                        <li>
                            <p>Surcharge de taille fixe : la longueur du tag ne dépend pas de la longueur du message (le tag typique est de 128 bits). Ça peut poser un problème pour les messages très courts (par exemple : IoT).</p>
                        </li>
                    </ul>
                    <h4>Sécurité MAC :</h4>
                    <p>Un bon MAC garantit qu'un attaquant qui ne connaît pas la clé ne peut pas modifier le message sans être détecté.</p>
                    <p>Cependant, la vérification MAC nécessite la connaissance de la clé. Toute personne pouvant <span class="em">vérifier</span> les canaux MAC pour en <span class="em">forger</span> un.</p>
                    <p>Un bon outil pour garantir l'intégrité dans une <span class="em">communauté fermée</span>.</p>
                    <h4>Cryptage authentifié :</h4>
                    <p>Nous avons discuté séparément de la confidentialité et de l'authenticité.</p>
                    <p>Et si nous voulons les deux en même temps ?</p>
                    <ul>
                        <li>
                            <p>Possible, mais doit être manipulé avec précaution.</p>
                        </li>
                        <li>
                            <p>De nombreuses idées intuitives sont mauvaises.</p>
                        </li>
                    </ul>
                    <figure>
                        <img src="../images/authenticated_encryption.png" alt="">
                        <figcaption>Source : <a href="http://www.dummies.com/how-to/content/understanding-wep-weaknesses.html" target="_blank">http://www.dummies.com/how-to/content/understanding-wep-weaknesses.html</a></figcaption>
                    </figure>
                    <h4>MAC, chiffrer : dans quel ordre ?</h4>
                    <figure>
                        <img src="../images/MAC_encrypt_in_which_order.png" alt="">
                        <figcaption>Source : P. Rogaway, <a href="https://crypto.stanford.edu/RealWorldCrypto/slides/phil.pdf" target="_blank">https://crypto.stanford.edu/RealWorldCrypto/slides/phil.pdf</a></figcaption>
                    </figure>
                    <h4>Cryptage authentifié (AE, AEAD) :</h4>
                    <p>Un primitif assurant conjointement confidentialité et authenticité.</p>
                    <ul>
                        <li>
                            <p>Saisie : clé, texte en clair, données associées. Les données associées ne seront pas cryptées, mais authentifiées.</p>
                        </li>
                        <li>
                            <p>Sortie : texte chiffré, tag d'authentification.</p>
                        </li>
                        <li>
                            <p>Assure</p>
                            <ul>
                                <li>
                                    <p>La confidentialité du texte brut.</p>
                                </li>
                                <li>
                                    <p>Le texte brut et l'authenticité des données associées.</p>
                                </li>
                                <li>
                                    <p>Des propriétés supplémentaires : résistance aux abus, reconnaissance du texte en clair...</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>Peut s'appuyer sur des primitives dédiées, ou des modes de fonctionnement (CCM, GCM...).</p>
                        </li>
                    </ul>
                    <p>C'est sécurisé et souvent plus efficace que les solutions ad hoc.</p>
                    <p>La référence actuelle pour garantir la confidentialité et l'authenticité dans un contexte de cryptographie symétrique. Par exemple : TLS 1.3.</p>
                    <img src="../images/NIST_Issues.png" alt="">
                    <p>L'appel du NIST est lancé en 2018.</p>
                    <p><q>Chaque dossier de soumission doit décrire un algorithme unique, ou un ensemble d'algorithmes, qui implémente la fonctionnalité de cryptage authentifié avec données associés (AEAD - AuthenticatedEncryption with Associated Data).</q> 56 soumissions acceptées.</p>
                    <p>Sélection finale en février 2023 : <span class="em">Ascon family</span>.</p>
                    <h3>Authenticité/intégrité : signature digitale :</h3>
                    <img src="../images/digitale_signature.PNG" alt="">
                    <p>Ça garantit l'authenticité des données.</p>
                    <p>Plus précisément, ça confirme que les données ont été générées par le propriétaire de la clé publique et les données n'ont pas été modifiées.</p>
                    <p>Asymétrique : Les rôles du prouveur et du vérificateur sont bien distingués (le vérificateur n'a pas de clé de signature).</p>
                    <p>Ça peut être utilisé dans un grand groupe, transféré...</p>
                </article>
                <article>
                    <h2 id="fonctions_hachage">Les fonctions de hachage :</h2>
                    <p>Les Big Data sont difficiles à gérer.</p>
                    <ul>
                        <li>
                            <p>La signature numérique coûte cher.</p>
                        </li>
                        <li>
                            <p>La transmission et la lecture humaine sont inefficaces.</p>
                        </li>
                        <li>
                            <p>Autres problèmes, plus complexes : attaques multiplicatives contre RSA, ...</p>
                        </li>
                    </ul>
                    <p>Pouvons-nous générer un "résumé" des données ?</p>
                    <ul>
                        <li>
                            <p>Plus facile à manipuler.</p>
                        </li>
                        <li>
                            <p>Reliées au document original.</p>
                        </li>
                    </ul>
                    <p>&#8594; Un autre outil est nécessaire : <span class="em">les fonctions de hachage</span>.</p>
                    <p>Une fonction de compression mappant une longueur arbitraire à une longueur fixe.</p>
                    <p>C'est facile à calculer, mais difficile à inverser (concept proche de la fonction unidirectionnelle).</p>
                    <img src="../images/fonctions_hachage.PNG" alt="">
                    <div class="important">
                        <img src="../images/important.png" alt="Important" class="float_left">
                        <p>Une fonction de hachage est une <span class="em">fonction publique</span>. Pas de clés, ...</p>
                    </div>
                    <h3>Les propriétés de la fonction de hachage :</h3>
                    <p>Plus précisément :</p>
                    <ul>
                        <li>
                            <p><span class="em">résistance pré-image</span> : étant donné x, difficile de trouver m tel que h(m) = x.</p>
                        </li>
                        <li>
                            <p><span class="em">deuxième résistance pré-image</span> : étant donné m, difficile de trouver m' tel que h(m) = h(m').</p>
                        </li>
                        <li>
                            <p><span class="em">résistance aux collisions</span> : difficile de trouver m et m' tel que h(m) = h(m').</p>
                        </li>
                    </ul>
                    <h3>Les fonctions de hachage en pratique :</h3>
                    <p>Les fonctions de hachage les plus connues sont :</p>
                    <ul>
                        <li>
                            <p>MD5 : ne doit plus être utilisé !</p>
                        </li>
                        <li>
                            <p>SHA-1 : des attaques existent.</p>
                        </li>
                        <li>
                            <p>SHA-256, SHA-384, SHA-512</p>
                        </li>
                        <li>
                            <p>SHA-3 : nouveau standard (2012)</p>
                        </li>
                    </ul>
                    <h3>Signé avec des fonctions de hachage :</h3>
                    <img src="../images/signe_fonctions_hachage.PNG" alt="">
                    <h3>Pourquoi la résistance aux collisions est importante ?</h3>
                    <img src="../images/collision_resistance_important.PNG" alt="">
                    <h3>Remarques importantes :</h3>
                    <p>C'est juste l'idée intuitive.</p>
                    <ul>
                        <li>
                            <p>Les normes sécurisées actuelles (PKCS #1, ISO, ...) utilisent cette idée ou des idées similaires, mais pas seulement.</p>
                        </li>
                        <li>
                            <p>De nombreuses autres problématiques complexes apparaissent (randomisation, ...).</p>
                        </li>
                        <li>
                            <p>&#854; Utilisez un standard, ne construisez pas le vôtre !</p>
                        </li>
                    </ul>
                    <p>Gardez à l'esprit que RSA, DES, AES, ... sont <span class="em">des primitives</span> à partir desquelles de bons schémas de chiffrement/signature/... peuvent (probablement) être construits. Ce ne sont <span class="em">PAS</span> des systèmes sécurisés !</p>
                    <h3>Application: stockage des mots de passe sur un serveur :</h3>
                    <p>Ne stockez jamais les mots de passe en clair !</p>
                    <p>Stockez (login,H(pw)) et recalculez H(pw) lorsque l'utilisateur arrive ?</p>
                    <ul>
                        <li>
                            <p>Le piratage du serveur ne divulgue pas les mots de passe stockés.</p>
                        </li>
                        <li>
                            <p>Mais la recherche par force brute à partir de mots de passe courants est assez simple.</p>
                        </li>
                        <li>
                            <p>Calculer H(x) pour x &#8712; {123456, password, 12345678, qwerty, 123456789, 12345, 1234, 111111, 1234567, dragon } vous fait déjà repérer 1,6 % des mots de passe.</p>
                        </li>
                    </ul>
                    <p>[WP Engine]</p>
                    <p>Stockez (login,salt,H(salt||pw)) pour un sel aléatoire ? La recherche par force brute se fait désormais avec un mot de passe à la fois !</p>
                    <p>Remplacez H(.) par H(H(H(...H(.)...))) : Ralentit la recherche exhaustive (Bcrypt, PBKDF2, ...).</p>
                    <p>D'autres raffinements existent : consommation importante de RAM, gêne pour le parallélisme...</p>
                    <p>Constructions recommandées : <span class="em">PBKDF2, bcrypt, scrypt</span>...</p>
                    <p><a href="https://crackstation.net/hashing-security.htm" target="_blank">Une discussion intéressante sur le sujet</a></p>
                    <h3>Exercices sur les fonctions de hachage :</h3>
                    <p>Téléchargez un logiciel et vérifiez que son hash est bien celui annoncé sur le site web du fournisseur.</p>
                    <ul>
                        <li>
                            <p>Vous pouvez par exemple <a href="https://curl.se/windows/" target="_blank">télécharger curl</a>.</p>
                        </li>
                        <li>
                            <p>Pour calculer un hash avec openssl, utilisez <span class="em">openssl dgst</span> (à vous de voir la commande exacte : <span class="em">openssl dgst -help</span> vous fournira un point de départ).</p>
                        </li>
                    </ul>
<pre><code>openssl dgst -sha256 &lt;fichier&gt;</code></pre>
                </article>
                <article>
                    <h2 id="certificats_PKI">Les certificats et la PKI :</h2>
                    <p>Souvenez-vous qu'on avait dit que, dans la signature digitale, les données ont été générées par le propriétaire de la clé publique.</p>
                    <h3>Faire confiance aux clés publiques :</h3>
                    <img src="../images/trusting_public_keys.png" alt="">
                    <h3>Authenticité/intégrité : signature digitale :</h3>
                    <img src="../images/digitale_signature_1.PNG" alt="">
                    <h3>Les certificats :</h3>
                    <img src="../images/certificates.PNG" alt="">
                    <h3>La chaîne de certification :</h3>
                    <img src="../images/certificates_chain.PNG" alt="">
                    <h3>Les certificats et la PKI :</h3>
                    <p>L'autorité de certification (CA - Certification Authority) est la partie chargée de délivrer les certificats, c'est-à-dire vérifier l'identité du sujet (mais pas vérifier s'il est digne de confiance).</p>
                    <p>L'infrastructure à clé publique (PKI - Public Key Infrastructure) est l'ensemble de composants, politiques, logiciels, ... utilisés pour gérer les certificats :</p>
                    <ul>
                        <li>
                            <p>Vérification d'identité</p>
                        </li>
                        <li>
                            <p>Génération/révocation de certificats</p>
                        </li>
                        <li>
                            <p>Format, règles de vérification</p>
                        </li>
                        <li>
                            <p>...</p>
                        </li>
                    </ul>
                    <h3>Chaînes de certification : hiérarchie (par exemple : Verisign) :</h3>
                    <img src="../images/certificates_chain_hierarchy.PNG" alt="">
                    <h3>Chaînes de certification : peer-to-peer (par exemple : PGP) :</h3>
                    <img src="../images/certificates_chain_peer_to_peer.PNG" alt="">
                    <h3>Chemin de certification :</h3>
                    <p>Donc, nous faisons confiance à une clé publique car elle est intégrée dans un certificat auquel nous faisons confiance...</p>
                    <p>... et nous faisons confiance à ce certificat car il est signé par (une clé publique intégrée dans) un certificat auquel nous faisons confiance...</p>
                    <p>... et ainsi de suite...</p>
                    <p>C'est ce qu'on appelle un <span class="em">chemin de certification</span>, c'est-à-dire le chemin allant du certificat que nous voulons vérifier à un certificat auquel nous faisons confiance et ainsi chaque certificat sur le chemin est signé par le prochain.</p>
                    <h3>Résumé :</h3>
                    <p>La signature digitale garantit que le document a été généré par le propriétaire de la clé publique.</p>
                    <p>Le certificat garantit l'identité du propriétaire de cette clé publique. La garantie est fournie par l'autorité de certification (CA).</p>
                    <p>OK, mais nous avons besoin d'un point de départ.</p>
                    <h3>Le certificat racine :</h3>
                    <p>C'est un certificat que nous faisons confiance "par définition". Il est directement transmis via un canal sécurisé. Il est installé par défaut. Il est utilisé comme point de départ pour la ou les chaînes de certification.</p>
                    <div class="important">
                        <img src="../images/important.png" alt="Important" class="float_left">
                        <p>Double question :</p>
                        <ul>
                            <li>
                                <p>Dans quelle mesure ai-je confiance en cette autorité ?</p>
                            </li>
                            <li>
                                <p>Comment le certificat a-t-il été transmis ?</p>
                            </li>
                        </ul>
                    </div>
                    <p>En pratique, un grand nombre de certificats sont préinstallés (navigateur, ...). Un mauvais certificat suffit pour perdre toute sécurité.</p>
                    <h3>Listes de révocation de certificats (CRL - Certificate Revocation Lists) :</h3>
                    <p>Que se passe-t-il si ma clé privée est volée ?</p>
                    <ul>
                        <li>
                            <p>Clé de cryptage :</p>
                            <ul>
                                <li>
                                    <p>L'adversaire pourra lire mes messages précédents.</p>
                                </li>
                                <li>
                                    <p>Je dois en générer une nouvelle et dire à tout le monde de l'utiliser.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>Clé de de signature :</p>
                            <ul>
                                <li>
                                    <p>L'adversaire est capable de signer des messages en mon nom, <span class="em">dès maintenant</span> et jusqu'à l'expiration de la clé !</p>
                                </li>
                                <li>
                                    <p>Je dois dire à tout le monde d'arrêter de <span class="em">faire confiance à cette clé</span>, et je dois le faire <span class="em">rapidement</span> !</p>
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <p>&#8594; Nous avons besoin d'un moyen de diffuser ces informations.</p>
                    <p>La CRL est une liste horodatée identifiant les certificats révoqués. Elle est signée par une CA (ou un émetteur de CRL). Elle est mise à disposition dans un répertoire public.</p>
                    <p>Chaque certificat révoqué est identifié dans une CRL par son numéro de série de certificat.</p>
                    <p>Lorsqu'un certificat est vérifié, nous devons vérifier les signatures tout au long du chemin de certification et que le numéro de série du certificat ne figure pas sur la CRL la plus récente.</p>
                    <p>... et ce n'est qu'une partie de l'histoire.</p>
                    <img src="../images/PKI_logical_architecture_overview.png" alt="">
                    <h3>PKI en situation réelle : quelques exemples :</h3>
                    <img src="../images/lets_encrypt.png" alt="">
                    <h4>Faire confiance au certificat racine :</h4>
                    <img src="../images/trust_root_certificate_1.png" alt="">
                    <img src="../images/trust_root_certificate_2.png" alt="">
                    <h4>Problèmes de sécurité avec les autorités de certification :</h4>
                    <img src="../images/security_issues_with_CAs.png" alt="">
                    <img src="../images/security_issues_with_CAs_2.png" alt="">
                    <h4>Certificat auto-signé :</h4>
                    <img src="../images/self_signed_certificate.png" alt="">
                    <h3>Exercices sur les certificats :</h3>
                    <ol>
                        <li>
                            <h4>Interprétation d'un certificat :</h4>
                            <p>Rendez-vous sur <a href="https://www.mozilla.org/fr/" target="_blank">Mozilla</a>.</p>
                            <p>La connexion est-elle chiffrée ? <span class="em">Oui (voir cadenas)</span>.</p>
                            <p>Est-elle authentifiée ? <span class="em">Oui</span>.</p>
                            <p>Quelle entité se porte-t-elle garante du certificat ? <span class="em">Let's Encrypt (CN = R12)</span>.</p>
                            <p>Quelle est l'identité précise identifiée par ce certificat ? <span class="em">www.mozilla.org</span>.</p>
                            <p>Quelle est la longueur de la chaîne de certification ? <span class="em">3 (www.mozilla.org &#8594; R12 &#8594; ISRG Root x1)</span>.</p>
                            <p>Avec quel(s) standard(s), le certificat de Mozilla est-il signé ? <span class="em">RSA PKCS #1</span>.</p>
                            <p>Quels sont les usages autorisés de la clef de Mozilla ? <span class="em">Signature digitale, chiffrage des clés, authentifier le serveur, authentifier le client</span>.</p>
                            <p>Quelle différence importante y a-t-il entre les usages autorisés pour la clef de Mozilla et ceux pour la clef de R12 ? <span class="em">R12 peut signer des certificats. R12 est une autorité de certification.</span></p>
                            <p>Quelle différence entre le "Subject Name" et le "Issuer Name" ? <span class="em">Le "Subject Name" est le destinataire du certificat (c'est-à-dire celui que le certificat représente) et le "Issuer Name" est l'émetteur du certificat (c'est-à-dire la Certification Authority qui délivre le certificat). Si c'est un certificat auto-signé, Suject Name = Issuer Name parce que tu es ton propre émetteur.</span></p>
                        </li>
                        <li>
                            <h4>Manipulation d'une PKI :</h4>
                            <p>Note : cet exercice vise uniquement à tester quelques manipulations simples de certificats : il laisse de côté de nombreux détails relatifs à la sécurisation et à la gestion d'une véritable PKI et ne constitue en aucun cas un mode d'emploi complet.</p>
                            <p>Nous allons à présent dérouler le fonctionnement d'une PKI au long d'un scénario dans lequel un utilisateur crée une paire de clés et demande un certificat.</p>
                            <ol>
                                <li>
                                    <h5>Création d'une PKI :</h5>
                                    <p>Commençons par mettre en place le côté "serveur" : une PKI prête à générer des certificats pour ses utilisateurs.</p>
                                    <p>Installez <a href="https://hohnstaedt.de/xca/" target="_blank">le logiciel XCA</a>.</p>
                                    <p>Lancez le logiciel et créez une base de données <span class="em">My_local_test_PKI</span>.</p>
                                    <p>Générez un certificat racine nommé <span class="em">Root_CA</span> comme suit (remplissez librement ou ignorez les champs non spécifiés) :</p>
                                    <ul>
                                        <li>
                                            <p>Ce certificat est auto-signé.</p>
                                        </li>
                                        <li>
                                            <p>Il porte le nom (common name) "Test root CA de ...", en indiquant votre nom à la place des pointillés, pour l'organisation "ephec", en Belgique.</p>
                                        </li>
                                        <li>
                                            <p>Il utilise une clé RSA de 4096 bits, et SHA-256.</p>
                                        </li>
                                        <li>
                                            <p>Il porte la basic constraint "Certification Authority".</p>
                                        </li>
                                        <li>
                                            <p>Il est de type Certification Authority, et valide pour un mois à compter d'aujourd'hui.</p>
                                        </li>
                                        <li>
                                            <p>Il ne peut servir qu'à signer des certificats.</p>
                                        </li>
                                    </ul>
                                    <p>Générez un certificat de CA intermédiaire comme suit :</p>
                                    <ul>
                                        <li>
                                            <p>Il est signé par votre certificat racine.</p>
                                        </li>
                                        <li>
                                            <p>Il porte le nom (common name) "Test CA #1 de ...", en indiquant votre nom à la place des pointillés, pour l'organisation "ephec", en Belgique.</p>
                                        </li>
                                        <li>
                                            <p>Il utilise une clé RSA de 2048 bits, et SHA-256.</p>
                                        </li>
                                        <li>
                                            <p>Il porte la basic constraint "Certification Authority".</p>
                                        </li>
                                        <li>
                                            <p>Il est de type Certification Authority, et valide pour 15 jours à compter d'aujourd'hui.</p>
                                        </li>
                                        <li>
                                            <p>Il ne peut servir qu'à signer des certificats.</p>
                                        </li>
                                    </ul>
                                    <p>Observez l'arborescence des certificats ainsi créés.</p>
                                </li>
                                <li>
                                    <h5>Création d'une paire de clés utilisateur :</h5>
                                    <p>Passons maintenant au côté utilisateur, qui va créer sa propre paire de clés et obtenir un certificat de sa clé publique, signé par notre nouveau CA.</p>
                                    <p>Installez GPG (cf. <a href="https://en.wikipedia.org/wiki/GNU_Privacy_Guard" target="_blank">https://en.wikipedia.org/wiki/GNU_Privacy_Guard</a>). Une version Windows assez simple à utiliser est <a href="https://www.gpg4win.org/" target="_blank">gpg4win</a>. La suite de ce tutoriel est basée sur cette version.</p>
                                    <p>Lancez Kleopatra, front-end installé en même temps que gpg4win.</p>
                                    <p>Créez une nouvelle paire de clés (file &#8594; new key pair), en choisissant l'option "create a personal X509 key pair and certification request", avec les consignes suivantes :</p>
                                    <ul>
                                        <li>
                                            <p>Le common name est votre nom, et l'email votre adresse habituelle.</p>
                                        </li>
                                        <li>
                                            <p>L'organisation est ephec, le pays, la Belgique.</p>
                                        </li>
                                        <li>
                                            <p>Choisissez un mot de passe pour protéger la clé privée.</p>
                                        </li>
                                        <li>
                                            <p>Sauvez la demande de certificat dans un fichier.</p>
                                        </li>
                                    </ul>
                                    <p>Ce fichier devrait maintenant être transmis au gestionnaire de PKI.</p>
                                </li>
                                <li>
                                    <h5>Création du certificat :</h5>
                                    <p>Revenez à XCA.</p>
                                    <ul>
                                        <li>
                                            <p>Choisissez Import &#8594; Request et ouvrez le fichier que vous venez de sauver (il faut peut-être faire apparaître tous les types de fichiers).</p>
                                        </li>
                                        <li>
                                            <p>Cette demande est maintenant visible sous l'onglet Request.</p>
                                        </li>
                                        <li>
                                            <p>Signez cette demande (c'est-à-dire générez un certificat), en utilisant la clé "Test CA #1 de ..." générée ci-dessus (on ne signe généralement pas les certificats directement avec la clé racine) avec les paramètres suivants :</p>
                                            <ul>
                                                <li>
                                                    <p>Type d'extension "end entity" (c'est un certificat pour utilisateur, pas pour CA).</p>
                                                </li>
                                                <li>
                                                    <p>Usage : chiffrement/déchiffrement, signature, key agreement.</p>
                                                </li>
                                                <li>
                                                    <p>Notez bien que, normalement, cette création de certificat demanderait des vérifications conformément à la politique de sécurité du PKI.</p>
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            <p>Exportez le certificat (attention : le certificat, pas la demande - il est dans l'onglet certificates) dans un fichier. Il serait normalement envoyé à l'utilisateur.</p>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <h5>Récupération des certificats :</h5>
                                    <p>Revenez à Kleopatra et importez le fichier.</p>
                                    <p>Le certificat est maintenant visible, mais il est marqué comme invalide. C'est normal, car Kleopatra ne connaît pas notre PKI ! Il reste donc à importer cette dernière.</p>
                                    <ul>
                                        <li>
                                            <p>Sous XCA, exportez les certificats root et #1, et importez-les sous Kleopatra.</p>
                                        </li>
                                        <li>
                                            <p>Les certificats apparaissent maintenant sous Kleopatra, mais sont toujours marqués invalides.</p>
                                        </li>
                                        <li>
                                            <p>Il faut encore établir le "root of trust" en sélectionnant le certificat root et en choisissant "trust this certificate". Dès le moment où l'on a décidé de faire confiance à cette racine (un choix lourd de sens, comme discuté en cours, et à ne pas faire à la légère), l'ensemble des certificats deviennent "certified".</p>
                                        </li>
                                    </ul>
                                    <p>Vous pouvez maintenant signer des documents, soit depuis Kleopatra, soit via les menus contextuels de votre explorateur de fichiers.</p>
                                </li>
                                <li>
                                    <h5>Un dernier exercice :</h5>
                                    <p>Que faudrait-il faire pour pouvoir échanger des documents signés avec un autre étudiant ? Discutez-en, et tentez de le faire.</p>
                                </li>
                            </ol>
                        </li>
                    </ol>
                </article>
                <article>
                    <h2 id="smart_card">Carte à puce :</h2>
                    <img src="../images/smart_card.wmf.png" alt="">
                    <p>En gros, c'est un ordinateur (avec le CPU, la RAM, la ROM, la mémoire non volatile et les ports d'entrée/sortie) à l'intérieur d'une armure :</p>
                    <ul>
                        <li>
                            <p>un seul morceau de silicium</p>
                        </li>
                        <li>
                            <p>recouvert de couches de protection, de capteurs, ...</p>
                        </li>
                    </ul>
                    <p>Ça stocke une clé secrète. Ça acceptera d'utiliser la clé pour signer/déchiffrer/... les données, mais ne produira jamais la clé elle-même.</p>
                    <h3>Crypto &amp; cartes à puce : le principe fondamental :</h3>
                    <img src="../images/smart_cart_1.PNG" alt="">
                    <p>Même approche avec la plupart des bibliothèques de chiffrement SW (Java keystore...).</p>
                    <h3>Signature basée sur une carte à puce :</h3>
                    <img src="../images/smart_cart_2.PNG" alt="">
                    <h3>Exemple : s'authentifier avec une carte à puce :</h3>
                    <img src="../images/smart_cart_3.PNG" alt="">
                    <p>De nombreuses variantes possibles (crypto asymétrique, ...).</p>
                    <p>La carte à puce permet une <span class="em">authentification forte</span> basée sur :</p>
                    <ul>
                        <li>
                            <p>quelque chose que l'on <span class="em">possède</span> &#8594; la carte</p>
                        </li>
                        <li>
                            <p>quelque chose que l'on <span class="em">connaît</span> &#8594; le PIN</p>
                        </li>
                    </ul>
                    <p>En résumé, une carte à puce est un dispositif matériel sécurisé qui permet d'exécuter des opérations cryptographiques sans jamais divulguer les clés secrètes.</p>
                </article>
                <article>
                    <h2 id="exemples_questions_examen">Exemples de questions d'examen :</h2>
                    <fieldset class="question">
                        <legend>Question 1</legend>
                        <p>Pour chacun des schémas cryptographiques ci-dessous, indiquez le nombre de clés impliquées.</p>
                        <ol type="a">
                            <li>
                                <p>Message Authentication Code (MAC). <span class="em">1</span></p>
                            </li>
                            <li>
                                <p>Fonction de hachage. <span class="em">0</span></p>
                            </li>
                            <li>
                                <p>Chiffrement symétrique. <span class="em">1</span></p>
                            </li>
                            <li>
                                <p>Signature électronique. <span class="em">2</span></p>
                            </li>
                        </ol>
                    </fieldset>
                    <fieldset class="question">
                        <legend>Question 2</legend>
                        <p>Alice est enseignante, et transmet ses résultats d'examens sous la forme de messages signés électroniquement. Carole, une de ses élèves, a obtenu la note de 2/20. Maligne, elle découvre à quel endroit du message la valeur numérique est encodée sous la forme d'un byte (lequel vaut ici 00000010, pour coder 2). Elle tente alors de transformer cette valeur en 00001010, qui ne demande de modifier qu'un seul bit de message et ferait "passer" sa note à 10/20, puis d'adapter la signature avant de montrer le message à ses parents. Sachant que ses parents possèdent déjà la clé publique d'Alice, quelles sont les chances de Carole de réussir à produire un message dont la signature soit correctement vérifiée ?</p>
                        <p>Veuillez choisir une réponse.</p>
                        <ol type="a">
                            <li>
                                <p>Aucune de ces réponses. &#10060;</p>
                            </li>
                            <li>
                                <p>Environ 1 sur 2 sur 256, car la note est codée sur un byte. &#10060;</p>
                            </li>
                            <li>
                                <p>Presque 100%, il suffit de modifier un bit de la signature pour que cela fonctionne.&#10060;</p>
                            </li>
                            <li>
                                <p>Pratiquement nulles. &#9989;</p>
                            </li>
                        </ol>
                    </fieldset>
                    <fieldset class="question">
                        <legend>Question 3</legend>
                        <p>Un hacker a réussi à obtenir une copie du certificat d'une grande agence bancaire. Lesquelles des attaques ci-dessous est-il susceptible de réussir (plusieurs réponses possibles) ?</p>
                        <ol type="a">
                            <li>
                                <p>Aucune de ces réponses. &#9989;</p>
                            </li>
                            <li>
                                <p>Modifier les informations transmises par les clients, comme les montants ou les numéros de compte du destinataires. &#10060;</p>
                            </li>
                            <li>
                                <p>Modifier le site web de l'agence, par exemple en indiquant de fausses URL ou numéros de compte. &#10060;</p>
                            </li>
                            <li>
                                <p>Contourner la confidentialité des échanges, et donc lire les informations envoyées par les clients. &#10060;</p>
                            </li>
                        </ol>
                    </fieldset>
                    <fieldset class="question">
                        <legend>Question 4</legend>
                        <p>Alice envoie à Bob un message chiffré via un algorithme de symétrique moderne, par exemple AES en mode compteur avec une clé de 128 bits. Un instant plus tard, elle constate qu'elle a fait une faute de frappe au milieu du message. Elle décide donc de corriger la faute, de chiffrer à nouveau le message (avec la même clé) et de le renvoyer à Bob. Si elle utilise correctement l'algorithme de chiffrement, quelles différences devrait-on observer entre les deux messages chiffrés ?</p>
                        <p>Veuillez choisir une réponse.</p>
                        <ol type="a">
                            <li>
                                <p>Les deux chiffrés sont totalement différents. &#9989;</p>
                            </li>
                            <li>
                                <p>Aucune de ces réponses. &#10060;</p>
                            </li>
                            <li>
                                <p>Une différence locale, à l'endroit de la correction. &#10060;</p>
                            </li>
                            <li>
                                <p>Les deux chiffrés comment de manière identifique, puis diffèrent à partir de la correction jusqu'à la fin du message. &#10060;</p>
                            </li>
                        </ol>
                    </fieldset>
                </article>
            <!-- fin de section -->
            </section>
        </main>
        <footer role="contentinfo">
            <div>
                <address>
                    Professeurs :
                    <a class="mail" href="mailto:olivier.choquet@vinci.be">Choquet Olivier</a>
                    <a class="mail" href="mailto:driss.vandenheede.techinfo@gmail.com">Vandenheede Driss</a>
                </address>
            </div>
            <div>
                <p>Si vous détectez une erreur, une faute d'orthographe, n'hésitez pas à envoyer un mail aux adresses juste à côté avec le nom de la page et l'erreur détectée.</p>
            </div>
            <div id="version">
                <p>Syllabus HTML</p>
                <p>Version 5.0</p>
            </div>
        </footer>
        <script src="../pre.js"></script>
    </body>
</html>