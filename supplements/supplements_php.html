<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="author" content="Choquet Olivier & Vandenheede Driss">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>PHP, MVC et Laravel - Suppléments - e-Syllabus HTML5 et CSS3</title>
        <!-- une icône dans la barre du navigateur -->
        <link rel="icon" href="../images/favicon.png" type="image/png">
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <!-- bannière et menu -->
        <header role="banner">
            <div class="logoTitle">
                <h1>Cours d'introduction au Web</h1>
                <h2>HTML5 et CSS3</h2>
            </div>
            <nav role="navigation" aria-label="Menu principal de navigation">
                <ul>
                    <li><a href="../index.html">Le cours</a></li>
                    <li><a href="../internet.html">Internet</a></li>
                    <li><a href="../html5.html">HTML5</a></li>
                    <li><a href="../css3.html">CSS3</a></li>
                    <li><a href="../methodologie.html">Méthodologie</a></li>
                    <li><a href="../lexique.html">Lexique</a></li>
                    <li><a href="../supplements.html" class="current">Suppléments</a></li>
                </ul>
            </nav>
        </header>
        <main id="container" role="main">
            <div id="menu">
                <nav role="navigation">
                    <ol>
                        <li><a href="#intro_php">Introduction à PHP</a></li>
                        <li><a href="#template_HTML_PHP">Template HTML et PHP</a></li>
                        <li><a href="#elements_syntaxe_php">Éléments de syntaxe PHP</a></li>
                        <li><a href="#variables_php">Variables PHP</a></li>
                        <li><a href="#operateurs_php">Opérateurs PHP</a></li>
                        <li><a href="#tableaux_php">Tableaux PHP</a></li>
                        <li><a href="#structures_controle_repetitives_php">Structures conditionnelles et boucles PHP</a></li>
                        <li><a href="#inclusion_fichier_php">Inclusion de fichier PHP</a></li>
                        <li><a href="#fonctions_php">Fonctions PHP</a></li>
                        <li><a href="#classes_php">Classes PHP</a></li>
                        <li><a href="#expressions_regulieres_php">Expressions régulières en PHP</a></li>
                        <li><a href="#intro_mvc">Introduction à MVC</a></li>
                        <li><a href="#dans_application_web_mvc">MVC en théorie</a></li>
                        <li><a href="#pratique_mvc_php">MVC en pratique avec PHP</a></li>
                        <li><a href="#frameworks_mvc">Frameworks MVC</a></li>
                        <li><a href="#intro_laravel">Introduction à Laravel</a></li>
                        <li><a href="#espaces_nom_laravel">Namespaces de Laravel</a></li>
                        <li><a href="#gestion_routes_laravel">Routes Laravel</a></li>
                        <li><a href="#gestion_controleurs_laravel">Contrôleurs Laravel</a></li>
                        <li><a href="#gestion_modeles_laravel">Modèles Laravel</a></li>
                        <li><a href="#gestion_vues_laravel">Vues Blade Laravel</a></li>
                    </ol>
                </nav>
                <!-- aside lié à la page et pas à l'article donc pas à l'intérieur de article -->
                <aside>
                    <p>Liens utiles :</p>
                    <ul>
                        <li><a href="http://www.w3schools.com/js/default.asp" target="_blank">Tutoriel JavaScript de W3Schools</a></li>
                        <li><a href="http://www.w3.org/" target="_blank">W3C</a></li>
                        <li><a href="http://fr.openclassrooms.com/informatique/cours/apprenez-a-creer-votre-site-web-avec-html5-et-css3" target="_blank">Open Classroom</a></li>
                        <li><a href="http://www.w3.org/TR/html5/" target="_blank">Norme HTML5</a></li>
                        <li><a href="http://www.w3schools.com/" target="_blank">W3Schools</a></li>
                        <li><a href="http://www.alsacreations.com/" target="_blank">Alsa Création</a></li>
                        <li><a href="https://www.youtube.com/c/LeDesignerduWeb/videos">Le Designer du web</a></li>
                    </ul>
                </aside>
            </div>
            <section id="mainSection">
                <article>
                    <h1>PHP, MVC et Laravel :</h1>
                </article>
                <article id="php">
                    <h2>Langage PHP :</h2>
                    <p><span class="em">PHP</span> est un langage de programmation par scripts principalement utilisé pour produire des pages Web dynamiques.</p>
                    <h3 id="intro_php">Indroduction au PHP :</h3>
                    <p>PHP, à l'origine "<span class="em">Personal Home Page</span>" mais depuis renommé en "<a href="https://www.php.net/manual/en/preface.php" class="em" target="_blank">PHP : Hypertext Preprocessor</a>" est un langage de scripts. Il est multi-usage, mais une de ses utilités principales est la possibilité d'intégrer des scripts PHP au sein de templates HTML afin de produire facilement des pages Web de façon dynamique.</p>
                    <p>Contrairement à JavaScript, où les pages Web sont <span class="em">modifiées</span> de façon dynamique du côté du client (c'est-à-dire du navigateur Internet de l'utilisateur), PHP permet de <span class="em">générer</span> des pages Web du côté du serveur. Le script PHP sera exécuté au niveau du serveur lors d'une requête HTTP, et c'est la page créée à l'issue de cette exécution qui est envoyée au client en réponse à sa requête.</p>
                    <h3 id="template_HTML_PHP">Template HTML et PHP :</h3>
                    <p>Un fichier PHP est un fichier texte, qui peut contenir de l'hypertexte de façon similaire à un fichier HTML.</p>
                    <p>Cependant, en outre, il peut contenir du code PHP, placé au sein de balises <span class="html">&lt;?php</span> (ouvrante) et <span class="html">?&gt;</span> (fermante). Lorsque le serveur charge la page, le code situé entre ces balises est exécuté, et ses valeurs de retours (s'il y en a) sont insérées dans la page à l'endroit où la balise PHP était placée.</p>
                    <p>Prenons par exemple le template suivant :</p>
<pre class="taille60"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;test&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;?php echo "Bonjour le monde ! &lt;br&gt;"; ?&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Une fois que le serveur charge cette page, le code PHP est exécuté. L'instruction <span class="html">echo</span> indique que le texte qui suit est inséré dans la page, et il s'agit de la seule instruction ici. Par conséquent, une fois le chargement terminé, le fichier HTML suivant est généré :</p>
<pre class="taille60"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;test&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        Bonjour le monde ! &lt;br&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Notez qu'il est aussi possible d'écrire un fichier PHP qui ne contient que du code PHP, sans HTML autour. Dans ces cas-là, il faut quand même ouvrir la balise <span class="html">&lt;php</span>, mais on peut omettre la balise fermante <span class="html">?&gt;</span>.</p>
                    <h3 id="elements_syntaxe_php">Éléments de syntaxe PHP :</h3>
                    <p>La syntaxe de PHP est inspirée de langages tels que C, C++ et Java; vous pourrez sans doute la prendre en main sans trop de difficulté. Nous verrons ici les particularités du langage les plus utiles, mais nous vous encourageons comme toujours de consulter la documentation du langage pour plus d'informations : <a href="https://www.php.net/docs.php" target="_blank">https://www.php.net/docs.php</a>.</p>
                    <p>Notons pour commencer qu'à l'instar de Java, toute instruction en PHP se termine par un point-virgule.</p>
                    <h4 id="variables_php">Variables :</h4>
                    <p>PHP est un langage non typé, à l'instar de JavaScript. Cela signifie que le type des variables n'est pas déclaré lorsqu'une variable est créé. En outre, PHP offre certaines fonctionnalités par rapport aux variables qui permettront de rendre la génération des pages dynamiques particulièrement pratique.</p>
                    <p>PHP offre trois niveaux de visibilité pour ses variables :</p>
                    <ul>
                        <li>Les variables <span class="em">locales</span> sont visibles uniquement dans le bloc de code où elles sont déclarées. Le nom d'une variable locale commence par le symbole <span class="html">$</span>, par exemple <span class="html">$var</span>.</li>
                        <li>Les variables <span class="em">globales</span>sont visibles partout dans le code. Celles-ci peuvent être définies de deux façons : soit avec le mot-clé <span class="html">global</span>, par exemple <span class="html">global $var</span>, soit en l'ajoutant au tableau <span class="html">$GLOBALS</span> via <span class="html">$GLOBALS['var']</span>.</li>
                        <li>
                            <p>Les variables <span class="em">superglobales</span> sont des variables visibles partout dans le code, déjà prédéfinies par PHP, avec des rôles bien définis. Il s'agit également de tableaux, qui pourront recevoir des champs nommés. On notera en particulier :</p>
                            <ul>
                                <li>La variable <span class="html">$_GET</span>, qui contient les données passées au serveur durant une requête HTTP GET.</li>
                                <li>La variable <span class="html">$_POST</span>, qui contient les données passées au serveur durant une requête HTTP POST.</li>
                                <li>La variable <span class="html">$_FILES</span>, qui contient les fichiers passés par une requête HTTP POST.</li>
                                <li>Les cookies <span class="html">$_COOKIE</span> qui permet d'accéder aux cookies HTTP.</li>
                                <li>La variable de requête <span class="html">$_REQUEST</span>, qui combine par défaut <span class="html">$_GET</span>, <span class="html">$_POST</span> et <span class="html">$_COOKIE</span>.</li>
                                <li>La variable de session <span class="html">$_SESSION</span> qui persistent durant une session utilisateur donnée.</li>
                                <li>La variable d'environnement <span class="html">$_ENV</span> contient les informations de l'environnement dans lequel le programme s'exécute.</li>
                            </ul>
                            <p>Notons aussi que <span class="html">$GLOBALS</span> est en fait une variable superglobale qui reprend les variables globales définies dans le programme.</p>
                        </li>
                    </ul>
                    <p>Les variables superglobales, en particuliers, sont celles qui vont nous permettre de créer des pages. Par exemple, lors de l'envoi d'un formulaire HTML :</p>
<pre class="taille60"><code>&lt;form action="login.php" method="POST"&gt;
    &lt;input type="text" name="login" placeholder="Login"&gt;
    &lt;input type="submit" value="Se connecter"&gt;
&lt;/form&gt;</code></pre>
                    <p>L'action de la balise <span class="html">&lt;form&gt;</span> dicte l'URL qui est demandée au serveur. Dans ce cas-ci, il s'agit d'un fichier PHP; le serveur va alors exécuter le script contenu dans ce fichier :</p>
<pre class="taille60"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;Login&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;?php
            $login = $_POST['login'];
            echo "Bienvenue $login";
        ?&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>La variable superglobale <span class="html">$_POST</span> récupère automatiquement les informations passées par le formulaire.</p>
                    <h5 id="controle_variables_php">Contrôle des variables :</h5>
                    <p>Il est possible d'effectuer des vérifications sur les variables :</p>
                    <ul>
                        <li>Vérification de l'existence : via la fonction <span class="html">isset()</span>.</li>
                        <li>
                            <p>Vérification de la vacuité (si la variable est vide) : via la fonction <span class="html">empty()</span>.</p>
                            <ul>
                                <li>Une variable peut <span class="em">exister</span> mais être <span class="em">vide</span> : par exemple un champ laissé vide dans un formulaire !</li>
                            </ul>
                        </li>
                        <li>Destruction manuelle de variable : via la méthode <span class="html">unset()</span>.</li>
                    </ul>
                    <h5 id="operateur$_variables_dyamiques">Opérateur $ et variables dynamiques :</h5>
                    <p>En dehors de la déclaration d'une variable, $ est un opérateur qui permet de retourner la valeur contenue dans la variable dont le nom est renseigné juste après le symbole $. Par exemple, dans <span class="em">login.php</span> ci-dessus, dans l'expression <span class="html">"Bienvenue 1login"</span>; l'opérateur <span class="em">$loin</span> est évalué en premier, et la valeur contenue dans cette variable est concaténée à la chaîne adjacente.</p>
                    <p>Un usage particulier de cette capacité en PHP est l'emploi de <span class="em">variables dynamiques</span> : si on souhaite à accéder à une variable dont le nom est lui-même contenu dans une autre variable, on pourra se servir de cet opérateur pour procéder rapidement :</p>
<pre class="taille60"><code>&lt;?php
    // appel d'une variable dynamique
    // affectation
    $cours = "AIN";
    $varx = "cours";
    // appel de la variable dynamique
    echo $$varx; # équivaut à echo $cours;
?&gt;</code></pre>
                    <h4 id="constantes_php">Constantes :</h4>
                    <p>La définition d'une constante se fait via la fonction <span class="html">define(name, value)</span>. Par exemple :</p>
<pre class="taille60"><code>&lt;?php
    define("WEB", "http://www.heb.be/esi");
    echo "Site internet : " . WEB . "&lt;br&gt;";
?&gt;</code></pre>
                    <p>Notez que l'accès la valeur de la constante se fait en notant son nom, <span class="em">sans</span> le précéder par l'opérateur $.</p>
                    <p>PHP possède en outre quelques constantes prédéfinies :</p>
                    <ul>
                        <li><span class="html">__FILE__</span> : nom du fichier actuellement exécuté.</li>
                        <li><span class="html">__LINE__</span> : n° de la ligne actuellement exécutée.</li>
                        <li><span class="html">PHP_VERSION</span> : chaîne de caractères donnant la version de PHP utilisée.</li>
                        <li><span class="html">PHP_OS</span> : nom du système d'exploitation.</li>
                    </ul>
                    <h4 id="operateurs_php">Opérateurs :</h4>
                    <p>Les opérateurs de PHP sont, pour la plupart, similaires à ceux que vous aurez rencontrés dans d'autreslangages comme Java. On notera par exemple :</p>
                    <ul>
                        <li>Les opérateurs arithmétiques (<span class="html">+</span>, <span class="html">-</span>, <span class="html">*</span>, <span class="html">/</span>, <span class="html">%</span>).</li>
                        <li>Les opérateurs d'incrémentation et de décrémentation (<span class="html">++</span> et <span class="html">--</span>).</li>
                        <li>L'opérateur d'assignation ($a <span class="html">=</span> 42;).</li>
                        <li>Les opérateurs de comparaison (<span class="html">==</span>, <span class="html">!=</span>, <span class="html">&gt;</span>, <span class="html">&gt;=</span>, <span class="html">&lt;</span>, <span class="html">&lt;=</span>).</li>
                        <li>Les opérateurs logiques (ET : <span class="html">&&</span> ou <span class="html">and</span>, OU : <span class="html">||</span> ou <span class="html">or</span>). Notez que la version texte de ces opérateurs a une priorité moindre.</li>
                        <li>L'opérateur de concaténation de chaînes, <span class="em">attention</span>, est différent de Java : il s'écrit avec <span class="html">.</span>. Par exemple : <span class="html">$a . $b</span> concatène les chaînes de caractères contenues dans les variables <span class="html">$a</span> et <span class="html">$b</span>.</li>
                        <li>L'accès à un caractère dans une chaîne de caractères se fait via les crochets, par exemple <span class="html">$str[0]</span> renvoie le premier caractère de la chaîne contenue dans <span class="html">$str</span>.</li>
                    </ul>
                    <p>L'instruction <span class="html">echo</span>, déjà mentionnée, place ce qui suit (typiquement une chaîne de caractères) dans la page HTML générée à la fin de l'exécution du script. La fonction <span class="html">print()</span> existe aussi, et effectue la même opération, mais renvoie également une valeur de retour (1 en cas de réussite), et peut donc être appelée au sein d'une expression.</p>
                    <h4 id="tableaux_php">Tableaux :</h4>
                    <p>Les tableaux en PHP combinent deux types de tableaux :</p>
                    <ul>
                        <li>Les tableaux <span class="em">scalaires</span>, où les éléments sont associés à des indices (nombres entiers).</li>
                        <li>Les tableaux <span class="em">associatifs</span>, où les éléments sont associés à des clés (typiquement des chaînes de caractères).</li>
                    </ul>
                    <p>Ces deux types être combinés au sein d'un même tableau. On notera en particulier que les variables superglobales sont toutes des tableaux.</p>
<pre class="taille60"><code>&lt;?php
    // tableau scalaire à une dimension (vecteur)
    $heb = array("esi", "isti", "defré");
    // tableau scalaire à deux dimensions (matrice)
    $mat[0][1] = 16;

    // tableau associatif à une dimension (vecteur)
    $tab["quatrieme"] = "ghi";
    // tableau associatif à plusieurs dimensions
    $user["admin"]["nom"] = "Simpson";
    $user["admin"]["prenom"] = "Bart";

    $mat[1]["nom"] = "Manfroid"; // combinaison d'indices associatif et numérique
?&gt;</code></pre>
                    <h4 id="structures_controle_repetitives_php">Structures de contrôle et répétitives :</h4>
                    <p>De même, les structures de contrôle et les boucles sont similaires à celles de Java :</p>
                    <ul>
                        <li>
                            <p>La condition <span class="html">if</span> :</p>
<pre class="taille60"><code>&lt;?php
    $a = 34;
    $b = 136;
    if ($a == $b) {
        echo "&lt;p&gt;\$a ($a) est égal à \$b ($b)";
        $c = 23;
    } elseif ($a &lt; $b) {
        echo "&lt;p&gt;\$a ($a) est plus petit que \$b ($b)";
    } else {
     echo "&lt;p&gt;\$a ($a) est plus grand que \$b ($b)";   
    }
?&gt;</code></pre>
                        </li>
                        <li>
                            <p>L'alternative à choix multiples <span class="html">switch</span> :</p>
<pre class="taille60"><code>&lt;?php
    $i = 2;
    switch ($i) {
        case 0:
            print '$i = 0';
            break;
        case 1:
            print '$i = 1';
            break;
        case 2:
            print '$i = 2';
            break;
        default:
            print '$i est très étrange';
    }
?&gt;</code></pre>
                        </li>
                        <li>
                            <p>La boucle "pour" <span class="html">for</span> :</p>
<pre class="taille60"><code>&lt;?php
    for ($i = 0; $i != 10; $i++) {
        print $i;
    }
?&gt;</code></pre>
                        </li>
                        <li>
                            <p>La boucle "pour chaque" <span class="html">foreach</span> :</p>
<pre class="taille60"><code>&lt;?php
    $arr = array(1, 2, 3, 4);
    foreach($arr as &$value) {
        $value *= 2;
    }
?&gt;</code></pre>
                        </li>
                        <li>
                            <p>La boucle "tant que" <span class="html">while</span> :</p>
<pre class="taille60"><code>&lt;?php
    $i = 0;
    while ($i != 10) {
        print $i . "&lt;br&gt;";
        $i++;
    }
?&gt;</code></pre>
                        </li>
                        <li>
                            <p>La boucle "pour" <span class="html">faire - tant que</span> :</p>
<pre class="taille60"><code>&lt;?php
    $i = 0;
    do {
        print $i . "&lt;br&gt;";
    } while ($i != 0);
?&gt;</code></pre>
                        </li>
                    </ul>
                    <p>Certaines instructions permettent d'influencer le déroulement de conditions ou de boucles :</p>
                    <ul>
                        <li>L'instruction <span class="html">break;</span> permet de sortir d'une condition ou d'une boucle.</li>
                        <li>L'instruction <span class="html">continue;</span> permet de continuer.</li>
                    </ul>
                    <h4 id="inclusion_fichier_php">Inclusion d'un fichier :</h4>
                    <p>L'inclusion <span class="html">include</span> permet de charger et d'exécuter d'autres fichiers PHP. Par exemple :</p>
<pre class="taille60"><code>&lt;?php
    $files = array('prem.php', 'deux.php', 'trois.php');
    for ($i = 0; $i &lt; count($files); $i++) {
        include $files[$i];
    }
?&gt;</code></pre>
                    <p>Ce fichier va charger et exécuter le contenu des fichiers <span class="em">prem.php</span>, <span class="em">deux.php</span> et <span class="em">trois.php</span>. Notez qu'en particulier, cela signifie que tous les <span class="em">echo</span> effectués dans ces fichiers seront appliqués, et toutes les définitions de fonctions ou classes dans ces fichiers seront désormais accessibles.</p>
                    <h4 id="fonctions_php">Fonctions :</h4>
                    <p>La définition et l'appel de fonctions utilise une syntaxe similaire à celle de JavaScript : le mot-clé <span class="html">function</span> permet de définir une nouvelle fonction, et l'appel se fait via le nom de la fonction suivi de parenthèses (contenant éventuellement les arguments de la fonction).</p>
<pre class="taille60"><code>&lt;?php
    // DÉFINITIONS DES Fonctions
    function entete($titre) {
        echo "&lt;html lang='fr'&gt;
                &lt;head&gt;
                    &lt;title&gt;$titre&lt;/title&gt;
                &lt;/head&gt;
                &lt;body&gt;";
    }

    function pied_de_page() {
        echo "&lt;hr&gt;
            &lt;/body&gt;
        &lt;/html&gt;";
    }

    // APPELS
    entete("inroduction à PHP");
    echo "&lt;h1&gt;Utilisation de fonctions&lt;/h1&gt;";
    pied_de_page();
?&gt;</code></pre>
                    <p>L'instruction <span class="html">return</span> permet de renvoyer une valeur de retour. Si on souhaite renvoyer plusieurs valeurs, on passera par un tableau. Par exemple :</p>
<pre class="taille60"><code>&lt;?php
    function addition ($nb1,$nb2) {
        $res = $nb1 + $nb2;
        return $res;
    }

    functin add_mult ($nb1, $nb2) {
        $res1 = $nb1 + $nb2;
        $res2 = $nb1 * $nb2;
        return array($res1, $res2);
    }

    $resultat = addition(8, 6);
    echo "la somme vaut : " . $resultat;

    $resultats = add_mult(8, 6);
    echo "la somme vaut : " . $resultats[0] . "&lt;br&gt;";
    echo "le produit vaut : " . $resultats[1] . "&lt;br&gt;";
?&gt;</code></pre>
                    <p>Il est aussi possible de renseigner des valeurs par défaut aux paramètres de vos fonctions. Faites attention à placer les arguments possédant des valeurs par défaut à la fin de vos en-têtes de fonction !</p>
<pre class="taille60"><code>&lt;?php
    // FONCTIONS avec valeurs par défaut  pour les arguments
    function entete($titre, $bgcolor = "red") {
        echo "&lt;html lang='fr'&gt;
                &lt;head&gt;
                    &lt;title&gt;$titre&lt;/title&gt;
                &lt;/head&gt;
                &lt;body bgcolor='$bgcolor'&gt;";
    }

    function pied_de_page($email = "info@he2b.be") {
        echo "&lt;hr&gt;Courriel : $email
            &lt;/body&gt;
        &lt;/html&gt;";
    }

    // APPELS
    entete("inroduction à PHP");
    echo "&lt;h1&gt;Utilisation de fonctions&lt;/h1&gt;";
    pied_de_page();
?&gt;</code></pre>
                    <h4 id="classes_php">Classes :</h4>
                    <p>PHP est un langage orienté objet : il est donc possible d'y définir des classes.</p>
                    <p>Les attributs sont définis comme des variables locales au sein d'une classe, et les méthodes comme des fonctions au sein de la classe également.</p>
<pre class="taille60"><code>&lt;?php
    class Dossier {
        // Attributs
        var $nom = null;
        var $fichiers = array();
        // Méthodes
        function Dossier ($valeur) {
            $this-&gt;nom = $valeur;
        }

        function ajouter_fichier ($nom_fichier) {
            $this-&gt;fichiers[] = $nom_fichier;
        }
    }
?&gt;</code></pre>
                    <p>Le constructeur de classe se note comme toute autre fonction, mais a pour nom le nom de la classe ou peut être utilisé par la fonction magique <span class="html">__construct()</span>. Notez aussi l'utilisation du mot-clé <span class="html">$this</span> pour faire référence à l'objet lui-même au sein de fonction, et de l'opérateur flèche <span class="html">-&gt;</span> pour accéder à un attribut ou appeler une méthode sur l'objet.</p>
                    <p>Pour créer un objet, on procèdera comme suit :</p>
<pre class="taille60"><code>&lt;?php
    $dossier = new Dossier("maison");
    $dossier-&gt;ajouter_fichier("cuisine");
?&gt;</code></pre>
                    <h3 id="fonctions_utiles_php">Quelques fonctions utiles :</h3>
                    <h4 id="manipulation_string">Manipulation de chaînes de caractères :</h4>
                    <p>Documentation complète : <a href="https://www.php.net/manual/fr/book.strings.php" target="_blank">https://www.php.net/manual/fr/book.strings.php</a>.</p>
                    <ul>
                        <li><span class="html">strlen(string)</span> : fournit la longueur de la chaîne.</li>
                        <li>
                            <p>Gestion de la casse :</p>
                            <ul>
                                <li><span class="html">strtolower(string)</span> : met les caractères en minuscule.</li>
                                <li><span class="html">strtoupper(string)</span> : met les caractères en majuscule.</li>
                                <li><span class="html">ucfirst(string)</span> : met le premier caractère en majuscule.</li>
                            </ul>
                        </li>
                        <li>
                            <p>Gestion des sous-chaînes :</p>
                            <ul>
                                <li><span class="html">substr(string, start, length)</span> : extrait une prtie d'une chaîne de caractères.</li>
                                <li><span class="html">substr_count(source, pattern)</span> : compte le nombre d'occurences de la sous-chaîne <span class="html">pattern</span> dans la chaîne <span class="html">source</span>.</li>
                                <li><span class="html">strrchr(string, pattern)</span> : extrait la fin de la chaîne <span class="html">string</span>, à partir de la dernière occurence de la sous-chaîne <span class="html">pattern</span>.</li>
                                <li><span class="html">str_replace(pattern, replacement, source)</span> : remplace toutes les occurences de "<span class="html">pattern</span>" trouvées dans la "<span class="html">source</span>" par la chaîne "<span class="html">replacement</span>.</li>
                                <li><span class="html">trim(string)</span> : retourne une string sans les espaces blancs (<span class="html">"\n"</span>, <span class="html">"\r"</span>, <span class="html">"\t"</span>, <span class="html">"\v"</span>, <span class="html">"\0"</span>, <span class="html">" "</span>) en début et en fin de chaîne.</li>
                                <li><span class="html">ltrim(string)</span> : retourne une string sans les espaces blancs de début de chaîne.</li>
                                <li><span class="html">rtrim(string)</span> : retourne une string sans les espaces blancs de fin de chaîne.</li>
                                <li><span class="html">explode(separator, string)</span> : scinde une chaîne sur base d'un séparateur et retourne un tableau contenant les éléments résultant de la division.</li>
                                <li><span class="html">implode(join, array)</span> :  retourne une chaîne formée par la concaténation des chaînes présentes dans <span class="html">array</span>, spéarées par la sous-chaîne présente dans <span class="html">join</span>.</li>
                                <li><span class="html">split(pattern, join)</span> : scinde une chaîne aux occurences de la sous-chaîne <span class="html">patern</span> et renvoie un tableau contenant les chaînes ainsi formées.</li>
                            </ul>
                        </li>
                        <li>
                            <p>Suppression de texte indésirable :</p>
                            <ul>
                                <li><span class="html">strip_tags(string [, allowable_tages])</span> : supprime les balises HTML et PHP dans une chaîne.</li>
                                <li><span class="html">stripslashes(string)</span> : supprime les caractères \ dans une chaîne de caractères.</li>
                            </ul>
                        </li>
                        <li>
                            <p>Encodage pour URL :</p>
                            <ul>
                                <li><span class="html">urlencode(string)</span> : convertit une chaîne selon les règles d'encodage d'URL.</li>
                                <li><span class="html">rawurlencode(string)</span> : convertit une chaîne en URL selon la norme IETF [RFC1738] (espace en "%20" au lieu de "+", utile lors d'utilisation d'URL avec le protocole FTP par exemple).</li>
                                <li><span class="html">urldecode(string)</span> : décode une chaîne selon les règles d'encodage d'URL.</li>
                                <li><span class="html">htmlspecialchars(string)</span> : convertit les caractères spéciaux("&", "&quot;", "&lt;", "&gt;") en équivalent HTML ("&amp;amp;", "&amp;quot;", "&amp;lt;", "&amp;gt;").</li>
                            </ul>
                        </li>
                        <li>
                            <p>Encodage pour HTML :</p>
                            <ul>
                                <li><span class="html">nl2br(string)</span> : convertit à la ligne en retour de chariot HTML (&lt;br&gt;).</li>
                                <li><span class="html">htmlentities(string)</span> : convertit les caractères significatifs en HTML.</li>
                            </ul>
                        </li>
                    </ul>
                    <h4 id="manipulation_tableaux_php">Manipulation de tableaux :</h4>
                    <p>Document complète : <a href="https://www.php.net/manual/fr/book.array.php" target="_blank">https://www.php.net/manual/fr/book.array.php</a>.</p>
                    <ul>
                        <li><span class="html">array_walk($var, fct)</span> : applique la fonction <span class="html">fct</span> à chaque élément du tableau <span class="html">$var</span>.</li>
                        <li><span class="html">list(var1, var2, ...)</span> : permet d'assigner une série de variables à partir d'un tableau : <span class="html">$info = list($drink, $color, $power);</span>.</li>
                        <li><span class="html">each(array)</span> : retourne chaque paire clé/valeur d'un tableau d'assignation.</li>
                        <li><span class="html">sizeof(array)</span> : retourne le nombre d'éléments du tableau.</li>
                        <li><span class="html">is_array(var)</span> : teste si une variable est de type tableau.</li>
                    </ul>
                    <h4 id="manipulation_repertoires_fichiers_php">Manipulation de répertoires et de fichiers :</h4>
                    <p>Documentation complète : <a href="https://www.php.net/manual/fr/refs.fileprocess.file.php" target="_blank">https://www.php.net/manual/fr/refs.fileprocess.file.php</a>.</p>
                    <ul>
                        <li>
                            <p>Navigation :</p>
                            <ul>
                                <li><span class="html">opendir(dir)</span> : ouvre un répertoire et récupère un pointeur.</li>
                                <li><span class="html">readdir(dir_handle)</span> : retourne le nom de fichier suivant dans le répertoire pointé par <span class="html">dir_handle</span> (obtenu via <span class="html">opendir</span>).</li>
                                <li><span class="html">rewinddir(dir_handle)</span> : se remplace au début du répertoire <span class="html">dir_handle</span>.</li>
                                <li><span class="html">closedir(dir_handle)</span> : ferme le répertoire.</li>
                                <li><span class="html">is_dir(filename)</span> : vérifie si la cible est un répertoire.</li>
                                <li><span class="html">chdir()</span> : change le dossier courant de PHP.</li>
                            </ul>
                        </li>
                        <li>
                            <p>Manipulation de fichier :</p>
                            <ul>
                                <li><span class="html">copy("anc_fich", "nouv_fich")</span> : copier un fichier.</li>
                                <li><span class="html">unlink(filename)</span> : supprimer le fichier.</li>
                                <li><span class="html">filesize(filename)</span> : retourner la taille d'un fichier en octets.</li>
                                <li><span class="html">file_exists(filename)</span> : teste si un fichier existe.</li>
                                <li><span class="html">tempnam(dir, prefix)</span> : crée un fichier et lui donne un nom unique.</li>
                                <li><span class="html">flock(file_hanfle, operation_type)</span> : permet un verrou sur un fichier en cas d'accès concurrents.</li>
                            </ul>
                        </li>
                        <li>
                            <p>Ouverture et modification de fichier :</p>
                            <ul>
                                <li><span class="html">fopen(filename, mode)</span> : ouvre un fichier et retourne  un pointeur sur ce fichier.</li>
                                <li><span class="html">fclose(file_handle)</span> : ferme le pointeur sur le fichier ouvert.</li>
                                <li><span class="html">fwrite(file_handle, string[, length])</span> : écrit dans un fichier.</li>
                                <li><span class="html">fread(file_handle, length)</span> : lit un fichier.</li>
                                <li><span class="html">fgets(file_handle, length)</span> : lit la ligne courante d'un fichier.</li>
                                <li><span class="html">file(filename)</span> : renvoie le contenu d'un fichier sous forme d'un tableau.</li>
                                <li><span class="html">readfile(filename)</span> : récupère le contenu d'un fichier et l'envoie sur la sortie standard.</li>
                                <li><span class="html">feof(file_handle)</span> : teste si la fin du fichier a été atteinte.</li>
                                <li><span class="html">topfile()</span> : crée un fichier temporaire et l'ouvre en mode écriture.</li>
                            </ul>
                        </li>
                    </ul>
                    <h4 id="expressions_regulieres_php">Expressions régulières :</h4>
                    <p>Documentation complète : <a href="https://www.php.net/manual/fr/book.regex.php" target="_blank">https://www.php.net/manual/fr/book.regex.php</a>.</p>
                    <p>Les expressions régulières permettent de représenter une catégorie de chaînes de caractères qui correspondent toutes au même modèle, afin de faire des manipulations plus possées.</p>
                    <ul>
                        <li><span class="html">ereg(pattern, string[, regs])</span> : cherche le modèle <span class="html">pattern</span> dans la chaîne et place éventuellementle résultat de recherche dans le tableau <span class="html">regs</span>.</li>
                        <li><span class="html">eregi(pattern, string[, regs])</span> : idem, mais insensible à la casse.</li>
                        <li><span class="html">ereg_replace(pattern, replacement, string)</span> : cherche le modèle <span class="html">pattern</span> dans la chaîne et les remplace par <span class="html">replacement</span>.</li>
                        <li><span class="html">eregi_replace(pattern, replacement, string)</span> : idem, mais insensible à la casse.</li>
                    </ul>
                    <p>Pour avoir la présentation du cours de PHP en PowerPoint, vous les obtenir en cliquant sur les liens ci-dessous :</p>
                    <p><a href="files/4-PHP.pptx">PHP</a></p>
                    <p><a href="files/5-Les_formulaires_PHP.pptx">Les formulaires PHP</a></p>
                    <p><a href="files/6-Cookies_et_Sessions_PHP.pptx">Cookies et Sessions</a></p>
                    <p><a href="files/7-PHP-PDO.ppt">PHP PDO</a></p>
                    <p><a href="files/8-PHP-systeme-de-fichiers.ppt">PHP - Système de fichiers.</a></p>
                </article>
                <article id="mvc">
                    <h2>Architecture MVC pour une application Web :</h2>
                    <p>Nous allons voir comment appliquer les principes de l'architecture <span class="html">MVC (Modèle - Vue - Contrôleur)</span> au développement d'une application Web.</p>
                    <h3 id="intro_mvc">Rappel : Architecture MVC :</h3>
                    <p>L'<a target="_blank" href="https://fr.wikipedia.org/wiki/Mod%E8le-vue-contr%F4leur" class="em">architecture Modèle - Vue - Contrôleur</a> (MVC) est un patron d'architecture logicielle adapté aux logiciels utilisant des interfaces graphiques, y compris des applications Web. Cette architecture divise l'application en trois composants. L'architecture MVC repose sur le principe de <span class="em">responsabilité unique</span> : chaque élémént de l'application possède un rôle unique ete précis.</p>
                    <ul>
                        <li>Le <span class="html">Modèle</span> représente les données <span class="em">métier</span> de l'application, à savoir les données proppres au système que l'application modélise (par opposition aux données propres à l'implémentation).</li>
                        <li>La <span class="html">Vue</span> contient la présentation de l'interface graphique.</li>
                        <li>Le <span class="html">Contrôleur</span> implémete la logique de traitement des actions effectuées par l'utilisateur.</li>
                    </ul>
                    <div>
                        <img src="../images/500px-MVC-Process.svg.png" alt="https://en.wikipedia.org/wiki/File:MVC-Process.svg" class="float_right">
                        <p>Le fonctionnement d'une application MVC passe par une boucle d'exécution :</p>
                        <ul>
                            <li>L'utilisateur interagit avec le programme via le contrôleur.</li>
                            <li>Le contrôleur détermine quelle action est demandée par le contrôleur, et la transmet au modèle.</li>
                            <li>Le modèle effectue cette action en suivant la logique des données métier.</li>
                            <li>Une fois modifié, le contrôleur informe la vue de se mettre à jour afin de représenter le nouvel état des données.</li>
                            <li>La vue affiche les nouvelles informations, permettant à l'utilisateur d'effectuer une nouvelle action.</li>
                        </ul>
                    </div>
                    <h3 id="dans_application_web_mvc">Dans une application Web :</h3>
                    <p>Lorsqu'on développe une application classique, les données métier pourraient se trouver par exemple dans des fichiers sur l'ordinateur où l'application tourne, et l'interface graphique pourrait se reposer sur un moteur de rendu au choix.</p>
                    <p>Toutefois, lors de développement d'une application Web, des contraintes supplémentaires s'ajoutent. L'application tourne en effet maintenant sur un serveyr distant, accédé via le réseau Internet, et l'interface graphique sera généralement lilurée au navigateur Internet de l'utilisateur.</p>
                    <h4 id="modele_theorie">Modèle :</h4>
                    <p>Les donées métier doivent être stockées sur le serveur distant : pour cela, une base de données persistante est un outils que vous connaissez bien, et qui est parfaitement approprié dans ce but.</p>
                    <p>Notre application serveur devra donc être capable de faire l'interface avec cette base de données (en lecture et potentiellement en écriture), et implémenter la logique métier du modèle, c'est-à-dire les règles régissant toute interactio et opération ayant lieu au sein du modèle. Dans ce but, une architecture orienté objet est un exemple d'implémentation très appropriée ; chaque classe d'un modèle orienté objet peut traduire une classe de la base de données, reprenant les données métier ainsi que l'implémentation des opérations sous la forme de méthodes.</p>
                    <h4 id="vue_theorie">Vue :</h4>
                    <p>La vue représente les informations qui seront transmises par l'application à l'utilisateur. Dans le cas d'une application Web, il s'agit donc d'envoyer une réponse aux requêtes de l'utilisateur via HTTP.</p>
                    <p>La vue de l'application aura donc pour tâche de générer des pages Web, par exemple au format HTML (agrémenté de feuilles de style CSS et scripts JavaScript éventuelsà répondant à la requête de l'utilisateur.</p>
                    <h4 id="controleur_theorie">Contrôleur :</h4>
                    <p>Les interactions de l'utilisateur avec le serveur d'une application Web se font toujours par l'intermédiaire d'une requête au serveur (à priori via HTTP).</p>
                    <p>Par conséquent, le rôle du contrôleur d'une application Web est de traduire une requête. C'est ce qu'on appelle un <span class="html">Router</span> : il fait le lien entre une adresse URL appelée avec une méthode HTTP (GET, POST, etc.) et les manipulation de modèle à effectuer et/ou la vue à afficher en réponse.</p>
                    <h3 id="pratique_implementation_mvc_php">En pratique : implémentation MVC en PHP :</h3>
                    <h4 id="modele_pratique">Modèle :</h4>
                    <p>PHP possède plusieurs librairies permettant d'interragir avec des bases de données persistantes. Nous montrerons ici <a href="https://www.w3schools.com/php/php_mysql_connect.asp" target="_blank">PDO</a>, qui a l'avantage de permettre des interactions avec de nombreux schémas de bases de données différents.</p>
                    <p>Il faudra s'assurer que PDO est installé dans votre exécutable avant de vous en servir (les versions récentes de WAMP ou XAMPP (pour Mac OS) l'incluent normalement par défaut). Une fois cela fait, vous pouvez créer un objet de la classe PDO comme suit (en supposant que la base de données utilise un schéma MySQL) :</p>
<pre class="taille60"><code>&lt;?php
    $servername = "localhost";
    $dbname = "myDB";
    $username = "username";
    $password = "password";

    try {
        $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
        $conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    } catch(PDOException $e) {
        // Gestion d'erreur avec $e-&gt;getMessage(); pour voir le message.
    }
?&gt;</code></pre>
                    <p>Une fois l'objet <span class="html">$conn</span> créé, sa méthode <a href="https://www.php.net/manual/en/pdo.query.php" class="html" target="_blank">query($sql)</a> permet de transmettre une requête contenie dans la variable à la base de données. Le résultat de cette méthode, de type <a href="https://www.php.net/manual/en/class.pdostatement.php" class="em" target="_blank">PDOStatement</a>. On peut alors parcourir les résultats de celle-ci, par exemple via la méthode <span class="html">PDOStatement::fetchAll()</span>, qui renvoie une matrice mixte contenant les données demandées.</p>
                    <p>De même, pour une requête qui met à jour les données de la base de données (INSERT, UPDATE, DELETE), la méthode <a href="https://www.php.net/manual/en/pdo.exec.php" class="html" target="_blank">PDO::exec($sql)</a> permet de transmettre la requête à la base de données. Cette méthode renvoie comme valeur le nombre de rangs modifiés dans la base de données.</p>
                    <p>Comme expliqué dans la section précédente, il conviendra de créer des classes représentant chaque objet du modèle. Ces classes se chargent de générer et d'exécuter les requêtes à la base de données nécessités par la logique métier du modèle. Il sera souvent pratique de créer une classe abstraite <span class="html">Model</span> (comme la création de l'objet PDO), et de laisser vos classes de modèles hériter de cette classe afin de factoriser votre code.</p>
                    <h4 id="vue_pratique">Vue :</h4>
                    <p>Comme nous l'avons vu au chapitre précédent, PHP est un langage très approprié pour générer des pages HTML de façon dynamique. On notera toutefois une règle de bonne pratique pour structurer une application plus complexe : l'utilisation de gabarits.</p>
                    <p>Un gabarit est un fichier PHP qui définit la structure d'une page HTML, avec des emplacements prévu pour insérer directement les valeurs de certaines variables. Par exemple, un fichier <span class="html">template.php</span> comme ci-dessous :</p>
<pre class="taille60"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;/head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;&lt;?= $title; ?&gt;&lt;/title&gt;
        &lt;link rel="stylesheet" href="style.css"&gt;
        &lt;script src="script.js"&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;header&gt;Website header&lt;/header&gt;
        &lt;nav&gt;Website nav&lt;/nav&gt;
        &lt;main&gt;
            &lt;h2&gt;&lt;?= $pagetitle; ?&gt;&lt;/h2&gt;
            &lt;?= $pagetext; ?&gt;
        &lt;/main&gt;
        &lt;footer&gt;Website footer&lt;/footer&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Note : la syntaxe <span class="html">&lt;?= $title; ?&gt;</span> est un raccourci pour <span class="html">&lt;?php echo $title; ?&gt;</span>.</p>
                    <p>Nos autres fichiers PHP peuvent alors donner les valeurs aux variables placées dans ce template, puis d'inclure le gabarit (<span class="em">template</span> en anglais) pour générer immédiatement la page HTML avec la structure voulue. Pour rappel : l'inclusion en PHP via <span class="html">require</span> ajoute tout code HTML dans la page générée. Par exemple :</p>
<pre class="taille60"><code>&lt;?php
    $title = "Ma page";
    $pagetitle = "Bienvenue sur ma page";
    $pagetext = "&lt;p&gt;Texte de la page&lt;/p&gt;";

    require "template.php";
?&gt;</code></pre>
                    <p>Procéder avec cette structure de factoriser lecode autant que possible :</p>
                    <ul>
                        <li>La définition de la structure de la page est faite dans des fichiers gabarits, alors que la transmission des données modèle est faite dans d'autres fichiers de vue.</li>
                        <li>La structure de la page est définie (à priori) à un seul endroit.</li>
                        <li>Les éléments communs ne sont définis qu'une fois (pas de code redondant).</li>
                    </ul>
                    <p>Pour des contenus de taille conséquente, il conviendra d'utiliser les fonctions de buffer <a href="https://www.php.net/manual/en/function.ob-start.php" class="html" target="_blank">ob_start()</a> et <a href="https://www.php.net/manual/en/function.ob-get-clean.php" class="html" target="_blank">ob_get_clean()</a>. Ces fonctions permettent d'ouvrir un buffer dans lequel vous pouvez placer du code HTML incluant des balises PHP. Par exemple :</p>
<pre class="taille60"><code>&lt;?php obstart(); ?&gt;
&lt;h1&gt;Tous les messages&lt;/h1&gt;
&lt;table class="messages"&gt;
    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th&gt;Date&lt;/th&gt;
            &lt;th&gt;Auteur&lt;/th&gt;
            &lt;th&gt;Titre&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
        &lt;?php foreach ($allMessages as $row) : ?&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;?= $row["msg_date"]; ?&gt;&lt;/td&gt;
                &lt;td&gt;&lt;?= $row["name"]; ?&gt;&lt;/td&gt;
                &lt;td&gt;&lt;?= $row["title"]; ?&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;?php endforeach; ?&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;php $content = ob_get_clean(); ?&gt;</code></pre>
                    <p>À l'exécution de ce code, la variable <span class="html">$content</span> contiendra tout le code HTML situé entre l'appel aux fonctions de buffer; en outre, le contenu de la table HTML aura été généré de façon itérative avec le contenu du tableau <span class="html">$allMessages</span>.</p>
                    <h4 id="controleur_pratique">Contrôleur :</h4>
                    <p>On pourrait, en guise de router, se contenter de créer un fichier PHP pour chaque URL qu'on estime être valide, et appeler au sein de ce fichier PHP la vue qui correspond. Toutefois, on recontrerait vite un problème d'échelle lorsque notre application grandit en taille, et cette méthode laisserait l'accès aux autres fichiers PHP qui constituent l'application, ce qui n'est à priori pas désirable.</p>
                    <p>Sur un serveur Apache comme celui créé par XAMPP, le fichier <span class="html">.htaccess</span>, placé à la racine des fichiers du serveur, permet de réécrire les URL demandées par des requêtes HTTP. Grâce à cela, nous pouvons rediriger toutes les requêtes vers un fichier PHP unique (typiquement nommé <span class="em">index.php</span>). Par exemple, pour transformer toute URL de type <span class="em">xxx/yyy</span> en <span class="em">index.php?action=xxx&id=yyy</span>.</p>
<pre class="taille60"><code># Réécrit une URL de type xxx/yyy/zzz
# en index.php?action=yyy&id=zzz
RewriteEngine on
RewriteRule ^([a-zA-Z)*)/?([a-zA-Z]*)?/?$ index.php?action=$1&id=$2 [NC, L]</code></pre>
                    <p>Ce fichier emploie une expression régulière pour réécrire l'URL demandée.</p>
                    <p>Dès lors, un Router peut être défini :</p>
<pre class="taille60"><code>&lt;?php
    require "ControllerActions.php";
    function routeRequest() {
        $action = $_GET["action"];
        try {
            if (function_exists($action)) {
                $action();
            } else {
                // Error
            }
        } catch (Exception $e) {
            // Error
        }
    }
?&gt;</code></pre>
                    <p><span class="em">index.php</span> peut simplement faire appel à ce Router :</p>
<pre class="taille60"><code>&lt;?php
    require "Router.php";
    routeRequest();
?&gt;</code></pre>
                    <p>Ajoutons une page au site revient à ajouter un cas dans la fonction de route, et ajouter une méthode d'action, définiesici dans le fichier <span class="em">ControllerActions.php</span> (que nous avons pas montré pour cet exemple-ci). Ces actions, faisant aussi partie du contrôleur, font appel au modèle pour récupérer les données utiles ou effectuer les modifications voulues, puis affichent la vue nécessaire pour la réponse via un <span class="html">require</span>. Elles peuvent également lire les autres paramètres reçues durant la requête HTTP (ou créés par <span class="html">.htaccess</span>.</p>
                    <p>Dans des cas plus complexes, il peut être utile de définir le Router comme une classe qui comprend cette fonction de routing ainsi que des fonctions anexes, par souci de factorisation.</p>
                    <h3 id="frameworks_mvc">Des frameworks pour se simplifier la vie... :</h3>
                    <p>Dans la pratique, de nombreux frameworks existent afin de créer des applications Web dotées d'une architecture MVC. Ces frameworks fournissent des librairies de classes et fonctions implémentnt déjà de nombreuses fonctionnalités de base communes à toute aplication Web (router, accès à la base de données, gestion de gabarits, ...). Ces frameworks reposent aussi chacun sur des langages de programmation différents, permettant aux développeurs de choisir les outils qui leur conviennent le mieux.</p>
                    <p>Notons par exemple <a href="https://www.google.com/search?client=safari&rls=en&q=laravel&ie=UTF-8&oe=UTF-8" target="_blank">Laravel</a> et <a href="https://symfony.com/" target="_blank">Symfony</a> (PHP), <a href="https://rubyonrails.org/" target="_blank">Ruby on Rails</a> (Ruby), <a href="https://www.djangoproject.com/" target="_blank">Django</a> (Python), <a href="https://dotnet.microsoft.com/apps/aspnet" target="_blank">ASP.NET</a> (C#.NET - Microsoft), <a href="https://github.com/balderdashy/sails" target="_blank">Sails.js</a> (Node.js, une librairie JavaScript permettant de faire tourner un serveur Web en JavaScript).</p>
                    <p>Ces frameworks sont cités à titre informatif, et cette liste n'est pas exhaustive; il s'agit ici simplement d'un survol de technologies existantes.</p>
                </article>
                <article id="laravel">
                    <h2 id="intro_laravel">Introduction à Laravel :</h2>
                    <p>Laravel est un framework Web open source qui respecte l'architecture MVC. Il nous fournit des librairies permettant de faire l'abstraction de la mécanique de base du MVC, et de laisser les développeurs Web se concentrer sur la logique de l'application Web à créer.</p>
                    <h2 id="gestionnaire_projet_laravel">Un gestionnaire de projet :</h2>
                    <p>Avant de pouvoir utiliser <a href="https://laravel.com/" class="html" target="_blank">Laravel</a>, nous aurons besoin d'un gestionnaire de projet qui permettra de traiter les dépendances nécesssaires à l'exécution d'un tel projet.</p>
                    <p>En PHP, le gestionnaire le plus utilisé est <a href="chrome-extension://mhjfbmdgcfjbbpaeojofohoefgiehjai/index.html" class="html" target="_blank">Composer</a>, une application en ligne de commandes multi-plateforme.</p>
                    <h3 id="gestion_dependances_laravel">Gestion de dépendances :</h3>
                    <p>Une fois Composer installé, tout projet qui dispose des fichiers <span class="html">composer.json</span> et <span class="html">composer.lock</span> à sa racine pourra utiliser Composer. Ces fichiers vont encoder les différentes dépendances présentes dans le projet. Dans la majorité des cas, ils ne sont pas édités manuellement, mais sont générés par le programme Composer lui-même.</p>
                    <p>Une dépendance peut être ajoutée à un projet via la commande <span class="html">composer require</span>. Les fichiers de la librairie invoquée sont alors installés dans le dossier <span class="html">vendor</span> à la racine du projet.</p>
                    <p>Puisque ces fichiers sont externes au projet, il est recommandé de ne <span class="em">pas</span> les inclure dans un gestionnaire de version comme Git, et donc d'ajouter <span class="em">vendor</span> à <span class="html">.gitignore</span>.</p>
                    <p>Si le projet doit être installé à un nouvel emplacement (par exemple une nouvelle machine après un clone de dépôt Git), il suffira d'utiliser la commande <span class="html">composer install</span> et les dépendances seront automatiquement chargées à nouveau dans le dossier <span class="em">vendor</span>.</p>
                    <h3 id="espaces_nom_laravel">Espaces de nom :</h3>
                    <p>Puisque Composer permet d'inclure de nombreuses librairies de code au sein d'un même projet, il offre en outre un mécanisme permettant de faire référence à ces différentes librairies de façon transparente, sans prendre connaissance de l'emplacement physique des fichiers concernés (ce qui serait nécessaire avec <span class="html">require</span> de PHP). Ce mécanisme sont les <span class="html">namespaces</span> ("espaces de nom").</p>
                    <p>Pour déclarer qu'un fichier se place dans un espace de nom, il suffit de le déclarer au début du script PHP via l'instruction <span class="html">namespace</span>.</p>
<pre class="taille60"><code>&lt;?php
    namespace WEBR34\Controller;

    class MyController {
        static function someControllerFunction() {
            // ...
        }
    }
?&gt;</code></pre>
                    <p>Pour ensuite faire l'import d'une ressource à un autre endroit dans le projet, l'instruction <span class="html">use</span> sera employée.</p>
<pre class="taille60"><code>&lt;?php
    namespace WEBR34\Model;

    use WEBR34\Controller\MyController;

    class MyModel {
        function someFunction() {
            MyController::someControllerFunction();
        }
    }
?&gt;</code></pre>
                    <p>À noter : la syntaxe des espaces de nom utilise souvent des standards de nomenclature. Le plus populaire (et celui employé par Laravel) est <a href="https://getcomposer.org/doc/04-schema.md#psr-4" target="_blank">psr-4</a>.</p>
                    <h2 id="framework_laravel">Le framework Laravel :</h2>
                    <h3 id="installation_demarrage_laravel">Installation et démarrage :</h3>
                    <p>Un projet Laravel peut être créé via Composer via la commande :<span class="html">composer install laravel/laravel nomDuProjet</span>.</p>
                    <p>Cette commande crée un répertoire <span class="em">nomDuProjet</span> qui servira de racine au projet Laravel. Une arborescence de fichier est automatiquementcréée pour vous, ainsi que des fichiers pré-remplis permettant de faire tourner une version minimale d'une application web utilisant Laravel. Notamment, vous pouvez noter que les fichiers de Composer (<span class="em">composer.json</span> et <span class="em">composer.lock</span>) sont présents.</p>
                    <h4 id="demarrage_serveur_tests_laravel">Démarrage en serveur de tests :</h4>
                    <p>Pour faire tourner l'application, un script PHP exécutable en console <span class="html">artisan</span> nous sera utile : la commande <span class="html">php artisan serve</span> permettra de lancer un <span class="em">serveur de tests</span>, accessible à l'adresse <a href="http://localhost:8000/" class="html" target="_blank">http://localhost:8000/</a> par défaut. Ce serveur nous permettra d'éviter de devoir configurer un serveur Apache; le terminal affiche alors aussi un log des interactions avec ce serveur de test.</p>
                    <p>Si l'installation a réussi avec succès, en vous rendant à l'adresse renseignée par <span class="em">artisan</span>, vous arriverez à une page d'accueil pré-définie par Laravel.</p>
                    <h4 id="deploiement_serveur_reel_laravel">Déploiement sur serveur réel :</h4>
                    <p>Le dossier <span class="em">public</span> contenant les fichiers directement accessibles à un utilisateur du site.</p>
                    <p>Ce dossier contient par défaut un fichier <span class="em">index.php</span> servant de <span class="em">Font Controller</span> ("contrôleur de façade") qui fera les appels au reste du code.</p>
                    <p>Un site déployé de façon professionnelle configurera donc un serveur (par exemple Apache) pour servir uniquement le répertoire <span class="em">public</span>, et ainsi s'assurer que le reste du code du site n'est pas accessible depuis l'extérieur.</p>
                    <h3 id="gestion_routes_laravel">Gestion des routes :</h3>
                    <p>Le dossier <span class="em">routes</span> contient des scripts de Router, permettant de définir les URLs qui sont accessibles dans notre application.</p>
                    <p>Plusieurs scripts sont définis par défaut, permettant de gérer différents types de routes. Ici, nous nous intéresserons principalement à <span class="html">web.php</span>, qui définit les routes accessibles depuis une application Web.</p>
                    <p>Ces routes sont définies en Laravel via la classe <span class="html">Route</span>, qui contient des méthodes statiques correspondant à chaque méthode HTTP. Par exemple, la route définie par défaut est <span class="html">Route::get('/', view('welcome'));</span>.</p>
                    <p>Cette instruction dit que quand l'URL à la racine du site est appelée avec une requête HTTP GET, appelera la vue (nous verrons plus tard comment celles-ci sont définies) <span class="em">welcome</span>.</p>
                    <p>Ajouter une route revient à appeler une des méthodes de <span class="em">Route</span> pour mettre en lien une URL et une exécution de code.</p>
                    <h3 id="gestion_controleurs_laravel">Gestion des contrôleurs :</h3>
                    <p>Le dossier <span class="html">app/Http/Controllers</span> contient les contrôleurs de Laravel. Ces classes ont pour rôler d'aller récupérer des informations tirées du modèle, puis d'appeler la vue correspondante. Par exemple :</p>
<pre class="taille60"><code>&lt;?php
    namespace App\Http\Controllers;
    use \App\Models\Post;

    class BlogCtrl extends Controller {
        public function allPosts() {
            $billets = Post::getAllPosts();
            return view("vueAccueil", ["billets" =&gt; $billets]);
        }

        public function postDetails($id) {
            $billets = Post::getPostDetails($id);
            return view("vueDetails", ["billets" =&gt; $billets]);
        }
    }
?&gt;</code></pre>
                    <p>Ce contrôleur appelle le modèle pour récupérer tous les billets de blog existants, puis passe ces billets à une vue <span class="html">vueAccueil</span> via la méthode <span class="em">view()</span> définie par Laravel.</p>
                    <p>Pour appeler cette méthode depuis notre <span class="em">Router</span>, on utilisera la notation suivante :</p>
                    <p class="html">Route::get('/blog', [BlogCtrl::class, 'allPosts']);</p>
                    <p>Le deuxième paramètre est ici un tableau, reprenant dans son premier élément la classe du contrôleur utilisé, puis le nom d'une méthode statique de ce contrôleur à appeler. En outre, le <span class="em">Router</span> peut passer des paramètres directement à la fonction appelée :</p>
                    <p class="html">Route::get('/blog/{id}', [BlogCtrl::class, 'postDetails']);</p>
                    <p>Ici {id} est noté comme un paramètre dans la route. Par exemple, si une requête est faite à l'URL <span class="em">blog/12</span>, le Router appellera la méthode <span class="em">postDetails</span> avec un paramètre nommé <span class="em">$id</span> de valeur <span class="em">12</span>.</p>
                    <p>Le script <span class="em">artisan</span> fournit une commande permettant de générer facilement un nouveau contrôleur : <span class="html">php artisan make:controller</span>.</p>
                    <h3 id="gestion_modeles_laravel">Gestion des modèles :</h3>
                    <p>Le dossier <span class="em">app/Models</span> contient les classes de modèle de Laravel. Il s'agit de classes PHP, et il est donc possible de leur ajouter des attributs et méthodes si c'est nécessaire au fonctionnement de l'application Web. En outre, les classes de modèle contiennent une ou plusieurs méthodes <span class="em">statiques</span> permettant de récupérer un ou plusieurs objets de cette classe, typiquement tirés d'une base de données.</p>
                    <p>Un exemple de classe de modèle, toujours tiré de myBlog, consisterait en :</p>
<pre class="taille60"><code>&lt;?php
    namespace App\Models;
    use \Illuminate\Support\facades\DB;

    class Post {
        public static function getAllPosts() {
            $result = DB::select('SELECT bild_id AS id, bil_date AS date,'
                        . ' bil_titre AS titre, bil_contenu AS contenu FROM t_billet'
                        . ' ORDER BY bil_id DESC;');
            return $result;
        }

        public static function getPostDetails($id) {
            $result = DB::select('SELECT bil_id AS id, bil_date AS date,'
                        . ' bil_titre AS titre, bil_contenu AS contenu FROM t_billet'
                        . ' where bil_id = ' . $id);
            return $result;
        }
    }
?&gt;</code></pre>
                    <p>Le script <span class="em">artisan</span> fournit une commande permettant de générer facilement une nouvelle classe de modèle <span class="html">php artisan make:model</span>.</p>
                    <h4 id="interactions_db_laravel">Interactions avec la base de données :</h4>
                    <p>Le fichier <span class="html">.env</span> contenu à la racine du projet contient les <span class="em">variables d'environnement</span> du projet, y compris les informations de connexion à la base de données :</p>
<pre class="taille60"><code>DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=TodoDB
DB_USERNAME=root
DB_PASSWORD=</code></pre>
                    <p>Une fois ces variables configurées, on pourra effectuer des requêtes à la base de données via la librairie DB de Laravel :</p>
<pre class="taille60"><code>&lt;?php
    use \Illuminate\Support\Facades\DB;

    // Requête select
    $result = DB::select("SELECT name FROM todos;");

    // Requête insert
    // ? permet de placer des valeurs dans la requête de façon sécurisée
    DB::insert("INSERT INTO todos (name, description) VALUES (?, ?);", ['acheter du lait', 'aucune description']);
?&gt;</code></pre>
                    <p>La méthode <span class="html">DB::select()</span> retourne par défaut des objets anonymes PHP (utilisant la classe <span class="html">stdClass</span>). Les noms de colonnes en SQL deviennent donc des attributs d'objets PHP.</p>
                    <h3 id="gestion_vues_laravel">Gestion des vues :</h3>
                    <p>Le dossier <span class="html">ressources/views</span> contient les différentes vues de l'application. Celles-ci sont appelées facilement avec la fonction <span class="html">view</span> (accessible partout dans un projet Laravel sans besoin d'imports), comme déjà mentionné.</p>
                    <p>Quant aux <span class="em">feuilles de style CSS</span> et <span class="em">scripts JavaScript</span>, ainsi que tout autre fichier (comme des images) chargés directement sur les pages du site, ils seront placés dans le dossier public. Leur URL sera définie comme le chemin à partir du dossier public.</p>
                    <h4 id="generation_vues_blade_laravel">Génération de vues : Blade :</h4>
                    <p>S'il est possible de définir une vue comme un simple fichier PHP créant une page HTML, on utilisera très souvent le <span class="em">moteur de templates</span> de Laravel : Blade. Les vues utilisant Blade doivent toutes être nommées avec un nom se terminant par <span class="em">.blade.php</span>; elles sont appelées au sein de Laravel avec la fonction <span class="html">view</span>, de la même que les vues normales. Par conséquent, <span class="em">view("vueAccueil");</span> peut à la fois faire référence au fichier <span class="em">vueAccueil.php</span> ou au fichier <span class="em">vueAccueil.blade.php</span>; attention à ne pas causer des conflits !</p>
                    <p>La fonction <span class="em">view</span> permet aussi de passer des variables à une vue :</p>
                    <p class="html">return view('todo', ['todos' =&gt; $todos]);</p>
                    <p>Ces variables sont passées au sein d'un tableau associatif. Attention : ce sont les noms des clés de ce tableau qui sont ensuite employées au sein de la vue pour faire référence aux variables !</p>
                    <p>Blade permet de transformer nos vues en se rapprochant du code HTML autant que possible, en laissant au contrôleur le soin de gérer la logique de traitement. De façon générale, un template Blade est du code HTML, avec des doubles accolades pour insérer du code PHP. Par exemple, <span class="html">{{$todos}}</span> insère le contenu de la variable <span class="html">$nom</span> (c'est-à-dire la valeur correspondant à la clé "nom" dans le tableau des variables passé à la vue). Les instructions de contrôle sont quant à elles notées avec un @.</p>
                    <p>Par exemple :</p>
<pre class="taille60"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;TODO&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;À faire...&lt;/h1&gt;
        @if (count($todos) === 0)
            &lt;p&gt;Rien pour le moment ;)&lt;/p&gt;
        @else
            &lt;ul&gt;
                @foreach ($todosas $todo)
                    &lt;li&gt;{{$todo}}&lt;/li&gt;
                @endforeach
            &lt;/ul&gt;
        @endif
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <h4 id="gabarits_blade_laravel">Gabarits et Blade :</h4>
                    <p>En tant que moteur de rendu, Blade simplifie en outre grandement l'utilisation d'un gabarit en utilisant un système d'héritage. Notre template est une vue comme les autres, possédant des appels à l'instruction @yield au sein de sa structure :</p>
<pre class="taille60"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;link rel="stylesheet" href="/style.css"&gt;
        &lt;title&gt;@yield('title')&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="global"&gt;
            &lt;header&gt;
                &lt;h1 id="titreBlog"&gt;&lt;a href="/blog"&gt;Mon Blog&lt;/a&gt;&lt;/a&gt;
                &lt;p&gt;Je vous souhaite la bienvenue sur ce modeste blog.&lt;/p&gt;
            &lt;/header&gt;
            &lt;div id="contenu"&gt;
                @yield('content')
            &lt;/div&gt; &lt;!-- #contenu --&gt;
            &lt;footer id="piedBlog"&gt;
                Blog réalisé avec PHP, HTML5, et CSS.
            &lt;/footer&gt;
        &lt;/div&gt; &lt;!-- #global --&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Ensuite, on peut définir une ou plusieurs vues qui héritent de celle-ci avec l'instruction <span class="html">@extends</span>. Le contenu des sections marquées par un <span class="html">@yield</span> est alors renseigné via l'instruction <span class="html">@section</span> (et éventuellement <span class="html">@endsection</span>).</p>
<pre class="taille60"><code>@extends('template')
@section('title', 'Mon Blog')
@section('content')
    @foreach ($billets as $billet)
        &lt;article&gt;
            &lt;header&gt;
                &lt;h1 class="titreBillet"&gt;
                    &lt;a href="/blog/{{$billet-&gt;id}}"&gt;{{$billet-&gt;titre}}&lt;/a&gt;
                &lt;/h1&gt;
                &lt;time&gt;{{$cillet-&gt;date}}&lt;/date&gt;
            &lt;/header&gt;
            &lt;p&gt;{{$billet-&gt;contenu}}&lt;/p&gt;
        &lt;/article&gt;
        &lt;hr&gt;
    @endforeach
@endsection
</code></pre>
                    <h2 id="et_apres">Et après :</h2>
                    <p>Laravel n'est qu'un seul framework web MVC. Il peut sembler imposer de se familiariser avec de nombreuses notions, mais une fois la prise en main effectuée, il simplifie grandement le travail du développeur Web, car il n'est dès lors plus nécessaire que de se soucier des manipulations propres à l'application, en laissant Laravel se charger des interactions de plus bas niveau.</p>
                    <p>Laravel inclut aussi des outils de développement et de débuggage, et bien plus que les bases que nous avons abordées ici. Comme toujours, vous êtes vivement encouragé.e.s de pousser plus loin votre recherche.</p>
                </article>
            <!-- fin de section -->
            </section>
            <footer role="contentinfo">
                <div>
                    <address>
                        Professeurs :
                        <a class="mail" href="mailto:olivier.choquet@vinci.be">Choquet Olivier</a>
                        <a class="mail" href="mailto:driss.vandenheede.techinfo@gmail.com">Vandenheede Driss</a>
                    </address>
                </div>
                <div>
                    <p>Si vous détectez une erreur, une faute d'orthographe, n'hésitez pas à envoyer un mail aux adresses juste à côté avec le nom de la page et l'erreur détectée.</p>
                </div>
                <div id="version">
                    <p>Syllabus HTML</p>
                    <p>Version 5.0</p>
                </div>
            </footer>
        </main>
    </body>
</html>