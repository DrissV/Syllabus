<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="author" content="Choquet Olivier & Vandenheede Driss">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Hébergeur - Suppléments - e-Syllabus HTML5 et CSS3</title>
        <!-- une icône dans la barre du navigateur -->
        <link rel="icon" href="../images/favicon.png" type="image/png">
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <!-- liens d'évitement -->
        <ul class="a11y-nav">
            <li>
                <a href="#container">Passer directement au contenu</a>
            </li>
            <li>
                <a href="#menu">Accéder au menu secondaire de la page</a>
            </li>
            <li>
                <a href="#aside">Accéder aux liens utiles</a>
            </li>
        </ul>
        <!-- bannière et menu -->
        <header role="banner">
            <div class="logoTitle">
                <h1>Cours d'introduction au Web</h1>
                <h2>HTML5 et CSS3</h2>
            </div>
            <nav role="navigation" aria-label="Menu principal de navigation">
                <ul>
                    <li><a href="../index.html">Le cours</a></li>
                    <li><a href="../internet.html">Internet</a></li>
                    <li><a href="../html5.html">HTML5</a></li>
                    <li><a href="../css3.html">CSS3</a></li>
                    <li><a href="../methodologie.html">Méthodologie</a></li>
                    <li><a href="../lexique.html">Lexique</a></li>
                    <li><a href="../supplements.html" class="current">Suppléments</a></li>
                </ul>
            </nav>
        </header>
        <main id="container" role="main" tabindex="-1">
            <div id="menu">
                <nav role="navigation">
                    <ol>
                        <li><a href="../supplements.html">Retour au sommaire</a></li>
                        <li><a href="#intro">Intoduction</a></li>
                        <li><a href="#choix_hebergeur">Le choix de l'hébergeur</a></li>
                    </ol>
                </nav>
                <!-- aside lié à la page et pas à l'article donc pas à l'intérieur de article -->
                <aside id="aside">
                    <p>Liens utiles :</p>
                    <ul>
                        <li><a href="https://www.youtube.com/c/LeDesignerduWeb/videos">Le Designer du web</a></li>
                    </ul>
                </aside>
            </div>
            <section id="mainSection">
                <article>
                    <h1>L'hébergeur et le paramétrage du serveur web :</h1>
                </article>
                <article>
                    <h2 id="intro">Introduction :</h2>
                    <p>Une fois que vous avez conçu votre site le plus accessible et le plus green IT possible, le dernier choix pour sa mise en place est son hébergement. Le choix de l'hébergeur est important pour avoir un site internet numériquement responsable. Il faut également le paramétrer correctement, en particulier pour bien gérer son cache.</p>
                    <h2 id="choix_hebergeur">Le choix de l'hébergergeur :</h2>
                    <h3 id="efficacite_energetique">L'efficacité énergétique :</h3>
                    <p>L'un des premiers éléments évoqués pour un hébergeur vert est son efficacité énergétique, mesurée par la PUE (<span class="em">Power Usage Effectiveness</span> ou indicateur d'efficacité énergétique en français). Le PUE calcule le rapport entre la consommation totale du centre de données et celle des équipements informatiques.</p>
                    <p>L'idéal est d'avoir un PUE valant 1,0. Plus sa valeur est grande moins bonne est l'efficacité énergétique du centre de données. Cet indicateur permet de mettre en évidence l'énergie utilisée par la climatisation, les ondulateurs, la filtration de l'air, la conversion du courant... À l'heure actuelle, la valeur moyenne des PUE des centres de données est d'environ 1,6.</p>
                    <p>Les hébergeurs ne publient pas systématiquement leur PUE. Généralement, s'ils ne le font pas, ce n'est pas bon signe : c'est qu'ils consomment encore beaucoup d'énergie en utilisant la climatisation (très énergivore) plutôt qu'une source naturelle de rafraîchissement (<span class="em">free-cooling</span> à air ou à eau).</p>
                    <p>Voici quelques exemples d'hébergeurs publiant de très bons PUE :</p>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th>Hébergeur</th>
                                <th>PUE</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Neural Hosting</td>
                                <td>1,06</td>
                            </tr>
                            <tr>
                                <td>OVH</td>
                                <td>1,09</td>
                            </tr>
                            <tr>
                                <td>Informaniak</td>
                                <td>1,10</td>
                            </tr>
                            <tr>
                                <td>Ex2</td>
                                <td>1,10</td>
                            </tr>
                        </tbody>
                    </table>
                    <p>Il existe la certification ISO 50 001 permettant d'attester de la performance énergétique. Le français Octup et le suisse Infomaniak possèdent cette certification par exemple.</p>
                    <h3 id="sources_approvisionnemen_electrique">Les sources d'approvisionnement électrique :</h3>
                    <p>Un certain nombre d'hébergeurs indiquent qu'ils utilisent des énergies vertes. À nouveau, les informations sont plus ou moins précises. Par exemple, le canadien Planet Hoster indique utiliser 100% d'électricité hydraulique alors que le français Neural Hosting affiche "électricité verte" sans plus de précisions... Il est important que ces informations soient prouvées à l'aide de certificats.</p>
                    <h3 id="compensation_carbone">La compensation carbone :</h3>
                    <p>Les hébergeurs les plus vertueux compensent leurs émissions de CO<sub>2</sub>. Il faut alors être attentif à l'inclusion de l'ensemble des émissions de l'entreprise (fabrication, acheminement et recyclage du matériel, déplacements professionnels des collaborateurs, production d'énergie...). À titre d'exemple, Infomaniak compense à 200% ses émissions de CO<sub>2</sub>.</p>
                    <h3 id="recuperation_chaleur_degagee">La récupération de la chaleur dégagée :</h3>
                    <p>Les serveurs produisent de la chaleur. Un certain nombre de centres de données valorisent cette chaleur. Par exemple, Neutral Hosting s'en sert pour chauffer en partie la piscine de la Butte-aux-Cailles à Paris ou des bâtiments résidentiels dans d'autres grandes villes où il est implémenté.</p>
                    <h3 id="politique_achat">La politique d'achat :</h3>
                    <p>Le choix du matériel peut avoir des impacts importants. Certains serveurs supportent des températures plus élevées et nécessitent unn refroidissement moins important, donc moins énergivore. Le choix de processeurs de faible voltage permet d'économiser de l'énergie. Cela peut sembler paradoxal, mais mathématiquement cela dégrade le score du PUE. C'est pourquoi il est important de prendre en compte les autres critères de cette section.</p>
                    <h3 id="politique_renouvellement_materiel">La politique de renouvellement du matériel :</h3>
                    <p>Nous avons vu que beaucoup d'impacts écologiques proviennent de la production et de la destruction du matériel. Il est donc important de connaître les engagements des hébergeurs en la matière. Il est difficile de trouver des engagements écrits. Neutral Hosting indique qu'il utilise la technique d'immersion liquide de ses serveurs afin d'augmenter leur durée de vie en plus de réduire le bruit généré et de les refroidir efficacement. Infomaniak indique dans sa charte qu'il s'engage à conserver ses serveurs pour une durée minimale de cinq ans et qu'ensuite ils sont réutilisés en interne.</p>
                    <p>Il est également important de connaître les engagements des hébergeurs en matière de gestion de leurs déchets d'équipemnts électriques et électroniques (DEEE).</p>
                    <h3 id="localisation">La localisation :</h3>
                    <p>Pour gagner en performance et pour moins solliciter le réseau, il est judicieux de choisir un hébergeur proche de la localisation de la majorité des visiteurs du site. Par exemple, un site internet d'une association locale nantaise est principalement visité par des internautes de la région de Nantes. Il est donc pertinent d'héberger ce site dans un centre de données nantais. Au contraire, une entreprise ayant des visiteurs répartis dans l'ensemble de l'Europe choisira un hébergeur ayant son centre de données au coeur de l'Europe.</p>
                    <h3 id="respect_donnees">Le respect des données :</h3>
                    <p>Suivant le pays hébergeant les données, la législation en vigueur n'est pas la même. Dans l'Union Européenne (UE), le Règlement Général sur la Protection des Données (RGPD) prévaut; en Suisse, c'est la Loi fédérale sur la Protection des Données (LPD); aux États-Unis ou avec une entreprise américaine, c'est le Patriot Act qui s'applique. Les données personnelles sont alors moins bien protégées.</p>
                    <h3 id="hebergeurs_independants">Les hébergeurs indépendants :</h3>
                    <p>Outre confier votre site à un hébergeur pour qu'il l'installe dans son centre de données, vous pouvez héberger votre site sur une simple machine ayant une bonne connexion à Internet.</p>
                    <p>Le collectif CHATONS (collectif des hébergeurs alternatifs, transparents, neutres et solidaires) propose des solutions alternatives aux géants du Web, tels des hébergements gratuits pour des sites d'associations, d'initiatives citoyennes, d'activités artistiques, promouvant les solutions libres...</p>
                    <figure>
                        <img src="../images/logo_chatons.png" alt="">
                        <figcaption>Logo du collectif CHATONS</figcaption>
                    </figure>
                    <p>Enfin, certaines personnes ont même un site internet fonctionnant sur un Rasperry Pi alimenté par un panneau solaire ! C'est par exemple le cas de <a href="https://solar.lowtechmagazine.com" target="_blank">Low&#8594;Techmagazine</a>. Son site est à Barcelone, il profite donc d'un bon ensoleillement, et si le batteries alimentées par les panneaux solaires sont épuisées, le site n'est pas disponible ! Mais est-il nécessaire que le site doit accessible à tout moment du jour et de la nuit ?</p>
                    <h3 id="comparatifs">Les comparatifs :</h3>
                    <p>Il est possible de comparer les engagements des uns et des autres sur leurs sites internet. Les hébergeurs ont généralement une page dédiée pour expliquer leurs engagements pour être plus verts.</p>
                    <table class="tableBalises">
                        <caption class="souligne">Exemples (par ordre alphabétique) :</caption>
                        <thead>
                            <tr>
                                <th>Hébergeur</th>
                                <th>Page</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Ex2</td>
                                <td><a href="https://www.ex2.com/hosting/green-hosting" target="_blank">https://www.ex2.com/hosting/green-hosting</a></td>
                            </tr>
                            <tr>
                                <td>HostPapa</td>
                                <td><a href="https://www.hostpapa.fr/hebergement-web-vert/" target="_blank">https://www.hostpapa.fr/hebergement-web-vert/</a></td>
                            </tr>
                            <tr>
                                <td>Infomaniak</td>
                                <td><a href="https://www.infomaniak.com/fr/hebergeur-ecologique/charte-ecologique" target="_blank">https://www.infomaniak.com/fr/hebergeur-ecologique/charte-ecologique</a></td>
                            </tr>
                            <tr>
                                <td>Neutral Hosting</td>
                                <td><a href="https://neutral.hosting" target="_blank">https://neutral.hosting</a></td>
                            </tr>
                            <tr>
                                <td>OVHcloud</td>
                                <td><a href="https://www.ovh.com/fr/manifesto.xml#watercooling" target="_blank">https://www.ovh.com/fr/manifesto.xml#watercooling</a></td>
                            </tr>
                            <tr>
                                <td>PlanetHoster</td>
                                <td><a href="https://www.planethoster.com/fr/Hebergement-Vert">https://www.planethoster.com/fr/Hebergement-Vert</a></td>
                            </tr>
                        </tbody>
                    </table>
                    <p>Le site Zei (Zéro éco impact) cherche à comparer l'engagement dans la transition écologique des entreprises. Il propose entre autres un comparatif des hébergeurs. Pour le moment, il n'y a que peu d'hébergeurs comparés, mais il faut espérer qu'ils seront de plus en plus nombreux.</p>
                    <h2 id="parametrage_serveur">Le paramétrage du serveur :</h2>
                    <h3 id="certificat_ssl">Le certificat SSL :</h3>
                    <p>Pour la sécurisation du site, il est important de mettre en place un certificat SSL afin d'utiliser le protocole HTTPS. Pour les serveurs mutualisés, certains hébergeurs le proposent d'office; chez d'autres hébergeurs, il faut cocher une case pour l'activer.</p>
                    <h4 id="mise_en_place_serveur_dedie">La mise en place sur un serveur dédié :</h4>
                    <p>Pour les serveurs dédiés, il est nécessaire que vous génériez le certificat SSL vous-même. Vous devez obtenir un certificat SSL d'une autorité de certification. La bonne nouvelle, c'est que l'autorité de certification <span class="em">Let's Encrypt</span> vous propose d'en générer un gratuitement.</p>
                    <ul>
                        <li>Rendez-vous sur le site <a href="https://letsencrypt.org/fr" target="_blank">https://letsencrypt.org/fr</a> et cliquez sur <span class="em">Commencer</span>.</li>
                        <li>
                            <p>Vous arrivez sur une page de présentation qui vous indique d'utiliser Certbot. Pour cela, cliquez sur le lien puis choisissez votre serveur web (Apache, par exemple), puis la distribution de votre serveur (Debian 10, par exemple).</p>
                            <img src="../images/certbot.png" alt="page de Certbot avec formulaire rempli avec Apache et Debian 10">
                        </li>
                        <li>Ensuite, suivez les instructions qui ont été générées en fonction de votre situation.</li>
                    </ul>
                    <h4 id="obligation_passer_https">L'obligation de passer par HTTPS :</h4>
                    <p>Une fois votre site disponible en HTTPS, il est intéressant d'imposer à vos visiteurs d'utiliser cette communication sécurisée. Pour cela, il est possible de rediriger toute demande faite en HTTP vers la même en HTTPS. Cela se réalise avec les lignes suivantes à positionner dans votre configuration d'Apache soit dans le fichier principal de configuration, soit dans un fichier <span class="html">.htaccess</span> à la racine de votre site :</p>
<pre class="taille60"><code>RewriteEngine On
RewriteCond % {HTTPS} off
Rewrite (.*) https://%{HTTP_HOST}%{REQUEST_URI} {R=301,L}
&lt;IfModule mod_headers.c&gt;
    Header always set Strict-Transport-Security "max-age=31536000"; includeSubDomains; preload"
&lt;/IfModule&gt;</code></pre>
                    <p>Ces lignes font une redirection en utilisant la réécriture d'URL et ajoutet l'en-tête de la requête l'utilisation systématique. HSTS (<span class="em">HTTP Strict Transport Security</span>) pour refuser toute requête en HTTP.</p>
                    <h3 id="cache">Le cache :</h3>
                    <p>Le cache est un très bon moyen pour optimiser un site internet et ainsi réduire son empreinte environnementale. Il existe plusieurs niveaux de cache.</p>
                    <h4 id="cache_navigateur">Le cache du navigateur :</h4>
                    <p>Lorsqu'un visiteur navigue pour la première fois sur un site, il charge tous les éléments pour afficher une première page internet (page HTML, feuilles de style CSS, scripts JavaScript, images...). Tous ces éléments sont conservés en cache un certain temps. Ainsi, s'il navigue sur une autre page du site, il n'a pas besoin de tous les fichiers, mais seulement de ceux qu'il ne possède pas. Si vpis avez le logo de votre entreprise sur toutes vos pages, une feuille de style, etc. ces éléments ne sont pas téléchargés à nouveau. Si l'internaute revient sur une page déjà visitée, normalement aucune ressource n'est envoyée depuis le serveur, ce qui permet de le soulager et de moins solliciter le réseau.</p>
                    <p>Pour indiquer le temps pendant lequel le navigateur doit utiliser la ressource en cache, plutôt que de le redemander au serveur, il est nécessaire de préciser dans l'en-tête HTTP <span class="html">Cache-Control: max-age=tempsEnSecondes, public</span>. En configurant Apache, il est possible de lui faire intégrer cette information dans ses réponses. Il faut le faire dans le fichier principal de configuration ou dans un fichier <span class="html">.htaccess</span> à la racine du site.</p>
                    <p class="souligne">Syntaxe :</p>
<pre class="taille60"><code>&lt;filesMatch "filtreFichier"&gt;
    Header set Cache-Control "max-age=tempsEnSecondes, public"
&lt;/filesMatch&gt;</code></pre>
                    <p>La chaîne de caractères <span class="em">filtreFichier</span> est une expression rationnelle PCRE.</p>
                    <p>Il est possible parexemple de conserver en cache les pages, les scripts et les feuilles de style pendant 10 jours (864000 secondes) et les images pendant 1 an (31536000 secondes).</p>
<pre class="taille60"><code>&lt;filesMatch ".(css|js|html)$"&gt;
    Header set Cache-Control "max-age=864000, public"
&lt;/filesMatch&gt;
&lt;filesMatch ".(ico|webp|png|gif|svg|avif|jpg)$&gt;
    Header set Cache-Control "max-age=315536000, public"
&lt;/filesMatch&gt;</code></pre>
                    <p>Pour vérifier le bon fonctionnement, il faut se rendre pour la première fois sur l'une des pages du site et visualiser la réponse à la requête HTTP envoyée dans les outls du développeur.</p>
<pre class="taille60"><code>HTTP/1.1 200 OK
Date: Sun, 25 Jul 2021 12:58:29 GMT
Server: Apache/2.4.43 (Win64) OpenSSL/1.1.1g PHP/7.4.7
Last-Modified: Sun, 25 Jul 2021 12:58:27 GMT
ETag: "712-5c7f23156590a"
Accept-Ranges: bytes
Content-Length: 1810
<span class="html">Cache-Control: max-age=86400, public</span>
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html</code></pre>
                    <p>L'en-tête contient bien la ligne <span class="em">Cache-Control</span>.</p>
                    <p>Si nous actualisons la page, nous obtenons un code 304 indiquant que la page est celle récupérée en cache :</p>
<pre class="taille60"><code>HTTP/1.1 <span class="html">304 Not Modified</span>
Date: Sun, 25 Jul 2021 13:02:32 GMT
Server: Apache/2.4.43 (Win64) OpenSSL/1.1.1g PHP/7.4.7
Last-Modified: Sun, 25 Jul 2021 12:58:27 GMT
Connection: Keep-Alive
Keep-Alive: timeout=5, max=100
ETag: "712-5c7f23156590a"
Cache-Control: max-age=86400, public</code></pre>
                    <p>Lorsque la ressource demandée est en cache, mais qu'elle a expiré, une requête est envoyée au serveur pour savoir si elle est encore vlable, avec comme en-tête :</p>
<pre class="taille60"><code>If-Modified_Since: datDuFichierEnCache</code></pre>
                    <p>Si la ressource n'a pas changé, le serveur renvoie le code 304 afin que la ressource en cache soit utilisée. Sinon, la nouvelle version de la ressource est envoyée avec un code 200.</p>
                    <h4 id="cache_serveur_web">Le cache du serveur web :</h4>
                    <p>Le serveur Apache peut conserver également le résultat de l'exécution de code PHP pour éviter de les réexécuter à chaque fois. Cela peut être réalisé en configurant Apache avec les lignes suivantes :</p>
<pre class="taille60"><code>CacheEnable mem répertoireDuCahe
MCacheSize tailleDuCacheEnOctets
MCacheMaxObjectCount nombreDElementsEnCache
MCacheMinObjectSize tailleMinimale
MCacheMaxObjectSize tailleMaximale</code></pre>
                    <p class="souligne">Exemple :</p>
<pre class="taille60"><code>CacheEnable mem /cache
MCacheSize 100000000
MCacheMaxObjectCount 1000
MCacheMinObjectSize 100
MCacheMaxObjectSize 1000000</code></pre>
                    <p>Ainsi, si plusieurs internautes demandent successivement une même page générée dynamiquement en PHP, elle est générée pour être envoyée au premier et mise en cache sur le serveur et le second reçoit la page stockée dans le cache. Cette technique est particulièrement intéressante si toutes les pages sont générées dynamiquement à l'aide d'un modèle de page.</p>
                    <h4 id="cache_php">Le cache de PHP :</h4>
                    <p>La génération et l'envoi d'une page dynamique sont plus coûteux que l'envoi d'une page statique directement. C'est pourquoi, afin d'accélérer le rendu des pages dynamiques, le code PHP qui a déjà été analysé et transformé en langage intermédiaire (OPcode) est sauvegardé en cache avec OPcache pour éviter de refaire ces étapes. Jusqu'à la version 5.4 de PHP, il était nécessaire d'effectuer des étapes de configuration pour mettre en place OPcache. Depuis PHP 5.5, l'OPcache est installé et activé par défaut. IL n'y a donc rien à faire si vous utilisez une version récente de PHP.</p>
                    <h4 id="cache_serveur_base_de_donnees">Le cache du serveur de base de données :</h4>
                    <p>Il est également possible d'utiliser un cache pour les requêtes fréquemment envoyées au serveur de base de données. Il faut utiliser un produit supplémentaire tel que la solution open source Redis. Si les autres niveaux de cache ont été correctement mis en place, ce cache n'est nécessaire que sur un site internet sollicitant beaucoup la base de données.</p>
                    <h2 id="etude_cas_pratique">L'étude d'un cas pratique :</h2>
                    <h3 id="hebergement">L'hébergement :</h3>
                    <p>Pour héberger le site internet associé au livre de référence de ce syllabus, ils ont choisi <a href="https://zici.fr" target="_blank">un des membres du collectif CHATTONS</a>. Le serveur est installé chez un particulier, donc sans climitation ni aucun autre système énergivore. Son PUE doit donc être extrêmementt proche de 1. Il est localisé à Nantes, vu que le lotorat du livre se situe principalement en France ou dans les pays francophones limirophes, et plus minitoritairement au Québec ou en Afrique, voire dans autres pays du monde... Le serveur est une machine qualifiée de "normale, constituée du fond de tiroir" par son propriétaire. Nous sommes bien dans la réutilisation du matériel ! Enfin, il propose tous les services nécessaires pour le site : la possibilité d'utiliser un certificat SSL de Lt's Encrypt, PHP en version 7.4 et des fichiers <span class="em">.htaccess</span>.</p>
                    <p>Remarque : Nous profitons de cette section pour remercier chaleureusement David Mercereau, le propriétaire de Zici.fr, d'héberger le site du livre.</p>
                    <h3 id="parametrage">Le paramétrage :</h3>
                    <p>Le protocole HTTPS a été mis en place comme indiqué précédemment. Enfin, les caches au niveau navigateur et serveur ont également été mis en place.</p>
                </article>
            <!-- fin de section -->
            </section>
        </main>
        <footer role="contentinfo">
            <div>
                <address>
                    Professeurs :
                    <a class="mail" href="mailto:olivier.choquet@vinci.be">Choquet Olivier</a>
                    <a class="mail" href="mailto:driss.vandenheede.techinfo@gmail.com">Vandenheede Driss</a>
                </address>
            </div>
            <div>
                <p>Si vous détectez une erreur, une faute d'orthographe, n'hésitez pas à envoyer un mail aux adresses juste à côté avec le nom de la page et l'erreur détectée.</p>
            </div>
            <div id="version">
                <p>Syllabus HTML</p>
                <p>Version 5.0</p>
            </div>
        </footer>
    </body>
</html>