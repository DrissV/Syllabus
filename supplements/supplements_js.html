<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="author" content="Choquet Olivier & Vandenheede Driss">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>JavaScript, jQuery, AJAX et JSON - Suppléments - e-Syllabus HTML5 et CSS3</title>
        <!-- une icône dans la barre du navigateur -->
        <link rel="icon" href="../images/favicon.png" type="image/png">
        <link rel="stylesheet" href="../style.css">
    </head>
    <body>
        <!-- liens d'évitement -->
        <ul class="a11y-nav">
            <li>
                <a href="#container">Passer directement au contenu</a>
            </li>
            <li>
                <a href="#menu">Accéder au menu secondaire de la page</a>
            </li>
            <li>
                <a href="#aside">Accéder aux liens utiles</a>
            </li>
        </ul>
        
        <!-- bannière et menu -->
        <header role="banner">
            <div class="logoTitle">
                <h1>Cours d'introduction au Web</h1>
                <h2>HTML5 et CSS3</h2>
            </div>
            <nav role="navigation" aria-label="Menu principal de navigation">
                <ul>
                    <li><a href="../index.html">Le cours</a></li>
                    <li><a href="../internet.html">Internet</a></li>
                    <li><a href="../html5.html">HTML5</a></li>
                    <li><a href="../css3.html">CSS3</a></li>
                    <li><a href="../methodologie.html">Méthodologie</a></li>
                    <li><a href="../lexique.html">Lexique</a></li>
                    <li><a href="../supplements.html" class="current">Suppléments</a></li>
                </ul>
            </nav>
        </header>

        <div id="menu">
            <nav role="navigation" aria-label="Menu secondaire">
                <ol>
                    <li><a href="../supplements.html">Retour au sommaire</a></li>
                    <li><a href="#intro_js">Introduction à JavaScript</a></li>
                    <li><a href="#elements_syntaxe_js">Éléments de syntaxe JS</a></li>
                    <li><a href="#validation_formulaire_js">Validation de formulaire JS</a></li>
                    <li><a href="#gestion_cookies">Gestion des cookies</a></li>
                    <li><a href="#dom">Le DOM</a></li>
                    <li><a href="#decouplage_html_js">Découplage HTML/JS</a></li>
                    <li><a href="#jquery">jQuery</a></li>
                    <li><a href="#syntaxe_jquery">Syntaxe de jQuery</a></li>
                    <li><a href="#evenements_jquery">Les événements en jQuery</a></li>
                    <li><a href="#methodes_jquery">Les méthodes de jQuery</a></li>
                    <li><a href="#validation_formulaire_jquery">Validation de formulaire en jQuery</a></li>
                    <li><a href="#ajax">AJAX</a></li>
                    <li><a href="#objets_js">Les objets JavaScript</a></li>
                    <li><a href="#oo_js">Orienté Objet en JavaScript</a></li>
                    <li><a href="#intro_json">JSON</a></li>
                    <li><a href="#http_servlet">HTTPServlet</a></li>
                    <li><a href="#authentification">Authentification, Session et JWT</a></li>
                    <li><a href="#exercices">Exercices</a></li>
                    <li><a href="#typescript">TypeScript</a></li>
                </ol>
            </nav>
            
            <!-- aside lié à la page et pas à l'article donc pas à l'intérieur de article -->
            <aside id="aside" role="complementary">
                <p>Liens utiles :</p>
                <ul>
                    <li><a href="http://www.w3schools.com/js/default.asp" target="_blank">Tutoriel JavaScript de W3Schools</a></li>
                    <li><a href="http://www.w3.org/" target="_blank">W3C</a></li>
                    <li><a href="http://fr.openclassrooms.com/informatique/cours/apprenez-a-creer-votre-site-web-avec-html5-et-css3" target="_blank">Open Classroom</a></li>
                    <li><a href="http://www.w3.org/TR/html5/" target="_blank">Norme HTML5</a></li>
                    <li><a href="http://www.w3schools.com/" target="_blank">W3Schools</a></li>
                    <li><a href="http://www.alsacreations.com/" target="_blank">Alsa Création</a></li>
                    <li><a href="https://www.youtube.com/c/LeDesignerduWeb/videos">Le Designer du web</a></li>
                </ul>
            </aside>
        </div>

        <main id="container" role="main" tabindex="-1">
            <section id="mainSection">
                <article>
                    <h1>JavaScript, jQuery, AJAX et JSON :</h1>
                    <p>Le JavaScript est un langage vaguement inspiré de la famille des langages C (comme Java, C++, Objective-C, ...).</p>
                </article>
                <article>
                    <h2 id="intro_js">Introduction à JavaScript :</h2>
                    <p><span class="em">JavaScript</span> est un langage de scripts essentiellement utilisé pour enrichir les pages HTML de code exécutable par le navigateur. Attention ! Il n' a guère qu'une partie de son nom en commun avec le langage Java ! L'utilisation de JavaScript s'étend de plus en olus vers de nouvelles cibles comme la programmation sur le serveur. Nous ne prendrons en compte ici que son utilisation pour les navigateurs.</p>
                    <p>Ce langage permet d'apporter du dynamisme au niveau des pagesWeb. Nous percevons immédiatement une contradiction entre le fait qu'un navigateur doive essentiemment se contenter de réaliser l'affichage de pages et celui de lui faire exécuter du code. On veillera donc à limiter au maximum l'utilisation de code JavaScript pour :</p>
                    <ul>
                        <li>éviter d'alourdir les documents HTML</li>
                        <li>faciliter leur maintenance</li>
                        <li>ne pas surcharger de traitements les postes de travail</li>
                    </ul>
                    <p>Veillons aussi à produire des pages qui pourront être exploitées sur un maximum de types de navigateurs en n'oubliant pas que cerains d'entre eux n'intègrent pas JavaScript (exemple : certains browsers de smartphones) et que certains utilisateurs inhibent JavaScript.</p>
                    <p>JavaScript est le premier outil nous permettant de faire évoluer un navigateur de la notion de "client léger" à celle de "client riche".</p>
                    <p>De manière générale, JavaScript est utilise pour :</p>
                    <ul>
                        <li>Permettre de réaliser des validations de données saisies dans des formulaires.</li>
                        <li>Pour gérer les cookies.</li>
                        <li>Pour éviter d'augmenter inutilement le nombre de requêtes soumises au serveur Web.</li>
                        <li>Il est peut aussi permettre d'enrichir la présentation de la page (menus dynamiques par exemple).</li>
                    </ul>
                    <p>Il peut aussi être utilisé pour faire clignoter une guirlande, faire traverser l'écran par un canard ou demander à un poisson de suivre votre souris (comme quoi il faut savoir ne pas abuser des bonnes choses, ...).</p>
                    <h3 id="integration_au_HTML_js">Intégration au HTML :</h3>
                    <p>Un script JavaScript sera fourni dans la balise <span class="em">script</span> avec l'attribut <span class="em">type</span> de valeur <span class="em">text/JavaScript</span>. Il existe également une version plus complexe tenant compte des vieux navigateurs qui ne gèrent pas le JavaScript. En HTML5, on déconseille de spécifier explicitement le type s'il s'agit de <span class="em">text/JavaScript</span> : <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script" target="_blank">https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script</a>.</p>
                    <p>Soit direment dans le code HTML :</p>
<pre><code>&lt;script type="text/JavaScript"&gt;
    // code du script...
&lt;/script&gt;</code></pre>
                    <p>Soit par référence à un fichier externe :</p>
                    <p class="html">&lt;script type="text/JavaScript" src="scriptname.js"&gt;&lt;/script&gt;</p>
                    <p>On préfèrera cette deuxième option par souci de lisibilité du code.</p>
                    <h3 id="declenchement_code_js">Déclenchement du code :</h3>
                    <p>Une balise <span class="em">&lt;script type="text/JavaScript"&gt;</span> peut apparaîtra soit dans le <span class="em">head</span> de la page, soit dans le <span class="em">body</span>. Le chargement du fichier de script JavaScript interrompt celui du fichier HTML. Tous les scripts invoqués dans le fichier JavaScript sont immédiatement exécutés lors du chargement dudit fichier.</p>
                    <h3 id="elements_syntaxe_js">Quelques éléments de syntaxe de JavaScript</h3>
                    <ul>
                        <li>
                            <p>Une instruction JS ("statement") se compose de :</p>
                            <ul>
                                <li>Expressions</li>
                                <li>Valeurs</li>
                                <li>Opérateurs (+, -, ...)</li>
                                <li>Mots clés (for, break, ...)</li>
                                <li>Commentaires</li>
                            </ul>
                        </li>
                        <li>Les instructions sont délimitées par le point-virgule mais celui-ci n'est obligatoire que si l'on désire reprendre plusieurs instructions sur la même ligne.</li>
                        <li>Les commentaires sont repris, sur une ligne derrière les caractères <span class="em">//</span>.</li>
                        <li>Les noms de variables sont sensibles à la casse. Il est possible également d'utiliser directement une variable sans utiliser <span class="em">let</span> (portée associée à un bloc), <span class="em">var</span> (portée globale) ou <span class="em">const</span> (portée associée à un bloc et immuable (la valeur ne peut pas être changée) !</li>
                        <li>Les instructions de contrôle de séquence (<span class="html">if</span>, <span class="html">while</span>, ...) sont sensiblement les mêmes qu'en Java.</li>
                    </ul>
                    <p>Dans le cadre de ce cours, nous nous obligerons à respecter la convention suivante :</p>
                    <ul>
                        <li>Toutes les variables seront déclarées !</li>
                        <li>Les variables seront déclarées avec let ou const !</li>
                        <li>Aucune variable sans déclaration !</li>
                        <li>Aucune variable déclarée avec var !</li>
                    </ul>
                    <h4 id="types">Types :</h4>
<pre><code>var i = 1; // Number
var f = 1.0; // Number
var s = "chaîne; // string
var s2 = 'chaîne'; // string
var s3 = new String('chaîne'); // string
var a = [1, 2.0, "3"]; // Array
var b = true; // Boolean
var u; // undefined
var n = null; // null</code></pre>
                    <p>Notez la différence entre undefined (la variable n'a pas été affectée, son type est inconnu) et null (cas particulier des objets).</p>
                    <h4 id="operateur_instanceof">Opérateur instanceof :</h4>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th>instanceof</th>
                                <th>Number</th>
                                <th>String</th>
                                <th>Array</th>
                                <th>Object</th>
                                <th>Booelan</th>
                                <th>Function</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>new Number(1)</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>"a"</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>new String("a")</td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>[1] // Array</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>new Array()</td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>{} // Object</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>new Object()</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>function()</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td></td>
                                <td>X</td>
                            </tr>
                            <tr>
                                <td>true</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>new Boolean(true)</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>X</td>
                                <td>X</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>null</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>undefined</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
<pre><code>var color1 = new String("green");
color1 instanceof String;
// returns true
var color2 = "coral";
color2 instanceof String;
// returns false (color2 is not a String object)</code></pre>
                    <p><span class="em">1</span> et <span class="em">new Number(1)</span> sont fonctionnellement identiques en JavaScript. Cependant, en internce, <span class="em">1</span> correspond à un int Java, tanis que <span class="em">New Number(1)</span> correspond à un Integer. Ceci explique le comportement bizarre d'<span class="html">instanceof</span>.</p>
                    <h4 id="operateur_typeof">Opérateur typeof :</h4>
                    <p>L'opérateur <span class="html">typeof</span> v : renvoie une chaîne de caractères décrivant le type de v.</p>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th></th>
                                <th>typeof</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>"number"</td>
                            </tr>
                            <tr>
                                <td>new Number(1)</td>
                                <td>"object"</td>
                            </tr>
                            <tr>
                                <td>"a"</td>
                                <td>"string"</td>
                            </tr>
                            <tr>
                                <td>new String("a")</td>
                                <td>"object"</td>
                            </tr>
                            <tr>
                                <td>[1] // Array</td>
                                <td>"object"</td>
                            </tr>
                            <tr>
                                <td>new Array()</td>
                                <td>"object"</td>
                            </tr>
                            <tr>
                                <td>{} // Object</td>
                                <td>"object"</td>
                            </tr>
                            <tr>
                                <td>new Object()</td>
                                <td>"object"</td>
                            </tr>
                            <tr>
                                <td>function()</td>
                                <td>"function"</td>
                            </tr>
                            <tr>
                                <td>true</td>
                                <td>"boolean"</td>
                            </tr>
                            <tr>
                                <td>new Boolean(true)</td>
                                <td>"object"</td>
                            </tr>
                            <tr>
                                <td>null</td>
                                <td>"object"</td>
                            </tr>
                            <tr>
                                <td>undefined</td>
                                <td>"undefined"</td>
                            </tr>
                        </tbody>
                    </table>
                    <p>Pour être vraiment certain d'un type (par exemple, String), il faudra donc utiliser <span class="html">typeof</span> et <span class="html">instanceof</span> :</p>
<pre><code>typeof s == 'string' || s instanceof String;</code></pre>
                    <h4 id="typage">À propos du typage :</h4>
                    <ul>
                        <li>Dynamiquement typé == le type de la variable est connu à l'exécution uniquement. Contraire : statiquement typé (ex. : Java).</li>
                        <li>Faiblement typé == la variable contient une certaine valeur qui peut être interprétée suivant plusieurs types. <span class="em">10 == la chaîne 10 == l'entier 10 == le flottant 10.0</span>. Contraire : fotement typé (ex. : Java).</li>
                        <li>Dynamiquement typé != faiblement typé</li>
                    </ul>
                    <p>JavaScript n'est pas faiblement typé mais certains opérateurs se comportent comme si c'était le cas !</p>
                    <p>Un transtypage est alors automatiquement  appliqué.</p>
                    <p>L'opérateur <span class="html">==</span> effectue un tel transtypage. Ceci donne des résultats parfois surprenants. En général, c'est une mauvaise idée de l'utiliser.</p>
                    <img src="../images/J==S.PNG" alt="">
                    <p><span class="html">===</span> est l'opérateur d'égalité qui n'effectue pas de transtypage. En général, c'est celui-ci qui doit vraiment être utilisé, pas <span class="html">==</span>.</p>
                    <p>Idem pour <span class="html">!==</span> et <span class="html">!=</span>.</p>
                    <h3 id="exemple_simple_js">Un exemple simple :</h3>
                    <p>Plaçons ceci dans le body d'un de nos précédents documents HTML :</p>
<pre><code>&lt;script type="text/JavaScript"&gt;
    document.write("Added by JavaScript code : ");
    document.write("He2b-Esi &lt;3");
&lt;/script&gt;</code></pre>
                    <p>Nous pouvons aussi sauvegarder ce script à part dans un fichier <span class="em">Myscript.js</span>, dont la référence relative au document HTML ou sa référence absolue sera fournie dans l'attribut source de l'élément <span class="html">script</span>. Si le fichier se trouve dans le même répertoire que le document HTML, nous pourrons le référencer comme suit :</p>
                    <p class="html">&lt;script type="text/JavaScript" src="MyScript.js"&gt;&lt;/script&gt;</p>
                    <h3>Quelques utilisations classiques :</h3>
                    <h4 id="validation_formulaire_js">Validation de formulaire :</h4>
                    <p>Un cas classique est celui de la validation d'un champ de saisie devant être numérique. Nous allons réaliser la validation lors de la perte du focus par le contrôle (voir <a href="http://www.w3schools.com/tags/ref_eventattributes.asp" target="_blank">http://www.w3schools.com/tags/ref_eventattributes.asp</a> pour une liste des événements gérés).</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;Validation de formulaire&lt;/title&gt;
        &lt;script type="text/JavaScript"&gt;
            function validateNumeric(champ) {
                if (isFinite(champ.value)) {
                    return true;
                } else {
                    alert("Vous ne pouvez entrer que des nombres !");
                    return false;
                }
            }
        &lt;/script&gt;
    &lt;/head&gt;
    
    &lt;body&gt;
            &lt;h1&gt;Validation externe&lt;/h1&gt;
            &lt;form name="InfoPersonnelle"&gt;
                Âge : &lt;input type="text" name="saisie" <span class="html">onblur</span>="validateNumeric"&gt;
            &lt;/form&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <h5>Remarques :</h5>
                    <ul>
                        <li>D'autres événements peuvent vous intéresser <span class="html">onclick</span>, <span class="html">onkeypress</span>, <span class="html">onload</span>, ... En voici la liste complète : <a href="http://www.w3schools.com/jsref/dom_obj_event.asp" target="_blank">http://www.w3schools.com/jsref/dom_obj_event.asp</a>.</li>
                        <li>Par convention, si la méthode associée à l'événement renvoie <span class="em">false</span> (comme dans l'exemple ci-dessusà, cela signifie que l'événement n'a pas eu lieu : la page ne sera pas soumise, le caractère pas rentré, ...</li>
                        <li>Si nous désirons réakuser une validation lors de l'envoi du formulaire nous serons obliger d'écrire un script spécifique au formulaire.</li>
                        <li>Nous verrons par la suite que nous veillerons à éviter l'utilisation des fonctions <span class="html">alert()</span>, <span class="html">confirm()</span>, <span class="html">prompt()</span>, ... qui ont tendance à alourdir l'interface.</li>
                    </ul>
                    <h4 id="gestion_cookies_js">Gestion des cookies :</h4>
                    <p>Un <span class="em">Cookie</span> est un petit fichier texte, chiffré ou non, que des sites visités peuvent stocker sur votre machine pour être récupérés d'une visite à l'autre (pour vous faciliter la navigation, pour vous tracer, ...). Seul le site ayant stocké le cookie y a accès.</p>
                    <p>Un cookie est une paire <span class="em">nom=valeur</span> associé à un serveur et stockée sur le poste client. Lorsque le navigateur envoie une requête à un serveur, il lui envoie également tous les cookies associés.</p>
                    <p>Un cookie possède aussi une date d'expiration. JavaScript permet, via <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie" target="_blank">la propriété cookie du document</a>, de lire et de créer des cookies. La version simplifiée qu'on présente ici peut être prise en défaut dans certains cas particuliers.</p>
<pre><code>function setCookie(nom, valeur) {
    document.cookie = nom + "=" + encodeURI(valeur);
}

function getCookie(nom) {
    // Tous les cookies sont reçus dans une seule chaîne,
    // séparés par des point-virgules, qu'il faut découper.
    start = document.cookie.indexOf(nom + "=");
    if (start != -1) {
        start = start + nom.length + 1;
        end = document.cookie.indexOf(";", start);
        if (end == -1) {
            end = document.cookie.length;
        }
        return unescape(document.cookie.substring(start, end));
    } else {
        return "";
    }
}</code></pre>
                    <h3 id="dom">DOM (Document Object Model) :</h3>
                    <p>Le Document Object Model va nous permettre de manipuler (consulter/modifier) notre page web via le code JavaScript. On va pouvoir, par exemple, ajouter un message d'erreur à côté d'un champ erroné. C'est également un élément essentiel d'Ajax que nous verrons ultérieurement.</p>
                    <p>Le <a href="https://developer.mozilla.org/fr/DOM" class="em">DOM (Document Object Model)</a>, ou modèle objet de document, est une API pour les documents HTML et XML. Le DOM fournitune représentation structurelle du document, permettant de modifier son contenu et sa présentation visuelle. Fondamentalement, il relie les pages Web aux scripts et langages de programmation.</p>
                    <p>Concrètement, cela signifie qu'au niveau de JavaScript on dispose d'une représentation du document HTML sous forme d'un "arbre", chaque "noeud" correspond à une balise du document. Cet arbre peut être parcouru mais surtout modifié. Les possibilités sont énormes mais nous l'utiliserons essentiellement :</p>
                    <ul>
                        <li>Pour faire apparaître des messages d'information ou d'erreurs aux endroits appropriés de la page.</li>
                        <li>Avec la technologie AJAX dont il est une des composantes essentielles.</li>
                    </ul>
                    <h4 id="elements_syntaxe_dom">Quelques éléments de syntaxe</h4>
                    <p>Nous ne présentant que la toute petite partie qui sert à notre propos. Nous en dirons un peu plus lorsque nous introduirons les technologies <span class="em">XSL</span> et, comme d'habitude, vous trouverez plus d'informations sur le site de la W3 Schools (<a href="http://www.w3schools.com/jsref/dom_obj_document.asp" target="_blank">http://www.w3schools.com/jsref/dom_obj_document.asp</a>).</p>
                    <ul>
                        <li>Il existe un certain nombre d'objets prédéfinis. Vous apprendrez à l'usage les méthodes et attributs offerts : document (la racine de l'arbre), window (la fenêtre), ...</li>
                        <li>
                            <p>On peut accéder à un ou des noeuds de l'arbre :</p>
                            <ul>
                                <li><span class="html">getElementById("id")</span> ; le noeud correspondant à cet identifiant unique.</li>
                                <li><span class="html">getElementsByTagName("tag")</span> : un tableau de noeuds porteurs de ce tag.</li>
                                <li><span class="html">querySelector(selecteur CSS)</span> : le premier élément dans la descendance de l'élément appelant la méthode <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/querySelector" target="_blank">querySelector</a> compatible avec le sélecteur CSS en argument.</li>
                            </ul>
                        </li>
                        <li>
                            <p>On peut interroger un noeud via des attributs :</p>
                            <ul>
                                <li>L'attribut <span class="html">innerHTML</span> correspond au code HTML inclus dans un noeud.</li>
                                <li>L'attribut <span class="html">style</span> donne le style associé à un noeud.</li>
                                <li>L'attribut <span class="html">attributes</span> donne les attributs associés à un noeud.</li>
                                <li>Il y a aussi : <span class="html">nodeType</span>, <span class="html">nodeName</span>, <span class="html">nodeValue</span>, ...</li>
                            </ul>
                        </li>
                        <li>On peut, à partir d'un noeud, se promener dans l'arbre : <span class="html">parentNode</span>, <span class="html">childNodes</span>, <span class="html">firstChild</span>, <span class="html">lastChild</span>, <span class="html">nextSibling</span>, <span class="html">previousSibling</span>.</li>
                        <li>On peut aussi modifier l'arbre : <span class="html">createElement</span>, <span class="html">createTextNode</span>, <span class="html">appendChild</span>, <span class="html">insertBefore</span>, <span class="html">replaceChild</span>, <span class="html">cloneNode</span>, <span class="html">removeChild</span>.</li>
                    </ul>
                    <h4 id="exemple_recapitulatif_dom">Exemple récapitulatif :</h4>
                    <p>Si le document contient <span class="html">&lt;span id="titre"&gt;&lt;/span&gt;</span>, alors le bout de code suivant permet d'insérer un titre :</p>
                    <p class="html">document.getElementById("titre").innerHTML = "Compléments Applications";</p>
                    <p>Le code suivant affiche un message avec le nombre de paragraphes (à lancer via l'événement <span class="html">onload</span> de la balise <span class="html">&lt;body&gt;</span> par exemple).</p>
<pre><code>function countParagraphs {
    var myParagraphs = document.getElementsByTagName("p");
    alert(myParagraphs.length);
}</code></pre>
                    <h3 id="decouplage_html_js">Découplage HTML / JavaScript :</h3>
                    <p>Tout comme il est de bonne pratique de découpler le contenu HTML de la mise en forme CSS, en liant le(s) fichier(s) CSS à l'aide de la balise <span class="html">&lt;link&gt;</span>, il est conseillé de séparer HTML et JavaScript à l'aide de l'attribut <span class="em">src</span> de la balise <span class="html">&lt;script&gt;</span>.</p>
                    <p>Par ailleurs, il est également conseillé de découpler fortement les éléments HTML du JavaScript en associant les gestionnaires d'événements dynamiques en JavaScript plutôt que statiquement dans le document HTML.</p>
                    <p>Dans la suite, voyons en détails comment associer une fonction de validation à un champ d'un formulaire, comme cela a été déjà rapidemment montré ci-dessus.</p>
                    <h4 id="js_interne">JavaScript interne :</h4>
                    <p>Reprenons le document HTML avec un script interne :</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;Validation de formulaire&lt;/title&gt;
        &lt;script type="text/JavaScript"&gt;
            function validateNumeric(champ) {
                if (isFinite(champ.value)) {
                    return true;
                } else {
                    alert("Vous ne pouvez entrer que des nombres !");
                    return false;
                }
            }
        &lt;/script&gt;
    &lt;/head&gt;
    
    &lt;body&gt;
            &lt;h1&gt;Validation externe&lt;/h1&gt;
            &lt;form name="InfoPersonnelle"&gt;
                Âge : &lt;input type="text" name="saisie" <span class="html">onblur</span>="validateNumeric"&gt;
            &lt;/form&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                        <h4 id="js_externe">JavaScript externe</h4>
                        <h5 id="association_statique">Association statique :</h5>
                        <p>Le script est déplacé dans un fichier <span class="em">formvalidate.js</span> :</p>
<pre><code>function validateNumeric(champ) {
    if (isFinite(champ.value)) {
        return true;
    } else {
        alert("Vous ne pouvez entrer que des nombres !");
        return false;
    }
}</code></pre>
                    <p>Et le fichier HTML est inchangé à l'exception du lien vers ce script :</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;Validation de formulaire&lt;/title&gt;
        &lt;script type="text/JavaScript" src="formvalidate.js"&gt;&lt;/script&gt;
    &lt;/head&gt;
    
    &lt;body&gt;
            &lt;h1&gt;Validation externe&lt;/h1&gt;
            &lt;form name="InfoPersonnelle"&gt;
                Âge : &lt;input type="text" name="saisie" <span class="html">onblur</span>="validateNumeric"&gt;
            &lt;/form&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <h5 id="association_dynamique">Associaion dynamique :</h5>
                    <p>On cherche à associer dynamiquement un gestionnaire d'événement à un élément HTML. Pour ce faire, on utilise le DOM via JavaScript dans un script <span class="em">association_event.js</span> :</p>
<pre>document.getElementById("age").addEventListener("blur", function(event) {
    validateNumeric(event.target.value);
}</pre>
                    <p>Et on ajoute un lien vers ce script dans le code HTML :</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;Validation de formulaire&lt;/title&gt;
        &lt;script type="text/JavaScript" src="formvalidate.js"&gt;&lt;/script&gt;
    &lt;/head&gt;
    
    &lt;body&gt;
        &lt;h1&gt;Validation externe&lt;/h1&gt;
        &lt;form name="InfoPersonnelle"&gt;
            Âge : &lt;input type="text" name="saisie"&gt;
        &lt;/form&gt;
        
        &lt;script type="text/JavaScript" src="association_event.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Notez qu'on préfère charger les scripts d'association en fin de la balise <span class="html">&lt;body&gt;</span>, puisque le code JavaScript est exécuté dès qu'il est chargé; les éléments HTML doivent donc être présents dans le DOM au moment de l'exécution du code.</p>
                    <h5 id="association_dynamique_defer">Association dynamique avec defer :</h5>
                    <p>Si toutefois on veut charger le script à un autre endroit du code HTML, l'attribut <span class="html">defer</span> permet de reporter le chargement du script après la fin du chargement de la page HTML dans son entièreté. Cet attribut n'est disponible que lorsqu'un script est chargé via l'attribut <span class="html">src</span>.</p>
                    <p>Par exemple, on pourrait avoir un fichier de script unique <span class="em">formvalidate_association_events.js</span> :</p>
<pre>function validateNumeric (champ) {
    if (isFinite(champ.value)) {
        return true;
    } else {
        alert("Vous ne pouvez entrer que des nombres !");
        return false;
    }
}

const ageElement = document.getElementById("age");

ageElement.addEventListener("blur", function(event) {
    validateNumeric(event.target.value);
});<code></code></pre>
                    <p>Qui est chargé dans le <span class="html">head</span> comme suit :</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;Validation de formulaire&lt;/title&gt;
        &lt;script defer type="text/JavaScript" src="formvalidate_association_events.js"&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
            &lt;h1&gt;Validation externe&lt;/h1&gt;
            &lt;form name="InfoPersonnelle"&gt;
                Âge : &lt;input type="text" name="saisie"&gt;
            &lt;/form&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <h5 id="association_dynamique_domcontentloaded">Association dynamique avec l'événement DOMContentLoaded :</h5>
                    <p>L'événment <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/DOMContentLoaded_" target="_blank">DOMContentLoaded</a> est émis lorsque le document HTML est chargé et traité dans son entièreté. On peut donc aussi s'en servir afin d'exécuter du code JavaScript une fois que le document complet est à notre disposition.</p>
                    <p>Notre script devient alors :</p>
<pre>function validateNumeric (champ) {
    if (isFinite(champ.value)) {
        return true;
    } else {
        alert("Vous ne pouvez entrer que des nombres !");
        return false;
    }
}

document.addEventListener("DOMContentLoaded", function() {
    const ageElement = document.getElementById("age");

    ageElement.addEventListener("blur", function(event) {
        validateNumeric(event.target.value);
    });
});<code></code></pre>
                    <p>Qui est chargé dans le <span class="html">head</span> comme suit :</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;Validation de formulaire&lt;/title&gt;
        &lt;script type="text/JavaScript" src="formvalidate_association_DOMContentLoaded.js"&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
            &lt;h1&gt;Validation externe&lt;/h1&gt;
            &lt;form name="InfoPersonnelle"&gt;
                Âge : &lt;input type="text" name="saisie"&gt;
            &lt;/form&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <h5>Conclusion :</h5>
                    <p>La méthode recommandée est celle qui utilise l'attribut <span class="html">defer</span> de la balise <span class="html">&lt;script&gt;</span>. Elle est en effet :</p>
                    <ul>
                        <li>Propre : le HTL et le JavaScript sont séparés car <span class="html">defer</span> oblige à utiliser l'attribut <span class="html">src</span>.</li>
                        <li>Lisible: les balises <span class="html">&lt;script&gt;</span> sont rassemblées dans le <span class="html">&lt;head&gt;</span> du HTML.</li>
                        <li>Efficace : la récupération du JavaScript se fait de manière synchrone avec l'analayse du HTML.</li>
                        <li>Sûre : l'exécution des scripts JavaScript a lieu une fois le document HTML complètement construit.</li>
                    </ul>
                    <h2 id="jquery">jQuery :</h2>
                    <p><span class="em">jQuery</span> est une librairie JavaScript qui facilite grandement l'écriture de scripts.</p>
                    <h3 id="intro_jquery">Introduction au jQuery :</h3>
                    <p>JavaScript est parfois lourd à utiliser et impose de reprendre régulièrement le même code, de truffer le code de tests pour s'adapter au navigateur, ... Beaucoup de librairies de scripts permettent d'alléger ou éliminer ces défauts : jQuery, Mootools, Dojo, ...</p>
                    <p>jQuery est certainement la plus répondue et <a href="http://w3techs.com/technologies/details/js-jquery/all/all" target="_blank">un grand nombre de firmes majeures du domaine de l'IT</a> l'utilise). Ses fonctionnalités incluent :</p>
                    <ol>
                        <li>Manipulation du DOM.</li>
                        <li>Manipulation du CSS.</li>
                        <li>Gestion des événements.</li>
                        <li>Animations.</li>
                        <li>Ajax (que nous verrons un peu plus tard).</li>
                    </ol>
                    <p>Une référence de jQuery se trouve à l'adresse <a href="https://jquery.com/" target="_blank">https://jquery.com/</a>.</p>
                    <h3 id="utilisation_jquery">Utilisation :</h3>
                    <h4 id="inclusion_jquery">Inclusion de la librairie :</h4>
                    <p>La librairie elle-même doit référencée dans votre page HTML, soit elle doit être fournie par votre site soit être référencée sur un site tiers.</p>
                    <p>Souvent, on utilise un <a href="https://fr.wikipedia.org/wiki/R%E9seau_de_diffusion_de_contenu)" target="_blank">CDN (ou Content Delivery Network)</a> : une infrastructure réseau permettant de fournir vite et sans interruption de service des ressources stables dans le temos, par exemple celui de :</p>
                    <ol>
                        <li><a href="https://code.jquery.com/" target="_blank">jQuery</a></li>
                        <li><a href="https://developers.google.com/speed/libraries#jquery" target="_blank">Google</a></li>
                        <li><a href="https://docs.microsoft.com/en-us/aspnet/ajax/cdn/overview#jQuery_Releases_on_the_CDN_0" target="_blank">Microsoft</a></li>
                    </ol>
                    <p>D'autres CDN peuvent se trouver à l'adresse <a href="https://jquery.com/download/#other-cdns" target="_blank">https://jquery.com/download/#other-cdns</a>. Ces CDN ont l'avantage d'être utilisés par tellement de sites que les clients de nos pages risquent d'avoir déjà la librairie en mémoire cache (et ne doivent donc pas le re-télécharger). En outre, même si la librairie n'est pas en cache, son téléchargement par l'utilisateur n'utilisera de toute façon pas la bande passante de notre site.</p>
                    <p>On inclut cette librairie comme tout autre script JavaScript, donc :</p>
                    <p class="html">&lt;script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HdCJo=" crossorigin="anonymous"&gt;&lt;/script&gt;</p>
                    <p>Ou plus simplement :</p>
                    <p class="html">&lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"&gt;&lt;/script&gt;</p>
                    <p>Ces librairies sont condensées (<span class="em">minified</span> en anglais, représenté dans le nom du fichier par <span class="em">.min</span> pour minimiser le trafic réseau, donc quasiment illisibles (on parle de version de "production"). Nous pouvons accéder à la librairie "lisible à l'adresse <a href="https://code.jquery.com/jquery-3.4.1.js" target="_blank">https://code.jquery.com/jquery-3.4.1.js</a>. Cette version est généralement utilisée pour le développement, elle nous permettra de vérifier qu'il s'agit bien d'un "gros" fichier de fonctions JavaScript.</p>
                    <p>Notons bien sûr que, puisque les scripts JavaScript sont chargés dans leur ordre d'apparition dans le DOM, qu'ilfaudra s'assurer que jQuery est chargé <span class="em">avant</span> nos scripts qui l'utilisent.</p>
                    <h4 id="syntaxe_jquery">Syntaxe de jQuery :</h4>
                    <p>Pour analyser quelques exemples d'utilisations de jQuery, nous utiliserons le fichier suivant :</p>
<pre class="taillle60"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;Exemples d'utilisation de jQuery&lt;/title&gt;
        &lt;script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HdCJo=" crossorigin="anonymous"&gt;&lt;/script&gt;
        &lt;script src="script.js"&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="a"&gt;TODO write content&lt;/div&gt;
        &lt;p&gt;Coucou&lt;/p&gt;
        &lt;p&gt;Bonjour&lt;/p&gt;
        &lt;p&gt;Hello&lt;/p&gt;
    &lt;;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Si le script <span class="em">script.js</span> est vide, l'affichage de la page ressemble à ceci :</p>
                    <div id="a">TODO write content</div>
                    <p>Coucou</p>
                    <p>Bonjour</p>
                    <p>Hello</p>
                    <h5 id="fonction_jquery">La fonction jQuery :</h5>
                    <p>La librairie jQuery propose une seule fonction, <span class="html">jQuery()</span>, qui peut aussi être appelée par son alias, <span class="html">$()</span>. Cette fonction permet de rapidement sélectionner un élément, puis d'appeler d'autres fonctions sur cet élément, sous la forme suivante :</p>
                    <p class="html">$(sélecteur).action(...);</p>
                    <p>Cette sélection se fait via des sélecteurs, qui utilisent la même syntaxe que les sélecteurs CSS.</p>
                    <p>Par exemple, le script suivant demande que l'élément dont l'<span class="em">id</span> est "<span class="em">a</span>" soit remplacé par l'argument  de la <span class="em">méthode <span class="html">html()</span></span>, qui est une des méthodes définies dans jQuery.</p>
<pre><code>$(function() {
    $("#a").html("Je modifie ceci avec jQuery.");
}</code></pre>
                   <h5 id="evenements_jquery">Les événements en jQuery :</h5>
                   <p>La plupart des événements du DOM disposent de leur équivalent en jQuery, généralement avec le même nom. Par exemple, <a href="http://api.jquery.com/click/" target="_blank" class="html">la méthode click()</a> associe à l'élément HTML sélectionné un événement qui se produit lorsque l'utilisateur clique sur cet élément.</p>
                   <p>Ajoutons un événement de ce type à notre script :</p>
<pre><code>$(function() {
    $("#a").html('Je modifie ceci avec jQuery.');
    $("#a").click(function() {
        $(this).hide();
    });
});</code></pre>
                    <p>Au moment où l'élément d'identifiant "<span class="em">a</span>" reçoit un clic de souris, il va maintenant disparaître via la méthode <span class="html">hide()</span>, qui permet de "cacher" l'élément. Le mot-clé <span class="html">this</span> désigne l'élément courant.</p>
                    <p>On notera que la méthode <a href="https://api.jquery.com/on/" target="_blank" class="html">on(event, handler)</a> permet d'ajouter le gestionnaire d'un événement via son nom dans le DOM.</p>
                    <p>Enfin, notons que la méthode <span class="html">jquery()</span> (et son alias <span class="html">$()</span>), si elle reçoit un gestionnaire d'événement en paramètre au lieu d'un sélecteur CSS, sert de raccourci à l'expression :</p>
                    <p class="html">$(document).ready(handler);</p>
                    <p>C'est-à-dire qu'il s'agit de l'événement qui se produit lorsque le DOM a terminé de se charger, qui comme nous l'avons vu permet de s'assurer que nos scripts JavaScript s'exécutent sur la page dans son ensemble.</p>
                    <h5 id="methodes_jquery">Les méthodes de jQuery :</h5>
                    <p>Nous avons déjà vu quelques méthodes qui peuvent être appelées sur un élément une fois qu'il a été sélectionné via jQuery. Il ne sera pas possible d'en voir une liste exhaustive dans le cadre de cours : comme toujours, nous ferons référence à la documentation sur le sujet.</p>
                    <p>Notons toutefois quelques méthodes fréquentes :</p>
                    <ol>
                        <li><a href="https://api.jquery.com/html/#html2" target="_blank" class="html">html(text)</a> permetde modifier le contenu d'un élément HTML (similaire à <span class="html">innerHTML</span> du DOM).</li>
                        <li>
                            <p><a href="https://api.jquery.com/css/" target="_blank" class="html">css()</a> permet d'accéder du style CSSde l'élément. Elle admet plusieurs syntaxes :</p>
                            <ol type="(a)">
                                <li><span class="html">css("background")</span> retourne la valeur de la propriété CSS <span class="em">background</span>.</li>
                                <li><span class="html">css("color", "red")</span> modifie la valeur de la propriété CSS <span class="em">color</span> en <span class="em">red</span>.</li>
                                <li><span class="html">css({"color": "red", "font-stle": "italic"})</span> modifie plusieurs propriétés d'un coup.</li>
                            </ol>
                            <p>Par sourci de séparation des rôles dans nos codes, il est généralement préférable de définir une classe CSS possédant ces propriétés, puis de donner cette classe aux éléments correspondants. De cette façon, toutes les informations destyle restent reléguées au CSS.</p>
                        </li>
                        <li>
                            <p><a href="https://api.jquery.com/attr/" target="_blank" class="html">attr()</a> permet d'accéder à un attribut d'un élément HTML. Par exemple :</p>
                            <ol type="(a)">
                                <li><span class="html">attr("class")</span> retourne la valeur de l'attribut <span class="em">class</span> de l'élément.</li>
                                <li><span class="html">attr("class", "myClass")</span> modifie la valeur de l'attribut <span class="em">class</span> de l'élément en <span class="em">myClass</span>.</li>
                            </ol>
                        </li>
                        <li><a href="https://api.jquery.com/find/" target="_blank" class="html">find()</a> cherche et retourne les éléments descendants correspondants à certains critères, comme un sélecteur ou l'appel à la fonction <span class="html">jQuery()</span>. Dans ce deuxième cas, les éléments retournés par cet appel à <span class="html">jQuery()</span> sont filtrés pour me conserver que ceux qui sont descendants de l'élément sur lequel <span class="html">find()</span> est appelé.</li>
                    </ol>
                    <p>Notons que les méthodes qui <span class="em">modifient</span> un élément HTML (y compris par un ajout de gestionnaire d'événement) renvoient l'élément lui-même en résultat. Cela nous permet d'effectuer du <span class="em">chaînage de méthodes</span>, où l'on appelle des méthodes successivement sans devoir rappeler la fonction <span class="html">jQuery()</span>. Cela nous permet d gagner en efficacité, et d'avoir une écriture plus compacte.</p>
                    <p>Par exemple, nous pouvons modifier notre script précédent :</p>
<pre><code>$(function() {
    $("#a").html('Je modifie ceci avec jQuery.').click(function() {
        $(this).hide();
    });
});</code></pre>
                    <table class="tableBalises">
                        <thead>
                            <tr>
                                <th>Event</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>onclick</td>
                                <td>The event occurs when the user clicks on an element.</td>
                            </tr>
                            <tr>
                                <td>oncontextmenu</td>
                                <td>The event occurs when the user right-clicks on an element to open a context menu.</td>
                            </tr>
                            <tr>
                                <td>ondblclick</td>
                                <td>The event occurs when the user double-clicks on an element.</td>
                            </tr>
                            <tr>
                                <td>omousedown</td>
                                <td> The event occurs when the user presses a mouse button over an element.</td>
                            </tr>
                            <tr>
                                <td>onmouseenter</td>
                                <td>The event occurs when the pointer is moved onto an element.</td>
                            </tr>
                            <tr>
                                <td>onmouseleave</td>
                                <td>The event occurs when the pointer is moved out of an element.</td>
                            </tr>
                            <tr>
                                <td>onmousemove</td>
                                <td>The event occurs when the pointer is moving while it is over an element.</td>
                            </tr>
                            <tr>
                                <td>onmouseover</td>
                                <td>The event occurs when the pointer is moved onto an elemnt or onto one of its children.</td>
                            </tr>
                            <tr>
                                <td>onmouseout</td>
                                <td>The event occurs when a user moves the mouse pointer out of an element, or out of one of its children.</td>
                            </tr>
                            <tr>
                                <td>onmouseup</td>
                                <td>The event occurs when a user releases a mouse button over an element.</td>
                            </tr>
                        </tbody>
                    </table>
                    <h3 id="validation_formulaires_jquery">Validation de formulaires :</h3>
                    <p>Rien n'est prévu à la base de jQuery mais le plugin <a href="https://jqueryvalidation.org/" target="_blank">validate</a> est accessible pour subvenir à nos besoins. Nous devons bien sûr le télécharger :</p>
                    <p class="html">&lt;script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.1/dist/jquery.validate.min.js"&gt;&lt;/script&gt;</p>
                    <p>La validation se fait via la création d'un objet JavaScript dans lequel nous définirons diverses règles que la validation prendra en compte. Nous reviendrons sur la syntaxe des <a href="https://www.w3schools.com/js/js_objects.asp" target="_blank">objets JavaScript</a> lorsque l'on va parler de JSON ci-dessous, mais prenons un exemple :</p>
<pre><code>$("#formId").validate({
    rules: { // gestion des rèfles de validation
        nom: "required", // l'élement de nom "nom" est obligatoire et ne reprend pas d'autre règle
        mail: {
            email: true // l'élement de nom "mail" est un email mais pas obligatoire
        },
        numero: { // numéro obligatoire et compris entre 30000 et 99999
            required: true,
            range: [30000, 99999]
        },
        messages: { // redéfinition desmessages
            nom: "Le nom est obligatoire.",
            mail: {
                email: "Entrez un adresse mail valide."
            },
            numero: {
                required: "Le numéro est obligatoire.",
                range: "Le numéro doit être compris entre {0} et {1}."
            },
            // ...
        }
    }
});</code></pre>
                    <h3 id="animations">Animations :</h3>
                    <p>jQuery permet de réaliser aisément un grand nombre d'<a href="https://api.jquery.com/category/effects/" target="_blank">animations</a>... dont il ne faut bien sûr pas abuser.</p>
                    <p>Prenez le temps de parcourir les quelques exemples présentés par W3Schools à partir de <a href="http://www.w3schools.com/jquery/jquery_hide_show.asp" target="_blank">http://www.w3schools.com/jquery/jquery_hide_show.asp</a>.</p>
                    <p>Un élément à bien comprendre est la notion de <span class="em">callback function</span>.</p>
                </article>
                <article id="ajax">
                    <h2>Ajax :</h2>
                    <h3 id="intro_ajax">Introduction à Ajax :</h3>
                    <p><span class="html">AJAX</span>, nom donné à la mise en oeuvre d'un ensemble de techniques, permet de dynamiser les pages HTML.</p>
                    <p>Avec une page permettant de sélectionner un employé comme ci-dessous :</p>
                    <img src="../images/selection_employe.PNG" alt="Sélectionnez un employé">
                    <p>Dans un site classique, à chaque fois que l'utilisateur choisit un autre département, une requête doit être faite au serveur afin de peupler la liste des employés avec ceux qui correspondent au département demandé. C'est peu efficace, surtout si l'utilisateur revient en arrière et doit dès lors demander une nouvelle liste.</p>
                    <p>Avec <span class="em">AJAX</span>, nous pourrons lancer une requête unique au serveur demandant l'ensemble des employés du département sélectionné et les placer dans la liste déroulante des employés. Généralement, la liste des employés nous sera retournée sous la forme d'un document XML ou JSON.</p>
                    <h3 id="definition_ajax">Définition de AJAX :</h3>
                    <p><span class="em">AJAX</span> signifie <span class="em">Asynchronous JavaScript And Xml</span>. Il ne s'agit pas d'un langage ou d'une librairie, mais d'une démarche permettant de diminuer certaines limitattions imposées aux applications Web par HTTP et HTML.</p>
                    <p>La lacune essentielle des applications Web était leur manque d'intéractivité : toute modification de la page affichée par le navigateur imposait un réaffichage complet.</p>
                    <p>Nous avons déjà aperçu que JavaScript permet d'assouplir ce fait, mais les actions apparaissant dans le navigateur sont réalisées sans aucun contact avec le serveur. Si, par exemple, nous voulons afficher des informations à la demande de l'utilisateur, soit l'ensemble des informations doit être chargé initialement (transfert prohibitif comme l'exemple ci-dessus où le client devrait recevoir tous les départements et tous les employés d!s le premier chargement de la page !), soit la page complète doit être rechargée à chaque action !</p>
                    <p><span class="em">AJAX</span> va nous permettre de nous libérer de ces contraintes. Attention, à nouveau, comme pour JavaScript, il s'agira de ne pas abuser de cette démarche pour ne pas rendre nos pages trop complexes à concevoir et surtout à maintenir. En partier, <span class="em">la logique métier doit rester sur le serveur !</span></p>
                    <p>En reprenant l'acronyme complet, les caractéristiques d'<span class="em">AJAX</span> sont :</p>
                    <ol>
                        <li>Il est <span class="em">Asynchrone</span> : Le client va pouvoir parler au serveur en mode asynchrone. Il demande des informations au serveur et continue son travail. Lorsque la réponse du serveur est prête, un code précédemment spécifié est appelé pour la traiter.</li>
                        <li>Il utilise <span class="em">JavaScript</span> : Du côté client, c'est généralment ce langage qui est utilisé. JavaScript a longtemps été décrié car peu compatible d'un navigateur à l'autre, créant des problèmes de sécurité et finalement essentiellement utilisé pour de futiles effets graphiques. À tel point que les nvaigateurs permettent d'empêcher l'utilisation de JavaScript. Depuis la compatibilité s'est accrue et, surtout, on s'est rendu compte, qu'au-delà des gadgets, il pouvait apporter un réel confort d'utilisation.</li>
                        <li>Il utilise aussi <span class="em">XML</span>, en tant que format utilisé par le serveur pour transmettre des informations au client. C'est parfois également fait avec HTML (rarement, car limité) ou JSON (que nous verrons un plus tard).</li>
                    </ol>
                    <h3 id="mise_en_oeuvre_ajax">Mise en oeuvre :</h3>
                    <p>Nous ne réaliserons réellement ceci que plus tard quand nous programmerons une application web, car les exemples ci-dessus sont prévus pour le protocole <span class="em">http(s)</span> et pas pour le protocole <span class="em">file</span>.</p>
                    <h4 id="meo_js_ajax">En JavaScript :</h4>
                    <p>L'objet JavaScript <a href="https://www.w3schools.com/xml/xml_http.asp" target="_blank" class="html">XMLHttpRequest</a> permet d'exécuter des requêtes HTTP utilisées par Ajax :</p>
                    <p class="html">http = new XMLHttpRequest();</p>
                    <p>Il faut noter qu'anciennement, chaque navigateur utilisait une syntaxe différente, et il fallait procéder via un <span class="em">try catch</span> de JavaScript pour essayer les différentes syntaxes existantes. C'est toutefois du passé.</p>
                    <p>Une fois l'objet créé, il peut être utilisé pour envoyer des requêtes à un serveur, à l'aide de plusieurs méthodes et propriétés :</p>
                    <ol>
                        <li><span class="em">http.open("method", "url")</span> prépare l'envoi d'une requête au serveur reseigné par l'URL mentionnée, avec la méthode renseignée (par exemple "<span class="em">GET</span>" ou "<span class="em">POST</span>").</li>
                        <li><span class="em">http.responseType</span> précise le format dans lequel le serveur va répondre; l'objet se prépare ainsi à recevoir et formater cette réponse.</li>
                        <li><span class="em">http.onreadystatechange</span>est une propriété dans laquelle on peut stocker une fonction, qui sera appelée lorsque la requête a été envoyée et une réponse a été reçue. Les valeurs que l'état peut prendre sont renseignées <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState" target="_blank">ici</a>.</li>
                        <li><span class="em">http.send()</span> envoie la requête au serveur.</li>
                    </ol>
                    <p>Envoyer une requête asynchrone en JavaScript nécessite quatrelignes, c'est quand même dommage d'utiliser une bibliothèque juste pour cela !</p>
<pre><code>function ajax(url, callbackfunction, method = 'GET') {
    let req = new XMLHttpRequest();
    req.open(method, url, true);
    req.onload = callbackfunction;
    req.send();
}

ajax('/monAPI/public/api/v1/info', () => {
    if (this.status === 200) {
        ...
    } else {
        ...
    }
});</code></pre>
                    <p>Cette petite fonction prend en paramètre l'URL de la requête HTTP à envoyern la fonction callback qui sera appeléelorsque la réponse sera parvenue et éventuellement le verbe HTTP à utiliser.</p>
                    <p>Remarque : il est égalemet possible d'utiliser l'API fetch qui est plus moderne que XHR. Néanmoins, Safarine l'implémente que depuis sa version 10.1 datant de mars 2017.</p>
                    <p>Pour plus d'informaions, un tutoriel est disponible sur <a href="https://www.pierre-giraud.com/JavaScript-apprendre-coder-cours/ajax-xmlhttprequest/" target="_blank">ce site</a>.</p>
                   <p>Un exemple de code complet d'envoi d'une requête serait par exemple :</p>
<pre><code>http = new XMLHttpRequest();
// Fonction appelée quand la réponse est prête.
http.onreadychange = stateChanged;
// Prépare une requête GET asynchrone pour l'URL indiquée.
http.open("GET", "url");
http.send(); // L'envoi au serveur

function stateChanged() {
    if (http.readyState == XMLHttpRequest.DONE) {
        // La réponse est revenue du serveur.
        if (http.status == 200) { // Tout s'est bien passé.
            http.responseText // Contient la réponse.
            http.responseXML // Pour récupérer du XML.
        } else {
            // Gestion de l'erreur.
        }
    }
}</code></pre>
                    <p>Cet envoi de requête est bien asynchrone :</p>
                    <ol>
                        <li>On spécifie les traitements à réaliser lorsque la réponse sera prête, en associant une fonction à la survenue de l'événement <span class="em">onreadystatechange</span>. La classe <span class="em">XMLHttpRequest</span> fournit également d'autres gestionnaires d'événements.</li>
                        <li>On prépare la requête avec la méthode <span class="em">open()</span>, puis on l'envoie au serveur avec <span class="em">send()</span>.</li>
                        <li>Quand la réponse est prête, cela déclenche l'exécution de la méthode spécifiée.</li>
                    </ol>
                    <p>Si vous souhaitez tester ces méthodes sur des fichiers locaux, vous pouvez utiliser le protocole <span class="em">file</span>; toutefois, notez que le code de réponse est alors 0 et non 200 comme pour une requête HTTP qui s'est déroulée avec succès.</p>
                    <h4 id="meo_jquery_ajax">Avec jQuery :</h4>
                    <p>jQuery introduit une fonction <a href="https://www.w3schools.com/jquery/ajax_ajax.asp" class="html" target="_blank">$.ajax()</a> qui permet de définir un appel AJAX avec les paramètres suivants, passés via un objet JavaScript :</p>
                    <ol>
                        <li><span class="html">url</span> : le document ciblé.</li>
                        <li><span class="html">type</span> : les méthodes d'appel.</li>
                        <li><span class="html">data</span> : des données qui accompagnent la requête (par exemple via un formulaire).</li>
                        <li><span class="html">success</span> : la fonction JavaScript à exécuter en cas de réussite.</li>
                        <li><span class="html">error</span> : la fonction JavaScript à exécuter en cas d'échec.</li>
                        <li><span class="html">complete</span> : la fonction JavaScript à exécuter quand tout est terminé.</li>
                    </ol>
                    <p>Par exemple (pris du tutoriel de W3Schools) :</p>
<pre><code>$("button").click(function() {
    $.ajex({
        url: "demo_test.txt",
        success: function(result) {
            $("#div1").html(result);
        }
    });
});</code></pre>
                    <p>Pour des requêtes plus standard, des méthodes prédéfinies existent également :</p>
                    <ol>
                        <li><a href="https://www.w3schools.com/jquery/ajax_load.asp" class="html" target="_blank">$(selector).load(url)</a> charge le contenu de la ressource à l'URL donnée dans l'élément sélectionné.</li>
                        <li><a href="https://www.w3schools.com/jquery/ajax_get.asp" class="html" target="_blank">$.get(url [, data, function, dataType])</a> envoie une requête avec la méthode GET à l'URL donnée.</li>
                        <li><a href="https://www.w3schools.com/jquery/ajax_getjson.asp" class="html" target="_blank">$.getJSON(url [, data, function])</a> envoie une requête avec la méthode GET et attend des données spécifiquement au format JSON.</li>
                        <li><a href="https://www.w3schools.com/jquery/ajax_post.asp" class="html" target="_blank">$.post(url [, data, function, dataType])</a> envoie une requête avec la méthode POST à l'URL donnée.</li>
                    </ol>
                    <h3 id="avantages_inconvenients_ajax">Avantages et inconvénients :</h3>
                    <p><span class="em">AJAX</span> permet de fluidifier les échanges navigateur-serveur et de rendre l'interface utilisateur moins rigide (client "riche"). Il faut toutefois rester attentif à certains points :</p>
                    <ol>
                        <li>Les robots ne référenceront pas les données obtenues au travers d'AJAX.</li>
                        <li>Attention à préserver la fonctionnalité du bouton "Back" du navigateur (des solutions toutes faites existent).</li>
                        <li>Il faut assurer la sécurité des requêtes via AJAX aussi sérieusement que les requêtes "classiques".</li>
                        <li>La notion de lien perd de son sens : fournir un lien à quelqu'un donne accès à la page mais pas nécessairement à l'info que l'on désire faire visualiser.</li>
                    </ol>
                    <p><span class="em">Remarque :</span> Pour des raisons de sécurité, la plupart des navigateurs empêchent d'accéder, par le biais d'AJAX, à une ressource d'un autre serveur que celui qui a fourni la page courante. Ceci peut parfois être modifié, à vos rsiques et périls, dans les paramètres du navigateur.</p>
                </article>
                <article id="oo_js">
                    <h2>Orienté Objet en JavaScript :</h2>
                    <p>JavaScript <span class="em">supporte aussi la programmation orientée objet</span> (ex. : <span class="em">new Object()</span>, <span class="em">new Array()</span>, ...).</p>
                    <p>La manière dont cela fonctionne est très différente d'un Java ou autres langages de programmation orientée objet.</p>
                    <p>Idépendamment de la programmation orientée objet, les objets JavaScript agissent aussi comme des Maps :</p>
                    <ul>
                        <li>Association d'une clé (une String) à une valeur (de n'importe quel type)</li>
                        <li>Ceci s'appelle des objets associatifs.</li>
                    </ul>
<pre><code>var o = {"nom": "Atreides",
    prenom: "Paul", // les " de la clé sont facultatifs
    "age": 30,
    "truc": function(p1,p2) {...}
}</code></pre>
                    <h3 id="gestion_attributs">Gestion des attributs :</h3>
                    <p><span class="em">Valeur</span> d'un attribut :</p>
                    <ul>
                        <li><span class="em">.nom</span> // renvoie "Atreides"</li>
                        <li><span class="em">["nom"]</span> // renvoie "Atreides"</li>
                    </ul>
                    <p><span class="em">Changer</span> un attribut :</p>
                    <ul>
                        <li><span class="em">.nom</span> = "Muad'dib"</li>
                        <li><span class="em">["nom"]</span> = "Kwisatz Haderach"</li>
                    </ul>
                    <p><span class="em">Supprimer</span> un attribut :</p>
                    <ul>
                        <li class="em">delete o.nom;</li>
                        <li class="em">delete o["nom"];</li>
                    </ul>
                    <p>Parcours sur les clés :</p>
                    <p><span class="html">Object.keys(o)</span> renvoie le tableau des clés <span class="em">["nom", "prenom", ...]</span>.</p>
<pre>for (var k in o) {
    // k vaudra successivement les clés de o
}<code></code></pre>
                    <h3 id="objets_heritage">Objets et héritage :</h3>
                    <p>Nous n'avons pas parlé de l'héritage, juste un petit écart :</p>
                    <ul>
                        <li>Les attributs peuvent provenir d'un parent de l'objet.</li>
                        <li><span class="em">Object.key</span> ne renvoie pas les attributs parents.</li>
                        <li><span class="em">for (... in ...)</span> par contre itère bien sur attributs parents.</li>
                        <li>
                            <p>La méthode <span class="html">hasOwnProperty()</span> retourne un booléen indiquant si l'objet possède l'attribut spécifié.</p>
                            <p class="em">o.hasOwnProperty("attribut");</p>
                        </li>
                    </ul>
                    <h3 id="pseudo_objet_js_foncionnel">Pseudo objet en JavaScript fonctionnel :</h3>
<pre><code>var o (fucntion() { // création d'une portée lexicale
    var a, b, c; // des variables restant privées
    function truc (p1, p2) { // aussi privé
        ...
    }
    function machin() { ... }
    return {
        getA : function() { return a; },
        "truc": truc ** machin rendue publique
    }
}) (); // exécution immédiate de la fonction (self-invoking)</code></pre>
                    <p>Utilisation :</p>
                    <p><span class="em">o.getA();</span> // renvoie la valeur de a</p>
                    <p><span class="em">o.truc(1, 2);</span> // appel de la fonction</p>
                    <h4 id="pseudo_classe">Variation : Pseudo classe :</h4>
<pre><code>var createPerson = function (name, surname) {
    var age, address;
    function setAddress (a) { address = a:}
    function setAge(a) { age = a;}
    var self = {
        getName : function() { return name;},
        getSurname : function() { return surname;},
        getAge : function() { return age;},
        getAddress : function() { return address;},
        setAge : setAge,
        setAddress : setAddress
    }
    return self;
};</code></pre>
                    <p>Utilisation de la pseudo classe :</p>
<pre><code>var toto = createPerson("Toto", "Blague");
toto.setAddress("rue de la blague, 10");
toto.setAge(7);
var jean = createPerson("Jean", "Valjean");
jean.setAge(42);</code></pre>
                    <p>Nous utilisons une variable pour retenir la pseudo-instance retournée. Nous l'appelons ici <span class="html">self</span>, <span class="html">this</span> étant un mot-clef réservé.</p>
                    <h4 id="pseudo_heritage">Variation : Pseudo héritage :</h4>
<pre><code>var createEtudiant = function (nom, prenom) {
    var self = createPerson(nom, prenom);
    var noma;
    self.setNoma = function(n) { noma = n;}
    self.getNoma = function() { return noma;}
    return self;
}</code></pre>
                </article>
                <article id="json">
                    <h2>Format de données JSON :</h2>
                    <p><span class="em">JSON</span> est un format de données dans les objectifs sont similaires à ceux de <span class="em">XML</span>. Il se distingue par son format très léger.</p>
                    <h3 id="objets_js">Objets JavaScript :</h3>
                    <p>Les <a href="https://www.w3schools.com/js/js_objects.asp" target="_blank">objets JavaScript</a> sont une structure de données permettant de stocker plusieurs informations dans une seule variable. Ces informations sont de deux types :</p>
                    <ul>
                        <li>Des <span class="em">propriétés</span>, qui contiennent des valeurs.</li>
                        <li>Des <span class="em">méthodes</span>, qui contiennent des fonctions.</li>
                    </ul>
                    <p>Contrairement à un langage typé tel que Java, il est possible de créer un objet sans définir une classe qui régit la structure de cet objet. Des classes peuvent être définies en JavaScript, mais leur rôle sert plutôt de générer des objets qui possèdent tous la même structure, puisque JavaScript n'est pas un langage typé.</p>
                    <p>Un objet est défini via des accolades <span class="em">{}</span>, contenant des déclarations sous la forme <span class="em">champ: valeur</span>, séparées par des virgules. Par exemple :</p>
<pre><code>var person = {
    firstName: "John",
    lastName: "Doe",
    age: 50,
    eyeColor: "blue",
    fullName: () =&gt; {
        return this.firstName + " " + this.lastName;
    }
};</code></pre>
                    <p>Cet objet possède quatre propriétés <span class="em">firstName</span>, <span class="em">lastName</span>, <span class="em">age</span> et <span class="em">eyeColor</span>, et une méthode <span class="em">fullName</span>. Notez que les propriétés et méthodes se déclarent exactement de la même façon : c'est la valeur assignée au champ qui détermine s'il s'agit d'une propriété ou méthode.</p>
                    <p>L'accès aux propriétés peut se faire de deux façons <span class="html">nomDeVariable.propriété</span> ou <span class="html">nomDeVariable["propriété"]</span>. Ces notions sont équivalents.</p>
<pre><code>person.firstName; // "John"
person["firstName"]; // "John"
person.age; // 50</code></pre>
                    <p>Quant aux méthodes, il est possible d'appeler la méthode de façon similaire à un appel de fonction classique <span class="html">nomDeVariable.méthode()</span>. Il est toutefois également possible de passer la déclaration de la fonction dans une variable en omettant les parenthèses <span class="html">nomDeVariable.méthode</span>.</p>
<pre><code>person.fullName; // Déclaration de la méthode
person.fullName(); // Appel de la méthode : renvoie "John Doe"</code></pre>
                    <p>On peut donc voir un objet JavaScript comme un dictionnaire mettant en relation des chaînes de caractères à des valeurs ou des fonctions.</p>
                    <h3 id="intro_json">Intoduction à JSON :</h3>
                    <p><a href="https://www.json.org/" class="html" target="_blank">JSON (JavaScript Object Notation)</a> est un format texte qui peut être facilement interprété comme un objet JavaScript, ou un tableau d'objets JavaScript, du moment que ces objets ne possèdent pas de méthodes. Étant un format très léger, il a tedance à supplanter XML dans les services Web et l'utilisation d'AJAX.</p>
                    <p>Les éléments constitutifs sont :</p>
                    <ul>
                        <li>
                            <p>Des objets, représentés comme dans du code JavaScript, entre accolades contenant des propriétés :</p>
                            <ul>
                                <li>Un nom de propriété sous la forme d'une chaîne de caractères. Contrairement à du code JavaScript, le nom de chaque propriété <span class="em">doit être noté entre guillemets</span>.</li>
                                <li>
                                    <p>Une valeur, soit :</p>
                                    <ul>
                                        <li>Une chaîne de caractères entre guillemets, avec certains caractères d'échappements possibles.</li>
                                        <li>Un nombre.</li>
                                        <li>Un booléen (<span class="html">true</span> ou <span class="html">false</span>).</li>
                                        <li>La valeur vide <span class="html">null</span>.</li>
                                        <li>Un objet.</li>
                                        <li>Un tableau.</li>
                                    </ul>
                                    <p>Les propriétés sont séparées par des virgules.</p>
                                </li>                            </ul>
                        </li>
                        <li>Des tableaux, représentés par des crochets, contenant des objets séparés par des virgules.</li>
                    </ul>
                    <p>Les espaces blancs (retours à la ligne, tabulations, etc) ne sont généralement pas pris en compte.</p>
                    <p>Par exemple, les données représentées dans le fichier XML suivant :</p>
<pre>&lt;?XML version="1.0" encoding="UTF-8".&gt;
&lt;classe&gt;
    &lt;cours&gt;Développement Internet&lt;/cours&gt;
    &lt;etudiants&gt;
        &lt;etudiant&gt;
            &lt;no&gt;23456&lt;/no&gt;
            &lt;nom&gt;Dupont&lt;/nom&gt;
            &lt;prenom&gt;Marc&lt;/prenom&gt;
        &lt;/etudiant&gt;
        &lt;etudiant&gt;
            &lt;no&gt;24235&lt;/no&gt;
            &lt;nom&gt;Durand&lt;/nom&gt;
            &lt;prenom&gt;Hélène&lt;/prenom&gt;
        &lt;/etudiant&gt;
    &lt;/etudiants&gt;
&lt;/classe&gt;<code></code></pre>
                    <p>Pourraient être représentées via le fichier JSON :</p>
<pre><code>{
    "classe": {
        "cours": "Développement Internet",
        "etudiants": [
            {"no": 23456, "nom": "Dupont", "prenom": "Marc"},
            {"no": 24235, "nom": "Durant", "prenom": "Hélène"}
        ]
    }
}</code></pre>
                    <h3 id="utilisation_json_js">Utilisation de JSON en JavaScript :</h3>
                    <p>La plupart des langages actuels offrent un support à JSON : nous allons aborder l'utilisation de JSON avec JQuer, comme il pourrait être utilisé avec AJAX.</p>
                    <p>Nous allons ici construire une page HTML dotée de trois boutons comme ci-dessous !</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;Exemple JSON&lt;title&gt;
        &lt;script type="text/JavaScript" src="http://code.jquery.com/jquery-latest.js"&gt;&lt;/script&gt;
        &lt;script type="text/JavaScript" src="buttons.js"&gt;&lt;/scripts&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="personne"&gt;
            &lt;input type="button" id="b1" value="getPersonne"&gt;
        &lt;/div&gt;
        &lt;div id="personnes"&gt;
            &lt;input type="button" id="b2" value="getPersonnes"&gt;
        &lt;/div&gt;
        &lt;div id="personnesAjax"&gt;
            &lt;input type="button" id="b3" value="getPersonnesAjax"&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Avecle fichier <span class="em">personnes.json</span> :</p>
<pre><code>[
    {"nom": "TonNom", "prenom": "TonPrenom"},
    {"nom": "SonNom", "prenom": "SonPrenom"}
]</code></pre>
                    <p>Et le script <span class="em">buttons.js</span> :</p>
<pre><code>varjson1 = '{"nom": "MonNom", "prenom": "MonPrenom"}';
var json2 = '[{"nom": "MonNom", "prenom": "MonPrenom"}, \
            {"nom": "SonNom", "prenom": "SonPrenom"}]';
$(document).ready(() =&gt; {
    $("#b1").click(() =&gt; {
        var une Personne = $.parseJSON(json1);
        $("#personne").html("&lt;p class='personne'&gt;" + unePersonne.nom + ", " + unePersonne.prenom + "&lt;/p&gt;");
    });
    $("#b2").click(() =&gt; {
        var desPersonnes = $.parseJSON(json2);
        var liste = "&lt;ul&gt;";
        $.each(desPersonnes, (idx, personne) =&gt;) {
            liste += "&lt;li classe='personne'&gt;" + personne.nom + ", " + personne.prenom + "&lt;/li&gt;";
        });
        liste += "&lt;/ul&gt;";
        $("#personnes").html(liste);
    });
    $("#b3").click(() =&gt; {
        $.ajaxSetup({mimeType: "text/plain"});
        $.getJSON("personnes.json", (desPersonnes) =&gt;) {
            var liste = "&lt;ul&gt;";
            $.each(desPersonnes, (key, personne) =&gt;) {
                liste += "&lt;li classe='personne'&gt;" + personne.nom + ", " + personne.prenom + "&lt;/li&gt;";
            });
            liste += "&lt;/ul&gt;";
            $("#personnesAajx").html(liste);
        });
    });
});</code></pre>
                    <p>Pour les deux premiers boutons, un gestionnaire d'événement <span class="em">onclick</span> est assigné comme nous l'avons déjà fait. La fonction <span class="html">$.parseJSON()</span> de jQuery permet de transformer une chaîne de caractères déjà stockée dans une variable, et de transformer celle-ci en un objet JavaScript, si le format de la chaîne est un format JSON valide.</p>
                    <p>Pour le troisième bouton, la fonction de jQuery <span class="html">$.getJSON()</span> est appelée à la place. Cette fonction, déjà vue précédemment, envoie unerequête <span class="html">GET</span> à l'adresse renseignée, reçoit une réponse qui est supposée au format JSON, et convertit celle-ci automatiquement en un objet JavaScript (en appelant implicitement la méthode <span class="html">parseJSON()</span>).</p>
                </article>
                <article>
                    <h2 id="http_servlet">HTTPServlet :</h2>
                    <p>Le front-end émet des requêtes (page web, fichiers JavaScript, CSS, ...) en format <a href="http://tools.ietf.org/html/rfc2616" target="_blank">HTTP 1.1</a>.</p>
                    <h3 id="anatomie_url">Anatomie d'une URL :</h3>
                    <img src="../images/url.png" alt="anatomie d'une URL">
                    <p>Il nous faut un serveur pour écouter les requêtes Web et y répondre.</p>
                    <p>Le composant de Java dédié au traitement d'une requête, <span class="html">HTTPServlet</span>, répond à une requête sur un chemin précis et s'utilise au sein d'un serveur Web.</p>
                    <p>Un serveur web traite en général beaucoup de requêtes différentes : de multiples HTTPServlet sur un seul serveur.</p>
                    <h3 id="configuration_http_servlet">Configuration :</h3>
                    <p>Il faut configurer le serveur web pour expliquer à Java son comportement :</p>
                    <ul>
                        <li>Quel port écouter</li>
                        <li>Quel(s) chemin(s) dans l'URL correspond(ent) à quel(s) servlet(s)</li>
                        <li>À quel endroit trouver les fichiers à servir.</li>
                        <li>S'il y a un fichier index.html à utiliser en cas d'absence de précision (<a href="www.monsite.com">www.monsite.com</a> servira <a href="www.monsite.com/index.html">www.monsite.com/index.html</a>)</li>
                        <li>Et plein d'autres...</li>
                    </ul>
                    <h3 id="jetty">Jetty :</h3>
                    <p>En Java, sur un unique serveur Web, on peut exécuter plusieurs applications distinctes. On appelle cela un "Application Server". Chaque application est distinguée par son chemin d'URL (www.monsite.com/app1/...). On "déploie" son application server.</p>
                    <p>Nous utiliserons <a href="http://www.eclipse.org/jetty/" target="_blank">Jetty</a>,la solution open source 100% Java, qui implémente les dernières technologies.</p>
                    <p>Sur un Application Server, chaque application poss!de son propre <span class="em">web.xml</span> (description XML de la configuration de l'application) la concernant.</p>
                    <p>À la place d'avoir un Application Server sur leqel on déploie les applications, on a un processus Java qui embarque (embedded) son propre Application Server pour y déployer son unique application.</p>
                    <p>Moins souple qu'un Application Server, mais beaucoup plus pratique lors du développement. Parce qu'il n'y a pas de phase de déploiement, c'est une pure application Java qui s'exécute. Les outils de debugging habituels restent 100% fonctionnels.</p>
                    <dl>
                        <dt>Nomenclature :</dt>
                        <dd>
                            <ul>
                                <li><span class="html">Server</span> &#8594; ce qui écoute un port TCP.</li>
                                <li><span class="html">WebAppContext</span> &#8594; ce qui configure le serveur en tant qu'Application Server.</li>
                                <li><span class="html">ServletHolder</span> &#8594; retient le nom et la configuration d'une instance de Servlet.</li>
                                <li><span class="html">HTTPServlet</span> &#8594; classe à étendre pour répondre aux requêtes HTTP.</li>
                            </ul>
                        </dd>
                    </dl>
<pre><code>Server server = new Server(8080);	// serveur sur port 8080
WebAppContext context = new WebAppContext();	// objet de configuration
HTTPServlet ms = new MaServlet();	// MaServlet réponds à une requête et il faut définir cette classe !
context.addServlet(new ServletHolder(ms), "/masv/*");	// ms traîtera les requêtes sur le chemin /masv/
context.setResourceBase("www");	// répertoire des fichiers html etc. !!! chemin relatif → à la racine du projet !!!
HTTPServlet ds = new DefaultServlet();	// ce servlet est fourni par Jetty, il répond aux requêtes pour obtenir les fichiers html etc.
context.addServlet(new ServletHolder(ds), "/");	// ds servira les fichiers pour tous les chemins. Comme il est ajouté après ms, sur le chemin /masv/ : ms est prioritaire.
server.setHandler(context);	// donne la configuration au serveur
server.start();	// démarrage</code></pre>
                    <h4 id="webappcontext_methodes">WebAppContext : quelques méthodes :</h4>
                    <ul>
                        <li><span class="html">context.setContentPath("/")</span> : Chemin de l'URL pour lequel ce contexte s'applique.</li>
                        <li><span class="html">context.setWelcomeFiles(new String[] { "index.html" });</span> : Quel est le fichierà servir si l'utilisateur va à l'URL racine sans plus de précision. <a href="www.monsite.com">www.monsite.com</a> affichera <a href="www.monsite/index.html">www.monsite.com/index.html</a>.</li>
                        <li><span class="html">context.setInitParameter("cacheControl", "no-store,no-cache,must-revalidate");</span> : Dans le protocole HTTP, le serveur dicte le comportement du cache du navigateur. Ici, on dit que par défaut, il faut pas stocker ni retenir en cache les réponses aux requêtes.</li>
                        <li><span class="html">context.setInitParameter("redirectWelcome", "true");</span> : Quand c'est "true", la page de bienvenue est affichée par redirection plutôt que par suivi. En d'autres termes, l'URL change à la page de bienvenue. Dans tous les cas, le contenu de cette page sera affichée.</li>
                        <li><span class="html">context.setMaxFormContentSize(50000000);</span> : Spécifie la taille limite des données qu'un front-end peut soumettre à ce back-end.</li>
                        <li><span class="html">context.addServlet(new ServletHolder(new MaServlet()), "/url1");</span> : Enregistre une servlet pour répondre à l'url <span class="em">/url1</span> exactement.</li>
                        <li><span class="html">context.addServlet§new ServletHolder(new MaServlet()), "/url2/*);</span> : Enregistre une servlet pour répondre à toute url commençant par <span class="em">/url2</span>. Si plusieurs servlets sont ajoutées, chaque requête est traitée dans l'ordre de cet ajout, jusqu'à trouver une servlet qui accepte de la traiter.</li>
                        <li><span class="html">context.addServlet(new ServletHolder(new DefaultServlet()), "/");</span> : La <span class="em">DefaultServlet</span> sert des focjoers. Ici, toutes les URLs seront traitées comme des fichiers à trouver puisque cela commence à <span class="em">/</span> directement. C'est pour cela qu'on ajoute la <span class="em">DefaultServlet</span> en dernier en général.</li>
                        <li><span class="html">context.setResourceBase("c:\web");</span> : spécifie dans quel répertoire se trouvent les fichiers.</li>
                    </ul>
                    <p>La classe <span class="html">HTTPServlet</span> a pour but d'être étendue. Chaque requête HTTP appelera la méthode suivante : <span class="html">service (HttpServletRequest i, HttpServletResponse o)</span>.</p>
                    <ul>
                        <li><span class="html">HttpServletRequest</span> : contient tout ce qui concerne la requête (son chemin, l'adresse de l'émetteur, les cookies, les données transmises, etc...).</li>
                        <li><span class="html">HttpServletResponse</span> : possède les méthodes pour préparer la réponse à renvoyer au front-end.</li>
                    </ul>
                    <p>En général, on ne redéfinit pas directement service :</p>
                    <ul>
                        <li class="html">doGet (HttpServletRequest i, HttpServletResponse o)</li>
                        <li class="html">doPost (HttpServletRequest i, HttpServletResponse o)</li>
                        <li class="html">doPut (HttpServletRequest i, HttpServletResponse o)</li>
                        <li class="html">doDelete (HttpServletRequest i, HttpServletResponse o)</li>
                        <li>...</li>
                    </ul>
                    <h4 id="front_end_to_back_end">Front-End &#8594; Back-End :</h4>
                    <p>La question est composée de :</p>
                    <ul>
                        <li>Une URL</li>
                        <li>Une méthode : Get/Post/Put/Delete/...</li>
                        <li>Une adresse d'origine</li>
                        <li>Des cookies</li>
                        <li>De données à envoyer</li>
                        <li><a href="http://www.sitepoint.com/web-foundations/mime-types-complete-list/" target="_blank">D'un mimetype pour les données à envoyer</a></li>
                        <li>Des en-têtes, par exemple le user agent=browser</li>
                        <li>...</li>
                    </ul>
                    <h4 id="back_end_to_front_end">Back-End &#8594; Front-End :</h4>
                    <p>La réponse est composée de :</p>
                    <ul>
                        <li><a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" target="_blank">Un code d'état</a> : 200 = ok, 400 = manquant etc</li>
                        <li>Des données</li>
                        <li>Un mimetype pour ces données</li>
                        <li>Des modifications de cookies (ajout/suppression/modification)</li>
                        <li>Des en-têtes, par exemple des informations sur la manière de cacher les entrées.</li>
                        <li>...</li>
                    </ul>
                    <h4 id="methodes_requetes">Les méthodes des requêtes :</h4>
                    <p><span class="html">GET</span> : obtenir une ressource.</p>
                    <ul>
                        <li>L'URL entrée dans le navigateur effectue un <span class="html">GET</span> sur cette adresse. Les paramètres sont encodés dans cet URL : <span class="em">?param1=valeur1&amp;param2=valeur2</span>.</li>
                        <li>Bookmarkable.</li>
                        <li>En général, peut être mis en cache.</li>
                    </ul>
                    <p><span class="html">POST</span> : soumettre une ressource.</p>
                    <ul>
                        <li>Soumission d'un formulaire : les données sont envoyées en <span class="html">POST</span>. Les paramètres sont encodés dans le "payload" qui est distinct de l'URL.</li>
                        <li>Non bookmarkable.</li>
                        <li>En général, ne peut pas être mis en cache : la réponse à la soumission d'un formulaire de ce formulaire et change donc à chaque fois.</li>
                    </ul>
                    <p><span class="html">DELETE, PUT</span> :</p>
                    <ul>
                        <li>utilisés dans les API Webs, dans le standard <span class="em">REST</span></li>
                        <li>peu voire pas du tout utilisés à partir d'un navigateur</li>
                    </ul>
<pre><code>public class MaServlet extends HttpServlet {
    
    @Override
    protected void doGet (HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        ...
    }
    
    @Override
    protected void doPost (HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        ...
    }
}</code></pre>
                    <h4 id="http_servlet_request">HttpServletRequest :</h4>
                    <p>Tout ce qui concerne la requête. Quelques méthodes :</p>
                    <ul>
                        <li><span class="html">getPathInfo()</span> : renvoie la partie d'URL supplémentaire à ce qui est configuré par la servlet.</li>
                        <li><span class="html">getParameter(String)</span> : obtient un des paramètres de la requête, c'est-à-dire des données transmises.</li>
                        <li><span class="html">getCookie()</span> : retourne les cookies.</li>
                    </ul>
                    <h4 id="http_servlet_response">HttpServletResponse :</h4>
                    <p>Tout ce qui concerne la réponse. Quelques méthodes :</p>
                    <ul>
                        <li><span class="html">setStatus(int)</span> : définit le statut de la réponse</li>
                        <li><span class="html">setContentLength(int)</span> : définit la longueur en bytes de la réponse</li>
                        <li><span class="html">setCharacterEncoding(String)</span> : définit l'encodage de la réponse ("utf-8')</li>
                        <li><span class="html">setContentType(String)</span> : définit le mimetype de la réponse</li>
                        <li><span class="html">getOutputStream()</span> : retourne l'OutputStream permettant d'écrire la réponse</li>
                    </ul>
                    <h4 id="exceptions_doget_dopost">Exceptions dans doGet ou doPost :</h4>
                    <p>Un fichier non trouvé = erreur 404.</p>
<pre><code>resp.setStatus(404);
resp.setContentType("text/html");
String msg = "&lt;html&gt;&lt;body&gt;Fichier non trouvé&lt;/body&gt;&lt;/html&gt;";
byte[] msgBytes = msg.getBytes("UTF-8");
resp.setContentLength(msgBytes.length);
resp.setCharacterEncoding("utf-8");
resp.getOutputStream().write(msgBytes);</code></pre>
                    <p>Ceci est un traitement normal du côté Java, pas une exception jetée !</p>
                    <p>Si une exception s'échappe, c'est Jetty lui-même qui la gérera (redirection vers une page d'erreur ou envoi d'un message standard).</p>
                    <p>En général, on évitera de laisser s'échapper les exceptions.</p>
<pre><code>@Override
protected void doPost (HttpServletRequest req, HttpServletReponse resp) throws ServletException, IOException {
    try {
        ...
    } catch (Exception e) {
        e.printStackTrace(); // pour logger l'erreur
        resp.setStatus(500); // erreur au niveau du serveur
        resp.setContentType("text/html");
        byte[] msgBytes = e.getMessage().getBytes("UTF-8");
        resp.setContentLength(msgBytes.length);
        resp.setCharacterEncoding("utf-8");
        resp.getOutputStream().write(msgBytes);
    }
}</code></pre>
                    <p>Plusieurs librairies Java permettent de transformer facilement du JSON en Java comme <a href="http://owlike.github.io/genson/" target="_blank">Genson</a>.</p>
                    <p>Genson peut faire la désérialisation (transformation de JSON vers du Java) et la sérialisation (transformation de Java vers du JSON).</p>
                    <p>On peut instancier Genson directement :</p>
<pre><code>Genson genson = new Genson();</code></pre>
                    <p>ou via un Builder pour plus de configuration :</p>
<pre><code>Genson genson = new GensonBuilder().useDateFormat(new SimpleDateFormat("yyyy-MM-dd")).useIdentation(true).useConstructorWithArguments(true).create();</code></pre>
                    <p>Deux modes de fonctionnement :</p>
                    <ul>
                        <li>
                            <p>Mode par défaut (marche dans les deux sens) :</p>
                            <ul>
                                <li>JSON object &#8596; Java Map</li>
                                <li>JSON array &#8596; Java aray</li>
                                <li>JSON number &#8596; Java double/int</li>
                                <li>JSON string &#8596; Java String</li>
                            </ul>
                        </li>
                        <li>
                            <p>Mode POJO/Beans :</p>
<pre><code>public class Person {
    
    private String name;
    private int age;
    private Address address;
    
    public Person() {}
    
    public Person (String name, int age, Address address) {
        this.name = name;
        this.age = age;
        this.address = address;
    }
    // getters & setters
}
    
public class Address {

    public int building;
    public String city;
    
    public Address() {}
    
    public Address (int building, String city) {
        this.building = building;
        this.city = city;
    }

}</code></pre>
                            <ul>
                                <li>
                                    <p>Marche aussi dans les deux sens :</p>
<pre><code>Person someone = new Person("Eugen", 28, new Address(157, "Paris"));
&#8596;
{"address":{"building":157,"city":"Paris"},"age":28,"name":"Eugen"}</code></pre>
                                </li>
                                <li>
                                    <p>Mais, dans le sens JSON &#8594; Java, il faut préciser la classe Java cible !</p>
<pre><code>int[] arrayOfInts = new int[] {1, 2, 3};
// json = [1, 2, 3]
String jsp, = genson.serialize(arrayOfInts);
genson.deserialize(json, int[].class);</code></pre>
                                </li>
                            </ul>
                            <p>On note que la transformation de Java &#8594; JSON est totalement automatique. Dans l'autre sens, il faut préciser vers quelle classe désérialiser. En effet, l'information de classe est nécessaire en Java mais n'existe pas en JSON.</p>
<pre><code>Map&lt;String, Object&gt; person = new HashMap&lt;String, Object&gt;()
{{
    put("name", "Foo");
    put("age", 28);
}};
// {"age":28,"name":"Foo"}
String json = genson.serialize(person);</code></pre>
                            <p>La sérialisation d'une classe anonyme avec un bloc d'initilaisation est automatique.</p>
                        </li>
                    </ul>
                    <h4 id="filtrer_renommer_proprietes">Utilisation avancée : Filtrer/renommer les propriétés :</h4>
<pre><code>new GensonBuilder().exclude("password").exclude(Class.class).include("name", FromSome.class).rename("type", "_type").create();</code></pre>
                </article>
                <article id="authentification">
                    <h2>L'authentification :</h2>
                    <p>L'authentificaion consiste à identifier un utilisateur.</p>
                    <p>Les requêtes du front-end dépendent de l'utilisateur authentifié. Les requêtes sont facilement manipulables.</p>
                    <p>Le serveur connaît cet utilisateur au moment de son authentification. Le serveur doit donc trouver un moyen de retenir l'utilisateur une fois qu'il est authentifié pour répondre aux requêtes ultérieures correctement.</p>
                    <h3 id="session">Session :</h3>
                    <p>L'application Server (Jetty) va retenir une conversation (ou session, qui est plusieurs requêtes successives du même front-end) entre un front-end et un back-end.</p>
                    <p>Attention : cependant, une conversation n'est pas une connexion TCP : l'Application Server fait de son mieux pour la tenir aussi exacte que possible, mais peut se tromper. Exemple typique : lors du redémarrage de l'Application Server, toutes les sessions disparaissent.</p>
                    <p>La méthode <span class="html">getSession()</span> de l'<span class="html">HttpServletRequest</span> permet d'obtenir la <a href="https://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpSession.html" target="_blank" class="html">HttpSession</a>.</p>
                    <p>Il faut appeler <span class="em">getSession()</span> pour qu'une session soit créée. Une requête qui est traitée par le serveur sans que ce dernier n'appelle <span class="em">getSession()</span> ne posèdera donc pas de session. Une fois la session créée, <span class="em">getSession()</span> retourne la même session jusqu'à son expiration.</p>
                    <p>Lors d'une authentification réussie, la session est remplie par l'id de l'utilisateur : <span class="html">req.getSession().setAttribute("id", idUser);</span>.</p>
                    <p>Lors des requêtes ultérieures, le serveur récupère l'id à partir de la session : <span class="html">Object idUser = req.getSession().getAttribute("id); if (idUser != null) {...}</span>.</p>
                    <h3 id="jwt">Gestion de l'authentification : JSON Web Token (JWT) :</h3>
                    <p>C'est une chaîne de caractères qui retient les informations d'authentification de l'utilisateur et qui est signée cryptographiquement par le serveur.</p>
                    <p>Seul le serveur peut générer et valider un JWT valide.</p>
                    <p>Création de la chaîne <a href="https://github.com/auth0/java-jwt" target="_blank">JWT</a> lors d'une authentification réussie :</p>
<pre><code>Map&lt;String, Object&gt; claims = new HashMap&lt;String, Object&gt;();
claims.put("username", email);
claims.put("id", id);
claims.put("ip", req.getRemoteAddr());
String ltoken = new JWTSigner(JWTSECRET).sign(claims);</code></pre>
                    <p><span class="html">JWTSECRET</span> est une constante chaîne de caractères connue uniquement par le serveur. C'est cette chaîne qui permet de signer/valider une signature.</p>
                    <p>Le navigateur devra donc founir la chaîne JWT à chacune de ses requêtes. Si on retient le JWT dans un cookie : cela sera automatique :</p>
<pre><code>Cookie cookie = new Cookie("user", ltoken);
cookie.setPath("/");
cookie.setMaxAge(60 * 60 * 24 * 365);
resp.addCookie(cookie);</code></pre>
                    <p>Lors des requêtes ultérieures, on pourra chercher la chaîne JWT dans les cookies :</p>
<pre><code>String token = null;
Cookie[] cookies = req.getCookies();
if (cookies != null) {
    for (Cookie c : cookies) {
        if ("user".equals(c.getName()) &amp;&amp; c.getSecure()) {
            token = c.getValue();
        } else if ("user".equals(c.getName()) &amp;&amp; token == null) {
            token = c.getValue();
        }
    }
}</code></pre>
                    <p>Et finalement on pourra valider la chaîne JWT avant de récupérer l'utilisateur :</p>
<pre><code>Object userID = null;
try {
    Map&lt;String, Object&gt; decodedPayload = new JWTVerifier(JWTSECRET).verify(ltoken);
    userID = decodedPayload.get("id");
    if (!remoteHost.equals(decodedPayload.get("ip"))) userID = null;
} catch (Exception exception) {
    // ignore
}
if (userID != null) { // ici on a pu récupérer un utilisateur valide
    ...
} else {
    // ici pas : envoi d'une erreur ou redirection vers page d'authentification ou autre...
    ...
}</code></pre>
                    <p>On peut mettre un id, un nom, une date de préremption, l'IP du front-end, etc... On ne met surtout pas le mot de passe de l'utilisateur du JWT !</p>
                    <p>Une chaîne JWT ne peut être créée que par le serveur (signée sur base de son secret caché). Sa signature ne peut être validée que par le serveur (toujours su base de son secret caché). Mais elle est facilement décrytable, le front-end peut en lire le contenu facilement sans même connaître le secret.</p>
                </article>
                <article id="informations_supplementaires">
                    <h2>Informations supplémentaires :</h2>
                    <ul>
                        <li>
                            <p><a href="http://127.0.0.1/Calc?expr=2+2">http://127.0.0.1/Calc?expr=2+2</a></p>
                            <p>Ce que l'utilisateur met comme expression arithmétique finit par se trouver dans l'URL. Il pourrait donc en profiter pour abuser le comportement de cette URL en y mettant des caractères non prévus, par exemple <span class="html">&amp;</span>. Tout paramètre doit donc être encodé avec, par exemple, <a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Objets_globaux/encodeURIComponent" target="_blank">encodeURIComponent(str)</a>. La fonction <span class="html">encodeURIComponent(str)</span> permet d'encoder un composant d'un Uniform Resource Identifier (URI) en remplaçant chaque exemplaire de certains caractères par une, deux, trois ou quatre séquences d'échappement UTF-8 correspondantes (quatre séquences seront utilisées uniquement lorsque les caractères à encoder sont composés de deux caractères "surrogate").</p>
<pre><code>console.log(encodeURIComponent('?x=test'));
// expected output : "%3Fx%3Dtest"</code></pre>
                        </li>
                        <li>
                            <p>En Java 8, c'est la classe <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/file/Files.html" target="_blank">Files</a> qui permet de lire ou écrire un fichier avec un minimum d'effort, ou de lister le contenu d'un répertoire.</p>
                            <p>Par exemple, pour lire le contenu du fichier "cal.json" :</p>
<pre><code>String contenu = new String(Files.readAllBytes(Paths.get("calc.json")), StandardCharsets.UTF_8);</code></pre>
                            <p>Pour avoir la liste des fichiers du répertoire "machines" :</p>
<pre><code>String[] fichiers = new File("machines").list();</code></pre>
                            <p>Pour écrire sur un fichier spécifique :</p>
<pre><code>Files.write(new File("machines", nomFichier).toPath(), nouveauContenu.getBytes(StandardCharsets.UTF_8), StandardOpenOption.CREATE, StandardOpenOption.TRUNCATE_EXISTING);</code></pre>
                        </li>
                        <li>
                            <p>Pour déconnecter l'utilisateur :</p>
<pre><code>if (req.getSession() != null) {
    req.getSession().invalidate();
}</code></pre>
                        </li>
                        <li>
                            <p>Evoyer une erreur dans la réponse :</p>
<pre><code>resp.sendError(HttpServletReponse.SC_BAD_REQUEST, "Action invalide");</code></pre>
                        </li>
                    </ul>
                </article>
                <article>
                    <h2 id="exercices">Exercices :</h2>
                    <p>JavaScript est un langage aux nombreux interpréteurs. Bien sûr chaque navigateur possède le sien mais on le retrouve aussi du côté serveur avec Node.js par exemple. Pour le moment, nous utiliserons le moteur JavaScript fournit par Java 8, qui s'appelle Nasshorn.</p>
                    <p>Prenez le fichier Nasshom.zip se trouvant sur l'ecampus, décompressez-le etimporter le projet Eclipse : <span class="em">File/Import/General/Existing Project Into Workspace/Browse/</span> pointez vers le répertoire que vous avez dézippé, puis Next etc. jusqu'à terminer l'import.</p>
                    <p>Exécutez la classe Nasshom.</p>
                    <p>Dans la console, entrez <span class="em">1+ 1</span>, faites Enter et hop, vous avez le résultat.</p>
                    <p>Le moteur JavaScript possède ce qu'on appelle un store : un espace de stockage auquel on ajoute de l'information.</p>
                    <p>Entrez : <span class="em">function hello(){return "hello";}</span></p>
                    <p>La fonction est ajoutée au store. Entrez <span class="em">hello()</span> et elle est appelée.</p>
                    <p>Ce serait plus pratique d'enregistrer tout cela dans un fichier. réez un fichier <span class="em">hello.js</span> à la racine (le répertoire src n'est pas la racine de votre projet mais son répertoire parent l'est par contre !) de votre projet Eclipse et copiez-y la définition de la fonction <span class="em">hello</span> ci-dessus. Pour charger le fichier, il faut faire : <span class="html">&gt; file.loadScript("hello.js")</span>.</p>
                    <p>Le script est alors chargé et exécuté immédiatement.</p>
                    <p>À noter : chaque chargement ajoute au store déjà existant. Si vous désirez nettoyer complètement le store, il faut faire : <span class="html">&gt; file.reload()</span>.</p>
                    <p>Utiisation avancée :</p>
                    <p>À chaque sauvegarde du fichier, il faut donc faire un <span class="html">location.reload</span> suivi d'un <span class="html">file.loadScript</span> pour obtenir le résultat de l'exécution de la nouvelle version. Ceci devenant vite lassant, on peut faire : <span class="html">&gt; file.reloadScript("hello.js")</span>.</p>
                    <p>Une fois cette commande exécuté, le système surveille le fichier hello.js. À chaque fois qu'il est modifié (à chaque fois que vous sauvez une nouvelle version dans Eclipse), le <span class="html">location.reload</span> et le <span class="html">file.loadScript</span> sont automatiquement refait pour vous.</p>
                    <h3 id="exercice1">Exercice n° 1 :</h3>
                    <ol type="A">
                        <li>
                            <p>Écrivez une boucle qui va de 1 à 100. Imprimez chaque numéro à la console. C'est <span class="html">console.log(variable)</span> qui permet d'afficher variable à la console.</p>
                        </li>
                        <li>
                            <p>Écrivez une boucle qui va de 1 à 100. Imprimez chaque numéro à la console, mais les chiffres multiples de 3 sont remplacés par Fizz, ceux multiples e 5 par Buzz et ceux multiples d'à la fois de 3 et 5 sont remplacés par FizzBuzz.</p>
                            <p>Nota : x est multiple de y &#8596; le restant de la division entière de x par y zéro. En JavaScript, c'est l'opérateur % (appelé modulo) qui calcule le restant d'une division entière.</p>
                        </li>
                        <li>
                            <p>Transformons la solution de l'exercice précédenten une fonction appelée <span class="em">fizzBuzz</span> et prenant le nombre d'itérations en paramètre. Appeler <span class="em">fizzBuzz(100)</span> va itérer sur les 100 premiers nombres, tandis que <span class="em">fizzBuzz(200)</span> sur les 200, etc. Sauvez cette fonction dans un fichier <span class="em">ex1c.js</span> à la racine de votre projet. Pour la charger : <span class="html">&gt; file.loadScript("ex1c.js")</span>.</p>
                            <p>Notez le résultat : <span class="html">&lt;function&gt;</span> qui indique que la dernière chose évaluée lors de l'exécution de ce script est une fonction. Appelez-la : <span class="em">&gt; fizzBuzz(200)</span>.</p>
                        </li>
                    </ol>
<pre><code class="html">function fizzBuzz(n) {
    for (var i = 1; i &lt;= n; i++) {
        if (i % 3 === 0 &amp;&amp; i % 5 === 0) {
            console.log("FizzBuzz");
        } else if (i % 3 === 0) {
            console.log("Fizz");
        } else if (i % 5 === 0) {
            console.log("Buzz");
        } else {
            console.log(i);
        }
    }
}</code></pre>
                    <h3 id="exercice2">Exercice n° 2 :</h3>
                    <p>Nous allons demander à l'ordinateur de jouer à Ding Ding Bottle. Les règles sont les suivantes :</p>
                    <ul>
                        <li>
                            <p>Les multiples de 5 sont remplacés par Ding Ding.</p>
                        </li>
                        <li>
                            <p>Les multiples de 7 et les chiffres se terminant par 7 sont remplacés par Bottle. Donc 7, 14, 21, ... mais aussi 17, 27, 37, ...</p>
                        </li>
                        <li>
                            <p>Les multiples de 5 et 7 sont remplacés par Ding Ding Bottle.</p>
                        </li>
                        <li>
                            <p>Le jeu se joue autour d'une table; chaque fois qu'un joueur a dit son chiffre ou son emplacement, c'est au joueur qui le suit dans le sens actuel de jeu qui doit s'occuper du chiffre suivant. Cependant,lorsqu'un Bottle est dit, le sens s'inverse ! C'est donc alors au joueur précédent dans l'ancien sens de rotation qui s'occupe du chiffre suivant.</p>
                        </li>
                    </ul>
                    <ol type="A">
                        <li>
                            <p>Nous allons d'abord implémenter un joueur :</p>
                            <ul>
                                <li>
                                    <p>Il possède un nom. Cette valeur est déterminée une fois pour toute.</p>
                                </li>
                                <li>
                                    <p>Il possède un joueur à sa droite et un joueur à gauche. Ces valeurs peuvent être changées n'importe quand.</p>
                                </li>
                                <li>
                                    <p>Il possède une fonction pour s'occuper d'un chiffre. Cette fonction reçoit le chiffre et la référence de qui l'appelle : ce sera soit son joueur de droite, soit son joueur de gauche. Cette seconde information permet de déterminer le sens du jeu. N'oubliez pas d'inverser ce sens en cas de Bottle !</p>
                                </li>
                                <li>
                                    <p>Cette fonction affiche le nom du joueur suivi de ce qu'il doit dire, puis elle passe la main au joueur suivant. Quand le chiffre à afficher est plus grand que 100, cette fonction ne fait plus rien.</p>
                                </li>
                            </ul>
                            <p>Implémentez ceci en utilisant la technique de pseudo-classe vue dans les diapos.</p>
                        </li>
                        <li>
                            <p>Créons une partie en adaptant le code suivant en fonction de votre propre code :</p>
<pre><code class="html">var a = joueur('a');
var b = joueur('b');
var c = joueur('c');
a.setDroite(b);
b.setDroite(c);
c.setDroite(a),
a.setGauche(c);
c.setGauche(b);
b.setGauche(a);
a.traitement(1, c);</code></pre>
                            <p>Notez la dernière ligne : elle demander au joueur a de traiter la valeur 1, et en déclarant c comme étant son prédécesseur afin d'imposer le sens initial a &#8594; b &#8594; c &#8594; a &#8594; ...</p>
                            <p>Le résultat devvait être :</p>
                            <p><img src="../images/dingdingbottle.png" alt=""></p>
                        </li>
                        <li>
                            <p>Améliorons le programme : si b et à droite de a, alors a est à gauche de b. Automatisez cela chaque fois qu'on appelle <span class="em">setDroite</span> ou <span class="em">setGauche</span>, l'élément dans l'autre sens est aussi automatiquement placé. Comment faire pour éviter d'avoir une boucle infinie : a.setDroite(b) &#8594; b.setGauche(a) &#8594; a.setDroite(b) &#8594; ...</p>
                            <p>C'est possible de trouver une solution sans introduire de getter sur les droites et gauches, et sans introduire de fonctions supplémentaires.</p>
                        </li>
                        <li>
                            <p>Même s'il ne faut plus qu'utiliser <span class="em">setDroite</span> ou <span class="em">setGauche</span>, configurer une table de jeu reste pénible. Créons la fonction dingdingbottle qui prend un nombre arbitraire de paramètres. Chaque paramètre est un nom de joueur. La fonction configure une table avec ces joueurs dans l'ordre dans lesquels ils sont fournis, le dernier étant relié au premier. Ensuite, elle lance la partie. Ainsi : <span class="html">&gt; dingdingbottle("a", "b", "c")</span> donne de nouveau le résultat de la photo précédente.</p>
                            <p>Pour réaliser cette fonction, nous aurons besoin de la variable appelée <span class="html">arguments</span> : c'est une variable de type tableau et automatiquement définie dans les fonctions. Elle contient l'ensemble des arguments passés en paramètre à la fonction <span class="html">arguments[0]</span> sera le premier paramètre, <span class="html">arguments[1]</span> le second, <span class="html">arguments.length</span> donnera le nombre d'arguments réellement passés, etc...</p>
                        </li>
                    </ol>
<pre><code class="html">var joueur = function(nom) {

	var droite, gauche;
	
	function setGauche(joueurGauche) {
		if (gauche === undefined) {
			gauche = joueurGauche;
			gauche.setDroite(self);
		}
	}
	
	function setDroite(joueurDroite) {
		if (droite === undefined) {
			droite = joueurDroite;
			droite.setGauche(self);
		}
	}
	
	function traitement(chiffre, joueur) {
		if (chiffre &lt;= 100) {
			var changerSens = afficher(chiffre);
			var suiv = joueur;
			if (!changerSens) {
				suiv = (joueur === gauche) ? droite : gauche;
			}
			suiv.traitement(chiffre + 1, self);
		}
	}
	
	function afficher(chiffre) {
		var sysout = chiffre;
		if (chiffre % 5 === 0 &amp;&amp; chiffre % 7 === 0) {
			sysout = "Ding Ding Bottle";
			console.log(nom + " : " + sysout);
			return true;
		}
		if (chiffre % 7 === 0 || chiffre % 10 === 7) {
			sysout = "Bottle";
			console.log(nom + " : " + sysout);
			return true;
		}
		if (chiffre % 5 === 0) {
			sysout = "Ding Ding";
		}
		console.log(nom + " : " + sysout);
		return false;
	}
	
	var self = {
		setDroite : setDroite,
		setGauche : setGauche,
		traitement : traitement
	};
	
	return self;
};

function dingdingbottle() {
	var joueurs = [];
	for (var i = 0; i &lt; arguments.length; i++) {
		joueurs.push(joueur(arguments[i]));
	}
	for (var i = 0; i &lt; arguments.length; i++) {
		joueurs[i].setDroite(joueurs[i + 1]);
	}
	joueurs[arguments.length - 1].setDroite(joueurs[0]);
	joueurs[0].traitement(1, joueurs[arguments.length - 1]);
};

dingdingbottle("a", "b", "c");</code></pre>
                    <h3 id="exercice3">Exercice n° 3 :</h3>
                    <p><a href="https://fr.wikipedia.org/wiki/Puissance_4" target="_blank">Jouons à Puissance 4.</a></p>
                    <ol type="A">
                        <li>
                            <p>Créez un pseudio-objet grille.</p>
                            <ol type="a">
                                <li>
                                    <p>Cette grille contient 7 colonnes de 6 cases. Chaque case contient soit : rien, un pion jaune ou un pion rouge.</p>
                                </li>
                                <li>
                                    <p>Une fonction imprime la grille. Utilisez console.log. Comme cette fonction ne permet pas d'afficher de la couleur, utilisez X pour les pions jaunes et 0 pour les pions rouges.</p>
                                </li>
                                <li>
                                    <p>Une fonction permet de jouer en désignant une colonne et une couleur. Elle renvoie vrai si le coup est valide (il reste de la place dans la colonne), faux sinon. La case la plus basse de cetet colonne prend la couleur désignée.</p>
                                </li>
                                <li>
                                    <p>Une fonction interne (privée) vérifie s'il y a une suite de 4 pions de la même couleur dans chacune des colonnes. Elle retourne une valeur représentant rien, rouge ou jaune (par exemple un entier, ou un string ou ...).</p>
                                </li>
                                <li>
                                    <p>Une fonction interne (privée) vérifie s'il y a une suite de 4 poins de la même couleur dans chacune des lignes. Elle retourne une valeur représentant rien, rouge ou jaune.</p>
                                </li>
                                <li>
                                    <p>Une fonction interne (privée) vérifie s'il y a une suite de 4 pions de la même couleur en diagonale, dans les deux directions possibles. Elle retourne une valeur représentant rien, rouge ou jaune.</p>
                                </li>
                                <li>
                                    <p>Une fonction qui vérifie s'il y a un gagnant. Elle retourne une valeur représentant rien, rouge ou jaune.</p>
                                </li>
                                <li>
                                    <p>Une fonction qui vérifie s'il reste de la place dans la grille. Elle renvoie vrai quand la grille est remplie, faux sinon.</p>
                                </li>
                            </ol>
                        </li>
                        <li>
                            <p>Testez votre objet grille</p>
                            <ol type="a">
                                <li>
                                    <p>À l'aide de lignes de code, ajoutez des points à la grille et validez que son état est correct via sa fonction d'affichage.</p>
                                </li>
                                <li>
                                    <p>À l'aide de lignes de code, ajoutez des points à la grille pour créer une combinaison gagnante horizontalement. Validez que la fonction de vérification de gagnant détecte bien cette victoire.</p>
                                </li>
                                <li>
                                    <p>Idem pour une combinaison verticale.</p>
                                </li>
                                <li>
                                    <p>Idem pour une combinaison diagonale. En particulier, vérifier que cela fonctionne pour des diagonales pour lesquels un des points est un des quatre coins de la grille.</p>
                                </li>
                            </ol>
                        </li>
                        <li>
                            <p>Il est temps de jouer. Construisez une fonction de jeu.</p>
                            <ol type="a">
                                <li>
                                    <p>Cette fonction demande alternativement à deux joueurs d'insérer un pion de leur couleur. La fonction <span class="html">console.readln()</span> retourne la chaîne de caractères rentrée par l'utilisateur. La fonction <span class="html">parseInt(s)</span> retourne le <span class="html">Number</span> équivalent à la chaîne de caractères passée en paramètre, ou null si la conversion n'a pas pi se faire (chaîne invalide).</p>
                                </li>
                                <li>
                                    <p>Après chaquepion posé, la fonction regarde s'il y a une victoire et l'affiche le cas échéant : le jeu est terminé. S'il n'y a pas pas de victoire, la fonction regarde si la grille est pleine. Dans ce cas, c'est une égalité et le jeu est aussi terminé. S'il n'y a ni ctoire ni égalité, le jeu boucle en passant au joueur suivant.</p>
                                </li>
                            </ol>
                        </li>
                    </ol>
<pre><code class="html">var nbrLignes = 6;
var nbrColonnes = 7;
var caseVide = ' ';
var jetonRouge = 'O';
var jetonJaune = 'X';
var suite = 4;
var jetonCourant = jetonRouge;
var joueurCourant = "red";

var jeu = function () {
    
    var grille = initialiserGrille();
    
    function initialiserGrille() {
        var tab = [];
        for (var ligne = 0; ligne &lt; nbrLignes; ligne++) {
            tab.push([]);
            for (var colonne = 0; colonne &lt; nbrColonnes; colonne++) {
                tab[ligne].push(caseVide);
            }
        }
        return tab;
    }
    
    function afficher() {
        for (var ligne = 0; ligne &lt; nbrLignes; ligne++) {
            var ligneAAfficher = ' | ';
            for (var colonne = 0; colonne &lt; nbrColonnes; colonne++) {
                ligneAAfficher += grille[ligne][colonne] + ' | ';
            }
            console.log(ligneAAfficher);
        }
    }
    
    function jouer(colonne, couleur) {
        colonne--;
        var ligne;
        for (ligne = 0; ligne &lt; nbrLignes; ligne++) {
            if (grille[ligne][colonne] !== caseVide) {
                break;
            }
        }
        if (ligne === 0) {
            return false;
        }
        grille[ligne - 1][colonne] = couleur;
        changerJoueur();
        return true;
    }
    
    function checkedColonne() {
        for (var colonne = ; colonne &lt; nbrColonnes; colonne++) {
            for (var ligne = ; ligne &lt;= nbrLignes - suite; ligne++) {
                if (grille[ligne][colonne] !== caseVide &amp;&amp; grille[ligne][colonne] === grille[ligne + 1][colonne] &amp;&amp; grille[ligne][colonne] === grille[ligne + 2][colonne] &amp;&amp; grille[ligne][colonne] === grille[ligne + 3][colonne]) {
                    return grille[ligne][colonne];
                }
            }
        }
        return false;
    }
    
    function checkedLigne() {
        for (var colonne = ; colonne &lt;= nbrColonnes - suite; colonne++) {
            for (var ligne = ; ligne &lt; nbrLignes; ligne++) {
                if (grille[ligne][colonne] !== caseVide &amp;&amp; grille[ligne][colonne] === grille[ligne][colonne + 1] &amp;&amp; grille[ligne][colonne] === grille[ligne][colonne + 2] &amp;&amp; grille[ligne][colonne] === grille[ligne][colonne + 3]) {
                    return grille[ligne][colonne];
                }
            }
        }
        return false;
    }
    
    function checkedD1() {
        for (var ligne = 0; ligne &lt;= nbrLignes - suite; ligne++) {
            for (var colonne = 0; colonne &lt;= nbrColonnes - suite; colonne++) {
                if (grille[ligne][colonne] !== caseVide &amp;&amp; grille[ligne][colonne] === grille[ligne - 1][colonne -1] &amp;&amp; grille[ligne][colonne] === grille[ligne - 2][colonne - 2] &amp;&amp; grille[ligne][colonne] === grille[ligne - 3][colonne -3]) {
                    return grille[ligne][colonne];
                }
        }
        return false;
    }
    
    function checkedD2() {
        for (var ligne = 0; ligne &lt;= nbrLignes - suite; ligne++) {
            for (var colonne = 0; colonne &lt; nbrColonnes; colonne++) {
                if (grille[ligne][colonne] !== caseVide &amp;&amp; grille[ligne][colonne] === grille[ligne + 1][colonne -1] &amp;&amp; grille[ligne][colonne] === grille[ligne + 2][colonne - 2] &amp;&amp; grille[ligne][colonne] === grille[ligne + 3][colonne -3]) {
                    return grille[ligne][colonne];
                }
        }
        return false;
    }
    
    function gagnant() {
        var gagnant;
        if ((gagnant = checkedLigne()) !== false) {
            return gagnant;
        }
        if ((gagnant = checkedColonne()) !== false) {
            return gagnant;
        }
        if ((gagnant = checkedD1()) !== false) {
            return gagnant;
        }
        if ((gagnant = checkedD2()) !== false) {
            return gagnant;
        }
        return false;
    }
    
    function grilleRemplie() {
        for (var ligne = 0; ligne &lt; nbrLignes; ligne++) {
            for (var colonne = 0; colonne &lt; nbrColonnes; colonne++) {
                if (grille[ligne][colonne] === caseVide) {
                    return false;
                }
            }
        }
        return true;
    }
    
    function changerJoueur() {
        if (joueurCourant === 'red') {
            jetonCourant = jetonJaune;
            joueurCourant = 'yellow';
        } else {
            jetonCourant = jetonRouge;
            joueurCourant = 'red';
        }
    }
    
    var self = {
        afficher : afficher,
        jouer : jouer,
        gagnant : gagnant,
        grilleRemplie : grilleRemplie
    };
    
    return self;
}

var game = jeu();
var numCol;
var gagnant;
while ((gagnant = game.gagnant()) === false &amp;&amp; !game.grilleRemplie()) {
    console.log('C\'est aux ' + joueurCourant + ' de jouer');
    if (!isNan(numCol = parseInt(console.readln()))) {
        game.jouer(numCol, jetonCourant);
        game.afficher();
    }
}
if (game.grilleRemplie()) {
    console.log('C\'est égalité');
} else {
    console.log('gagant = ' + gagnant);
}</code></pre>
                    <h3 id="exercice4">Exercice n° 4 :</h3>
                    <p><a href="https://fr.wikipedia.org/wiki/Bataille_navale_(jeu)" target="_blank">Jouons à la bataille navale.</a></p>
                    <p>Cette fois l'énoncé sera moins, directif, à vous de voir ce qui doit être fait pour que cela fonctionne !</p>
                    <ol type="A">
                        <li>
                            <p>Créez une pseudo classe grille composée de 10 lignes et 10 colonnes.</p>
                            <ol type="a">
                                <li>
                                    <p>Ajoutez les fonctions nécessaires à y placer les bateaux (4 bateaux de 2 cases, 3 de 3 cases, 2 de 4 cases et 1 de 5 cases).</p>
                                </li>
                                <li>
                                    <p>Ajoutez les fonctions permettant de tirer sur les bateaux.</p>
                                </li>
                                <li>
                                    <p>Ajoutez les fonctions permettant d'afficher l'état d'une grille. Une fonction affiche la grille du joueur qui voit ses propres bateaux, tandis que l'autre fonction n'affiche que les coups qu'il a joués et s'ils ont touchés ou pas.</p>
                                </li>
                                <li>
                                    <p>Ajoutez une fonction permettant de placer les bateaux aléatoirement. Pour information, <span class="html">Math.random()</span> retourne un nombre compris entre 0 et 1 exclus.</p>
                                </li>
                                <li>
                                    <p>Créez une fonction déterminant s'il reste des bateaux vivants sur la grille.</p>
                                </li>
                            </ol>
                        </li>
                        <li>
                            <p>Testez votre grille.</p>
                        </li>
                        <li>
                            <p>Construisez une fonction de jeu.</p>
                            <ol type="a">
                                <li>
                                    <p>Cette fonction instancie une grille pour l'ordinateur et une grille pour le joueur. Elle tire au hasard des positions pour les bateaux des deux grilles.</p>
                                </li>
                                <li>
                                    <p>À chaque tour, les deux grilles sont affichées; celles de l'ordinateur n'affiche que les coups joués par le joueur, tandis que l'autre affiche aussi ses propres bateaux.</p>
                                </li>
                                <li>
                                    <p>Quand c'est son tour, le joueur rentre la ligne puis ensuite il rentre la colonne du coup qu'il joue. L'ordinateur tire au hasard.</p>
                                </li>
                                <li>
                                    <p>À chaque tour, il faut vérifier si un des joueurs a gagné et ne continuer que tant que ce n'est pas le cas.</p>
                                </li>
                            </ol>
                        </li>
                    </ol>
<pre><code class="html">var nbrLignes = 10;
var nbrColonnes = 10;
var caseVide = ' ';
var joueurCourant = 'ordi';
var numCol, numLigne, etatGrilleJoueur, etatGrilleOrdi;

var jeu = function () {
    
    var bateaux = [5, 4, 4, 3, 3, 3, 2, 2, 2, 2];
    var grille = initialiserGrille();
    var etatGrille = initialiserGrille();
    placerBateaux();
    
    function initialiserGrille() {
        var tab = [];
        for (var ligne = 0; ligne &lt; nbrLignes; ligne++) {
            tab.push([]);
            for (var colonne = 0; colonne &lt; nbrColonnes; colonne++) {
                tab[ligne].push(caseVide);
            }
        }
        return tab;
    }
    
    function afficherEtat() {
        var ligneAAfficher = '     0   1   3   4   5   6   7   8   9 \n';
        for (var ligne = 0; ligne &lt; nbrLignes; ligne++) {
            ligneAAfficher += ligne + ' ';
            for (var colonne = 0; colonne &lt; nbrColonnes; colonne) {
                ligneAAfficher += ' | ' + etatGrille[ligne][colonne];
            }
            ligneAAfficher += ' |\n';
        }
        console.log(ligneAAfficher);
        return etatGrille;
    }

    function afficherEtat() {
        var ligneAAfficher = '     0   1   3   4   5   6   7   8   9 \n';
        for (var ligne = 0; ligne &lt; nbrLignes; ligne++) {
            ligneAAfficher += ligne + ' ';
            for (var colonne = 0; colonne &lt; nbrColonnes; colonne) {
                ligneAAfficher += ' | ' + etatGrille[ligne][colonne];
            }
            ligneAAfficher += ' |\n';
        }
        console.log(ligneAAfficher);
    }
    
    function placerBateaux() {
        for (var i = 0; i &lt; bateaux.length; i++) {
            placerBateau(bateaux[i]);
        }
    }
    
    function placerBateau(nbCases) {
        var ok = false;
        while (!ok) {
            var placesLibres = true;
            var inclinaison = Math.random();
            var ligne = Math.ceil(Math.random() * nbrColonnes) - 1;
            var colonne = Math.ceil(Math.random() * nbrLignes) - 1;
            if (inclinaison &lt; 0.5) {
                for (var i = 0; i &lt; nbCases; i++à {
                    if (ligne + nbCases &gt;= nbrLignes || grille[ligne + i][colonne] !== caseVide) {
                        placesLibres = false;
                    }
                }
                if (placesLibres) {
                    for (var i = 0; i &lt; nbCases; i++) {
                        grille[ligne + i][colonne] = 'X';
                    }
                    ok = true;
                }
            } else {
                for (var i = 0; i &lt; nbCases; i++) {
                    if (colonne + nbCases &gt;= nbrColonnes || grille[ligne][colonne + i] !== caseVide) {
                        placesLibres = false;
                    }
                }
                if (placesLibres) {
                    for (var i = 0; i &lt; nbCases; i++) {
                        grille[ligne][colonne + i] = 'X';
                    }
                    ok = true;
                }
            }
        }
    }
    
    function tirer(ligne, colonne, grilleEnnemie) {
        var touvher = grille[ligne][colonne] === 'X';
        if (toucher) {
            grilleEnnemie.placerBonCoup(ligne, colonne);
        } else {
            grilleEnnemie.placerMauvaisCoup(ligne, colonne);
        }
        return toucher;
    }
    
    function placerBonCoup(ligne, colonne) {
        etatGrille[ligne][colonne] = 'X';
    }
    
    function placerMauvaisCoup(ligne, colonne) {
        etatGrille[ligne][colonne] = 'O';
    }
    
    function existeBateau() {
        for (var i = 0; i &lt; nbrLignes; i++) {
            for (var j = 0; j &lt; nbrColonnes; j++) {
                if (grille[i][j] === 'X' &amp;&amp; etatGrille[i][j] !== grille[i][j]) {
                    return true;
                }
            }
        }
        return false;
    }
    
    var self = {
        afficherEtat : afficherEtat,
        afficherGrille : afficherGrille,
        existeBateau : existeBateau,
        tirer : tirer,
        placerBonCoup : placerBonCoup,
        placerMauvaisCoup : placerMauvaisCoups
    };
    
    return self;
}

var gameOrdi = jeu();
var gameJoueur = jeu();
console.log('Grille de l\'ordi :');
gameOrdi.afficherGrille();
console.log('Grille du joueur :');
gameJoueur.afficherGrille();
while (gameOrdi.existeBateau() &amp;&amp; gameJoueur.existeBateau()) {
    console.log('Grille état de l\'ordi' :);
    etatGrilleOrdi = gameOrdi.afficherEtat();
    console.log('Grille état du joueur :');
    etatGrilleJoueur = gameJoueur.afficherEtat();
    while ('ordi' === joueurCourant) {
        numLigne = Math.ceil(nbrLignes * Math.random()) - 1;
        numCol = Math.ceil(nbrColonnes * Math.random()) -1;
        if (etatGrilleJoueur[numLigne][numCol] === caseVide) {
            gameOrdi.tirer(numLigne, numCol, gameJoueur);
            joueurCourant = 'joueur';
        }
    }
    while ('joueur' === joueurCourant) {
        numLigne = parseInt(console.readln());
        numCol = parseInt(console.readln());
        if (!isNaN(numLigne) &amp;&amp; !isNaN(numCol) &amp;&amp; etatGrilleOrdi[numLigne][numCol] === caseVide) {
            gameJoueur.tirer(numLigne, numCol, gameOrdi);
            joueurCourant = 'ordi';
        }
    }
}
if (!gameOrdi.existeBateau()) {
    console.log('Le joueur a gagné !');
} else {
    console.log('L\'ordi a gagné !');
}</code></pre>
                    <h3 id="exercice4">Exercice n° 4 :</h3>
                    <p>Nous allons porter le Puissance 4 en HTML :</p>
                    <ul>
                        <li>
                            <p>Créez une page qui contient une table de 7x7 cellules.</p>
                        </li>
                        <li>
                            <p>Sur les six premières rangées, chaque cellule contient un &lt;div&gt; dont le width et height est de 100%.</p>
                        </li>
                        <li>
                            <p>Sur la dernière rangée, chaque cellule contient un &lt;button&gt; dont le width et height est de 100%. De plus, le onclick de chaque bouton appelle la fonction joue avec en paramètre le numéro de colonne. Donc, <span class="html">onclick="joue(1)"</span> pour le premier bouton, <span class="html">onclick="joue(2)"</span> pour le second bouton etc.</p>
                        </li>
                        <li>
                            <p>À la fin de la page, le fichier puissance4.js est chargé. Vous pouvez récupérer votre code code de puissance4 en console comme base de travail.</p>
                        </li>
                        <li>
                            <p>L'affichage de l'état du jeu passe maintenantpar le DOM, écrivez une fonction pour le réaliser :</p>
                            <ul>
                                <li>
                                    <p>Il faut trouver la table, par exemple en utilisant <a href="https://developer.mozilla.org/en-US/docs/Web/API/document/getElementsByTagName" class="html" target="_blank">getElementsByTagName</a>.</p>
                                </li>
                                <li>
                                    <p>Il faut parcourir cette table pour trouver les cellules. Utilisez l'inspecteur du browser pour bien visualiser la structure de l'arbre. Utilisez par exemple <a href="http://www.w3schools.com/dom/prop_element_childnodes.asp" class="html" target="_blank">prop element childnodes</a>.</p>
                                </li>
                                <li>
                                    <p>Les &lt;div&gt; dans chacune des cellules doivent avoir leurs backgroundColor misent à blanc, rouge ou jaune en fonction de l'état du jeu.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>Les tours de jeu ne peuvent plus être gérés par une boucle utilisant un <span class="html">console.readln()</span> : ccette fonction n'existe pas dans un navigateur. Par contre, nous avons placé des boutons qui appelle la fonction joue et donnant en paramètre le numéro de colonne qui doit être joué. Implémentez cette fonction.</p>
                        </li>
                        <li>
                            <p>Bonus 1 : améliorer le programme en soignant la présentation avec le CSS, ajoutez un texte qui indique qui doit jouer, gérer de la fin du jeu avec la possibilité de relancer une partie, etc...</p>
                        </li>
                        <li>
                            <p>Bonus 2 : animons la descente d'un pion dans la grille. La manière d'effectuer cela en JavaScript est contre-intuitive : on ne peut pas faire une boucle qui passe le pion dans chacune des cases intermédiaires. Le résultat sera que le navigateur reste "gelé" durant toute la période de l'animation et seule la dernière étape est affichée. La raison est qu'un navigateur agit d'une manière mono-threadée : quand la boucle JavaScript s'exécute, rien d'autre ne se passe : pas d'intéraction avec l'utilisateur, pas de rafraïchissement de l'interface. Il faut donc "rendre" la main au navigateur, en terminant le traitement en cours (en laissant la fonction s'achever). Mais l'animation demande de reprendre la main après un certain temps pour afficher l'étape suivante. Nous utiliserons la fonction <span class="html">setTimeout(f, t)</span> pour effectuer cela : <span class="html">f</span> est une fonction qui sera appelée après <span class="html">t</span> millisecondes. Ainsi, si nous avons besoin d'une boucle, nous pouvons écrire :</p>
<pre><code class="html">function boucle (etape, max) {
    if (etape &gt;= max) {
        return;
    }
    // gérer le traitement de l'étape n° etape
    setTimeout(function() {
        boucle(etape + 1, max);
    }, 100);
}
boucle(1, 10);</code></pre>
                            <p>Ainsi la fonction <span class="em">boucle</span> sera appelée jusqu'à ce que l'étape soit supérieur ou égal au max. Chaque traitement s'effectue à la place du commentaire, c'est similaire au corps d'une boucle for. Pour que l'itération suivante se fasse, la fonction setTimeout est appelée. Le premier paramètre est une fonction qui appelle la fonction <span class="em">boucle</span> en incrémentant le numéro d'étape. Le scond paramètre dit de le faire dans <span class="em">100 ms</span>.</p>
                        </li>
                    </ul>
                    <p>Dans le fichier "puissance4.css" :</p>
<pre><code class="html">#grille td {
	width: 2cm;
	height: 2cm;
	border: 2px solid black;
	border-radius: 50%;
}

#grille div, button {
	width: 100%;
	height: 100%;
	border-radius: 50%;
}

button #reload {
	border-radius: unset;
	padding: 10px;
	width: initial;
	height: initial;
}</code></pre>
                    <p>Dans le fichier "puissance4.html" :</p>
<pre><code class="html">&lt;!DOCTYPE HTML&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8"&gt;
        &lt;title&gt;Puissance 4&lt;/title&gt;
        &lt;link rel="stylesheet" type="text/css" href="puissance4.css"&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;C'est aux &lt;span id="information"&gt;red&lt;/span&gt; de jouer !!!&lt;/h1&gt;
        &lt;table id="grille"&gt;
            &lt;tbody&gt;
                &lt;!-- 1 --&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;!-- 2 --&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;!-- 3 --&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;!-- 4 --&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;!-- 5 --&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;!-- 6 --&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;div&gt;&lt;/div&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;!-- 7 --&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;button onclick="joue(1)"&gt;1&lt;/button&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;button onclick="joue(2)"&gt;2&lt;/button&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;button onclick="joue(3)"&gt;3&lt;/button&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;button onclick="joue(4)"&gt;4&lt;/button&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;button onclick="joue(5)"&gt;5&lt;/button&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;button onclick="joue(6)"&gt;6&lt;/button&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;button onclick="joue(7)"&gt;7&lt;/button&gt;&lt;/td&gt;
                &lt;/tr&gt;
            &lt;/tbody&gt;
        &lt;/table&gt;
        &lt;script type="application/JavaScript" src="puissance4.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Dans le fichier "puissance4.js" :</p>
<pre><code class="html">var nbrLignes = 6;
var nbrColonnes = 7;
var caseVide = ' ';
var jetonRouge = 'O';
var jetonRouge = 'X';
var jetonCourant = jetonRouge;
var joueurCourant = 'red';
var suite = 4;
var info = document.getElementById('information');
var td = document.body.getElementsByTagName('td');

var jeu = function () {
    
    var grille = initialiserGrille();
    
    function initialiserGrille() {
        var tab = [];
        for (var ligne = 0; ligne &lt; nbrLignes; ligne++) {
            tab.push([]);
            for (var colonne = 0; colonne &lt; nbrColonnes; colonne++) {
                tab[ligne].push(caseVide);
            }
        }
        return tab;
    }
    
    function afficher() {
        for (var ligne = 0; ligne &lt; nbrLignes; ligne++) {
            var ligneAAfficher = ' | ';
            for (var colonne = 0; colonne &lt; nbrColonnes; colonne++) {
                ligneAAfficher += grille[ligne][colonne] + ' | ';
            }
            console.log(ligneAAfficher);
        }
    }

    function jouer(colonne, couleur) {
        colonne--;
        var ligne;
        for (ligne = 0; ligne &lt; nbrLignes; ligne++) {
            if (grille[ligne][colonne] !== caseVide) {
                break;
            }
        }
        if (ligne === 0) {
            return false;
        }
        ligne--;
        grille[ligne][colonne] = couleur;
        /* var nb = (ligne * nbrColonnes) + colonne;
        td[nb].style.backgroundColor = joueurCourant; */
        animer(ligne, 0, colonne);
        return true;
    }
    
    function animer(max, ligne, colonne) {
        if (ligne &gt; max) {
            changerJoueur();
            return;
        }
        if (ligne - 1 &gt;= 0) {
            var nbO = ((ligne - 1) * nbrColonnes) + colonne;
            td[nbO].style.backgroundColor = 'white';
        }
        var nbC = (ligne * nbrColonnes) + colonne;
        td[nbC].style.backgroundColor = joueurCourant;

        setTimeout(function() {
            animer(max, ligne + 1, colonne);
        }, 10);
    }
    
    function checkedColonne() {
        for (var colonne = 0; colonne &lt; nbrColonnes; colonne++) {
            for (var ligne = 0; ligne &lt;= nbrLignes - suite; ligne++) {
                if (grille[ligne][colonne] !== caseVide &amp;&amp; grille[ligne][colonne] === grille[ligne + 1][colonne] &amp;&amp; grille[ligne][colonne] === grille[ligne + 2][colonne] &amp;&amp; grille[ligne][colonne] === grille[ligne + 3][colonne]) {
                    return grille[ligne][colonne];
                }
            }
        }
        return false;
    }
    
    function checkedLigne() {
        for (var colonne = 0; colonne &lt;= nbrColonnes - suite; colonne++) {
            for (var ligne = 0; ligne &lt; nbrLignes; ligne++) {
                if (grille[ligne][colonne] !== caseVide &amp;&amp; grille[ligne][colonne] === grille[ligne][colonne + 1] &amp;&amp; grille[ligne][colonne] === grille[ligne][colonne + 2] &amp;&amp; grille[ligne][colonne] === grille[ligne][colonne + 3]) {
                    return grille[ligne][colonne];
                }
            }
        }
        return false;
    }
    
    function checkedD1() {
        for (var ligne = 0; ligne &lt;= nbrLignes - suite; ligne++) {
            for (var colonne = 0; colonne &lt;= nbrColonnes - suite; colonne++) {
                if (grille[ligne][colonne] !== caseVide &amp;&amp; grille[ligne][colonne] === grille[ligne - 1][colonne -1] &amp;&amp; grille[ligne][colonne] === grille[ligne - 2][colonne - 2] &amp;&amp; grille[ligne][colonne] === grille[ligne - 3][colonne -3]) {
                    return grille[ligne][colonne];
                }
            }
        }
        return false;
    }
    
    function checkedD2() {
        for (var ligne = 0; ligne &lt;= nbrLignes - suite; ligne++) {
            for (var colonne = 0; colonne &lt; nbrColonnes; colonne++) {
                if (grille[ligne][colonne] !== caseVide &amp;&amp; grille[ligne][colonne] === grille[ligne + 1][colonne -1] &amp;&amp; grille[ligne][colonne] === grille[ligne + 2][colonne - 2] &amp;&amp; grille[ligne][colonne] === grille[ligne + 3][colonne -3]) {
                    return grille[ligne][colonne];
                }
            }
        }
        return false;
    }
    
    function gagnant() {
        var gagnant;
        if ((gagnant = checkedLigne()) !== false) {
            return joueur(gagnant);
        }
        if ((gagnant = checkedColonne()) !== false) {
            return joueur(gagnant);
        }
        if ((gagnant = checkedD1()) !== false) {
            return joueur(gagnant);
        }
        if ((gagnant = checkedD2()) !== false) {
            return joueur(gagnant);
        }
        return false;
    }
    
    function grilleRemplie() {
        for (var ligne = 0; ligne &lt; nbrLignes; ligne++) {
            for (var colonne = 0; colonne &lt; nbrColonnes; colonne++) {
                if (grille[ligne][colonne] === caseVide) {
                    return false;
                }
            }
        }
        return true;
    }
    
    function joueur(jeton) {
        return (jeton === jetonRouge) ? 'red' : 'yellow';
    }
    
    function changerJoueur() {
        if (joueurCourant === 'red') {
            jetonCourant = jetonJaune;
            joueurCourant = 'yellow';
        } else {
            jetonCourant = jetonRouge;
            joueurCourant = 'red';
        }
    }
    
    var self = {
        afficher : afficher,
        jouer : jouer,
        gagnant : gagnant,
        grilleRemplie : grilleRemplie
    };
    
    return self;
}

var game = jeu();
var gagnant;
var button = '&lt;br&gt;&lt;button onclick="location.reload();" id="reload"&gt;Recharger la grille&lt;/button&gt;';

function joue(i) {
    game.jouer(i);
    info.innerHTML = joueurCourant;
    game.afficher();
    if (game.grilleRemplie()) {
        info.innerHTML = 'C\'est égalité !' + button;
    }
    if ((gagnant = game.gagnant()) !== false) {
        info.innerHTML = 'Le gagnant est les "' + gagnant + '"' + button;
    }
}</code></pre>
                    <h3 id="exercice5">Exercices 5 sur jQuery :</h3>
                    <h4>Préambule - Environnement de développement jQuery :</h4>
                    <p>Consultez à l'aide de Notepad++ le code source de deux emples dans les répertoires suivants d'"Exercices 4" :</p>
                    <ul>
                        <li>
                            <p>Base pour le développement</p>
                        </li>
                        <li>
                            <p>Hello World !</p>
                        </li>
                    </ul>
                    <p>Faites-les fonctionner dans le navigateur Web de votre choix.</p>
                    <ol>
                        <li>
                            <p>À partir du code présenté dans le dossier "Exercice 4.1", écrivez un script jQuery pour :</p>
                            <ol>
                                <li>
                                    <p>colorier le <sup>er</sup> élément de la liste en rouge</p>
                                </li>
                                <li>
                                    <p>colorier les éléments de la liste une ligne sur deux en vert et l'autre ligne sur deux en rouge.</p>
                                </li>
                            </ol>
                            <p>Dans le fichier "index.html" :</p>
<pre><code class="html">&lt;!DOCTYPE HTML&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8"&gt;
        &lt;title&gt;Exercice 4.1&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div&gt;
            &lt;ul id="list"&gt;
                &lt;li&gt;Élément 1 de liste&lt;/li&gt;
                &lt;li&gt;Élément 2 de liste&lt;/li&gt;
                &lt;li&gt;Élément 3 de liste&lt;/li&gt;
                &lt;li&gt;Élément 4 de liste&lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;
        &lt;script src="jquery.js"&gt;&lt;/script&gt;
        &lt;script src="myscript.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                            <p>Dans le fichier "myscript.js" :</p>
<pre><code class="html">$(function() {
	$('#list &gt; li:first').css('color', 'red');
	$('#list &gt; li:even').css('color', 'green');
	$('#list &gt; li:odd').css('color', 'red');
});</code></pre>
                        </li>
                        <li>
                            <p>À partir du code présenté dans le dossier "Exercice 4.2", écrivez un script jQuery pour :</p>
                            <ol>
                                <li>
                                    <p>mettre le focus sur la 1<sup>ère</sup> zone de texte du formulaire</p>
                                </li>
                                <li>
                                    <p>colorier le background de tous les éléments de type input, textarea, select et button en #FAFAD2,</p>
                                </li>
                                <li>
                                    <p>sélectionner d'emblée le radio button Homme,</p>
                                </li>
                                <li>
                                    <p>dimensionner l'image à 300 pixels de largeur,</p>
                                </li>
                                <li>
                                    <p>qu'au clic dans la zone textarea, le contenu de celle-ci soit effacé,</p>
                                </li>
                                <li>
                                    <p>colorier le background de l'élément ayantle focus en #F0E68C,</p>
                                </li>
                                <li>
                                    <p>qu'au clic sur l'image, une boîte de dialoue s'ouvre et affiche "Sexe : H" ou "Sexe : F" selon le radio button sélectionné.</p>
                                </li>
                            </ol>
                            <p>Dans le fichier "index.html" :</p>
<pre><code class="html">&lt;!DOCTYPE HTML&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8"&gt;
        &lt;title&gt;Formulaire&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;form method="POST"&gt;
            Nom d'utilisateur
            &lt;input type="text" name="nom"/&gt;&lt;br&gt;
            Mot de passe
            &lt;input type="password" name="pass"/&gt;&lt;br&gt;
            Sexe&lt;br&gt;
            Hommme &lt;input type=radio" name="sexe" value="H"/&gt;&lt;br&gt;
            Femme &lt;input type=radio" name="sexe" value="F"/&gt;&lt;br&gt;
            Commentaires
            &lt;textarea rows="3" name="commentaire"&gt;Entrez votre commentaire ici&lt;/textarea&gt;&lt;br&gt;
            &lt;img id="image" src="chat.jpg"/&gt;&lt;br&gt;
            &lt;input type="submit" value="Envoyer"/&gt;
        &lt;/form&gt;
        &lt;script src="jquery.js"&gt;&lt;/script&gt;
        &lt;script src="myscript.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                            <p>Dans le fichier "myscript.js" :</p>
<pre><code class="html">$(function() {
	$('input[type="text"]:first').focus();
	$('input, textarea, select, button').css('backgroundColor', '#FAFAD2');
	$('input[type="radio"][value="H"]').prop('checked', true);
	$('#image').css('width', '300px');
	$('textarea').on('click', function(event) {
		$(event.currentTarget).html('');
		$(this).html('');
	});
	$(':input').on('focus', function() {
		$(this).css('backgroundColor', '#F0E68C');
	});
	$(':input').on('blur', function() {
		$(this).css('backgroundColor', '#FAFAD2');
	});
	$('#image').click(function() {
		alert('Sexe : ' + $(':radio:checked').val());
	});
});</code></pre>
                        </li>
                    </ol>
                    <h3 id="exercice6">Exercice n° 6 en jQuery :</h3>
                    <h4>Objectifs :</h4>
                    <ul>
                        <li>
                            <p>Être capable de gérer des événements en jQuery,</p>
                        </li>
                        <li>
                            <p>Être capable d'écrire des fonctions,</p>
                        </li>
                        <li>
                            <p>Être capable d'insérer des éléments dans le DOM.</p>
                        </li>
                    </ul>
                    <h4>Préambule - Base de développement de l'exercice 5 :</h4>
                    <p>Consultez à l'aide de Notepad++ le code source présenté dans le répertoire "Base pour le développement de l'exercice 5".</p>
                    <p>Faites-le fonctionner dans le navigateur Web de votre choix.</p>
                    <p>Il s'agit d'une page Web avec un champ de saisie de type texte (<span class="em">textfield</span>), deux boutons et une table à une seule case.</p>
                    <p><img src="../images/exo5-1.png" alt=""></p>
                    <p>C'est une base de travail pour la créaton d'un mini-tableur.</p>
                    <h4>Étape 1 - Insertion d'une colonne :</h4>
                    <p>La première étape est d'insérer une colonne. Lorsque l'utilisateur appuie sur le bouton "Ajouter une colonne" le script lit la valeur contenue dans le <span class="em">textfield</span> et ajoute une colonne à la table avec pour contenu la valeur du <span class="em">textfield</span>.</p>
                    <p>Remarque : avant d'écrire votre script, vous pouvez exécuter des sélections jQuery dans la console JavaScript de Chrome.</p>
                    <p><img src="../images/exo5-2.png" alt=""></p>
                    <h4>Étape 2 - Insertion d'une ligne :</h4>
                    <p>Similaire à l'étape 1, ajoutez une ligne plutôt qu'une colonne.</p>
                    <p>Remarque : une ligne peut évidemment contenir une ou plusieurs colonnes.</p>
                    <p><img src="../images/exo5-3.png" alt=""></p>
                    <h4>Étape 3 - Ajout d'une colonne avec plusieurs lignes :</h4>
                    <p>Vérifiez que lorsque vous ajoutez une colonne, celle-ci contient autant de lignes que le tableau. Si ce n'est pas le cas, adaptez votre code.</p>
                    <p><img src="../images/exo5-4.png" alt=""></p>
                    <h4>Étape 4 - Sélection d'une case :</h4>
                    <p>Nous voulons maintenant que lorsque l'utilisateur clique sur une case, il puisse en modifier le contenu. Quand le contenu est modifié, le <span class="em">textfield</span> "Valeur cellule :" est aussi modifé.</p>
                    <p>Piste de solution : Il faudra en fait ajouter un <span class="em">listener</span> par case.</p>
                    <p><img src="../images/exo5-5.png" alt=""></p>
                    <p>Illustration : modification de la case du tableau située en 2<sup>ème</sup> colonne, 2<sup>ème</sup> ligne.</p>
                    <p><img src="../images/exo5-6.png" alt=""></p>
                    <p>Illustration : modification de la case du tableau située en 1<sup>ère</sup> colonne, 1<sup>ère</sup> ligne.</p>
                    <h4>Étape 5 - Coloriage d'une case :</h4>
                    <p>Gérez le fait qu'en cliquant avec le bouton de droite de la souris sur une case du tableau, celle-ci est coloriée en jaune.</p>
                    <p>Remarque : pour réaliser cette fonctionnalité, il faudra empêcher le menu contenu contextuel par défaut d'apparaître. Cherchez une solution sur Internet pour ce faire.</p>
                    <p><img src="../images/exo5-7.png" alt=""></p>
                    <p>Et, si vous appuyez sur ALT + clic droit de la souris, la case est décolorisée.</p>
                    <p><img src="../images/exo5-8.png" alt=""></p>
                    <p>Remarque : lorsque vous ajoutez une nouvelle colonne ou ligne, les cellules ne doivent pas être colories en jaune.</p>
                    <h4>Étape 6 - Déplacement dans le tableau :</h4>
                    <p>Enfin, dernière étape pour cet exercice, lors de la modification d'une case, il faut pouvoir se déplacer sur une case adjacente en appuyant sur ALT et l'une des 4 flèches du clavier.</p>
                    <p>Remarque : vérifiez que la touche Enter fonctionne lors de la modification d'une case.</p>
                    <p>Dans le fichier "index.html" :</p>
<pre><code class="html">&lt;!DOCTYPE HTML&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8"&gt;
        &lt;title&gt;Un Mini Tableur&lt;/title&gt;
        &lt;style type="text/css"&gt;
            td {
                border: 1px solid #000;
                width: 50px;
                height: 30px;
                padding: 0px;
                font-size: 14px;
                font-family: Arial;
            }
            
            table {
                margin-top: 10px;
                border-collapse: collapse;
            }
            
            input {
                font-size: 14px;
                font-family: Arial;
                width: 44px;
            }
            
            table input {
                width: 44px;
                height: 24px;
                border-color: transparent;
            }
            
            .coloriee {
                background-color: yellow;
            }
            
            .selected {
                border: 2px solid blue;
            }
        &lt;/style&gt;
    &lt;/head&gt;
    &lt;body&gt;
        Valeur cellule :
        &lt;input type="text" id="valeurCellule" name="valeur"/&gt;
        &lt;button id="btnNewCol"&gt;Ajouter une colonne&lt;/button&gt;
        &lt;button id="btnNewRow"&gt;Ajouter une ligne&lt;/button&gt;
        &lt;table id="myTable"&gt;
            &lt;tbody&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;/td&gt;
                &lt;/tr&gt;
            &lt;/tbody&gt;
        &lt;/table&gt;
        &lt;script type="application/JavaScript" src="jquery.js"&gt;&lt;/script&gt;
        &lt;script type="application/JavaScript" src="myscript.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Dans le fichier "myscript.js" :</p>
<pre><code class="html">$(function() {
	$('#btnNewCol').click(function() {
		var v = $('#valeurCellule).val();
		addCol(v);
	});
	
	$('#btnNewRow').click(function() {
		var v = $('#valeurCellule).val();
		addRow(v);
	});
	
	$('tbody').on('click', 'td', function() {
		selected($(this));
	});
	
	var selectionne = null;
	$('#valeurCellule').on('change', function() {
		if (selectionne !== null) {
			selectionne.text($('#valeurCellule').val));
		}
	});
	
	$(document).on('keyup', function(event) {
		if (!event.altKey || selectionne === null) {
			return;
		}
		switch(event.key) {
			case 'ArrowLeft' :
				selectionne.prev().click();
				break;
			case 'ArrowUp' :
				selectionne.parent().prev().children().eq(selectionne.index()).click();
				break;
			case 'ArrowRight' :
				selectionne.next().click();
				break;
			case 'ArrowDown' :
				selectionne.parent().next().children().eq(selectionne.index()).click();
				break;
		}
	});
	
	function selected(td) {
		if (selectionne !== null) {
			$(selectionne).removeClass('selected');
		}
		$('#valeurCellule').val(td.text());
		selectionne = td;
		$(selectionne).addClass('selected');
	}
	
	function addCol(val) {
		$('myTable tr').each(function(i, el) {
			var td = $('&lt;td&gt;').text(val);
			$(el).append(td);
			changeColor(td);
		});
	}
	
	function addRow(val) {
		$('#myTable').append($('&lt;tr&gt;'));
		$('#myTable tr:first td').each(function(i, el) {
			var td = $('&lt;td&gt;').text(val);
			$('tr:last').append(td);
			changeColor(td);
		});
	}
	
	function changeColor(td) {
		td.on('contextmenu', function(event) {
			if (event.altKey) {
				$(this).removeClass('coloriee');
			} else {
				$(this).addClass('coloriee');
			}
			event.preventDefault();
		});
	}
	
	function modifieCase(td) {
		var oldValue = $(td).text();
		td.on('click', function(event) {
			$('#valeurCellule').val(oldValue).on('keyup', function(event) {
				if (event.key === 'Enter') {
					$(td).text($(this).val());
				}
			});
			$(this).blur(function() {
				$(td).html(oldValue);
			});
		});
	}
});</code></pre>
                    <h3 id="exercice7">Exercice n° 7 :</h3>
                    <p>Un formulaire HTML peut être composé de différents composants graphiques.</p>
                    <p>Le but de l'exercice est de transformer l'état d'un formlaire en un JSON équivalent, et inversément. Le JSON aura pour clefs les noms des différents éléments du formulaire (attribut name), et pour valeurs :</p>
                    <ul>
                        <li>
                            <p>Input de type texte, password &#8596; chaîne de caractères</p>
                        </li>
                        <li>
                            <p>Input de type number &#8596; number</p>
                        </li>
                        <li>
                            <p>Input de type radiobutton &#8596; valeur du bouton sélectionné ou null si aucun ne l'est</p>
                        </li>
                        <li>
                            <p>Input de type checkbutton &#8596; true/false</p>
                        </li>
                        <li>
                            <p>Textarea &#8596; chaîne de caractères</p>
                        </li>
                        <li>
                            <p>Select unique &#8596; valeur de l'élément sélectionné ou null si aucun  ne l'est</p>
                        </li>
                        <li>
                            <p>Select multiple &#8596; tableau des valeurs des éléments sélectionnés</p>
                        </li>
                    </ul>
                    <ol>
                        <li>
                            <p>Créez un formulaire HTML. Il doit contenir au minimum un élément de chacun des types ci-dessus.</p>
                        </li>
                        <li>
                            <p>Ajoutez un bouton "JSON". Quand l'utilisateur clique sur ce bouton, la fonction formToJSON est appelée en donnant l'élément racine du formulaire en paramètre. Cette méthode renvoie le JSON représentant l'état du formulairen qui est alors affiché (par exemple dans un textarea en base de la page). Vous devez écrire tout le code gérant ceci.</p>
                        </li>
                        <li>
                            <p>Ajoutez un textarea en dessous du formulaire (ou réutilisez celui du point précédent), et un bouton "Formulaire". Quand l'utilisateur clique sur ce bouton, la fonction JSONToForm est appelée en donnant l'élément racine du formulaire en paramètre ainsi que le contenu du textarea. Cette méthode transforme le texte en objet JSON et change le formulaire pour prendre l'état d'écrit par ce dernier. Vous devez écrire tout le code gérant ceci.</p>
                        </li>
                        <li>
                            <p>Ajoutez un bouton "Nettoyer" : ce dernier parcourt le formulaire et vide tous les champs. De plus, les checkbox sont mises à faux, le premier radio de chaque groupe est sélectionné, la première option de chaque select unique est sélectionnée, tout est déselectionné pour les selects multiples.</p>
                        </li>
                        <li>
                            <p>Paufinez votre solution :</p>
                            <ol type="a">
                                <li>
                                    <p>Les éléments désactivés sont ignorés par fromToJSON, ils ne doivent pas apparaître dans le JSON.</p>
                                </li>
                                <li>
                                    <p>Rendez JSONToForm solide : les éléments désactivés ne doivent pas être modifiés. SI la valeur fournie par JSON n'est pas valide, alors le champ doit rester inchangé. Si plusieurs champs portent le même nom, une exception doit être lancée; attention cependant qu'il est normal que plusieurs radio portent le même nom. Etc...</p>
                                </li>
                            </ol>
                        </li>
                    </ol>
                    <p>Dans le fichier "exo6.html" :</p>
<pre><code class="html">&lt;DOCTYPE HTML&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8"&gt;
        &lt;title&gt;Exos séance 6&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;form action="#" method="POST" id="f"&gt;
            &lt;p&gt;Nom : &lt;input type="text" name="nom" placeholder="entrez votre nom"&gt;&lt;/p&gt;
            &lt;p&gt;Prénom : &lt;input type="text" name="prenom" placeholder="entrez votre prénom"&gt;&lt;/p&gt;
            &lt;p&gt;Sexe : M &lt;input type="radio" name="sexe" value="M"&gt; F &lt;input type="radio" name="sexe" value="F"&gt;&lt;/p&gt;
            &lt;p&gt;Email : &lt;input type="mail" name="email" placeholder="entrez votre email"&gt;&lt;/p&gt;
            &lt;p&gt;Numéro de téléphone : &lt;input type="number" name="phone_number" placeholder="entrez votre num de tel"&gt;&lt;/p&gt;
            &lt;p&gt;Numéro de téléphone : &lt;input type="password" name="password" placeholder="entrez votre password"&gt;&lt;/p&gt;
            &lt;p&gt;Remarques : &lt;textarea cols="15" rows="5"name="remarques"&gt;&lt;/textararea&gt;&lt;/p&gt;
            &lt;p&gt;Choix d'options :&lt;/p&gt;
            &lt;select name="option_selected"&gt;
                &lt;option name="SAP"&gt;SAP&lt;/option&gt;
                &lt;option name="IA"&gt;IA&lt;/option&gt;
                &lt;option name="Unity"&gt;Unity&lt;/option&gt;
            &lt;/select&gt;
            &lt;p&gt;Choix de plusieurs options :&lt;/p&gt;
            &lt;select multiple name="options_selected"&gt;
                &lt;option name="SAP"&gt;SAP&lt;/option&gt;
                &lt;option name="IA"&gt;IA&lt;/option&gt;
                &lt;option name="Unity"&gt;Unity&lt;/option&gt;
            &lt;/select&gt;
            &lt;p&gt;Cochez pour accepter les termes d'utilisation : &lt;input type="checkbox" name="accept_term" value="accepted"&gt;&lt;/p&gt;
        &lt;/form&gt;
        &lt;p&gt;&lt;input type="submit" value="FormToJSON" onclick="formToJSON($('#f'));"&gt;&lt;/p&gt;
        &lt;p&gt;&lt;input type="submit" value="JSONToForm" onclick="JSONToForm($('#f'), $('#json').val());"&gt;&lt;/p&gt;
        &lt;p&gt;&lt;input type="submit" value="Nettoyer" onclick="clearForm($('#f'));"&gt;&lt;/p&gt;
        &lt;p&gt;&lt;textarea cols="25" rows="15" id="json"&gt;&lt;/textarea&gt;&lt;/p&gt;
        &lt;script src="jquery.js"&gt;&lt;/script&gt;
        &lt;script src="myscript.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Dans le fichier "myscript.js" :</p>
<pre><code class="html">function formToJSON(f) {
	var o = {};
	var inputs = f.find('input:not(:radio):not(:checkbox), textarea').each(function(i, el) {
		var nameEl = $(el).attr('name');
		var valEl = $(el).val();
		if ($(el).attr('type') === 'number') {
			valEl = parseFloat(valEl);
		}
		o[nameEl] = valEl;
	});
	inputs = f.find('select').each(function(i, el) {
		var nameEl = $(el).attr('name');
		var valEl = $(el).val();
		if ($(el).attr('multiple') === undefined) {
			o[nameEl] = (valEl === '') ? null : valEl; 
		} else {
			o[nameEl] = (valEl === null) ? [] : valEl;
		}
	});
	inputs = f.find(':radio, :checkbox').each(function(i, el) {
		var nameEl = $(el).attr('name');
		if ($(el).attr('type') === 'radio') {
			p[nameEl] = $(el).is(':checked') ? $(el).val() : null;
		} else if ($(el).attr(type') === 'checkbox') {
			o[nameEl] = $(el).prop('checked');
		}
	});
	return JSON.stringify(o);
}

function JSONToForm(f, texte) {
	var o = (typeof texte === 'string' || texte instanceof String) ? JSON.parse(texte) : texte);
	for (var key in o) {
		var v = o[key];
		var input = $(':input[name=' + key + ']');
		if ($(input).is('select')) {
			if ($(input).attr('multiple') === undefined) {
				$(input).val(v.length === 0 ? null : v);
			} else {
				$(input).val(v === null ? '' : v);
			}
		} else if ($(input).attr('type' === 'checkbox') {
			$(input).prop('checked', v);
		} else if ($(input).attr('type') === 'radio') {
			if (v === null) {
				$(input).prop('checked', false);
			} else {
				$(input).filter('[value="' + v + '"]').prop('checked', true);
			}
		} else {
			$(input).val(o[key]);
		}
	}
	var inputs = f.find(':input').each(function(i, el) {
		var nameEl = $(el).attr('name');
		var valEl = $(el).val();
		if (o[nameEl] === undefined) {
			$(el).val(valEl);
		}
	});
}

function clearForm(f) {
	var inputs = f.find(':input').each(function(i, el) {
		if (($(el).attr('type') === 'radio' || $(el).attr('type') === 'checkbox') {
			$(el).attr('checked', false);
		} else {
			if (!$(el).is('select[multiple]')) {
				$(el).val($(el).find('option:first').val());
			} else {
				$(el).val('');
			}
		}
	});
}</code></pre>
                    <h3 id="exerice8">Exercice n° 8 :</h3>
                    <h4>Partie HTTPServlet :</h4>
                    <p>Nous allons mettre sur pied un site Web qui calcule des expressions mathématiques.</p>
                    <p>L'architecture sera la suivante :</p>
                    <ol>
                        <li>
                            <p>Créez une page HTML contenant un champ textarea dans lequel l'utilisateur rentre sa formule.</p>
                        </li>
                        <li>
                            <p>Ajoutez un bouton pour envoyer la requête. Cette dernière aura la forme d'un <span class="html">GET</span> envoyé au serveur et fournissant la formule du textarea dans le paramètre <span class="em">expr</span>. En d'autres termes, il faudra rediriger la page vers quelque chose ressemblant à http://127.0.0.1/Calc?expr=2+2.</p>
                            <p>Comment redirige-t-on encore en JavaScript ?</p>
                            <p>Ce que l'utilisateur entre dans le textarea finit par se retrouver dans l'URL. Il pourrait donc en profiter pour abuser le comportement de cette URL en y mettant des caractères non prévus, par exemple <span class="html">&</span>. Tout paramètre envoyé par un <span class="html">GET</span> doit être encodé. Consultez <a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Objets_globaux/encodeURIComponent" target="_blank">la documentation de la fonction encodeURIComponent</a> pour la solution standard à ce problème.</p>
                        </li>
                        <li>
                            <p>Créez un serveur en Java :</p>
                            <ol type="a">
                                <li>
                                    <p>Créez un répertoire <span class="em">lib</span> à la racine de votre projet et décompressez-y le contenu de Jetty.zip qui se trouve sur l'ecampus. Faites refresh (F5) sur la racine de votre projet, sélectionnez les fichiers <span class="html">.jar</span> du répertoire <span class="em">lib</span> et <span class="em">click-droit/Build Path/Add To Build Path</span>.</p>
                                </li>
                                <li>
                                    <p>Créez une classe et dans sa méthode main, copiez les lignes de code de la préservation permettant d'utiliser Jetty en mode embedded.</p>
                                </li>
                                <li>
                                    <p>Servez les fichiers requis pour le front-end à l'aide d'un <span class="html">DefaultServlet</span>.</p>
                                </li>
                                <li>
                                    <p>Créez une servlet pour recevoir les <span class="html">GET</span> de calcul d'expressions mathématiques.</p>
                                </li>
                                <li>
                                    <p>Pour le calcul à propremnt dit, vous pouvez utiliser <a href="http://projects.congrace.de/exp4j/index.html" class="html" target="_blank">la librairie exp4j</a>.</p>
                                </li>
                                <li>
                                    <p>La réponse renvoyée doit être simplement un document HTML dont le body est la réponse.</p>
                                </li>
                                <li>
                                    <p>Configurez votre serveur pour que tout fonctionne !</p>
                                </li>
                            </ol>
                        </li>
                        <li>
                            <p>Bonus : améliorer le rendu du résultat :</p>
                            <ul>
                                <li>
                                    <p>Rappelez la formule évaluée (afficher 1+1=2.0 plutôt que se contenter d'afficher juste 2.0).</p>
                                </li>
                                <li>
                                    <p>Rendez l'affichage plus joli.</p>
                                </li>
                                <li>
                                    <p>En plus d'afficher le résultat, permettez d'entrer une nouvelle formule mathématique.</p>
                                </li>
                                <li>
                                    <p>Suivez votre imagination...</p>
                                </li>
                            </ul>
                        </li>
                    </ol>
                    <p>Dans le fichier "index.html" :</p>
<pre><code class="html">&lt;!DOCTYPE HTML&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8"&gt;
        &lt;title&gt;HttpServlet&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
            &lt;textarea&gt;&lt;/textarea&gt;
            &lt;button&gt;Calculer&lt;/button&gt;
        &lt;script src="jquery.js"&gt;&lt;/script&gt;
        &lt;script&gt;
            $('button').click(function() {
                location.replace('/Calc?expr=' + encodeURIComponent($('textarea').val()));
            });
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Dans le fichier "Main.java" :</p>
<pre><code class="html">import javax.servlet.http.HttpServlet;

import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.servlet.DefaultServlet;
import org.eclipse.jetty.servlet.ServletHolder;
import org.eclipse.jetty.webapp.WebAppContext;

public class Main {

    public static void main(String[] args) throws Exception {
        Server server = new Server(8080);
        WebAppContext context = new WebAppContext();
        HttpServlet ms = new MaServlet();
        context.addServlet(new ServletHolder(ms), "/Calc");
        context.setResourceBase("www");
        HttpServlet ds = new DefaultServlet();
        context.addServlet(new ServletHolder(ds), "/");
        server.setHandler(context);
        server.start();
    }

}</code></pre>
                    <p>Dans le fichier "MaServlet.java" :</p>
<pre><code class="html">import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import net.objecthunter.exp4j.Expression;
import net.objecthunter.exp4j.ExpressionBuilder;


public class MaServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        try {
            String expr = req.getParameter("expr");
            Expression e = new ExpressionBuilder(expr).build();
            String html = "&lt;html lang="fr"&gt;&lt;body&gt;" + expr + " = " + e.evaluate() + "&lt;/body&gt;&lt;/html&gt;";
            resp.setStatus(200);
            byte[] b = html.getBytes("UTF-8");
            resp.setContentLength(b.length);
            resp.setContentType("text/html");
            resp.setCharacterEncoding("utf-8");
            resp.getOutputStream().write(b);
        } catch (Exception e) {
            e.printStackTrace();
            resp.setStatus(500);
            resp.setContentType("text/html");
            byte[] msgBytes = e.getMessage().getBytes("UTF-8");
            resp.setContentLength(msgBytes.length);
            resp.setCharacterEncoding("utf-8");
            resp.getOutputStream().write(msgBytes);
        }
    }

}</code></pre>
                    <h4>Partie Genson :</h4>
                    <p>Lisez attentivement <a href="http://owlike.github.io/genson/GettingStarted/" target="_blank">la documentation de Genson</a>.</p>
                    <ol>
                        <li>
                            <p>Dans un fichier <span class="em">calc.json</span>, entrez ceci : <span class="em">{"x":4,"y":10,"eval":"x+y"}</span>.</p>
                            <p>L'idée de ce JSON est de décrire une expression mathématique avec des variables. La clef "eval" contient toujours l'expression à évaluer. Les autres clefs sont par contre libres, chacune représentant une variable de l'expression mathématique.</p>
                            <p>Écrivez un programme Java qui lit le fichier calc dans une chaîne de caractères.</p>
                            <p class="html">String content = new String(Files.readAllBytes(Path.get("calc.json")));</p>
                            <p>Utilisez Genson et exp4j pour créer l'expression, placer les valeurs des variables et afficher le résultat.</p>
                            <p>Bonis : changerl'application Web de votre point précédent pour qu'elle aussi fonctionne sur base d'un tel JSON.</p>
                            <p>Dans le fichier "calc.json" :</p>
<pre><code class="html">{"x":4,"y":10,"eval":"x + y + c","c":16}</code></pre>
                        </li>
                        <li>
                            <p>Une machine de l'IPL est définie par :</p>
                            <ul>
                                <li>
                                    <p>Son local = un numéro de local</p>
                                </li>
                                <li>
                                    <p>Sa localisation dans ce local = une chaîne de caractères</p>
                                </li>
                                <li>
                                    <p>Un modèle de CPU</p>
                                </li>
                                <li>
                                    <p>Une fréquence de CPU</p>
                                </li>
                                <li>
                                    <p>Une taille de mémoire en GB</p>
                                </li>
                                <li>
                                    <p>Une taille de disque dur en GB</p>
                                </li>
                                <li>
                                    <p>Un modèle de carte graphique</p>
                                </li>
                                <li>
                                    <p>Une date d'achat</p>
                                </li>
                            </ul>
                            <p>Décidez d'une classe Java et d'un JSON qui décrivent cette machine. Faites attention au format de date : dans le JSON, il faut utiliser une chaîne au format <span class="el">JJ/MM/AAAA</span> et en Java utiliser une classe <span class="html">Date</span>.</p>
                            <p>Écrivez trois fichiers JSON : un pour votre machine, un pour la machine à votre gauche (ou derrière ou devant), un pour la machine à votre droite (ou derrière ou devant).</p>
                            <p>Écrivez une classe Java, modèle d'une machine, ainsi que sa méthode toString().</p>
                            <p>Écrivez une application de test qui lit les fichiers JSON, les transforme en objets Java en utilisant vos classes, affiche le contenu avec le toString(), retransforme la classe en chaîne de caractères au format JSON proprement formaté.</p>
                            <p>Dans le fichier "MachineIPL.java" :</p>
<pre><code class="html">import java.time.LocalDate;
import java.time.format.DateTimeFormatter;

public class MachineIPL {

    private int local;
    private String localisation;
    private String modeleCPU;
    private double frequenceCPU;
    private double tailleMemoire;
    private double tailleDisqueDur;
    private String modeleCarteGraphique;
    private LocalDate dateAchat;

    public int getLocal() {
        return local;
    }

    public void setLocal(int local) {
        this.local = local;
    }

    public String getLocalisation() {
        return localisation;
    }

    public void setLocalisation(String localisation) {
        this.localisation = localisation;
    }

    public String getModeleCPU() {
        return modeleCPU;
    }

    public void setModeleCPU(String modeleCPU) {
        this.modeleCPU = modeleCPU;
    }

    public double getFrequenceCPU() {
        return frequenceCPU;
    }

    public void setFrequenceCPU(double frequenceCPU) {
        this.frequenceCPU = frequenceCPU;
    }

    public double getTailleMemoire() {
        return tailleMemoire;
    }

    public void setTailleMemoire(double tailleMemoire) {
        this.tailleMemoire = tailleMemoire;
    }

    public double getTailleDisqueDur() {
        return tailleDisqueDur;
    }

    public void setTailleDisqueDur(double tailleDisqueDur) {
        this.tailleDisqueDur = tailleDisqueDur;
    }

    public String getModeleCarteGraphique() {
        return modeleCarteGraphique;
    }

    public void setModeleCarteGraphique(String modeleCarteGraphique) {
        this.modeleCarteGraphique = modeleCarteGraphique;
    }

    public LocalDate getDateAchat() {
        return dateAchat;
    }

    public void setDateAchat(String dateAchat) {
        this.dateAchat = LocalDate.parse(dateAchat, DateTimeFormatter.ofPattern("dd/MM/yyyy"));
    }

    @Override
    public String toString() {
        return "MachineIPL [local=" + local + ", localisation=" + localisation + ", modeleCPU=" + modeleCPU
                + ", frequenceCPU=" + frequenceCPU + ", tailleMemoire=" + tailleMemoire + ", tailleDisqueDur="
                + tailleDisqueDur + ", modeleCarteGraphique=" + modeleCarteGraphique + ", dateAchat="
                + dateAchat + "]";
    }

}</code></pre>
                            <p>Dans le fichier "TestMachineIPL.java" :</p>
<pre><code class="html">import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.text.SimpleDateFormat;

import com.owlike.genson.GensonBuilder;

public class TestMachineIPL {

    public static void main(String[] args) throws IOException {
        String content = new String(Files.readAllBytes(Paths.get("MineMachine.json")), StandardCharsets.UTF_8);
        MachineIPL machine = new GensonBuilder().useDateFormat(new SimpleDateFormat("dd/MM/yyyy")).useIndentation(true).useConstructorWithArguments(true).create().deserialize(content, MachineIPL.class);
        for (String s : machine.toString().split(",")) {
            System.out.println(s);
        }
    }

}</code></pre>
                            <p>Dans le fichier "MineMachine.json" :</p>
<pre><code class="html">{"local":026,"localisation":"première rangée","modeleCPU":"AMD A8","frequenceCPU":17.6,"tailleMemoire":1024,"tailleDisqueDur":65536,"modeleCarteGraphique":"A8 AMD","dateAchat":"22/11/2017"}</code></pre>
                        </li>
                    </ol>
                    <h3 id="exercice9">Exercice n° 9 :</h3>
                    <p>Nous allons créer une interface permettant de retenir l'information des machines IPL. Chaque machine sera sauvée dans un fichier JSON dans un répertoire que vous choisissez.</p>
                    <ol>
                        <li>
                            <p>Créer une page contenant un select pour sélectionner une machine et un formulaire pour l'éditer.</p>
                        </li>
                        <li>
                            <p>Au chargement de la page, un premier appel Ajax permet d'obtenir la liste de toutes les machines afin de remplir le select.</p>
                            <ul>
                                <li>
                                    <p>En Java 8, c'est la classe <span class="html">Files</span> qui permet de lire ou écrire un fichier avec un minimum d'effort, ou de lister le contenu d'un répertoire. Confer <a href="chrome-extension://mhjfbmdgcfjbbpaeojofohoefgiehjai/index.html" target="_blank">chrome-extension://mhjfbmdgcfjbbpaeojofohoefgiehjai/index.html</a>.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>À la sélection d'une machine, il faut un appel Ajax permettant d'en obtenir la spécification, et peupler le formulaire en conséquence</p>
                            <ul>
                                <li>
                                    <p>N'hésitez pas à récupérer vos résultats des exercices précédents : classe Java modèle d'une machine, fonction JSON&#8594;Formulaire et Formulaire&#8594;JSON, etc.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>Lors de la sauvegarde, il faut un appel Ajax pour donner les nouvelles spécifications au serveur qui met alors son fichier à jour.</p>
                        </li>
                        <li>
                            <p>Bonus : ajouter des boutons "Créer une nouvelle machine" et "Effacer la machine sélectionnée" et rendez-les fonctionnels.</p>
                        </li>
                    </ol>
                    <p>Dans le fichier "index.html" :</p>
<pre><code class="html">&lt;!DOCTYPE HTML&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8"&gt;
        &lt;title&gt;Ajax&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;label for="machines"&gt;Machine :&lt;/label&gt;&lt;select id="machines"&gt;&lt;/select&gt;
        &lt;form style="display: none;" id="form_machine"&gt;
            &lt;p&amp;&amp;gt;lt;label for="local"&gt;Local :&lt;/label&gt;&lt;input type="text" name="local" id="local"&gt;&lt;/p&gt;
            &lt;p&gt;&lt;label for="localisation"&gt;Place :&lt;/label&gt;&lt;input type="text" name="localisation" id="localisation"&gt;&lt;/p&gt;
            &lt;p&gt;&lt;label for="modeleCPU"&gt;CPU :&lt;/label&gt;&lt;input type="text" name="modeleCPU" id="modeleCPU"&gt;&lt;/p&gt;
            &lt;p&gt;&lt;label for="frequenceCPU"&gt;Fréquence :&lt;/label&gt;&lt;input type="number" name="frequenceCPU" id="frequenceCPU"&gt;&lt;/p&gt;
            &lt;p&gt;&lt;label for="tailleMemoire"&gt;Mémoire :&lt;/label&gt;&lt;input type="number" name="tailleMemoire" id="tailleMemoire"&gt;&lt;/p&gt;
            &lt;p&gt;&gt;&lt;label for="tailleDisqueDur"&gt;HDD :&lt;/label&gt;&lt;input type="number" name="tailleDisqueDur" id="tailleDisqueDur"&gt;&lt;/p&gt;
            &lt;p&gt;&lt;label for="modeleCarteGraphique"&gt;GUI :&lt;/label&gt;&lt;input type="text" name="modeleCarteGraphique" id="modeleCarteGraphique"&gt;&lt;/p&gt;
            &lt;p&gt;&lt;label for="dateAchat"&gt;Date d'achat :&lt;/label&gt;&lt;input type="text" name="dateAchat" id="dateAchat"&gt;&lt;/p&gt;
        &lt;/form&gt;
        &lt;button id="save"&gt;Sauver&lt;/button&gt;
        &lt;script src="jquery.js"&gt;&lt;/script&gt;
        &lt;script src="form.js"&gt;&lt;/script&gt;
        &lt;script src="machines.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Dans le fichier "form.js"(même chose qu'en haut) :</p>
<pre><code class="html">function formToJSON(f) {
	var o = {};
	var inputs = f.find('input:not(:radio):not(:checkbox), textarea').each(function(i, el) {
		var nameEl = $(el).attr('name');
		var valEl = $(el).val();
		if ($(el).attr('type') === 'number') {
			valEl = parseFloat(valEl);
		}
		o[nameEl] = valEl;
	});
	inputs = f.find('select').each(function(i, el) {
		var nameEl = $(el).attr('name');
		var valEl = $(el).val();
		if ($(el).attr('multiple') === undefined) {
			o[nameEl] = (valEl === '') ? null : valEl; 
		} else {
			o[nameEl] = (valEl === null) ? [] : valEl;
		}
	});
	inputs = f.find(':radio, :checkbox').each(function(i, el) {
		var nameEl = $(el).attr('name');
		if ($(el).attr('type') === 'radio') {
			p[nameEl] = $(el).is(':checked') ? $(el).val() : null;
		} else if ($(el).attr(type') === 'checkbox') {
			o[nameEl] = $(el).prop('checked');
		}
	});
	return JSON.stringify(o);
}

function JSONToForm(f, texte) {
	var o = (typeof texte === 'string' || texte instanceof String) ? JSON.parse(texte) : texte);
	for (var key in o) {
		var v = o[key];
		var input = $(':input[name=' + key + ']');
		if ($(input).is('select')) {
			if ($(input).attr('multiple') === undefined) {
				$(input).val(v.length === 0 ? null : v);
			} else {
				$(input).val(v === null ? '' : v);
			}
		} else if ($(input).attr('type' === 'checkbox') {
			$(input).prop('checked', v);
		} else if ($(input).attr('type') === 'radio') {
			if (v === null) {
				$(input).prop('checked', false);
			} else {
				$(input).filter('[value="' + v + '"]').prop('checked', true);
			}
		} else {
			$(input).val(o[key]);
		}
	}
	var inputs = f.find(':input').each(function(i, el) {
		var nameEl = $(el).attr('name');
		var valEl = $(el).val();
		if (o[nameEl] === undefined) {
			$(el).val(valEl);
		}
	});
}

function clearForm(f) {
	var inputs = f.find(':input').each(function(i, el) {
		if (($(el).attr('type') === 'radio' || $(el).attr('type') === 'checkbox') {
			$(el).attr('checked', false);
		} else {
			if (!$(el).is('select[multiple]')) {
				$(el).val($(el).find('option:first').val());
			} else {
				$(el).val('');
			}
		}
	});
}</code></pre>
                    <p>Dans le fichier "machines.js" :</p>
<pre><code class="html">$(function() {
	
	$.ajax({
		url: '/Machines',
		type: 'POST',
		data: {action: 'list'},
		success: function(reponse) {
			for (var i = 0; i &lt; reponse.length; i++) {
				var option = $('&lt;option&gt;').text(reponse[i]);
				$('#machines').append(option);
			}
			$('#machines').trigger('change');
			console.info(reponse);
		}
	});
	
	$('#machines').on('change', function() {
		$.ajax({
			url: '/Machines',
			data: {machine: $('#machine option:checked').text(), action: 'get'},
			type: 'POST',
			success: function(reponse) {
				$('#form_machine').css('display', 'block');
				JSONToForm($('#form_machine'), reponse);
			}
=		});
	});
	
	$('#save').click(function() {
		var machine = $('#machines option:checked').text();
		var json = formToJSON($('#form_machine'));
		$.ajax({
			url: '/Machines',
			data: {machine: machine, json: json, action: 'save'},
			type: 'POST',
			success: function(reponse) {
				alert('Machine sauvée');
			}
		});
	});
});</code></pre>
                    <p>Dans le fichier "Main.java" :</p>
<pre><code class="html">import javax.servlet.http.HttpServlet;

import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.servlet.DefaultServlet;
import org.eclipse.jetty.servlet.ServletHolder;
import org.eclipse.jetty.webapp.WebAppContext;

public class Main {

    public static void main(String[] args) throws Exception {
        Server server = new Server(8080);
        WebAppContext context = new WebAppContext();
        HttpServlet ms = new MaServlet();
        context.addServlet(new ServletHolder(ms), "/Machines");
        context.setResourceBase("www");
        HttpServlet ds = new DefaultServlet();
        context.addServlet(new ServletHolder(ds), "/");
        server.setHandler(context);
        server.start();
    }

}</code></pre>
                    <p>Dans le fichier "MaServlet.java" :</p>
<pre><code class="html">import java.io.File;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.StandardOpenOption;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.owlike.genson.Genson;

public class MaServlet extends HttpServlet {

    private static final long serialVersionUID = 1L;

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        try {
            String action = req.getParameter("action");
            switch (action) {
            case "list":
                String[] machines = new File("machines").list();
                String json = new Genson().serialize(machines);
                resp.setStatus(200);
                byte[] b = json.getBytes("UTF-8");
                resp.setContentLength(b.length);
                resp.setContentType("application/json");
                resp.setCharacterEncoding("utf-8");
                resp.getOutputStream().write(b);
                break;
            case "get":
                String machine = req.getParameter("machine");
                File m = new File("machines", machine);
                byte[] bytes = Files.readAllBytes(m.toPath());
                resp.setCharacterEncoding("utf-8");
                resp.setContentType("application/json");
                resp.getOutputStream().write(bytes);
                break;
            case "save":
                machine = req.getParameter("machine");
                m = new File("machines", machine);
                String contenu = req.getParameter("json");
                Files.write(m.toPath(), contenu.getBytes(StandardCharsets.UTF_8), StandardOpenOption.CREATE, StandardOpenOption.TRUNCATE_EXISTING);
                break;
            }
        } catch (Exception e) {
            e.printStackTrace();
            resp.setStatus(500);
            resp.setContentType("text/html");
            byte[] msgBytes = e.getMessage().getBytes("UTF-8");
            resp.setContentLength(msgBytes.length);
            resp.setCharacterEncoding("utf-8");
            resp.getOutputStream().write(msgBytes);
        }
    }

}</code></pre>
                    <h3 id="exercice10">Exercice n° 10 :</h3>
                    <p>Les séances 9 à 12 sont consacrées à perfectionner votre apprentissage par la réalisation d'un projet.</p>
                    <p>Il est attendu de votre part que vous maîtrisiez :</p>
                    <ul>
                        <li>
                            <p>JavaScript et l'organisation du code en pseudo-objets et pseudo-classes.</p>
                        </li>
                        <li>
                            <p>jQuery.</p>
                        </li>
                        <li>
                            <p>JSON et Genson.</p>
                        </li>
                        <li>
                            <p>Le démarrage d'un serveur utilisant Jetty en mode embedded, configuré avec une ou plusieurs servlets.</p>
                        </li>
                        <li>
                            <p>Les requêtes Ajax.</p>
                        </li>
                        <li>
                            <p>L'utilisation de JWT pour signer l'authentification d'un utilisateur.</p>
                        </li>
                        <li>
                            <p>Les cookies.</p>
                        </li>
                        <li>
                            <p>HttpSession.</p>
                        </li>
                    </ul>
                    <p>Ceci compose aussi la matière de l'examen.</p>
                    <p>De plus, vous pouvez profiter du projet pour découvrir Bootstrap, Select2, jQuery UI et jQuery datatables, mais ce n'est pas obligatoire.</p>
                    <p>Plusieurs sujets sont proposés, vous en choisissez un seul. Cependant, pour tous les projets, il faut :</p>
                    <ul>
                        <li>
                            <p>Permettre l'enregistrement est l'authentification des utilisateurs, en utilisant JWT. Utilisez un cookie pour retenir la chaîne JWT et les HTTPSession pour éviter de valider la signature à chaque requête.</p>
                        </li>
                        <li>
                            <p>Utiliser des pseudo-classes et des pseudo-objets en JavaScript.</p>
                        </li>
                        <li>
                            <p>Utiliser jQuery, en réutilisant vos fonctions <span class="html">form&#8596;json</span> quand cela s'y prête.</p>
                        </li>
                        <li>
                            <p>Le serveur doit être en Java, utiliser Jetty en mode embedded et être pensé en stateless. Les données seront enregistrées dans des fichiers textes contenant du JSON.</p>
                        </li>
                    </ul>
                    <p>Ce projet ne sera pas évalué. Vous pouvez donc explorer et prendre des risques sans que cela ne se prête à réelle conséquence. Nous insistons une fois encore sur l'asppect auto-formation : l'examen pourra vous demander de faire n'importe quel point ci-dessus, et vu le temps pour le réaliser vous ne pourrez pas espérer vous auto-former sur le moment même.</p>
                    <h4>Projet A : Dessinez-c'est gagné !</h4>
                    <p>Votre application sera capable de :</p>
                    <ul>
                        <li>
                            <p>Enregistrer un nouvel utilisateur.</p>
                        </li>
                        <li>
                            <p>Authentifier un utilisateur existant.</p>
                        </li>
                        <li>
                            <p>Lorsque l'utilisateur est authentifié, il peut soit dessiner, soit jouer :</p>
                        </li>
                        <li>
                            <p>S'il dessine :</p>
                            <ul>
                                <li>
                                    <p>Une interface à la paint (en très simplifié) lui permet de faire un dessin. Chaque trait a une couleur. Chaque trait retient l'ensemble des points par lequel la souris passe. L'ordre des traits est retenu.</p>
                                </li>
                                <li>
                                    <p>Il peut enregister un ou plusieurs mot-clefs : c'est ce que le joueur doit deviner par le dessin.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>S'il joue :</p>
                            <ul>
                                <li>
                                    <p>Le back-end choisit un dessin au hasard.</p>
                                </li>
                                <li>
                                    <p>Les traits sont dessinés dans leur ordre successif, avec un peu d'attente entre chaque trait 100 ms par exemple).</p>
                                </li>
                                <li>
                                    <p>Il rentre dans un champ texte des propositions. Le serveur l'accepte si la proposition correspond à un des mots clés enregistrés par le dessinateur.</p>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <p>Imaginez un système de points : au plus vite c'est trouvé, au plus grand les points par exemple. Ajoutez une page 'Highscore' listant les utilisateurs classés par leurs points du plus grand au plus petit.</p>
                        </li>
                        <li>
                            <p>Faites preuve d'imagination pour améliorer tout cela.</p>
                        </li>
                    </ul>
                    <p>Dans le fichier "index.html" :</p>
<pre><code class="html">&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;Dessinez-c'est gagné&lt;/title&gt;
    &lt;/head&gt;
&lt;body&gt;
    &lt;div id="page1" style="display: none;"&gt; 
        &lt;form&gt;
            &lt;p&gt;&lt;label for="login"&gt;Login : &lt;/label&gt;&lt;input type="text" name="login" id="login"&gt;&lt;/p&gt;
            &lt;p&gt;&lt;label for="mdp"&gt;Mot de passe :&lt;/label&gt;&lt;input type="password" name="mdp" id="mdp"&gt;&lt;/p&gt;
        &lt;/form&gt;
        &lt;p&gt;&lt;button id="connect"&gt;Connectez-vous&lt;/button&gt;&lt;/p&gt;
    &lt;/div&gt;
    &lt;div id="page2" style="display: none;"&gt;
        &lt;button id="deco"&gt;Déconnexion&lt;/button&gt;
        &lt;canvas style="background-color: #808080;" id="monCanvas"&gt;
        &lt;/canvas&gt;
        &lt;br&gt;
        &lt;button id="envoiDessin"&gt;Envoie le dessin&lt;/button&gt;
    &lt;/div&gt;
    &lt;div id="page3" style="display: none;"&gt;
        &lt;button id="deco1"&gt;Déconnexion&lt;/button&gt;
        &lt;canvas style="background-color: #808080;" id="monCanvas2"&gt;
        &lt;/canvas&gt;
    &lt;/div&gt;
    &lt;script src="jquery.js"&gt;&lt;/script&gt;
    &lt;script src="frontend.js"&gt;&lt;/script&gt;
    &lt;script src="myscript.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Dans le fichier "Main.java" :</p>
<pre><code class="html">import javax.servlet.http.HttpServlet;

import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.servlet.DefaultServlet;
import org.eclipse.jetty.servlet.ServletHolder;
import org.eclipse.jetty.webapp.WebAppContext;

public class Main {

    public static void main(String[] args) throws Exception {
        Server server = new Server(8080);
        WebAppContext context = new WebAppContext();
        HttpServlet ms = new MaServlet();
        context.addServlet(new ServletHolder(ms), "/login");
        context.setResourceBase("www");
        HttpServlet ds = new DefaultServlet();
        context.addServlet(new ServletHolder(ds), "/");
        server.setHandler(context);
        server.start();
    }

}</code></pre>
                    <p>Dans le fichier "MaServlet.java" :</p>
<pre><code class="html">import java.io.IOException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.security.SignatureException;
import java.util.HashMap;
import java.util.Map;

import javax.servlet.ServletException;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.auth0.jwt.JWTSigner;
import com.auth0.jwt.JWTVerifier;
import com.auth0.jwt.JWTVerifyException;

public class MaServlet extends HttpServlet {
    
    private static final long serialVersionUID = 1L;
    private static String JWTSECRET = "jkdh lqjk lcx wuich liuhza";
    private Map&lt;String, String&gt; users = new HashMap&lt;String, String&gt;() {{
        put("toto", "toto");
        put("toto1", "toto1");
        put("toto2", "toto2");
        put("toto3", "toto3");
    }};
    private String dessin = null, dessinateur = null;
    
    @Override
    protected void doPost(HttpServlet req, HttpServletResponse reponse) {
        try {
            String action = req.getParameter("action"), token = null;
            switch (action) {
            case "login":
                String user = req.getParameter("user"), mdp = req.getParameter("password");
                if (users.containsKey(user) &amp;&amp; users.get(user).equals(mdp)) {
                    if (dessinateur == null) {
                        dessinateur = user;
                        resp.getOutputStream().print("dessinateur");
                        resp.getOutputStream().flush();
                    } else if (dessinateur.equals(user)) {
                        resp.getOutputStream().print("devineur");
                        resp.getOutputStream().flush();
                    }
                    Map&lt;String, Object&gt; claims = new HashMap&lt;String; Object&gt;();
                    claims.put("username", user);
                    claims.put("ip", req.getRemoteAddr());
                    token = new JWTSigner(JWTSECRET).sign(claims);
                    Cookie cookie = new Cookie("user", token);
                    cookie.setPath("/");
                    cookie.setMaxAge(60 * 60);
                    resp.addCookie(cookie);
                    req.getSession().setAttribute("userSession", user);
                } else {
                    resp.getOutputStream().write("menteur".getBytes());
                    resp.getOutputStream().flush();
                }
                System.out.println("dessinateur = " + dessinateur + " et dessin = " + dessin);
                break;
            case "isconnected" :
                String session = (String) req.getSession().getAttribute("userSession");
                Cookie[] cookies = req.getCookies();
                if (cookies != null) {
                    for (Cookie c : cookies) {
                        if ("user".equals(c.getName()) &amp;&amp; (c.getSecre()|| token == null) {
                            token = c.getValue();
                        }
                    }
                }
                Map&lt;String, Object&gt; decodedPayload = new JWTVerifier(JWTSECRET).verify(token);
                System.out.println(decodedPayload);
                if (session == null) {
                    resp.getOutputStream().print("personne");
                } else if (session.equalss(dessinateur)) {
                    resp.getOutputStream().print("dessinateur");
                } else {
                    resp.getOutputStream().print("devineur");
                }
                resp.getOutputStream().flush();
                System.out.println("dessinateur = " + dessinateur + " et dessin = " + dessin);
                break;
            case "dessine":
                session = (String) req.getSession().getAttribute("userSession");
                if (session == null || !session.equald(dessinateur)) {
                    resp.getOutputStream().print("tricheur");
                    resp.getOutputStream().flush();
                } else {
                    dessin = req.getParameter("donnees");
                    resp.getOutputStream().write("ok".getBytes());
                    resp.getOutputStream().flush();
                }
                System.out.println("dessinateur = " + dessinateur + " et dessin = " + dessin);
                break;
            case "joue":
                resp.setContentType("application/json");
                resp.getOutputStream().write(dessin.getBytes());
                resp.getOutputStream().flush();
                break;
            case "deco":
                if (req.getSession() != null) {
                    req.getSession().invalidate();
                }
                System.out.println("dessinateur = " + dessinateur + " et dessin = " + dessin);
                break;
            default:
                resp.sendError(HttpServletResponse.SC_BAD_REQUEST, "Action invalide");
            }
        } catch (SignatureException signatureException) {
            System.err.println("Invalid signature!");
        } catch (IllegalStateException illegalStateException) {
            System.err.println("Invalid Token! " + illegalStateException);
        } catch (InvalidKeyException e) {
            System.err.println("Invalid Key! " + e);
        } catch (NoSuchAlgorithmException e) {
            System.err.println("Invalid Algorithm! " + e);
        } catch (IOException e) {
            e.printStackTrace();
        } catch (JWTVerifyException e) {
            System.err.println("JWT Verify Exception! " + e);
        }
    }
    
}</code></pre>
                    <p>Dans le fichier "frontend.js" :</p>
<pre><code class="html">/*!
* Framework Front-End minimaliste
*
* Copyright 2017 Donatien Grolaux
* Released under the MIT license
* https://opensource.org/licenses/MIT
*
* Date: 2017-03-12
*/

var FrontEnd = (function() {

    var onInits = {};
    var onLeaves = {};
    var onDisplays = {};
    var inited = {};
    var currentPage = null;

    function onInitPage(page, f) {
        if (page instanceof String || typeof page == 'string') {
            page=$('#' + page);
        }
        if (page.length != 1) return false;
        onInits[page.attr('id')] = f;
        return true;
    }

    function onLeavePage(page, f) {
        if (page instanceof String || typeof page == 'string') {
            page=$('#' + page);
        }
        if (page.length != 1) return false;
        onLeaves[page.attr('id')] = f;
        return true;
    }

    function onDisplayPage(page, f) {
        if (page instanceof String || typeof page == 'string') {
            page = $('#' + page);
        }
        if (page.length != 1) return false;
        onDisplays[page.attr('id')] = f;
        return true;
    }

    function getCurrentPage() {
        return currentPage;
    }

    function canDisplayPage(page) {
        if (page instanceof String || typeof page == 'string') {
            page = $('#' + page);
        }
        if (page.length != 1) return false;

        if (currentPage !== null) {
            if (onLeaves[currentPage.attr('id')] != undefined) {
                if (onLeaves[currentPage.attr('id')](page) === false) {
                    return false;
                }
            }
        }

        if (inited[page.attr('id')] !== true) {
            if (onInits[page.attr('id')] != undefined) {
                if (onInits[page.attr('id')](page) === false) {
                    return false;
                }
            }
            inited[page.attr('id')] = true;
        }

        if (onDisplays[page.attr('id')] != undefined) {
            if (onDisplays[page.attr('id')](page) === false) {
                return false;
            }
        }

        return true;
    }

    function displayPage(page) {
        if (page instanceof String || typeof page == 'string') {
            page = $('#' + page);
        }

        if (!canDisplayPage(page)) return false;

        if (currentPage !== null) {
            currentPage.css('display', 'none');
        }
        page.css('display', 'block');
        currentPage = page;

    }

    function alert(title, question, message, callback) {
        var modal = $('&gt;div class="modal"&gt;&gt;div class="modal-content"&gt;&gt;div class="modal-header"&gt;&gt;span class="close"&gt;×&gt;/span&gt;&gt;h2&gt;M&gt;/h2&gt;&gt;/div&gt;&gt;div class="modal-body"&gt;&gt;div&gt;&gt;div class="modal-footer"&gt;&gt;/div&gt;  &gt;/div&gt;&gt;/div&gt;');
        modal.find('.modal-header h2').text(title);
        modal.find('.modal-body').text(message);
        var btn=question.split("|");
        modal.find('.modal-header span').css('display', 'none');
        $.each(btn, function(i, item) {
            var btn = $('&gt;button type="button"&gt;');
            switch(item) {
            case 'YES':
                btn.text('Oui');
                break;
            case 'NO':
                btn.text('Non');
                break;
            case 'ALWAYSYES':
                btn.text('Toujours oui');
                break;
            case 'ALWAYSNO':
                btn.text('Toujours non');
                break;
            case 'CANCEL':
                btn.text('Annuler');
                modal.find('.modal-header span').css('display', 'block').on('click', function() {
                    btn.trigger('click');
                });
                break;
            }
            btn.on('click', function() {
                modal.remove();
                modal=null;
                if (callback !== undefined) {
                    callback(item);
                }
            });
            modal.find('.modal-footer').append(btn);
        });
        $('body').append(modal);
        modal.css('display', 'block');
    }

    function ajax(config) {
        var fail = config.error;
        config.error = function(jqxhr, status, error) {
            if (fail !== undefined) {
                if (fail(jqxhr, status, error) === true) {
                    return;
                }
            }
            if (jqxhr.status == 400) {
                FrontEnd.alert('Erreur', 'CANCEL', jqxhr.responseText);
            } else {
                FrontEnd.alert('Erreur grave', 'CANCEL', jqxhr.responseText, function() {location.reload();});
            }
        }
        if (config.type === undefined) config.type = 'POST';
        if (config.url === undefined) config.url = '/dispatch';
        if (config.action!==undefined) {
            if (config.data === undefined) config.data = {};
            config.data.action = config.action;
            delete config.action;
        }
        
        $.ajax(config);
    }

    $('body &gt; .container &gt; .row').css('display', 'none');

    return {
        onInitPage: onInitPage,
        onLeavePage: onLeavePage,
        onDisplayPage: onDisplayPage,
        displayPage: displayPage,
        canDisplayPage: canDisplayPage,
        currentPage: getCurrentPage,
        ajax: ajax,
        alert: alert
    }

})();</code></pre>
                    <p>Dans le fichier "myscript.js" :</p>
<pre><code class="html">$(function() {
	
	$.ajax({
		url: '/login',
		type: 'POST',
		data: {action: 'isconnected'},
		success: function(reponse) {
			console.log(reponse);
			if (reponse === 'dessinateur') {
				FrontEnd.displayPage('page2');
			} else if (reponse === 'devineur') {
				FrontEnd.displayPage('page3');
			} else {
				FrontEnd.displayPage('page1');
			}
		}
	});	
	
	$('#deco').click(function() {
		deco();
	});
	
	$('#deco1').click(function() {
		deco();
	});
	
	function deco() {
		$.ajax({
			url: '/login',
			type: 'POST',
			data: {action: 'deco'},
			success: function (reponse) {
				console.log(reponse);
				location.reload();
			}
		});
	}
	
	$('#connect').click(function() {
		$.ajax({
			url: '/login',
			type: 'POST',
			data: {action: 'login', user: $('#login').val(), password: $('#mdp').val()},
			success:function (reponse) {
				console.log(reponse);
				if (reponse === 'dessinateur') {
					FrontEnd.displayPage('page2');
				} else if (reponse === 'devineur') {
					FrontEnd.displayPage('page3');
				} else {
					alert('MENTEUR !', 'YES');
				}
			}
		});
	});
	
	var canvas = $('#monCanvas');
		console.log(canvas);
		var ctx = canvas[0].getContext('2d');
		var dessine = false;
		var x, y;
		var traits = [];
		var traitEnCours;
		
		canvas.on('mousedown', function(event) {
			dessine = true;
			x = event.offsetX;
			y = event.offsetY;
			traitEnCours = [x, y];
		});
		
		canvas.on('mouseup', function(event) {
			dessine = false;
			traits.push(traitEnCours);
		});
		
		canvas.on('mousemove', function(event) {
			if(dessine) {
				ctx.beginPath();
				ctx.moveTo(x,y);
				ctx.lineTo(event.offsetX, event.offsetY);
				ctx.stroke();
				x = event.offsetX;
				y = event.offsetY;
				traitEnCours.push(x);
				traitEnCours.push(y);
			}
		});
	
	$('#envoiDessin').click(function() {
		$.ajax({
			url: '/login',
			type: 'POST',
			data: {action: 'dessine', donnees: JSON.stringify(traits)},
			success: function (reponse) {
				console.log(reponse);
				if (reponse === 'ok') {
					alert('Envoyé');
				}
			}
		});
	});
	
	FrontEnd.onDisplayPage('page3', function() {
		$.ajax({
			url:'/login',
			type:'POST',
			data:{action:'joue'},
			success:function (reponse) {
				console.log(reponse);
				if (reponse !== null) {
					affiche(reponse, $('#monCanvas2'));
				}		
			}
		});
	});
	
	function affiche(traits, canvas) {	
		var ctx = canvas[0].getContext('2d');
		var lignes = 0;
		var idx = 0;
		
		function callBack() {
			if (lignes &gt;= traits.length) {
				clearInterval(id);
				return;
			}
			if (idx &gt;= traits[lignes].length - 2) {
				lignes++;
				idx = 0;
				return;
			}
			ctx.beginPath();
			ctx.moveTo(traits[lignes][idx], traits[lignes][idx + 1]);
			ctx.lineTo(traits[lignes][idx + 2], traits[lignes][idx + 3]);
			ctx.stroke();
			idx += 2;
		}
		
		var id = setInterval(callBack, 10);
	}
});</code></pre>
                </article>
                <article>
                    <h2 id="examen_janvier_2018">Examen janvier 2018 : Mini-pixel-draw :</h2>
                    <p>Ce mini-programme consiste à implémenter une grille sur laquelle les utilisateurs peuvent cliquer afin d'en colorier les cellules.</p>
                    <h3>Dans le répertoire "Question1" :</h3>
                    <p>Créez une page HTML contenant une table initialement vide (aucun <span class="html">&lt;tr&gt;</span> dans l'HTML). En JavaScript, insérer dans cette table 100 lignes contenant 100 cellules afin d'obtenir une grille de 100x100. De plus, chaque fois que l'utilisateur clique sur une cellule, celle-ci sera coloriée :</p>
                    <ul>
                        <li>
                            <p>Si la cellule est déjà coloriée, rien ne se passe.</p>
                        </li>
                        <li>
                            <p>Au premier click de l'utilisateur, la cellule est coloriée en rouge.</p>
                        </li>
                        <li>
                            <p>Au click suivant, la cellule est coloriée en vert.</p>
                        </li>
                        <li>
                            <p>Au click suivant, la cellule est coloriée en bleu.</p>
                        </li>
                        <li>
                            <p>Les clicks suivants cyclent ces trois couleurs (rougek vert et bleu).</p>
                        </li>
                    </ul>
                    <p>Attention : l'esthétique n'est pas évaluée ! Faites au fonctionnel le plus rapidement possible. Votre code doit utiliser jQuery à bon escient. Il n'y a pas besoin de serveur pour cette question.</p>
                    <p>Dans le fichier "index.html" :</p>
<pre><code class="html">&lt;!DOCTYPE HTML&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8"&gt;
        &lt;title&gt;Examen Janvier 2018&lt;/title&gt;
        &lt;style type="text/css"&gt;
            td {
                width: 5px;
                height: 5px;
            }
        &lt;/style&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;table id="mytable" border="1"&gt;
        &lt;/table&gt;
        &lt;script src="jquery.js"&gt;&lt;/script&gt;
        &lt;script src="myscript.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Dans le fichier "myscript.js" :</p>
<pre><code class="html">$(function() {
	
	var nbClicks = 0;
	var couleurs = ['red', 'green', 'blue'];
	var nbLignes = 100;
	var nbColonnes = 100;
	
	for (var ligne = 0; ligne &lt; nbLignes; ligne++) {
		var tr = $('&lt;tr&gt;');
		for (var colonne = 0; colonne &lt; nbColonnes; colonne++) {
			var td = $('&lt;td&gt;');
			tr.append(td);
			colorierTd(td);
		}
		$('#mytable').append(tr);
	}
	
	function colorierTd (td) {
		td.click(function() {
			var backgroundColor = $(this).css('backgroundColor');
			if (backgroundColor === 'rgba(0, 0, 0, 0)') {
				var indice = nbClicks % couleurs.length;
				$(this).css('backgroundColor', couleurs[indice]);
			}
			nbClicks++;
		});
    }
});</code></pre>
                    <h3>Dans le répertoire "Question2" :</h3>
                    <p>Créez une page HTML contenant un champ login (pas de mot de passe) et un bouton "S'authentifier". Créez un back-end Java à l'aide de Jetty pour servir les ficiers nécessaires.</p>
                    <p>En JavaScript et à l'aide de jQuery, programmez que le click du bouton fasse un appel Ajax à votre back-end. Ce dernier retiendra l'utilisateur dans la session uniquement (pas de token JWT). Une fois authentifié, l'interface affichera un message de bienvenue et un bouton "Se déconnecter" qu'il faut rendre fonctionnel. Attention à ce qu'un refresh de la page neforce pas l'utilisateur à s'authentifier s'il l'est déjà.</p>
                    <p>Dans le fichier "Main.java" :</p>
<pre><code class="html">import javax.servlet.http.HttpServlet;
import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.servlet.DefaultServlet;
import org.eclipse.jetty.servlet.ServletHolder;
import org.eclipse.jetty.webapp.WebAppContext;

public class Main {

    public static void main(String[] args) throws Exception {
    Server server = new Server(8080);
    WebAppContext context = new WebAppContext();
    HttpServlet ms = new MaServlet();
    context.addServlet(new ServletHolder(ms), "/login");
    context.setResourceBase("www");
    HttpServlet ds = new DefaultServlet();
    context.addServlet(new ServletHolder(ds), "/");
    context.setWelcomeFiles(new String[] {"login.html"});
    server.setHandler(context);
    server.start();
    }

}</code></pre>
                    <p>Dans le fichier "MaServlet.java" :</p>
<pre><code class="html">import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

public class MaServlet extends HttpServlet {

    private static final long serialVersionUID = 1L;

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp)
        throws ServletException, IOException {
    String action = req.getParameter("action");
    switch (action) {
        case "login":
        String user = req.getParameter("login");
        if (user != null) {
            req.getSession().setAttribute("userSession", user);
            resp.getWriter().print(true);
        } else {
            resp.getWriter().print("menteur");
        }
        break;
        case "isconnected":
        String userSession = (String) req.getSession().getAttribute("userSession");
        resp.getWriter().print((userSession != null));
        break;
        case "deco":
        if (req.getSession() != null) {
            req.getSession().invalidate();
        }
        break;
        default:
        super.doPost(req, resp);
    }
    }

}</code></pre>
                    <p>Dans le fichier "login.html" :</p>
<pre><code class="html">&lt;!DOCTYPE HTML&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8"&gt;
        &lt;title&gt;Login&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="page1" style="display: none;"&gt;
            &lt;p&gt;&lt;label for="login"&gt;Votre login :&lt;/label&gt;&lt;input type="text" id="login" name="login" placeholder="votre login"&gt;&lt;/p&gt;
            &lt;p&gt;&lt;button id="connexion"&gt;S'authentifier&lt;/button&gt;&lt;/p&gt;
        &lt;/div&gt;
        &lt;div id="page2" style="display: none;"&gt;
            &lt;p&gt;Bienvenue&lt;/p&gt;
            &lt;p&gt;&lt;button id="deco"&gt;Déconnexion&lt;/button&gt;&lt;/p&gt;
        &lt;/div&gt;
        &lt;script src="jquery.js"&gt;&lt;/script&gt;
        &lt;script src="frontend.js"&gt;&lt;/script&gt;
        &lt;script src="login.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Dans le fichier "login.js" :</p>
<pre><code class="html">$(function() {

	$.ajax({
		url: '/login',
		type: 'POST',
		data: {action: 'isconnected'},
		success: function(reponse) {
			console.log(reponse);
			if (reponse === 'true') {
				FrontEnd.displayPage('page2');
			} else {
				FrontEnd.displayPage('page1');
			}
		}
	});
	
	$('#connexion').click(function() {
		$.ajax({
			url: '/login',
			type: 'POST',
			data: {action: 'login', login: $('#login').val()},
			success: function(reponse) {
				console.log(reponse);
				if (reponse === 'true') {
					FrontEnd.displayPage('page2');
				} else {
					alert('Menteur !!!');
				}
			}
		});
	});
	
	$('#deco').click(function() {
		$.ajax({
			url: '/login',
			type: 'POST',
			data: {action: 'deco'},
			success: function(reponse) {
				location.reload();
			}
		});
	});
	
});</code></pre>
                    <h3>Dans le répertoire "Question3" :</h3>
                    <p>Vous pouvez partir du code de la question 2 pour commencer la question 3; pensez à le recopier dans le répertoire "Question3". Lorsqu'un utilisateur est authentifié, le back-end doit en plus choisir une couleur : rouge pour le premier utilisateur authentifié, vert pour le second, bleu pour le troisième, puis on cycle entre ces 3 couleurs. De plus, dans le navigateur, une grille 100x100 cellules s'affiche à l'utilisateur, comme à l'étape 1. Lorsque ce dernier clique sur une cellule, un message est envoyé au serveur. Ce dernier essaie de colorier dans un tableau à 2 dimensions retenu en mémoire (aucune sauvegarde dans un fichier ou BD) :</p>
                    <ul>
                        <li>
                            <p>Si la cellule est déjà coloriée, rien ne se passe.</p>
                        </li>
                        <li>
                            <p>Sinon, la cellule est coloriée de la couleur de l'utilisateur. Le premier utilisateur authentifié colorie donc toujours en rouge, le second toujours en vert, etc.</p>
                        </li>
                    </ul>
                    <p>Le serveur renvoie alors tout le contenu du tableau à l'utilisateur (les couleurs de 100x100 cases). Lorsque le navigateur reçoit cette information, il met sa grille complètement à jour.</p>
                    <p>Astuce : pour tester plusieurs utilisateurs, pensez au mode de navigation privée (un utilisateur en normal et un autre en navigation privée); pensez à déconnecter un utilisateur pour changer de couleur, etc.</p>
                    <p>Dans le fichier "login.html" :</p>
<pre><code class="html">&lt;!DOCTYPE HTML&gt;
&lt;html lang="fr"&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8"&gt;
        &lt;title&gt;Examen Janvier 2018&lt;/title&gt;
        &lt;style type="text/css"&gt;
            td {
                width: 5px;
                height: 5px;
            }
        &lt;/style&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="page1" style="display: none;"&gt;
            &lt;p&gt;&lt;label for="login"&gt;Votre login :&lt;/label&gt;&lt;input type="text" id="login" name="login" placeholder="votre login"&gt;&lt;/p&gt;
            &lt;p&gt;&lt;button id="connexion"&gt;S'authentifier&lt;/button&gt;&lt;/p&gt;
        &lt;/div&gt;
        &lt;div id="page2" style="display: none;"&gt;
            &lt;table id="mytable" border="1"&gt;
            &lt;/table&gt;
            &lt;p&gt;&lt;button id="deco"&gt;Déconnexion&lt;/button&gt;&lt;/p&gt;
        &lt;/div&gt;
        &lt;script src="jquery.js"&gt;&lt;/script&gt;
        &lt;script src="frontend.js"&gt;&lt;/script&gt;
        &lt;script src="login.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
                    <p>Dans le fichier "login.js" :</p>
<pre><code class="html">$(function() {

	var couleur = null;
	var nbLignes = 10;
	var nbColonnes = 10;
	var couleurs = ['red', 'blue', 'green'];
	var matrice;
	
	$.ajax({
		url: '/login',
		type: 'POST',
		data: {action: 'isconnected'},
		success: function(reponse) {
			if (reponse !== 'null') {
				couleur = reponse;
				FrontEnd.displayPage('page2');
			} else {
				FrontEnd.displayPage('page1');
			}
		}
	});
	
	$('#connexion').click(function() {
		$.ajax({
			url: '/login',
			type: 'POST',
			data: {action: 'login', login: $('#login').val()},
			success: function(reponse) {
				console.log(reponse);
				if (reponse !== 'menteur') {
					FrontEnd.displayPage('page2');
					couleur = reponse;
				} else {
					alert('Menteur !!!');
				}
			},
			error: function(jqXHR, textStatus, errorThrown) {
	            console.log(jqXHR.responseText)
	        }
		});
	});
	
	$('#deco').click(function() {
		$.ajax({
			url: '/login',
			type: 'POST',
			data: {action: 'deco'},
			success: function(reponse) {
				couleur = null;
				location.reload();
			},
			error: function(jqXHR, textStatus, errorThrown) {
	            console.log(jqXHR.responseText)
	        }
		});
	});
	
	FrontEnd.onInitPage('page2', function() {
		$.ajax({
			url: '/login',
			type: 'POST',
			data: {action: 'initPage'},
			success: function(reponse) {
				matrice = JSON.parse(reponse);
				FrontEnd.displayPage('page2');
			},
			error: function(jqXHR, textStatus, errorThrown) {
	            console.log(jqXHR.responseText)
	        }
		});
	});
	
	FrontEnd.onDisplayPage('page2', function() {
		$('#mytable tr').remove();
		for (var ligne = 0; ligne &lt; nbLignes; ligne++) {
			var tr = $('&lt;tr&gt;');
			for (var colonne = 0; colonne &lt; nbColonnes; colonne++) {
				var td = $('&lt;td&gt;');
				tr.append(td);
				if (typeof matrice === 'object') {
					console.log(matrice[ligne][colonne]);
					td.css('backgroundColor', matrice[ligne][colonne]);
				}
				colorierTd(td, ligne, colonne);
			}
			$('#mytable').append(tr);
		}
	});
	
	function colorierTd (td, ligne, colonne) {
		td.click(function() {
			/*var backgroundColor = $(this).css('backgroundColor');
			if (backgroundColor === 'rgba(0, 0, 0, 0)') {
				$(this).css('backgroundColor', couleur);
			}*/
			$.ajax({
				url: '/login',
				type: 'POST',
				data: {action: 'click', couleur: couleur, ligne: ligne, colonne: colonne},
				success: function(reponse) {
					matrice = JSON.parse(reponse);
					FrontEnd.displayPage('page2');
				},
				error: function(jqXHR, textStatus, errorThrown) {
		            console.log(jqXHR.responseText)
		        }	
			});
		});
	}
	
});</code></pre>
                    <p>Dans le fichier "Main.js" :</p>
<pre><code class="html">import javax.servlet.http.HttpServlet;
import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.servlet.DefaultServlet;
import org.eclipse.jetty.servlet.ServletHolder;
import org.eclipse.jetty.webapp.WebAppContext;

public class Main {

    public static void main(String[] args) throws Exception {
    Server server = new Server(8080);
    WebAppContext context = new WebAppContext();
    HttpServlet ms = new MaServlet();
    context.addServlet(new ServletHolder(ms), "/login");
    context.setResourceBase("www");
    HttpServlet ds = new DefaultServlet();
    context.addServlet(new ServletHolder(ds), "/");
    context.setWelcomeFiles(new String[] {"login.html"});
    server.setHandler(context);
    server.start();
    }

}</code></pre>
                    <p>Dans le fichier "MaServlet.java" :</p>
<pre><code class="html">import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import com.owlike.genson.Genson;

public class MaServlet extends HttpServlet {

    private static final long serialVersionUID = 1L;
    private static final String[] couleurs = {"red", "blue", "green"};
    private int nbConnexions = 0;
    private String[][] tab = new String[10][10];

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp)
        throws ServletException, IOException {
    String action = req.getParameter("action");
    switch (action) {
        case "initPage":
        resp.getWriter().print(new Genson().serialize(tab));
        break;
        case "login":
        String user = req.getParameter("login");
        if (user != null) {
            String couleur = couleurs[(nbConnexions++) % couleurs.length];
            req.getSession().setAttribute("userSession", user);
            req.getSession().setAttribute("couleur", couleur);
            resp.getWriter().print(couleur);
        } else {
            resp.getWriter().print("menteur");
        }
        break;
        case "isconnected":
        resp.getWriter().print(req.getSession().getAttribute("couleur"));
        break;
        case "deco":
        if (req.getSession() != null) {
            req.getSession().invalidate();
        }
        break;
        case "click":
        String couleur = req.getParameter("couleur");
        int ligne = Integer.parseInt(req.getParameter("ligne"));
        int colonne = Integer.parseInt(req.getParameter("colonne"));
        if (tab[ligne][colonne] == null) {
            tab[ligne][colonne] = couleur;
        }
        resp.getWriter().print(new Genson().serialize(tab));
        break;
        default:
        super.doPost(req, resp);
    }
    }

}</code></pre>
                </article>
                <article>
                    <h2 id="typeScript">TypeScript :</h2>
                    <p>Pour commencer on peut se demander ce qu'est TypeScript et à quoi il peut servir. TypeScript est un superset du JavaScript (du code JavaScript valide est du code TypeScript valide) où on aura la possibilité de spécifier les types attendus lorsque l'on va créer des fonctions ou des variables.</p>
                    <p>Ensuite, TypeScript c'est aussiun outil qui va être capable de passer en revue le code écrit et qui va pouvoir vérifier s'il y a des incohérences de types.</p>
                    <p>Maintenant on peut se demander pourquoi utiliser TypeScript alors que vous êtes peut être déjà satisfait avec JavaScript. Qu'est-ce que va apporter TypeScript...</p>
                    <h3>Les avantages du TypeScript :</h3>
                    <h4>Moins d'erreurs :</h4>
                    <p>TypeScript va vous permettre de limiter les erreurs dans votre code et notamment un type d'erreur que l'on rencontre trop souvent.</p>
<pre><code>Uncaught TypeError: Cannot read properties of undefined (reading 'toLowerCase')</code></pre>
                    <p>Ce type d'erreurs arrive parce que vous avez peut-être fait une erreur de frappe ou parce que vous avez une erreur de logique et une fonction reçoit un paramètre qui n'est pas celui attendu. Le problème est que cette erreur se déclenche assez tard dans notre code et il faut souvent reminter la pile d'appel pour cmprendre l'origine. Avec le TypeScript, si un paramètre n'a pas la bonne forme on sera informé du problème assez tôt et on pourra même corriger l'erreur avant qu'elle ne se produise.</p>
                    <p>L'autre situation est une incohérence de type.</p>
<pre><code>resultat.innerTexte = 'Le prix TTC est : ' + ((amount.value + addons.value) *1.2).toFixed(2)</code></pre>
                    <p>Ici, on a oublié que la valeur d'un champ est de type <span class="em">string</span> et l'addition va en fait être une concaténation. TypeScript renverra une erreur dans cette situation en vous indiquant qu'une multiplication entre une chaîne de caractères et un nombre n'est pas possible.</p>
                    <h4>Une meilleur documentation :</h4>
                    <p>Du code écrit en TypeScript permettra aussi d'avoir une meilleure auto-complétion et une meilleure documentation (à travers le typage on saura quel type de paramètre est attendu par les fonctions). Cette documentation des types sera d'ailleurs beaucoup plus exhaustive que ce qu'il est possible de faire avec JSDoc.</p>
                    <p>Il est d'ailleurs intéressant de noter que votre éditeur utilse probablement les fichiers de définitions TypeScript pour offrir l'auto-complétion sur es librairies de base.</p>
                    <h4>Une cible unique :</h4>
                    <p>Un autre avantage est que l'on peut facilement cibler une version spécifique de TypeScript et lui demander d'exporter le code pour n'importer quelle version de JavaScript (depuis ES3 jusqu'à ESNext). Il peut alors remplacer des outils comme Babel (à condition d'ajouter les polyfills si vous utilisez des objets spéciaux).</p>
                    <h3>Les inconvénients :</h3>
                    <p>Cpmme toute technologie, son utilisation implique aussi quelques inconvénients.</p>
                    <h4>Un outil en plus :</h4>
                    <p>Cela semble évident mais TypeScript va représenter un outil supplémentaire enre votre code et le navigateur / serveur. Vous ne pourrez plus directement coller une fonction dans votre navigateur pour la tester par exemple et vous allez devoir trouver des adapters TypeScript pour les outils que vous avez l'habitude d'utiliser (par exemple pour les tests untaires). Cependant, dans le pire des cas, vous pourrez toujours convertir votre code en JavaScript pourle faire fonctionner avec l'outil de votre choix.</p>
                    <h4>L'écosystème JavaScript :</h4>
                    <p>Pour que TypeScript fonctionne pleinement il a besoin de connaître le type de tous les éléments. Ce qui peut poser un problème lorque l'on choisit d'utiliser une librairie qui n'est écrite qu'en JavaScript. Il faudra donc être plus attentif aux librairies que l'on va choisir et si possible chercher des librairies qui disposent de fichiers de types (un petit logo apparaît maintenant sur NPM.JS pour nous informer de la présence d'un fichier de déclaration).</p>
                    <p>Aussi, le projet <a href="https://definitelytyped.org/" target="_blank">Definitely Typed</a> offre de nombreux de déclaration pour certains paquets npm.</p>
                    <h4>Attention au code dynamique :</h4>
                    <p>Ce problème est un peu particulier car il est le fruit du principe même de TypeScript. Les types étant statiques, ils se marient difficilement avec un code trop dynamique et il faudra parfois repenser sa manière d'écrire. Il faudra, dans la mesure du possible, essayer de s'adapter à la contrainte plutôt que de créer des méthodes tropdynamiques qui sont difficiles à typer. Malgré tout, le système de typage est asez flexible pour s'adapter à beaucoup de situations.</p>
                    <h4>Lisibilité du code :</h4>
                    <p>Enfin, le dernier problème réside dans le mélange entre le code et les types. Parfois ce mélange peut rendre le code moins isible.</p>
<pre><code>function push&lt;T, U&gt;(items: readonly T[], item: U): (T | )[] {
    return [...items, item];
}</code></pre>
                    <p>On aura la possibilité de créer des alias pour mitiger ce problème. Bien que cette pratique est rare, vous pouvez aussi déplacer les types dans les commentaires si vous le souhaitez pas les mélanger à votre code.</p>
                    <h3>Adopter TypeScript :</h3>
                    <p>Avec tout ça, on peut se poser la question sur l'utilisation du TypeScript. Au final, c'est à vous de voir si vous jugez que l'intérêt des avantages est supérieur aux inconvénients.</p>
                    <p>Cependant, si vous n'êtes pas fan de TypeScript dans sa globalité, vous pouvez l'utiliser avec différents niveaux d'implication.</p>
                    <ul>
                        <li>
                            <p>Vous pouvez continuer à écrire du JavaScript et utiliser TypeScript pour vérifier vptre code pour des erreurs simples (variables non définies). Si vous avez de la documentation JSDoc, il peut l'utiliser pour vérifier certaines correspondances.</p>
                        </li>
                        <li>
                            <p>Vous pouvez juste l'utiliser pour créer un fichier de déclaration pour votre librairie pour simplifier son utilisation.</p>
                        </li>
                        <li>
                            <p>Ou l'adopter complètement en écrivat votre code directement en TypeScript.</p>
                        </li>
                    </ul>
                    <h3>Conclusion :</h3>
                    <p>Pour résumer, TypeScript est un langage de programmation cousin du JavaScript. C'est précisément du JavaScript fortement typé. Pour utiliser TypeScript, il faut avoir installé Node.JS.</p>
                    <p>Pour créer un projet Node.JS, on utilise la commande suivante :</p>
<pre><code>npm init -y</code></pre>
                    <p>Pour ajouter TypeScript au projet, on utilise la commande ci-dessous :</p>
<pre><code>npm install typescript --save-dev</code></pre>
                    <p>Pour compiler le fichier <span class="em">my-file.ts</span>, on utilise le Node Package eXecute (NPX) TypeScript Compiler (TSC) en précisant la compilation en ES6 :</p>
<pre><code>npx tsc my-file.ts --target es6</code></pre>
                    <p>Exemple du fichier <span class="em">my-file.ts</span> :</p>
<pre><code>function addition(x: number, y: number): number {
    return x + y;
}

const = resumt: number = addition('10', '20');
console.log(result);</code></pre>
                    <p>Faites attention car <span class="html">number !== Number</span> et lance <span class="em">TypeScript Error Translator</span> !</p>
                    <p>Pour les types de tableaux, il y a deux notations :</p>
<pre><code>type MyArrayOfNumbers = number[];
# ou
type MyArrayOfNumbers = Array&lt;number&gt;;</code></pre>
                    <p>Il existe un type <span class="html">unknown</span> quand on ne sait pas quel type on attend.</p>
                </article>
            <!-- fin de section -->
            </section>
        </main>
        <footer role="contentinfo">
            <div>
                <address>
                    Professeurs :
                    <a class="mail" href="mailto:olivier.choquet@vinci.be">Choquet Olivier</a>
                    <a class="mail" href="mailto:driss.vandenheede.techinfo@gmail.com">Vandenheede Driss</a>
                </address>
            </div>
            <div>
                <p>Si vous détectez une erreur, une faute d'orthographe, n'hésitez pas à envoyer un mail aux adresses juste à côté avec le nom de la page et l'erreur détectée.</p>
            </div>
            <div id="version">
                <p>Syllabus HTML</p>
                <p>Version 5.0</p>
            </div>
        </footer>
        <script src="../pre.js"></script>
    </body>
</html>